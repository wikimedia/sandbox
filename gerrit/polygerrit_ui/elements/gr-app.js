const e=/^(https?:\/\/|mailto:|[^:/?#]*(?:[/?#]|$))/i;class t{constructor(t){if(!e.test(t))throw new Error(`URL not marked as safe: ${t}`);this._url=t}toString(){return this._url}}const i={};class n{constructor(){this._experiments=this._loadExperiments()}isEnabled(e){return this._experiments.has(e)}_loadExperiments(){return new Set(window.ENABLED_EXPERIMENTS)}get enabledExperiments(){return[...this._experiments]}}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function r(e,t){throw console.error(t,e),new Error(t)}function s(e,t){if(!e)throw new Error(t)}function a(e,t="variable"){if(null==e)throw new Error(`${t} is not defined`)}function l(e,t){for(const i of t)if(!e.has(i))return!1;return!0}function c(e,t,i){return i.indexOf(e)===t}var d,h,p;!function(e){e.PLUGIN_LIFE_CYCLE="Plugin life cycle",e.STARTED_AS_USER="Started as user",e.STARTED_AS_GUEST="Started as guest",e.VISIBILILITY_HIDDEN="Visibility changed to hidden",e.VISIBILILITY_VISIBLE="Visibility changed to visible",e.EXTENSION_DETECTED="Extension detected",e.PLUGINS_INSTALLED="Plugins installed",e.USER_REFERRED_FROM="User referred from"}(d||(d={})),function(e){e.PLUGIN_API="plugin-api",e.REACHABLE_CODE="reachable code",e.METHOD_USED="method used"}(h||(h={})),function(e){e.APP_STARTED="App Started",e.CHANGE_DISPLAYED="ChangeDisplayed",e.CHANGE_LOAD_FULL="ChangeFullyLoaded",e.DASHBOARD_DISPLAYED="DashboardDisplayed",e.DIFF_VIEW_CONTENT_DISPLAYED="DiffViewOnlyContent",e.DIFF_VIEW_DISPLAYED="DiffViewDisplayed",e.DIFF_VIEW_LOAD_FULL="DiffViewFullyLoaded",e.FILE_LIST_DISPLAYED="FileListDisplayed",e.PLUGINS_LOADED="PluginsLoaded",e.METRICS_PLUGIN_LOADED="MetricsPluginLoaded",e.STARTUP_CHANGE_DISPLAYED="StartupChangeDisplayed",e.STARTUP_CHANGE_LOAD_FULL="StartupChangeFullyLoaded",e.STARTUP_DASHBOARD_DISPLAYED="StartupDashboardDisplayed",e.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED="StartupDiffViewOnlyContent",e.STARTUP_DIFF_VIEW_DISPLAYED="StartupDiffViewDisplayed",e.STARTUP_DIFF_VIEW_LOAD_FULL="StartupDiffViewFullyLoaded",e.STARTUP_FILE_LIST_DISPLAYED="StartupFileListDisplayed",e.WEB_COMPONENTS_READY="WebComponentsReady",e.CHANGE_DATA="ChangeDataLoaded",e.CHANGE_RELOAD="ChangeReloaded",e.SEND_REPLY="SendReply",e.DIFF_TOTAL="Diff Total Render",e.DIFF_CONTENT="Diff Content Render",e.DIFF_SYNTAX="Diff Syntax Render",e.FILE_RENDER="FileListRenderTime",e.FILE_RENDER_AVG="FileListRenderTimePerFile",e.FILE_EXPAND_ALL="ExpandAllDiffs",e.FILE_EXPAND_ALL_AVG="ExpandAllPerDiff"}(p||(p={}));const u="timing-report",g={UI_LATENCY:"UI Latency",RPC:"RPC Timing"},m="lifecycle",f={DEFAULT:"Default",EXTENSION_DETECTED:"Extension detected",PLUGINS_INSTALLED:"Plugins installed",VISIBILITY:"Visibility",EXECUTION:"Execution"},_="interaction",v={DEFAULT:"Default",VISIBILITY:"Visibility"},y="nav-report",b={LOCATION_CHANGED:"Location Changed"},w={PAGE:"Page"},C="error",S={EXCEPTION:"exception",ERROR_DIALOG:"Error Dialog"},E={[p.PLUGINS_LOADED]:0,[p.METRICS_PLUGIN_LOADED]:0,[p.STARTUP_CHANGE_DISPLAYED]:0,[p.STARTUP_CHANGE_LOAD_FULL]:0,[p.STARTUP_DASHBOARD_DISPLAYED]:0,[p.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED]:0,[p.STARTUP_DIFF_VIEW_DISPLAYED]:0,[p.STARTUP_DIFF_VIEW_LOAD_FULL]:0,[p.STARTUP_FILE_LIST_DISPLAYED]:0,[p.APP_STARTED]:0,[p.WEB_COMPONENTS_READY]:0};class A{constructor(){this.accHiddenDurationMs=0,this.lastVisibleTimestampMs=null,this.reset()}reset(){this.accHiddenDurationMs=0,this.lastVisibleTimestampMs=0}onVisibilityChange(){"hidden"===document.visibilityState?this.lastVisibleTimestampMs=x():"visible"===document.visibilityState&&null!==this.lastVisibleTimestampMs&&(this.accHiddenDurationMs+=x()-this.lastVisibleTimestampMs,this.lastVisibleTimestampMs=null)}get hiddenDurationMs(){return"hidden"===document.visibilityState&&null!==this.lastVisibleTimestampMs?this.accHiddenDurationMs+x()-this.lastVisibleTimestampMs:this.accHiddenDurationMs}}function x(){return Math.round(window.performance.now())}class R{constructor(e){this._baselines=E,this.timers={timeBetweenDraftActions:null},this.pending=[],this.slowRpcList=[],this.executionReported=new Set,this.hiddenDurationTimer=new A,this._flagsService=e}get performanceTiming(){return window.performance.timing}get slowRpcSnapshot(){return(this.slowRpcList||[]).slice()}_arePluginsLoaded(){return this._baselines&&!o(this._baselines,p.PLUGINS_LOADED)}_isMetricsPluginLoaded(){return this._arePluginsLoaded()||this._baselines&&!o(this._baselines,p.METRICS_PLUGIN_LOADED)}reporter(e,t,i,n,o,r){const s=this._createEventInfo(e,t,i,n,o);e===C&&t===S.EXCEPTION&&console.error("object"==typeof n&&n.error||i),this._isMetricsPluginLoaded()&&!this.pending.length?this._reportEvent(s,r):(this.pending.push([s,r]),this._isMetricsPluginLoaded()&&(this.pending.forEach(([e,t])=>{this._reportEvent(e,t)}),this.pending=[]))}_reportEvent(e,t){const{type:i,value:n,name:o}=e;document.dispatchEvent(new CustomEvent(i,{detail:e})),t||i!==C&&(void 0!==n?console.info(`Reporting: ${o}: ${n}`):console.info(`Reporting: ${o}`))}_createEventInfo(e,t,i,n,o){const r={type:e,category:t,name:i,value:n,eventStart:x()};"object"==typeof o&&0!==Object.entries(o).length&&(r.eventDetails=JSON.stringify(o)),this.reportRepoName&&(r.repoName=this.reportRepoName),this.reportChangeId&&(r.changeId=`${this.reportChangeId}`);const s="hidden"===document.visibilityState;return void 0!==s&&(r.inBackgroundTab=s),this._flagsService.enabledExperiments.length&&(r.enabledExperiments=JSON.stringify(this._flagsService.enabledExperiments)),r}appStarted(){this.timeEnd(p.APP_STARTED),this._reportNavResTimes()}onVisibilityChange(){let e;this.hiddenDurationTimer.onVisibilityChange(),"hidden"===document.visibilityState?e=d.VISIBILILITY_HIDDEN:"visible"===document.visibilityState&&(e=d.VISIBILILITY_VISIBLE),e&&this.reporter(m,f.VISIBILITY,e,void 0,{hiddenDurationMs:this.hiddenDurationTimer.hiddenDurationMs},!1)}_reportNavResTimes(){Object.keys(this.performanceTiming.toJSON()).forEach(e=>this._reportPerformanceTiming(e))}_reportPerformanceTiming(e,t){const i=this.performanceTiming[e];if(i>0){const n=i-this.performanceTiming.navigationStart;this.reporter(u,g.UI_LATENCY,`NavResTime - ${e}`,n,t,!0)}}beforeLocationChanged(){for(const e of Object.keys(this._baselines))delete this._baselines[e];this.time(p.CHANGE_DISPLAYED),this.time(p.CHANGE_LOAD_FULL),this.time(p.DASHBOARD_DISPLAYED),this.time(p.DIFF_VIEW_CONTENT_DISPLAYED),this.time(p.DIFF_VIEW_DISPLAYED),this.time(p.DIFF_VIEW_LOAD_FULL),this.time(p.FILE_LIST_DISPLAYED),this.reportRepoName=void 0,this.reportChangeId=void 0,this.slowRpcList=[],this.hiddenDurationTimer.reset()}locationChanged(e){this.reporter(y,b.LOCATION_CHANGED,w.PAGE,e)}dashboardDisplayed(){o(this._baselines,p.STARTUP_DASHBOARD_DISPLAYED)?this.timeEnd(p.STARTUP_DASHBOARD_DISPLAYED,this._pageLoadDetails()):this.timeEnd(p.DASHBOARD_DISPLAYED,this._pageLoadDetails())}changeDisplayed(){o(this._baselines,p.STARTUP_CHANGE_DISPLAYED)?this.timeEnd(p.STARTUP_CHANGE_DISPLAYED,this._pageLoadDetails()):this.timeEnd(p.CHANGE_DISPLAYED,this._pageLoadDetails())}changeFullyLoaded(){o(this._baselines,p.STARTUP_CHANGE_LOAD_FULL)?this.timeEnd(p.STARTUP_CHANGE_LOAD_FULL):this.timeEnd(p.CHANGE_LOAD_FULL)}diffViewDisplayed(){o(this._baselines,p.STARTUP_DIFF_VIEW_DISPLAYED)?this.timeEnd(p.STARTUP_DIFF_VIEW_DISPLAYED,this._pageLoadDetails()):this.timeEnd(p.DIFF_VIEW_DISPLAYED,this._pageLoadDetails())}diffViewFullyLoaded(){o(this._baselines,p.STARTUP_DIFF_VIEW_LOAD_FULL)?this.timeEnd(p.STARTUP_DIFF_VIEW_LOAD_FULL):this.timeEnd(p.DIFF_VIEW_LOAD_FULL)}diffViewContentDisplayed(){o(this._baselines,p.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED)?this.timeEnd(p.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED):this.timeEnd(p.DIFF_VIEW_CONTENT_DISPLAYED)}fileListDisplayed(){o(this._baselines,p.STARTUP_FILE_LIST_DISPLAYED)?this.timeEnd(p.STARTUP_FILE_LIST_DISPLAYED):this.timeEnd(p.FILE_LIST_DISPLAYED)}_pageLoadDetails(){var e;const t={rpcList:this.slowRpcSnapshot,hiddenDurationMs:this.hiddenDurationTimer.accHiddenDurationMs};if(window.screen&&(t.screenSize={width:window.screen.width,height:window.screen.height}),(null===document||void 0===document?void 0:document.documentElement)&&(t.viewport={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}),null===(e=window.performance)||void 0===e?void 0:e.memory){const e=e=>Math.round(e/1048576*100)/100;t.usedJSHeapSizeMb=e(window.performance.memory.usedJSHeapSize)}return t.hiddenDurationMs=this.hiddenDurationTimer.hiddenDurationMs,t}reportExtension(e){this.reporter(m,f.EXTENSION_DETECTED,d.EXTENSION_DETECTED,void 0,{name:e})}pluginLoaded(e){e.startsWith("metrics-")&&this.timeEnd(p.METRICS_PLUGIN_LOADED)}pluginsLoaded(e){this.timeEnd(p.PLUGINS_LOADED),this.reporter(m,f.PLUGINS_INSTALLED,d.PLUGINS_INSTALLED,void 0,{pluginsList:e||[]},!0)}time(e){this._baselines[e]=x(),window.performance.mark(`${e}-start`)}timeEnd(e,t){if(!o(this._baselines,e))return;const i=this._baselines[e];delete this._baselines[e],this._reportTiming(e,x()-i,t),0!==i?window.performance.measure(e,`${e}-start`):window.performance.measure(e)}timeEndWithAverage(e,t,i){if(!o(this._baselines,e))return;const n=this._baselines[e];if(this.timeEnd(e),!i)return;const r=x()-n;this._reportTiming(t,r/i)}_reportTiming(e,t,i){this.reporter(u,g.UI_LATENCY,e,t,i)}getTimer(e){let t,i=!1,n=null;const o={reset:()=>(i=!1,t=x(),o),end:()=>{if(i)throw new Error(`Timer for "${e}" already ended.`);i=!0;const r=x()-t;return n&&r>n?o:(this._reportTiming(e,r),o)},withMaximum:e=>(n=e,o)};return o.reset()}reportRpcTiming(e,t){this.reporter(u,g.RPC,"RPC-"+e,t,{},!0),t>=500&&this.slowRpcList.push({anonymizedUrl:e,elapsed:t})}reportLifeCycle(e,t){this.reporter(m,f.DEFAULT,e,void 0,t,!0)}reportInteraction(e,t){this.reporter(_,v.DEFAULT,e,void 0,t,!0)}reportExecution(e,t){const i=`${e}${JSON.stringify(t)}`;this.executionReported.has(i)||(this.executionReported.add(i),this.reporter(m,f.EXECUTION,e,void 0,t,!0))}trackApi(e,t,i){var n;const o=null!==(n=null==e?void 0:e.getPluginName())&&void 0!==n?n:"unknown";this.reportExecution(h.PLUGIN_API,{plugin:o,object:t,method:i})}recordDraftInteraction(){const e=this.timers.timeBetweenDraftActions;e?e.end().reset():this.timers.timeBetweenDraftActions=this.getTimer("TimeBetweenDraftActions").withMaximum(12e4)}error(e,t,i){const n=null!=i?i:{},o=`${t?t+": ":""}${e.message}`;this.reporter(C,S.EXCEPTION,o,{error:e},{...n,stack:e.stack})}reportErrorDialog(e){this.reporter(C,S.ERROR_DIALOG,"ErrorDialog: "+e,{error:new Error(e)})}setRepoName(e){this.reportRepoName=e}setChangeId(e){this.reportChangeId=e}}class T{constructor(){this._listenersMap=new Map}addListener(e,t){if(!e||!t)return console.warn("A valid eventname and callback is required!"),()=>{};const i=this._listenersMap.get(e)||[];return i.push(t),this._listenersMap.set(e,i),()=>{this.off(e,t)}}on(e,t){return this.addListener(e,t)}once(e,t){const i=(...n)=>{t(...n),this.off(e,i)};return this.on(e,i)}removeListener(e,t){let i=this._listenersMap.get(e)||[];i=i.filter(e=>e!==t),this._listenersMap.set(e,i)}off(e,t){this.removeListener(e,t)}emit(e,t){const i=this._listenersMap.get(e)||[];for(const e of i)try{e(t)}catch(e){console.error(e)}return 0!==i.length}dispatch(e,t){return this.emit(e,t)}removeAllListeners(e){e?this._listenersMap.set(e,[]):this._listenersMap=new Map}}function k(){return window.CANONICAL_PATH||""}let P;function I(e,t){return P||(P=new Promise(i=>{var n;(null===(n=null==e?void 0:e.gerrit)||void 0===n?void 0:n.doc_url)?i(e.gerrit.doc_url):t.probePath(k()+"/Documentation/index.html").then(e=>{i(e?k()+"/Documentation":null)})})),P}function O(e,t){let i=encodeURIComponent(encodeURIComponent(e));return i=i.replace(/%253A/g,":"),i=i.replace(/%2520/g,"+"),t&&(i=i.replace(/%252F/g,"/")),i}function N(e){const t=e.replace(/\+/g,"%20");return decodeURIComponent(t)}var L,D;!function(e){e.XSRF_TOKEN="xsrf_token",e.ACCESS_TOKEN="access_token"}(L||(L={})),function(e){e[e.UNDETERMINED=0]="UNDETERMINED",e[e.AUTHED=1]="AUTHED",e[e.NOT_AUTHED=2]="NOT_AUTHED",e[e.ERROR=3]="ERROR"}(D||(D={}));class M{constructor(e){this._last_auth_check_time=Date.now(),this._status=D.UNDETERMINED,this.retriesLeft=2,this.cachedTokenPromise=null,this.defaultOptions={},this.getToken=()=>Promise.resolve(this.cachedTokenPromise),this.eventEmitter=e}get baseUrl(){return k()}authCheck(){return(!this.authCheckPromise||Date.now()-this._last_auth_check_time>3e4)&&(this.authCheckPromise=fetch(`${this.baseUrl}/auth-check`),this._last_auth_check_time=Date.now()),this.authCheckPromise.then(e=>204===e.status?(this._setStatus(M.STATUS.AUTHED),!0):(this._setStatus(M.STATUS.NOT_AUTHED),!1)).catch(()=>(this._setStatus(D.ERROR),this.authCheckPromise=void 0,!1))}clearCache(){this.authCheckPromise=void 0}_setStatus(e){this._status!==e&&(this._status===D.AUTHED&&this.eventEmitter.emit("auth-error",{message:M.CREDS_EXPIRED_MSG,action:"Refresh credentials"}),this._status=e)}get status(){return this._status}get isAuthed(){return this._status===M.STATUS.AUTHED}setup(e,t){this.retriesLeft=2,e&&(this.type=L.ACCESS_TOKEN,this.cachedTokenPromise=null,this.getToken=e),this.defaultOptions={},t&&(this.defaultOptions.credentials=t.credentials)}fetch(e,t){const i={headers:new Headers,...this.defaultOptions,...t};return this.type===L.ACCESS_TOKEN?this._getAccessToken().then(t=>this._fetchWithAccessToken(e,i,t)):this._fetchWithXsrfToken(e,i)}_getCookie(e){const t=e+"=";let i="";return document.cookie.split(";").some(e=>!!(e=e.trim()).startsWith(t)&&(i=e.substring(t.length),!0)),i}_isTokenValid(e){if(!e)return!1;if(!e.access_token||!e.expires_at)return!1;const t=new Date(1e3*Number(e.expires_at));return!(Date.now()>=t.getTime())}_fetchWithXsrfToken(e,t){if(t.method&&"GET"!==t.method){const e=this._getCookie("XSRF_TOKEN");e&&t.headers.append("X-Gerrit-Auth",e)}return t.credentials="same-origin",fetch(e,t)}_getAccessToken(){return this.cachedTokenPromise||(this.cachedTokenPromise=this.getToken()),this.cachedTokenPromise.then(e=>this._isTokenValid(e)?(this.retriesLeft=2,e.access_token):this.retriesLeft>0?(this.retriesLeft--,this.cachedTokenPromise=null,this._getAccessToken()):null)}_fetchWithAccessToken(e,t,i){const n=[];if(i){n.push(`access_token=${i}`);const t=this.baseUrl,o=t?e.substring(e.indexOf(t)+t.length):e;o.startsWith("/a/")||(e=e.replace(o,"/a"+o))}const o=t.method||"GET";let r=t.headers.get("Content-Type");return!r&&t.body&&(r="application/json"),"GET"!==o&&(t.method="POST",n.push(`$m=${o}`),r||(r="text/plain")),r&&(t.headers.set("Content-Type","text/plain"),n.push(`$ct=${encodeURIComponent(r)}`)),n.length&&(e=e+(-1===e.indexOf("?")?"?":"&")+n.join("&")),fetch(e,t)}}M.TYPE={XSRF_TOKEN:L.XSRF_TOKEN,ACCESS_TOKEN:L.ACCESS_TOKEN},M.STATUS={UNDETERMINED:D.UNDETERMINED,AUTHED:D.AUTHED,NOT_AUTHED:D.NOT_AUTHED,ERROR:D.ERROR},M.CREDS_EXPIRED_MSG="Credentials expired.",window.JSCompiler_renameProperty=function(e,t){return e};let F,$,B=/(url\()([^)]*)(\))/g,j=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;function H(e,t){if(e&&j.test(e))return e;if("//"===e)return e;if(void 0===F){F=!1;try{const e=new URL("b","http://a");e.pathname="c%20d",F="http://a/c%20d"===e.href}catch(e){}}if(t||(t=document.baseURI||window.location.href),F)try{return new URL(e,t).href}catch(t){return e}return $||($=document.implementation.createHTMLDocument("temp"),$.base=$.createElement("base"),$.head.appendChild($.base),$.anchor=$.createElement("a"),$.body.appendChild($.anchor)),$.base.href=t,$.anchor.href=e,$.anchor.href||e}function U(e,t){return e.replace(B,(function(e,i,n,o){return i+"'"+H(n.replace(/["']/g,""),t)+"'"+o}))}function G(e){return e.substring(0,e.lastIndexOf("/")+1)}const z=!window.ShadyDOM||!window.ShadyDOM.inUse,V=Boolean(!window.ShadyCSS||window.ShadyCSS.nativeCss),W=!window.customElements.polyfillWrapFlushCallback,q=z&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const e=new CSSStyleSheet;e.replaceSync("");const t=document.createElement("div");return t.attachShadow({mode:"open"}),t.shadowRoot.adoptedStyleSheets=[e],t.shadowRoot.adoptedStyleSheets[0]===e}catch(e){return!1}})();let K=window.Polymer&&window.Polymer.rootPath||G(document.baseURI||window.location.href);const Y=function(e){K=e};let X=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0;const J=function(e){X=e};let Z=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1;const Q=function(e){Z=e};let ee=window.Polymer&&window.Polymer.strictTemplatePolicy||!1;const te=function(e){ee=e};let ie=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1;const ne=function(e){ie=e};let oe=window.Polymer&&window.Polymer.legacyOptimizations||!1;const re=function(e){oe=e};let se=window.Polymer&&window.Polymer.legacyWarnings||!1;let ae=window.Polymer&&window.Polymer.syncInitialRender||!1;const le=function(e){ae=e};let ce=window.Polymer&&window.Polymer.legacyUndefined||!1;let de=window.Polymer&&window.Polymer.orderedComputed||!1;let he=!0;let pe=window.Polymer&&window.Polymer.removeNestedTemplates||!1;let ue=window.Polymer&&window.Polymer.fastDomIf||!1;let ge=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1;let me=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1;let fe=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1;let _e=0;function ve(){}ve.prototype.__mixinApplications,ve.prototype.__mixinSet;const ye=function(e){let t=e.__mixinApplications;t||(t=new WeakMap,e.__mixinApplications=t);let i=_e++;return function(n){let o=n.__mixinSet;if(o&&o[i])return n;let r=t,s=r.get(n);if(!s){s=e(n),r.set(n,s);let t=Object.create(s.__mixinSet||o||null);t[i]=!0,s.__mixinSet=t}return s}};let be={},we={};function Ce(e,t){be[e]=we[e.toLowerCase()]=t}function Se(e){return be[e]||we[e.toLowerCase()]}class Ee extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,t){if(e){let i=Se(e);return i&&t?i.querySelector(t):i}return null}attributeChangedCallback(e,t,i,n){t!==i&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,t=H(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=G(t)}return this.__assetpath}register(e){if(e=e||this.id){if(ee&&void 0!==Se(e))throw Ce(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,Ce(e,this),(t=this).querySelector("style")&&console.warn("dom-module %s has style outside template",t.id)}var t}}Ee.prototype.modules=be,customElements.define("dom-module",Ee);function Ae(e){return Ee.import(e)}function xe(e){const t=U((e.body?e.body:e).textContent,e.baseURI),i=document.createElement("style");return i.textContent=t,i}function Re(e){const t=e.trim().split(/\s+/),i=[];for(let e=0;e<t.length;e++)i.push(...Te(t[e]));return i}function Te(e){const t=Ae(e);if(!t)return console.warn("Could not find style data in module named",e),[];if(void 0===t._styles){const e=[];e.push(...Ie(t));const i=t.querySelector("template");i&&e.push(...ke(i,t.assetpath)),t._styles=e}return t._styles}function ke(e,t){if(!e._styles){const i=[],n=e.content.querySelectorAll("style");for(let e=0;e<n.length;e++){let o=n[e],r=o.getAttribute("include");r&&i.push(...Re(r).filter((function(e,t,i){return i.indexOf(e)===t}))),t&&(o.textContent=U(o.textContent,t)),i.push(o)}e._styles=i}return e._styles}function Pe(e){let t=Ae(e);return t?Ie(t):[]}function Ie(e){const t=[],i=e.querySelectorAll("link[rel=import][type~=css]");for(let e=0;e<i.length;e++){let n=i[e];if(n.import){const e=n.import,i=n.hasAttribute("shady-unscoped");if(i&&!e._unscopedStyle){const t=xe(e);t.setAttribute("shady-unscoped",""),e._unscopedStyle=t}else e._style||(e._style=xe(e));t.push(i?e._unscopedStyle:e._style)}}return t}function Oe(e){let t=e.trim().split(/\s+/),i="";for(let e=0;e<t.length;e++)i+=Ne(t[e]);return i}function Ne(e){let t=Ae(e);if(t&&void 0===t._cssText){let e=De(t),i=t.querySelector("template");i&&(e+=Le(i,t.assetpath)),t._cssText=e||null}return t||console.warn("Could not find style data in module named",e),t&&t._cssText||""}function Le(e,t){let i="";const n=ke(e,t);for(let e=0;e<n.length;e++){let t=n[e];t.parentNode&&t.parentNode.removeChild(t),i+=t.textContent}return i}function De(e){let t="",i=Ie(e);for(let e=0;e<i.length;e++)t+=i[e].textContent;return t}const Me=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?e=>ShadyDOM.patch(e):e=>e;function Fe(e){return e.indexOf(".")>=0}function $e(e){let t=e.indexOf(".");return-1===t?e:e.slice(0,t)}function Be(e,t){return 0===e.indexOf(t+".")}function je(e,t){return 0===t.indexOf(e+".")}function He(e,t,i){return t+i.slice(e.length)}function Ue(e,t){return e===t||Be(e,t)||je(e,t)}function Ge(e){if(Array.isArray(e)){let t=[];for(let i=0;i<e.length;i++){let n=e[i].toString().split(".");for(let e=0;e<n.length;e++)t.push(n[e])}return t.join(".")}return e}function ze(e){return Array.isArray(e)?Ge(e).split("."):e.toString().split(".")}function Ve(e,t,i){let n=e,o=ze(t);for(let e=0;e<o.length;e++){if(!n)return;n=n[o[e]]}return i&&(i.path=o.join(".")),n}function We(e,t,i){let n=e,o=ze(t),r=o[o.length-1];if(o.length>1){for(let e=0;e<o.length-1;e++){if(n=n[o[e]],!n)return}n[r]=i}else n[t]=i;return o.join(".")}const qe=Fe,Ke={},Ye=/-[a-z]/g,Xe=/([A-Z])/g;function Je(e){return Ke[e]||(Ke[e]=e.indexOf("-")<0?e:e.replace(Ye,e=>e[1].toUpperCase()))}function Ze(e){return Ke[e]||(Ke[e]=e.replace(Xe,"-$1").toLowerCase())}let Qe=0,et=0,tt=[],it=0,nt=!1,ot=document.createTextNode("");new window.MutationObserver((function(){nt=!1;const e=tt.length;for(let t=0;t<e;t++){let e=tt[t];if(e)try{e()}catch(e){setTimeout(()=>{throw e})}}tt.splice(0,e),et+=e})).observe(ot,{characterData:!0});const rt={after:e=>({run:t=>window.setTimeout(t,e),cancel(e){window.clearTimeout(e)}}),run:(e,t)=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}},st={run:e=>window.requestAnimationFrame(e),cancel(e){window.cancelAnimationFrame(e)}},at={run:e=>window.requestIdleCallback?window.requestIdleCallback(e):window.setTimeout(e,16),cancel(e){window.cancelIdleCallback?window.cancelIdleCallback(e):window.clearTimeout(e)}},lt={run:e=>(nt||(nt=!0,ot.textContent=it++),tt.push(e),Qe++),cancel(e){const t=e-et;if(t>=0){if(!tt[t])throw new Error("invalid async handle: "+e);tt[t]=null}}},ct=lt,dt=ye(e=>class extends e{static createProperties(e){const t=this.prototype;for(let i in e)i in t||t._createPropertyAccessor(i)}static attributeNameForProperty(e){return e.toLowerCase()}static typeForProperty(e){}_createPropertyAccessor(e,t){this._addPropertyToAttributeMap(e),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[e]||(this.__dataHasAccessor[e]=!0,this._definePropertyAccessor(e,t))}_addPropertyToAttributeMap(e){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let t=this.__dataAttributes[e];return t||(t=this.constructor.attributeNameForProperty(e),this.__dataAttributes[t]=e),t}_definePropertyAccessor(e,t){Object.defineProperty(this,e,{get(){return this.__data[e]},set:t?function(){}:function(t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let e in this.__dataHasAccessor)this.hasOwnProperty(e)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[e]=this[e],delete this[e])}_initializeInstanceProperties(e){Object.assign(this,e)}_setProperty(e,t){this._setPendingProperty(e,t)&&this._invalidateProperties()}_getProperty(e){return this.__data[e]}_setPendingProperty(e,t,i){let n=this.__data[e],o=this._shouldPropertyChange(e,t,n);return o&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),!this.__dataOld||e in this.__dataOld||(this.__dataOld[e]=n),this.__data[e]=t,this.__dataPending[e]=t),o}_isPropertyPending(e){return!(!this.__dataPending||!this.__dataPending.hasOwnProperty(e))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,ct.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const e=this.__data,t=this.__dataPending,i=this.__dataOld;this._shouldPropertiesChange(e,t,i)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(e,t,i)),this.__dataCounter--}_shouldPropertiesChange(e,t,i){return Boolean(t)}_propertiesChanged(e,t,i){}_shouldPropertyChange(e,t,i){return i!==t&&(i==i||t==t)}attributeChangedCallback(e,t,i,n){t!==i&&this._attributeToProperty(e,i),super.attributeChangedCallback&&super.attributeChangedCallback(e,t,i,n)}_attributeToProperty(e,t,i){if(!this.__serializing){const n=this.__dataAttributes,o=n&&n[e]||e;this[o]=this._deserializeValue(t,i||this.constructor.typeForProperty(o))}}_propertyToAttribute(e,t,i){this.__serializing=!0,i=arguments.length<3?this[e]:i,this._valueToNodeAttribute(this,i,t||this.constructor.attributeNameForProperty(e)),this.__serializing=!1}_valueToNodeAttribute(e,t,i){const n=this._serializeValue(t);"class"!==i&&"name"!==i&&"slot"!==i||(e=Me(e)),void 0===n?e.removeAttribute(i):e.setAttribute(i,n)}_serializeValue(e){switch(typeof e){case"boolean":return e?"":void 0;default:return null!=e?e.toString():void 0}}_deserializeValue(e,t){switch(t){case Boolean:return null!==e;case Number:return Number(e);default:return e}}}),ht={};let pt=HTMLElement.prototype;for(;pt;){let e=Object.getOwnPropertyNames(pt);for(let t=0;t<e.length;t++)ht[e[t]]=!0;pt=Object.getPrototypeOf(pt)}const ut=ye(e=>{const t=dt(e);return class extends t{static createPropertiesForAttributes(){let e=this.observedAttributes;for(let t=0;t<e.length;t++)this.prototype._createPropertyAccessor(Je(e[t]))}static attributeNameForProperty(e){return Ze(e)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(e){for(let t in e)this._setProperty(t,e[t])}_ensureAttribute(e,t){const i=this;i.hasAttribute(e)||this._valueToNodeAttribute(i,t,e)}_serializeValue(e){switch(typeof e){case"object":if(e instanceof Date)return e.toString();if(e)try{return JSON.stringify(e)}catch(e){return""}default:return super._serializeValue(e)}}_deserializeValue(e,t){let i;switch(t){case Object:try{i=JSON.parse(e)}catch(t){i=e}break;case Array:try{i=JSON.parse(e)}catch(t){i=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${e}`)}break;case Date:i=isNaN(e)?String(e):Number(e),i=new Date(i);break;default:i=super._deserializeValue(e,t)}return i}_definePropertyAccessor(e,t){!function(e,t){if(!ht[t]){let i=e[t];void 0!==i&&(e.__data?e._setPendingProperty(t,i):(e.__dataProto?e.hasOwnProperty(JSCompiler_renameProperty("__dataProto",e))||(e.__dataProto=Object.create(e.__dataProto)):e.__dataProto={},e.__dataProto[t]=i))}}(this,e),super._definePropertyAccessor(e,t)}_hasAccessor(e){return this.__dataHasAccessor&&this.__dataHasAccessor[e]}_isPropertyPending(e){return Boolean(this.__dataPending&&e in this.__dataPending)}}}),gt={"dom-if":!0,"dom-repeat":!0};let mt=!1,ft=!1;function _t(e){(function(){if(!mt){mt=!0;const e=document.createElement("textarea");e.placeholder="a",ft=e.placeholder===e.textContent}return ft})()&&"textarea"===e.localName&&e.placeholder&&e.placeholder===e.textContent&&(e.textContent=null)}function vt(e){let t=e.getAttribute("is");if(t&&gt[t]){let i=e;for(i.removeAttribute("is"),e=i.ownerDocument.createElement(t),i.parentNode.replaceChild(e,i),e.appendChild(i);i.attributes.length;)e.setAttribute(i.attributes[0].name,i.attributes[0].value),i.removeAttribute(i.attributes[0].name)}return e}function yt(e,t){let i=t.parentInfo&&yt(e,t.parentInfo);if(!i)return e;for(let e=i.firstChild,n=0;e;e=e.nextSibling)if(t.parentIndex===n++)return e}function bt(e,t,i,n){n.id&&(t[n.id]=i)}function wt(e,t,i){if(i.events&&i.events.length)for(let n,o=0,r=i.events;o<r.length&&(n=r[o]);o++)e._addMethodEventListenerToNode(t,n.name,n.value,e)}function Ct(e,t,i,n){i.templateInfo&&(t._templateInfo=i.templateInfo,t._parentTemplateInfo=n)}const St=ye(e=>class extends e{static _parseTemplate(e,t){if(!e._templateInfo){let i=e._templateInfo={};i.nodeInfoList=[],i.nestedTemplate=Boolean(t),i.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,i,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,i){return this._parseTemplateNode(e.content,t,i)}static _parseTemplateNode(e,t,i){let n=!1,o=e;return"template"!=o.localName||o.hasAttribute("preserve-content")?"slot"===o.localName&&(t.hasInsertionPoint=!0):n=this._parseTemplateNestedTemplate(o,t,i)||n,_t(o),o.firstChild&&this._parseTemplateChildNodes(o,t,i),o.hasAttributes&&o.hasAttributes()&&(n=this._parseTemplateNodeAttributes(o,t,i)||n),n||i.noted}static _parseTemplateChildNodes(e,t,i){if("script"!==e.localName&&"style"!==e.localName)for(let n,o=e.firstChild,r=0;o;o=n){if("template"==o.localName&&(o=vt(o)),n=o.nextSibling,o.nodeType===Node.TEXT_NODE){let i=n;for(;i&&i.nodeType===Node.TEXT_NODE;)o.textContent+=i.textContent,n=i.nextSibling,e.removeChild(i),i=n;if(t.stripWhiteSpace&&!o.textContent.trim()){e.removeChild(o);continue}}let s={parentIndex:r,parentInfo:i};this._parseTemplateNode(o,t,s)&&(s.infoIndex=t.nodeInfoList.push(s)-1),o.parentNode&&r++}}static _parseTemplateNestedTemplate(e,t,i){let n=e,o=this._parseTemplate(n,t);return(o.content=n.content.ownerDocument.createDocumentFragment()).appendChild(n.content),i.templateInfo=o,!0}static _parseTemplateNodeAttributes(e,t,i){let n=!1,o=Array.from(e.attributes);for(let r,s=o.length-1;r=o[s];s--)n=this._parseTemplateNodeAttribute(e,t,i,r.name,r.value)||n;return n}static _parseTemplateNodeAttribute(e,t,i,n,o){return"on-"===n.slice(0,3)?(e.removeAttribute(n),i.events=i.events||[],i.events.push({name:n.slice(3),value:o}),!0):"id"===n&&(i.id=o,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e,t){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let i=(t=t||this.constructor._parseTemplate(e)).nodeInfoList,n=t.content||e.content,o=document.importNode(n,!0);o.__noInsertionPoint=!t.hasInsertionPoint;let r=o.nodeList=new Array(i.length);o.$={};for(let e,n=0,s=i.length;n<s&&(e=i[n]);n++){let i=r[n]=yt(o,e);bt(0,o.$,i,e),Ct(0,i,e,t),wt(this,i,e)}return o=o,o}_addMethodEventListenerToNode(e,t,i,n){let o=function(e,t,i){return e=e._methodHost||e,function(t){e[i]?e[i](t,t.detail):console.warn("listener method `"+i+"` not defined")}}(n=n||e,0,i);return this._addEventListenerToNode(e,t,o),o}_addEventListenerToNode(e,t,i){e.addEventListener(t,i)}_removeEventListenerFromNode(e,t,i){e.removeEventListener(t,i)}});let Et=0;const At=[],xt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},Rt=/[A-Z]/;function Tt(e,t,i){let n=e[t];if(n){if(!e.hasOwnProperty(t)&&(n=e[t]=Object.create(e[t]),i))for(let e in n){let t=n[e],i=n[e]=Array(t.length);for(let e=0;e<t.length;e++)i[e]=t[e]}}else n=e[t]={};return n}function kt(e,t,i,n,o,r){if(t){let s=!1;const a=Et++;for(let l in i){let c=t[o?$e(l):l];if(c)for(let t,d=0,h=c.length;d<h&&(t=c[d]);d++)t.info&&t.info.lastRun===a||o&&!It(l,t.trigger)||(t.info&&(t.info.lastRun=a),t.fn(e,l,i,n,t.info,o,r),s=!0)}return s}return!1}function Pt(e,t,i,n,o,r,s,a){let l=!1,c=t[s?$e(n):n];if(c)for(let t,d=0,h=c.length;d<h&&(t=c[d]);d++)t.info&&t.info.lastRun===i||s&&!It(n,t.trigger)||(t.info&&(t.info.lastRun=i),t.fn(e,n,o,r,t.info,s,a),l=!0);return l}function It(e,t){if(t){let i=t.name;return i==e||!(!t.structured||!Be(i,e))||!(!t.wildcard||!je(i,e))}return!0}function Ot(e,t,i,n,o){let r="string"==typeof o.method?e[o.method]:o.method,s=o.property;r?r.call(e,e.__data[s],n[s]):o.dynamicFn||console.warn("observer method `"+o.method+"` not defined")}function Nt(e,t,i){let n=$e(t);if(n!==t){return Lt(e,Ze(n)+"-changed",i[t],t),!0}return!1}function Lt(e,t,i,n){let o={value:i,queueProperty:!0};n&&(o.path=n),Me(e).dispatchEvent(new CustomEvent(t,{detail:o}))}function Dt(e,t,i,n,o,r){let s=(r?$e(t):t)!=t?t:null,a=s?Ve(e,s):e.__data[t];s&&void 0===a&&(a=i[t]),Lt(e,o.eventName,a,s)}function Mt(e,t,i,n,o){let r=e.__data[t];X&&(r=X(r,o.attrName,"attribute",e)),e._propertyToAttribute(t,o.attrName,r)}function Ft(e,t,i,n){let o=e[xt.COMPUTE];if(o)if(de){Et++;const r=function(e){let t=e.constructor.__orderedComputedDeps;if(!t){t=new Map;const i=e[xt.COMPUTE];let n,{counts:o,ready:r,total:s}=function(e){const t=e.__computeInfo,i={},n=e[xt.COMPUTE],o=[];let r=0;for(let e in t){const n=t[e];r+=i[e]=n.args.filter(e=>!e.literal).length+(n.dynamicFn?1:0)}for(let e in n)t[e]||o.push(e);return{counts:i,ready:o,total:r}}(e);for(;n=r.shift();){t.set(n,t.size);const e=i[n];e&&e.forEach(e=>{const t=e.info.methodInfo;--s,0==--o[t]&&r.push(t)})}if(0!==s){const t=e;console.warn(`Computed graph for ${t.localName} incomplete; circular?`)}e.constructor.__orderedComputedDeps=t}return t}(e),s=[];for(let e in t)Bt(e,o,s,r,n);let a;for(;a=s.shift();)jt(e,"",t,i,a)&&Bt(a.methodInfo,o,s,r,n);Object.assign(i,e.__dataOld),Object.assign(t,e.__dataPending),e.__dataPending=null}else{let r=t;for(;kt(e,o,r,i,n);)Object.assign(i,e.__dataOld),Object.assign(t,e.__dataPending),r=e.__dataPending,e.__dataPending=null}}const $t=(e,t,i)=>{let n=0,o=t.length-1,r=-1;for(;n<=o;){const s=n+o>>1,a=i.get(t[s].methodInfo)-i.get(e.methodInfo);if(a<0)n=s+1;else{if(!(a>0)){r=s;break}o=s-1}}r<0&&(r=o+1),t.splice(r,0,e)},Bt=(e,t,i,n,o)=>{const r=t[o?$e(e):e];if(r)for(let t=0;t<r.length;t++){const s=r[t];s.info.lastRun===Et||o&&!It(e,s.trigger)||(s.info.lastRun=Et,$t(s.info,i,n))}};function jt(e,t,i,n,o){let r=qt(e,t,i,n,o);if(r===At)return!1;let s=o.methodInfo;return e.__dataHasAccessor&&e.__dataHasAccessor[s]?e._setPendingProperty(s,r,!0):(e[s]=r,!1)}function Ht(e,t,i,n,o,r,s){i.bindings=i.bindings||[];let a={kind:n,target:o,parts:r,literal:s,isCompound:1!==r.length};if(i.bindings.push(a),function(e){return Boolean(e.target)&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode}(a)){let{event:e,negate:t}=a.parts[0];a.listenerEvent=e||Ze(o)+"-changed",a.listenerNegate=t}let l=t.nodeInfoList.length;for(let i=0;i<a.parts.length;i++){let n=a.parts[i];n.compoundIndex=i,Ut(e,t,a,n,l)}}function Ut(e,t,i,n,o){if(!n.literal)if("attribute"===i.kind&&"-"===i.target[0])console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character');else{let r=n.dependencies,s={index:o,binding:i,part:n,evaluator:e};for(let i=0;i<r.length;i++){let n=r[i];"string"==typeof n&&(n=Zt(n),n.wildcard=!0),e._addTemplatePropertyEffect(t,n.rootProperty,{fn:Gt,info:s,trigger:n})}}}function Gt(e,t,i,n,o,r,s){let a=s[o.index],l=o.binding,c=o.part;if(r&&c.source&&t.length>c.source.length&&"property"==l.kind&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let n=i[t];t=He(c.source,l.target,t),a._setPendingPropertyOrPath(t,n,!1,!0)&&e._enqueueClient(a)}else{let s=o.evaluator._evaluateBinding(e,c,t,i,n,r);s!==At&&function(e,t,i,n,o){o=function(e,t,i,n){if(i.isCompound){let o=e.__dataCompoundStorage[i.target];o[n.compoundIndex]=t,t=o.join("")}"attribute"!==i.kind&&("textContent"!==i.target&&("value"!==i.target||"input"!==e.localName&&"textarea"!==e.localName)||(t=null==t?"":t));return t}(t,o,i,n),X&&(o=X(o,i.target,i.kind,t));if("attribute"==i.kind)e._valueToNodeAttribute(t,o,i.target);else{let n=i.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[n]?t[xt.READ_ONLY]&&t[xt.READ_ONLY][n]||t._setPendingProperty(n,o)&&e._enqueueClient(t):e._setUnmanagedPropertyToNode(t,n,o)}}(e,a,l,c,s)}}function zt(e,t){if(t.isCompound){let i=e.__dataCompoundStorage||(e.__dataCompoundStorage={}),n=t.parts,o=new Array(n.length);for(let e=0;e<n.length;e++)o[e]=n[e].literal;let r=t.target;i[r]=o,t.literal&&"property"==t.kind&&("className"===r&&(e=Me(e)),e[r]=t.literal)}}function Vt(e,t,i){if(i.listenerEvent){let n=i.parts[0];e.addEventListener(i.listenerEvent,(function(e){!function(e,t,i,n,o){let r,s=e.detail,a=s&&s.path;a?(n=He(i,n,a),r=s&&s.value):r=e.currentTarget[i],r=o?!r:r,t[xt.READ_ONLY]&&t[xt.READ_ONLY][n]||!t._setPendingPropertyOrPath(n,r,!0,Boolean(a))||s&&s.queueProperty||t._invalidateProperties()}(e,t,i.target,n.source,n.negate)}))}}function Wt(e,t,i,n,o,r){r=t.static||r&&("object"!=typeof r||r[t.methodName]);let s={methodName:t.methodName,args:t.args,methodInfo:o,dynamicFn:r};for(let o,r=0;r<t.args.length&&(o=t.args[r]);r++)o.literal||e._addPropertyEffect(o.rootProperty,i,{fn:n,info:s,trigger:o});return r&&e._addPropertyEffect(t.methodName,i,{fn:n,info:s}),s}function qt(e,t,i,n,o){let r=e._methodHost||e,s=r[o.methodName];if(s){let n=e._marshalArgs(o.args,t,i);return n===At?At:s.apply(r,n)}o.dynamicFn||console.warn("method `"+o.methodName+"` not defined")}const Kt=[],Yt=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?((?:[a-zA-Z_$][\\w.:$\\-*]*)\\s*(?:\\(\\s*(?:(?:(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*)(?:,\\s*(?:((?:[a-zA-Z_$][\\w.:$\\-*]*)|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*))*)?)\\)\\s*)?)(?:]]|}})","g");function Xt(e){let t="";for(let i=0;i<e.length;i++){t+=e[i].literal||""}return t}function Jt(e){let t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let e={methodName:t[1],static:!0,args:Kt};if(t[2].trim()){return function(e,t){return t.args=e.map((function(e){let i=Zt(e);return i.literal||(t.static=!1),i}),this),t}(t[2].replace(/\\,/g,"&comma;").split(","),e)}return e}return null}function Zt(e){let t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),i={name:t,value:"",literal:!1},n=t[0];switch("-"===n&&(n=t[1]),n>="0"&&n<="9"&&(n="#"),n){case"'":case'"':i.value=t.slice(1,-1),i.literal=!0;break;case"#":i.value=Number(t),i.literal=!0}return i.literal||(i.rootProperty=$e(t),i.structured=Fe(t),i.structured&&(i.wildcard=".*"==t.slice(-2),i.wildcard&&(i.name=t.slice(0,-2)))),i}function Qt(e,t,i){let n=Ve(e,i);return void 0===n&&(n=t[i]),n}function ei(e,t,i,n){const o={indexSplices:n};ce&&!e._overrideLegacyUndefined&&(t.splices=o),e.notifyPath(i+".splices",o),e.notifyPath(i+".length",t.length),ce&&!e._overrideLegacyUndefined&&(o.indexSplices=[])}function ti(e,t,i,n,o,r){ei(e,t,i,[{index:n,addedCount:o,removed:r,object:t,type:"splice"}])}const ii=ye(e=>{const t=St(ut(e));return class extends t{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return xt}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(ni.length){let e=ni[ni.length-1];e._enqueueClient(this),this.__dataHost=e}}_initializeProtoProperties(e){this.__data=Object.create(e),this.__dataPending=Object.create(e),this.__dataOld={}}_initializeInstanceProperties(e){let t=this[xt.READ_ONLY];for(let i in e)t&&t[i]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[i]=this.__dataPending[i]=e[i])}_addPropertyEffect(e,t,i){this._createPropertyAccessor(e,t==xt.READ_ONLY);let n=Tt(this,t,!0)[e];n||(n=this[t][e]=[]),n.push(i)}_removePropertyEffect(e,t,i){let n=Tt(this,t,!0)[e],o=n.indexOf(i);o>=0&&n.splice(o,1)}_hasPropertyEffect(e,t){let i=this[t];return Boolean(i&&i[e])}_hasReadOnlyEffect(e){return this._hasPropertyEffect(e,xt.READ_ONLY)}_hasNotifyEffect(e){return this._hasPropertyEffect(e,xt.NOTIFY)}_hasReflectEffect(e){return this._hasPropertyEffect(e,xt.REFLECT)}_hasComputedEffect(e){return this._hasPropertyEffect(e,xt.COMPUTE)}_setPendingPropertyOrPath(e,t,i,n){if(n||$e(Array.isArray(e)?e[0]:e)!==e){if(!n){let i=Ve(this,e);if(!(e=We(this,e,t))||!super._shouldPropertyChange(e,t,i))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(e,t,i))return function(e,t,i){let n=e.__dataLinkedPaths;if(n){let o;for(let r in n){let s=n[r];je(r,t)?(o=He(r,s,t),e._setPendingPropertyOrPath(o,i,!0,!0)):je(s,t)&&(o=He(s,r,t),e._setPendingPropertyOrPath(o,i,!0,!0))}}}(this,e,t),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[e])return this._setPendingProperty(e,t,i);this[e]=t}return!1}_setUnmanagedPropertyToNode(e,t,i){i===e[t]&&"object"!=typeof i||("className"===t&&(e=Me(e)),e[t]=i)}_setPendingProperty(e,t,i){let n=this.__dataHasPaths&&Fe(e),o=n?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(e,t,o[e])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),e in this.__dataOld||(this.__dataOld[e]=this.__data[e]),n?this.__dataTemp[e]=t:this.__data[e]=t,this.__dataPending[e]=t,(n||this[xt.NOTIFY]&&this[xt.NOTIFY][e])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[e]=i),!0)}_setProperty(e,t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(e){this.__dataPendingClients=this.__dataPendingClients||[],e!==this&&this.__dataPendingClients.push(e)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let e=this.__dataPendingClients;if(e){this.__dataPendingClients=null;for(let t=0;t<e.length;t++){let i=e[t];i.__dataEnabled?i.__dataPending&&i._flushProperties():i._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(e,t){for(let i in e)!t&&this[xt.READ_ONLY]&&this[xt.READ_ONLY][i]||this._setPendingPropertyOrPath(i,e[i],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(e,t,i){let n,o=this.__dataHasPaths;this.__dataHasPaths=!1,Ft(this,t,i,o),n=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(t,i,o),this._flushClients(),kt(this,this[xt.REFLECT],t,i,o),kt(this,this[xt.OBSERVE],t,i,o),n&&function(e,t,i,n,o){let r,s,a=e[xt.NOTIFY],l=Et++;for(let s in t)t[s]&&(a&&Pt(e,a,l,s,i,n,o)?r=!0:o&&Nt(e,s,i)&&(r=!0));r&&(s=e.__dataHost)&&s._invalidateProperties&&s._invalidateProperties()}(this,n,t,i,o),1==this.__dataCounter&&(this.__dataTemp={})}_propagatePropertyChanges(e,t,i){this[xt.PROPAGATE]&&kt(this,this[xt.PROPAGATE],e,t,i),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,e,t,i)}_runEffectsForTemplate(e,t,i,n){const o=(t,n)=>{kt(this,e.propertyEffects,t,i,n,e.nodeList);for(let o=e.firstChild;o;o=o.nextSibling)this._runEffectsForTemplate(o,t,i,n)};e.runEffects?e.runEffects(o,t,n):o(t,n)}linkPaths(e,t){e=Ge(e),t=Ge(t),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[e]=t}unlinkPaths(e){e=Ge(e),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[e]}notifySplices(e,t){let i={path:""};ei(this,Ve(this,e,i),i.path,t)}get(e,t){return Ve(t||this,e)}set(e,t,i){i?We(i,e,t):this[xt.READ_ONLY]&&this[xt.READ_ONLY][e]||this._setPendingPropertyOrPath(e,t,!0)&&this._invalidateProperties()}push(e,...t){let i={path:""},n=Ve(this,e,i),o=n.length,r=n.push(...t);return t.length&&ti(this,n,i.path,o,t.length,[]),r}pop(e){let t={path:""},i=Ve(this,e,t),n=Boolean(i.length),o=i.pop();return n&&ti(this,i,t.path,i.length,0,[o]),o}splice(e,t,i,...n){let o,r={path:""},s=Ve(this,e,r);return t<0?t=s.length-Math.floor(-t):t&&(t=Math.floor(t)),o=2===arguments.length?s.splice(t):s.splice(t,i,...n),(n.length||o.length)&&ti(this,s,r.path,t,n.length,o),o}shift(e){let t={path:""},i=Ve(this,e,t),n=Boolean(i.length),o=i.shift();return n&&ti(this,i,t.path,0,0,[o]),o}unshift(e,...t){let i={path:""},n=Ve(this,e,i),o=n.unshift(...t);return t.length&&ti(this,n,i.path,0,t.length,[]),o}notifyPath(e,t){let i;if(1==arguments.length){let n={path:""};t=Ve(this,e,n),i=n.path}else i=Array.isArray(e)?Ge(e):e;this._setPendingPropertyOrPath(i,t,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(e,t){var i;this._addPropertyEffect(e,xt.READ_ONLY),t&&(this["_set"+(i=e,i[0].toUpperCase()+i.substring(1))]=function(t){this._setProperty(e,t)})}_createPropertyObserver(e,t,i){let n={property:e,method:t,dynamicFn:Boolean(i)};this._addPropertyEffect(e,xt.OBSERVE,{fn:Ot,info:n,trigger:{name:e}}),i&&this._addPropertyEffect(t,xt.OBSERVE,{fn:Ot,info:n,trigger:{name:t}})}_createMethodObserver(e,t){let i=Jt(e);if(!i)throw new Error("Malformed observer expression '"+e+"'");Wt(this,i,xt.OBSERVE,qt,null,t)}_createNotifyingProperty(e){this._addPropertyEffect(e,xt.NOTIFY,{fn:Dt,info:{eventName:Ze(e)+"-changed",property:e}})}_createReflectedProperty(e){let t=this.constructor.attributeNameForProperty(e);"-"===t[0]?console.warn("Property "+e+" cannot be reflected to attribute "+t+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(e,xt.REFLECT,{fn:Mt,info:{attrName:t}})}_createComputedProperty(e,t,i){let n=Jt(t);if(!n)throw new Error("Malformed computed expression '"+t+"'");const o=Wt(this,n,xt.COMPUTE,jt,e,i);Tt(this,"__computeInfo")[e]=o}_marshalArgs(e,t,i){const n=this.__data,o=[];for(let r=0,s=e.length;r<s;r++){let{name:s,structured:a,wildcard:l,value:c,literal:d}=e[r];if(!d)if(l){const e=je(s,t),o=Qt(n,i,e?t:s);c={path:e?t:s,value:o,base:e?Ve(n,s):o}}else c=a?Qt(n,i,s):n[s];if(ce&&!this._overrideLegacyUndefined&&void 0===c&&e.length>1)return At;o[r]=c}return o}static addPropertyEffect(e,t,i){this.prototype._addPropertyEffect(e,t,i)}static createPropertyObserver(e,t,i){this.prototype._createPropertyObserver(e,t,i)}static createMethodObserver(e,t){this.prototype._createMethodObserver(e,t)}static createNotifyingProperty(e){this.prototype._createNotifyingProperty(e)}static createReadOnlyProperty(e,t){this.prototype._createReadOnlyProperty(e,t)}static createReflectedProperty(e){this.prototype._createReflectedProperty(e)}static createComputedProperty(e,t,i){this.prototype._createComputedProperty(e,t,i)}static bindTemplate(e){return this.prototype._bindTemplate(e)}_bindTemplate(e,t){let i=this.constructor._parseTemplate(e),n=this.__preBoundTemplateInfo==i;if(!n)for(let e in i.propertyEffects)this._createPropertyAccessor(e);if(t)if(i=Object.create(i),i.wasPreBound=n,this.__templateInfo){const t=e._parentTemplateInfo||this.__templateInfo,n=t.lastChild;i.parent=t,t.lastChild=i,i.previousSibling=n,n?n.nextSibling=i:t.firstChild=i}else this.__templateInfo=i;else this.__preBoundTemplateInfo=i;return i}static _addTemplatePropertyEffect(e,t,i){(e.hostProps=e.hostProps||{})[t]=!0;let n=e.propertyEffects=e.propertyEffects||{};(n[t]=n[t]||[]).push(i)}_stampTemplate(e,t){t=t||this._bindTemplate(e,!0),ni.push(this);let i=super._stampTemplate(e,t);if(ni.pop(),t.nodeList=i.nodeList,!t.wasPreBound){let e=t.childNodes=[];for(let t=i.firstChild;t;t=t.nextSibling)e.push(t)}return i.templateInfo=t,function(e,t){let{nodeList:i,nodeInfoList:n}=t;if(n.length)for(let t=0;t<n.length;t++){let o=n[t],r=i[t],s=o.bindings;if(s)for(let t=0;t<s.length;t++){let i=s[t];zt(r,i),Vt(r,e,i)}r.__dataHost=e}}(this,t),this.__dataClientsReady&&(this._runEffectsForTemplate(t,this.__data,null,!1),this._flushClients()),i}_removeBoundDom(e){const t=e.templateInfo,{previousSibling:i,nextSibling:n,parent:o}=t;i?i.nextSibling=n:o&&(o.firstChild=n),n?n.previousSibling=i:o&&(o.lastChild=i),t.nextSibling=t.previousSibling=null;let r=t.childNodes;for(let e=0;e<r.length;e++){let t=r[e];Me(Me(t).parentNode).removeChild(t)}}static _parseTemplateNode(e,i,n){let o=t._parseTemplateNode.call(this,e,i,n);if(e.nodeType===Node.TEXT_NODE){let t=this._parseBindings(e.textContent,i);t&&(e.textContent=Xt(t)||" ",Ht(this,i,n,"text","textContent",t),o=!0)}return o}static _parseTemplateNodeAttribute(e,i,n,o,r){let s=this._parseBindings(r,i);if(s){let t=o,r="property";Rt.test(o)?r="attribute":"$"==o[o.length-1]&&(o=o.slice(0,-1),r="attribute");let a=Xt(s);return a&&"attribute"==r&&("class"==o&&e.hasAttribute("class")&&(a+=" "+e.getAttribute(o)),e.setAttribute(o,a)),"attribute"==r&&"disable-upgrade$"==t&&e.setAttribute(o,""),"input"===e.localName&&"value"===t&&e.setAttribute(t,""),e.removeAttribute(t),"property"===r&&(o=Je(o)),Ht(this,i,n,r,o,s,a),!0}return t._parseTemplateNodeAttribute.call(this,e,i,n,o,r)}static _parseTemplateNestedTemplate(e,i,n){let o=t._parseTemplateNestedTemplate.call(this,e,i,n);const r=e.parentNode,s=n.templateInfo,a="dom-if"===r.localName,l="dom-repeat"===r.localName;pe&&(a||l)&&(r.removeChild(e),(n=n.parentInfo).templateInfo=s,n.noted=!0,o=!1);let c=s.hostProps;if(ue&&a)c&&(i.hostProps=Object.assign(i.hostProps||{},c),pe||(n.parentInfo.noted=!0));else{let e="{";for(let t in c){Ht(this,i,n,"property","_host_"+t,[{mode:e,source:t,dependencies:[t],hostProp:!0}])}}return o}static _parseBindings(e,t){let i,n=[],o=0;for(;null!==(i=Yt.exec(e));){i.index>o&&n.push({literal:e.slice(o,i.index)});let r=i[1][0],s=Boolean(i[2]),a=i[3].trim(),l=!1,c="",d=-1;"{"==r&&(d=a.indexOf("::"))>0&&(c=a.substring(d+2),a=a.substring(0,d),l=!0);let h=Jt(a),p=[];if(h){let{args:e,methodName:i}=h;for(let t=0;t<e.length;t++){let i=e[t];i.literal||p.push(i)}let n=t.dynamicFns;(n&&n[i]||h.static)&&(p.push(i),h.dynamicFn=!0)}else p.push(a);n.push({source:a,mode:r,negate:s,customEvent:l,signature:h,dependencies:p,event:c}),o=Yt.lastIndex}if(o&&o<e.length){let t=e.substring(o);t&&n.push({literal:t})}return n.length?n:null}static _evaluateBinding(e,t,i,n,o,r){let s;return s=t.signature?qt(e,i,n,0,t.signature):i!=t.source?Ve(e,t.source):r&&Fe(i)?Ve(e,i):e.__data[i],t.negate&&(s=!s),s}}}),ni=[];let oi=0;function ri(){oi++}const si=[];function ai(e){console.log("["+e.is+"]: registered")}function li(e){si.push(e)}const ci=ye(e=>{const t=dt(e);function i(e){const t=Object.getPrototypeOf(e);return t.prototype instanceof o?t:null}function n(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",e))){let t=null;if(e.hasOwnProperty(JSCompiler_renameProperty("properties",e))){const i=e.properties;i&&(t=function(e){const t={};for(let i in e){const n=e[i];t[i]="function"==typeof n?{type:n}:n}return t}(i))}e.__ownProperties=t}return e.__ownProperties}class o extends t{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){li(this.prototype);const e=this._properties;this.__observedAttributes=e?Object.keys(e).map(e=>this.prototype._addPropertyToAttributeMap(e)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const e=i(this);e&&e.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const e=n(this);e&&this.createProperties(e)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const e=i(this);this.__properties=Object.assign({},e&&e._properties,n(this))}return this.__properties}static typeForProperty(e){const t=this._properties[e];return t&&t.type}_initializeProperties(){ri(),this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return o}),di=window.ShadyCSS&&window.ShadyCSS.cssBuild,hi=ye(e=>{const t=ci(ii(e));function i(e,t,i,n){i.computed&&(i.readOnly=!0),i.computed&&(e._hasReadOnlyEffect(t)?console.warn(`Cannot redefine computed property '${t}'.`):e._createComputedProperty(t,i.computed,n)),i.readOnly&&!e._hasReadOnlyEffect(t)?e._createReadOnlyProperty(t,!i.computed):!1===i.readOnly&&e._hasReadOnlyEffect(t)&&console.warn(`Cannot make readOnly property '${t}' non-readOnly.`),i.reflectToAttribute&&!e._hasReflectEffect(t)?e._createReflectedProperty(t):!1===i.reflectToAttribute&&e._hasReflectEffect(t)&&console.warn(`Cannot make reflected property '${t}' non-reflected.`),i.notify&&!e._hasNotifyEffect(t)?e._createNotifyingProperty(t):!1===i.notify&&e._hasNotifyEffect(t)&&console.warn(`Cannot make notify property '${t}' non-notify.`),i.observer&&e._createPropertyObserver(t,i.observer,n[i.observer]),e._addPropertyToAttributeMap(t)}return class extends t{static get polymerElementVersion(){return"3.4.1"}static _finalizeClass(){t._finalizeClass.call(this);const e=((i=this).hasOwnProperty(JSCompiler_renameProperty("__ownObservers",i))||(i.__ownObservers=i.hasOwnProperty(JSCompiler_renameProperty("observers",i))?i.observers:null),i.__ownObservers);var i;e&&this.createObservers(e,this._properties),this._prepareTemplate()}static _prepareTemplate(){let e=this.template;e&&("string"==typeof e?(console.error("template getter must return HTMLTemplateElement"),e=null):oe||(e=e.cloneNode(!0))),this.prototype._template=e}static createProperties(e){for(let t in e)i(this.prototype,t,e[t],e)}static createObservers(e,t){const i=this.prototype;for(let n=0;n<e.length;n++)i._createMethodObserver(e[n],t)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){const e=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;this._template=void 0!==e?e:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&function(e){let t=null;if(e&&(!ee||ie)&&(t=Ee.import(e,"template"),ee&&!t))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${e}`);return t}(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(e){this._template=e}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const e=this.importMeta;if(e)this._importPath=G(e.url);else{const e=Ee.import(this.is);this._importPath=e&&e.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=K,this.importPath=this.constructor.importPath;let e=function(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",e))){e.__propertyDefaults=null;let t=e._properties;for(let i in t){let n=t[i];"value"in n&&(e.__propertyDefaults=e.__propertyDefaults||{},e.__propertyDefaults[i]=n)}}return e.__propertyDefaults}(this.constructor);if(e)for(let t in e){let i=e[t];if(this._canApplyPropertyDefault(t)){let e="function"==typeof i.value?i.value.call(this):i.value;this._hasAccessor(t)?this._setPendingProperty(t,e,!0):this[t]=e}}}_canApplyPropertyDefault(e){return!this.hasOwnProperty(e)}static _processStyleText(e,t){return U(e,t)}static _finalizeTemplate(e){const t=this.prototype._template;if(t&&!t.__polymerFinalized){t.__polymerFinalized=!0;const i=this.importPath;!function(e,t,i,n){if(!di){const o=t.content.querySelectorAll("style"),r=ke(t),s=Pe(i),a=t.content.firstElementChild;for(let i=0;i<s.length;i++){let o=s[i];o.textContent=e._processStyleText(o.textContent,n),t.content.insertBefore(o,a)}let l=0;for(let t=0;t<r.length;t++){let i=r[t],s=o[l];s!==i?(i=i.cloneNode(!0),s.parentNode.insertBefore(i,s)):l++,i.textContent=e._processStyleText(i.textContent,n)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(t,i),fe&&di&&q){const i=t.content.querySelectorAll("style");if(i){let t="";Array.from(i).forEach(e=>{t+=e.textContent,e.parentNode.removeChild(e)}),e._styleSheet=new CSSStyleSheet,e._styleSheet.replaceSync(t)}}}(this,t,e,i?H(i):""),this.prototype._bindTemplate(t)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(e){const t=Me(this);if(t.attachShadow)return e?(t.shadowRoot||(t.attachShadow({mode:"open",shadyUpgradeFragment:e}),t.shadowRoot.appendChild(e),this.constructor._styleSheet&&(t.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),ae&&window.ShadyDOM&&window.ShadyDOM.flushInitial(t.shadowRoot),t.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(e){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)}resolveUrl(e,t){return!t&&this.importPath&&(t=H(this.importPath)),H(e,t)}static _parseTemplateContent(e,i,n){return i.dynamicFns=i.dynamicFns||this._properties,t._parseTemplateContent.call(this,e,i,n)}static _addTemplatePropertyEffect(e,i,n){return!se||i in this._properties||n.info.part.signature&&n.info.part.signature.static||n.info.part.hostProp||e.nestedTemplate||console.warn(`Property '${i}' used in template but not declared in 'properties'; `+"attribute will not be observed."),t._addTemplatePropertyEffect.call(this,e,i,n)}}}),pi=function(e){window.ShadyCSS&&window.ShadyCSS.styleDocument(e)};class ui{constructor(e){this.value=e.toString()}toString(){return this.value}}function gi(e){if(e instanceof ui)return e.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${e}`)}const mi=function(e,...t){const i=document.createElement("template");return i.innerHTML=t.reduce((t,i,n)=>t+function(e){if(e instanceof HTMLTemplateElement)return e.innerHTML;if(e instanceof ui)return gi(e);throw new Error(`non-template value passed to Polymer's html function: ${e}`)}(i)+e[n+1],e[0]),i},fi=hi(HTMLElement);class _i{constructor(){this._etags=new Map,this._payloadCache=new Map}getOptions(e,t){const i=this._etags.get(e);if(!i)return t;const n={...t};return n.headers=n.headers||new Headers,n.headers.set("If-None-Match",i),n}collect(e,t,i){if(!t||!t.ok||200!==t.status)return;this._payloadCache.set(e,i);const n=t.headers&&t.headers.get("etag");n?(this._etags.set(e,n),this._truncateCache()):this._etags.delete(e)}getCachedPayload(e){return this._payloadCache.get(e)}_truncateCache(){for(const e of this._etags.keys()){if(this._etags.size<=30)break;this._etags.delete(e),this._payloadCache.delete(e)}}}var vi,yi;function bi(e,t){e.dispatchEvent(new CustomEvent(t,{composed:!0,bubbles:!0}))}function wi(e,t,i){e.dispatchEvent(new CustomEvent(t,{detail:i,composed:!0,bubbles:!0}))}function Ci(e,t){wi(e,vi.SHOW_ALERT,{message:t})}function Si(e){null===e&&(e=void 0),wi(document,vi.PAGE_ERROR,{response:e})}function Ei(e,t){wi(document,vi.SERVER_ERROR,{response:e,request:t})}function Ai(e){wi(document,vi.NETWORK_ERROR,{error:e})}function xi(e,t){wi(e,vi.TITLE_CHANGE,{title:t})}function Ri(e,t){wi(e,vi.DIALOG_CHANGE,t)}function Ti(e,t){wi(e,vi.IRON_ANNOUNCE,{text:t})}function ki(e,t,i,n){const o={tab:t,scrollIntoView:i,tabState:n};wi(e,vi.SHOW_PRIMARY_TAB,o)}function Pi(e,t){return new Promise(i=>{e.addEventListener(t,e=>{i(e)},{once:!0})})}!function(e){e.CHANGE_MESSAGE_DELETED="change-message-deleted",e.DIALOG_CHANGE="dialog-change",e.EDITABLE_CONTENT_SAVE="editable-content-save",e.GR_RPC_LOG="gr-rpc-log",e.LOCATION_CHANGE="location-change",e.IRON_ANNOUNCE="iron-announce",e.MOVED_LINK_CLICKED="moved-link-clicked",e.NETWORK_ERROR="network-error",e.OPEN_FIX_PREVIEW="open-fix-preview",e.CLOSE_FIX_PREVIEW="close-fix-preview",e.PAGE_ERROR="page-error",e.RELOAD="reload",e.REPLY="reply",e.SERVER_ERROR="server-error",e.SHORTCUT_TRIGGERERD="shortcut-triggered",e.SHOW_ALERT="show-alert",e.SHOW_ERROR="show-error",e.SHOW_PRIMARY_TAB="show-primary-tab",e.SHOW_SECONDARY_TAB="show-secondary-tab",e.THREAD_LIST_MODIFIED="thread-list-modified",e.TITLE_CHANGE="title-change"}(vi||(vi={})),function(e){e.UNRESOLVED="unresolved",e.DRAFTS="drafts",e.SHOW_ALL="show all"}(yi||(yi={}));function Ii(e){return e.text().then(e=>{let t;try{t=Oi(e)}catch(e){t=null}return{parsed:t,raw:e}})}function Oi(e){return JSON.parse(e.substring(")]}'".length))}class Ni{constructor(){this.data=new Map,window.INITIAL_DATA&&Object.entries(window.INITIAL_DATA).forEach(e=>this._cache().set(e[0],e[1]))}_cache(){return this.data.has(window.CANONICAL_PATH)||this.data.set(window.CANONICAL_PATH,new Map),this.data.get(window.CANONICAL_PATH)}has(e){return this._cache().has(e)}get(e){return this._cache().get(e)}set(e,t){this._cache().set(e,t)}delete(e){this._cache().delete(e)}invalidatePrefix(e){const t=new Map;for(const[i,n]of this._cache().entries())i.startsWith(e)||t.set(i,n);this.data.set(window.CANONICAL_PATH,t)}}class Li{constructor(){this.data={}}testOnlyGetData(){return this.data}has(e){return!!this.data[e]}get(e){return this.data[e]}set(e,t){this.data[e]=t}invalidatePrefix(e){const t={};Object.entries(this.data).forEach(([i,n])=>{i.startsWith(e)||(t[i]=n)}),this.data=t}}class Di{constructor(e,t,i){this._cache=e,this._auth=t,this._fetchPromisesCache=i}fetch(e){const t=Date.now(),i=this._auth.fetch(e.url,e.fetchOptions);return i.then(i=>this._logCall(e,t,i?i.status:null)),i}_logCall(e,t,i){const n=e.fetchOptions&&e.fetchOptions.method?e.fetchOptions.method:"GET",o=Date.now(),r=o-t,s=new Date(t),a=new Date(o);if(console.info(["HTTP",i,n,`${r}ms`,e.anonymizedUrl||e.url,`(${s.toISOString()}, ${a.toISOString()})`].join(" ")),e.anonymizedUrl){const t={status:i,method:n,elapsed:r,anonymizedUrl:e.anonymizedUrl};document.dispatchEvent(new CustomEvent("gr-rpc-log",{detail:t,composed:!0,bubbles:!0}))}}fetchRawJSON(e){const t=this.urlWithParams(e.url,e.params),i={url:t,fetchOptions:e.fetchOptions,anonymizedUrl:e.reportUrlAsIs?t:e.anonymizedUrl};return this.fetch(i).then(t=>{if(!e.cancelCondition||!e.cancelCondition())return t;t.body&&t.body.cancel()}).catch(t=>{throw e.errFn?e.errFn.call(void 0,null,t):Ai(t),t})}fetchJSON(e,t){return t||(e=this.addAcceptJsonHeader(e)),this.fetchRawJSON(e).then(t=>{if(t)return t.ok?this.getResponseObject(t):e.errFn?void e.errFn.call(null,t):void Ei(t,e)})}urlWithParams(e,t){if(!t)return k()+e;const i=[];for(const[e,n]of Object.entries(t)){if(null==n){i.push(this.encodeRFC5987(e));continue}const t=[].concat(n);for(const n of t)i.push(`${this.encodeRFC5987(e)}=${this.encodeRFC5987(n)}`)}return k()+e+"?"+i.join("&")}encodeRFC5987(e){return encodeURIComponent(e).replace(/['()*]/g,e=>"%"+e.charCodeAt(0).toString(16))}getResponseObject(e){return Ii(e).then(e=>e.parsed)}addAcceptJsonHeader(e){return e.fetchOptions||(e.fetchOptions={}),e.fetchOptions.headers||(e.fetchOptions.headers=new Headers),e.fetchOptions.headers.has("Accept")||e.fetchOptions.headers.append("Accept","application/json"),e}fetchCacheURL(e){return this._fetchPromisesCache.has(e.url)?this._fetchPromisesCache.get(e.url):this._cache.has(e.url)?Promise.resolve(this._cache.get(e.url)):(this._fetchPromisesCache.set(e.url,this.fetchJSON(e).then(t=>(void 0!==t&&this._cache.set(e.url,t),this._fetchPromisesCache.set(e.url,void 0),t)).catch(t=>{throw this._fetchPromisesCache.set(e.url,void 0),t})),this._fetchPromisesCache.get(e.url))}send(e){const t={method:e.method};if(e.body&&(t.headers=new Headers,t.headers.set("Content-Type",e.contentType||"application/json"),t.body="string"==typeof e.body?e.body:JSON.stringify(e.body)),e.headers){t.headers||(t.headers=new Headers);for(const[i,n]of Object.entries(e.headers))t.headers.set(i,n)}const i=e.url.startsWith("http")?e.url:k()+e.url,n={url:i,fetchOptions:t,anonymizedUrl:e.reportUrlAsIs?i:e.anonymizedUrl},o=this.fetch(n).catch(t=>{if(Ai(t),e.errFn)return e.errFn.call(void 0,null,t);throw t}).then(t=>{if(t&&!t.ok){if(e.errFn)return void e.errFn.call(void 0,t);Ei(t,n)}return t});return e.parseResponse?o.then(e=>this.getResponseObject(e)):o}invalidateFetchPromisesPrefix(e){this._fetchPromisesCache.invalidatePrefix(e),this._cache.invalidatePrefix(e)}}const Mi=864e5;function Fi(e){return new Date(e.replace(" ","T")+"Z")}function $i(e){return e instanceof Date&&!isNaN(e.valueOf())}function Bi(e,t=!1){return ji(e,new Date,t)}function ji(e,t,i=!1){const n=i?"":" ago",o=Math.floor((t.valueOf()-e.valueOf())/1e3);if(o<=59)return"just now";if(o<=119)return`1 minute${n}`;const r=Math.floor(o/60);if(r<=59)return`${r} minutes${n}`;if(60===r)return`1 hour${n}`;if(r<=119)return`1 hour ${r-60} min${n}`;const s=Math.floor(r/60);if(s<=23)return`${s} hours${n}`;if(24===s)return`1 day${n}`;if(s<=47)return`1 day ${s-24} hr${n}`;const a=Math.floor(s/24);if(a<=30)return`${a} days${n}`;if(a<=60)return`1 month${n}`;const l=Math.floor(a/30);return l<=11?`${l} months${n}`:12===l?`1 year${n}`:l<=24?`1 year ${l-12} m${n}`:`${Math.floor(a/365)} years${n}`}function Hi(e,t){return e.valueOf()-t.valueOf()<Mi&&t.getDay()===e.getDay()}function Ui(e,t){const i={};t.includes("MM")&&(t.includes("MMM")?i.month="short":i.month="2-digit"),t.includes("YY")&&(t.includes("YYYY")?i.year="numeric":i.year="2-digit"),t.includes("DD")&&(i.day="2-digit"),t.includes("HH")&&(i.hour="2-digit",i.hour12=!1),t.includes("h")&&(i.hour="numeric",i.hour12=!0),t.includes("mm")&&(i.minute="2-digit"),t.includes("ss")&&(i.second="2-digit");let n="en-US";t.includes("HH")&&(n="en-GB");const o=new Intl.DateTimeFormat(n,i).formatToParts(e).filter(e=>"literal"!==e.type).reduce((e,t)=>(e[t.type]=t.value,e),{});return t.includes("YY")&&(t=t.includes("YYYY")?t.replace("YYYY",o.year):t.replace("YY",o.year)),t.includes("DD")&&(t=t.replace("DD",o.day)),t.includes("HH")&&(t=t.replace("HH",o.hour)),t.includes("h")&&(t=t.replace("h",o.hour)),t.includes("mm")&&(t=t.replace("mm",o.minute)),t.includes("ss")&&(t=t.replace("ss",o.second)),t.includes("A")&&(t=o.dayperiod?t.replace("A",o.dayperiod.toUpperCase()):t.replace("A",o.dayPeriod.toUpperCase())),t.includes("MM")&&(t=t.includes("MMM")?t.replace("MMM",o.month):t.replace("MM",o.month)),t}var Gi,zi,Vi,Wi,qi,Ki,Yi,Xi,Ji,Zi,Qi,en,tn,nn,on,rn,sn,an,ln,cn,dn,hn,pn,un,gn,mn,fn,_n,vn,yn,bn,wn,Cn,Sn,En,An,xn,Rn,Tn;function kn(e){if(e._account_id)return e._account_id;if(e.email)return e.email;throw new Error("Account has neither _account_id nor email.")}function Pn(e){var t;return!!(null===(t=null==e?void 0:e.tags)||void 0===t?void 0:t.includes(pn.SERVICE_USER))}function In(e,t){return(null==e?void 0:e._account_id)===(null==t?void 0:t._account_id)}function On(e){return(null==e?void 0:e.filter(e=>!Pn(e)))||[]}function Nn(e,t,i){return t===i.findIndex(t=>function(e,t){var i,n,o,r;return(null===(n=null===(i=null==e?void 0:e.avatars)||void 0===i?void 0:i[0])||void 0===n?void 0:n.url)===(null===(r=null===(o=null==t?void 0:t.avatars)||void 0===o?void 0:o[0])||void 0===r?void 0:r.url)}(e,t))}!function(e){e.SIDE_BY_SIDE="SIDE_BY_SIDE",e.UNIFIED="UNIFIED_DIFF"}(Gi||(Gi={})),function(e){e.LEFT="left",e.RIGHT="right"}(zi||(zi={})),function(e){e.COVERED="COVERED",e.NOT_COVERED="NOT_COVERED",e.PARTIALLY_COVERED="PARTIALLY_COVERED",e.NOT_INSTRUMENTED="NOT_INSTRUMENTED"}(Vi||(Vi={})),function(e){e.ADD="add",e.BOTH="both",e.BLANK="blank",e.REMOVE="remove"}(Wi||(Wi={})),function(e){e.FILES="files",e.COMMENT_THREADS="comments",e.FINDINGS="findings",e.CHECKS="checks"}(qi||(qi={})),function(e){e.CHANGE_LOG="_changeLog"}(Ki||(Ki={})),function(e){e.TAG_DELETE_REVIEWER="autogenerated:gerrit:deleteReviewer",e.TAG_NEW_PATCHSET="autogenerated:gerrit:newPatchSet",e.TAG_NEW_WIP_PATCHSET="autogenerated:gerrit:newWipPatchSet",e.TAG_REVIEWER_UPDATE="autogenerated:gerrit:reviewerUpdate",e.TAG_SET_PRIVATE="autogenerated:gerrit:setPrivate",e.TAG_UNSET_PRIVATE="autogenerated:gerrit:unsetPrivate",e.TAG_SET_READY="autogenerated:gerrit:setReadyForReview",e.TAG_SET_WIP="autogenerated:gerrit:setWorkInProgress",e.TAG_SET_ASSIGNEE="autogenerated:gerrit:setAssignee",e.TAG_UNSET_ASSIGNEE="autogenerated:gerrit:deleteAssignee",e.TAG_MERGED="autogenerated:gerrit:merged"}(Yi||(Yi={})),function(e){e.KEEP_VISIBLE="keep-visible",e.NEVER="never"}(Xi||(Xi={})),function(e){e.ABANDONED="ABANDONED",e.MERGED="MERGED",e.NEW="NEW"}(Ji||(Ji={})),function(e){e.PATCHSET_LEVEL_COMMENTS="/PATCHSET_LEVEL",e.COMMIT_MESSAGE="/COMMIT_MSG",e.MERGE_LIST="/MERGE_LIST"}(Zi||(Zi={})),function(e){e.OK="OK",e.NOT_READY="NOT_READY",e.RULE_ERROR="RULE_ERROR"}(Qi||(Qi={})),function(e){e.REVIEWER="REVIEWER",e.CC="CC",e.REMOVED="REMOVED"}(en||(en={})),function(e){e.REWORK="REWORK",e.TRIVIAL_REBASE="TRIVIAL_REBASE",e.MERGE_FIRST_PARENT_UPDATE="MERGE_FIRST_PARENT_UPDATE",e.NO_CODE_CHANGE="NO_CODE_CHANGE",e.NO_CHANGE="NO_CHANGE"}(tn||(tn={})),function(e){e.FIXED="FIXED",e.FIX_FAILED="FIX_FAILED"}(nn||(nn={})),function(e){e.ADDED="A",e.DELETED="D",e.RENAMED="R",e.COPIED="C",e.REWRITTEN="W",e.UNMODIFIED="U"}(on||(on={})),function(e){e.BAD="BAD",e.OK="OK",e.TRUSTED="TRUSTED"}(rn||(rn={})),function(e){e.USERNAME="USERNAME",e.FIRST_NAME="FIRST_NAME",e.FULL_NAME="FULL_NAME"}(sn||(sn={})),function(e){e.ACTIVE="ACTIVE",e.READ_ONLY="READ_ONLY",e.HIDDEN="HIDDEN"}(an||(an={})),function(e){e.STRING="STRING",e.INT="INT",e.LONG="LONG",e.BOOLEAN="BOOLEAN",e.LIST="LIST",e.ARRAY="ARRAY"}(ln||(ln={})),function(e){e.MERGE_IF_NECESSARY="MERGE_IF_NECESSARY",e.FAST_FORWARD_ONLY="FAST_FORWARD_ONLY",e.REBASE_IF_NECESSARY="REBASE_IF_NECESSARY",e.REBASE_ALWAYS="REBASE_ALWAYS",e.MERGE_ALWAYS="MERGE_ALWAYS ",e.CHERRY_PICK="CHERRY_PICK",e.INHERIT="INHERIT"}(cn||(cn={})),function(e){e.RECURSIVE="recursive",e.RESOLVE="resolve",e.SIMPLE_TWO_WAY_IN_CORE="simple-two-way-in-core",e.OURS="ours",e.THEIRS="theirs"}(dn||(dn={})),function(e){e.TRUE="TRUE",e.FALSE="FALSE",e.INHERITED="INHERITED"}(hn||(hn={})),function(e){e.SERVICE_USER="SERVICE_USER"}(pn||(pn={})),function(e){e.ALLOW="ALLOW",e.DENY="DENY",e.BLOCK="BLOCK",e.INTERACTIVE="INTERACTIVE",e.BATCH="BATCH"}(un||(un={})),function(e){e.BATCH="BATCH",e.INTERACTIVE="INTERACTIVE"}(gn||(gn={})),function(e){e.HEAD="HEAD",e.POST="POST",e.GET="GET",e.DELETE="DELETE",e.PUT="PUT"}(mn||(mn={})),function(e){e.REVISION="REVISION",e.PARENT="PARENT"}(fn||(fn={})),function(e){e.DARK="DARK",e.LIGHT="LIGHT"}(_n||(_n={})),function(e){e.STD="STD",e.US="US",e.ISO="ISO",e.EURO="EURO",e.UK="UK"}(vn||(vn={})),function(e){e.HHMM_12="HHMM_12",e.HHMM_24="HHMM_24"}(yn||(yn={})),function(e){e.ENABLED="ENABLED",e.CC_ON_OWN_COMMENTS="CC_ON_OWN_COMMENTS",e.ATTENTION_SET_ONLY="ATTENTION_SET_ONLY",e.DISABLED="DISABLED"}(bn||(bn={})),function(e){e.PLAINTEXT="PLAINTEXT",e.HTML_PLAINTEXT="HTML_PLAINTEXT"}(wn||(wn={})),function(e){e.AUTO_MERGE="AUTO_MERGE",e.FIRST_PARENT="FIRST_PARENT"}(Cn||(Cn={})),function(e){e.PUBLISH="PUBLISH",e.PUBLISH_ALL_REVISIONS="PUBLISH_ALL_REVISIONS",e.KEEP="KEEP"}(Sn||(Sn={})),function(e){e.NONE="NONE",e.OWNER="OWNER",e.OWNER_REVIEWERS="OWNER_REVIEWERS",e.ALL="ALL"}(En||(En={})),function(e){e.OPENID="OPENID",e.OPENID_SSO="OPENID_SSO",e.OAUTH="OAUTH",e.HTTP="HTTP",e.HTTP_LDAP="HTTP_LDAP",e.CLIENT_SSL_CERT_LDAP="CLIENT_SSL_CERT_LDAP",e.LDAP="LDAP",e.LDAP_BIND="LDAP_BIND",e.CUSTOM_EXTENSION="CUSTOM_EXTENSION",e.DEVELOPMENT_BECOME_ANY_ACCOUNT="DEVELOPMENT_BECOME_ANY_ACCOUNT"}(An||(An={})),function(e){e.ALL="ALL",e.SAME_GROUP="SAME_GROUP",e.VISIBLE_GROUP="VISIBLE_GROUP",e.NONE="NONE"}(xn||(xn={})),function(e){e.FULL_NAME="FULL_NAME",e.USER_NAME="USER_NAME",e.REGISTER_NEW_EMAIL="REGISTER_NEW_EMAIL"}(Rn||(Rn={})),function(e){e.API_REF_UPDATED_AND_CHANGE_REINDEX="API_REF_UPDATED_AND_CHANGE_REINDEX",e.REF_UPDATED_AND_CHANGE_REINDEX="REF_UPDATED_AND_CHANGE_REINDEX",e.NEVER="NEVER"}(Tn||(Tn={}));function Ln(e){return!(!e.updates||!e.updates.length)}class Dn{constructor(e){this.batch=null,this.updateItems=null,this._lastState={},this.result={...e}}_filterRemovedMessages(){this.result.messages=this.result.messages.filter(e=>e.tag!==Yi.TAG_DELETE_REVIEWER)}_startBatch(e){return this.updateItems={},{author:e.updated_by,date:e.updated,type:"REVIEWER_UPDATE",tag:Yi.TAG_REVIEWER_UPDATE}}_completeBatch(e){var t;const i=[];for(const[e,n]of Object.entries(null!==(t=this.updateItems)&&void 0!==t?t:{}))this._lastState[e]!==n.state&&(this._lastState[e]=n.state,i.push(n));i.length&&(e.updates=i)}_groupUpdates(){const e=this.result.reviewer_updates.reduce((e,t)=>{this.batch||(this.batch=this._startBatch(t));const i=Fi(t.updated).getTime(),n=Fi(this.batch.date).getTime(),o=kn(t.reviewer);(i-n>6e3||t.updated_by._account_id!==this.batch.author._account_id)&&(this._completeBatch(this.batch),Ln(this.batch)&&e.push(this.batch),this.batch=this._startBatch(t));const r=this.updateItems;return r[o]={reviewer:t.reviewer,state:t.state},this._lastState[o]&&(r[o].prev_state=this._lastState[o]),e},[]),t=this.batch;return this._completeBatch(t),Ln(t)&&e.push(t),this.result.reviewer_updates=e,e}_getUpdateMessage(e,t){return"REMOVED"!==e&&e?"REMOVED"===t?e?`Removed from ${e.toLowerCase()}: `:"Removed : ":`Moved from ${e.toLowerCase()} to ${t.toLowerCase()}: `:`Added to ${t.toLowerCase()}: `}_groupUpdatesByMessage(e){return e.reduce((e,t)=>{const i=this._getUpdateMessage(t.prev_state,t.state);return e[i]||(e[i]=[]),e[i].push(t.reviewer),e},{})}_formatUpdates(){const e=this.result.reviewer_updates;for(const t of e){const e=this._groupUpdatesByMessage(t.updates),i=[];for(const[t,n]of Object.entries(e))i.push({message:t,reviewers:n});t.updates=i}}_advanceUpdates(){const e=this.result.reviewer_updates,t=this.result.messages;t.forEach((i,n)=>{const o=Fi(i.date).getTime(),r=n===t.length-1?null:Fi(t[n+1].date).getTime();for(const t of e){const e=Fi(t.date).getTime();if(e>=o&&(!r||e<r)){const e=Fi(t.date).getTime()-500;t.date=new Date(e).toISOString().replace("T"," ").replace("Z","000000")}if(r&&e>r)break}})}static parse(e){if(!e||!function(e){return!!(e.messages&&e.reviewer_updates&&e.reviewer_updates.length)}(e))return e;const t=new Dn(e);return t._filterRemovedMessages(),t._groupUpdates(),t._formatUpdates(),t._advanceUpdates(),t.result}}function Mn(e){const t=e;return void 0!==t.approved||void 0!==t.rejected||void 0!==t.recommended||void 0!==t.disliked||void 0!==t.blocking||void 0!==t.blocking||void 0!==t.value}function Fn(e){return!!e.values}function $n(e){const t=e;return void 0!==t._account_id||void 0!==t.email}function Bn(e){return void 0!==e.account}function jn(e){return void 0!==e.group}const Hn=["autogenerated:gerrit:newWipPatchSet","autogenerated:gerrit:setWorkInProgress"],Un=["autogenerated:gerrit:setReadyForReview"];function Gn(e){return"-"===`${e}`[0]}function zn(e){return"PARENT"===e||Gn(e)}function Vn(e){if(void 0===e)return e;(function(e){return!isNaN(Number(e))||("edit"===e||"PARENT"===e)})(e)||console.error("string is not of type PatchSetNum");const t=Number(e);return isNaN(t)?e:t}function Wn(e){return"number"==typeof e}function qn(e,t){for(const i of e)if(i._number===t)return i;console.warn("no revision found")}function Kn(e){const t=function(e){const t=function(e){const t=e.find(e=>"edit"===e._number);return t&&e.find(e=>e._number===t.basePatchNum)||null}(e);return t?t._number:-1}(e),i=e=>"edit"===e._number?2*t:2*(e._number-1)+1;return e.sort((e,t)=>i(t)-i(e))}function Yn(e){if(!e)return[];let t=[];if(e.revisions&&Object.keys(e.revisions).length){const i=e.revisions;t=Kn(Object.keys(e.revisions).map(e=>({sha:e,...i[e]}))).map(e=>({num:e._number,desc:e.description,sha:e.sha}))}return Xn(e,t)}function Xn(e,t){if(!e.messages||!e.messages.length)return t;const i=new Map;let n=!!e.work_in_progress;for(let t=0;t<e.messages.length;t++){const o=e.messages[t];o.tag&&Hn.includes(o.tag)?n=!0:o.tag&&Un.includes(o.tag)&&(n=!1),o._revision_number&&!1!==i.get(`${o._revision_number}`)&&i.set(`${o._revision_number}`,n)}for(let e=0;e<t.length;e++)t[e].wip=i.get(`${t[e].num}`);return t}function Jn(e){if(!e||!e.length)return;let t=e[0].num;return"edit"===t&&(t=e[1].num),s(Wn(t),"Latest patchset cannot be EDIT or PARENT."),t}function Zn(e){if(e&&"PARENT"!==e&&"edit"!==e)return 1===e?"PARENT":Number(e)-1}function Qn(e,t){const i=Jn(Yn(e));return t.getChangeDetail(e._number).then(t=>{if(!t){const e=new Error("Change detail not found.");return Promise.reject(e)}const n=Jn(Yn(t));if(!n||!i){const e=new Error("Unable to check for latest patchset.");return Promise.reject(e)}return{isLatest:n<=i,newStatus:e.status!==t.status?t.status:null,newMessages:(e.messages||[]).length<(t.messages||[]).length?t.messages[t.messages.length-1]:void 0}})}function eo(e,t){return(t=t||[]).findIndex(t=>`${t._number}`===`${e}`)}function to(e){return-Number(`${e}`)}const io=0,no=8,oo=1,ro=2,so=3,ao=4,lo=7,co=9,ho=11,po=13,uo=14,go=16,mo=18,fo=20,_o=23;function vo(...e){let t=0;for(let i=0;i<e.length;i++)t|=1<<e[i];return t.toString(16)}function yo(e,t,i){let n=`${k()}/changes/${encodeURIComponent(e)}~${t}`;return i&&(n+=`/revisions/${i}`),n}function bo(e){return(null==e?void 0:e.status)===Ji.NEW}function wo(e){return(null==e?void 0:e.status)===Ji.MERGED}function Co(e){return(null==e?void 0:e.status)===Ji.ABANDONED}function So(e,t){const i=[];return e.status===Ji.MERGED?i.push("Merged"):e.status===Ji.ABANDONED?i.push("Abandoned"):(!1===e.mergeable||t&&!1===t.mergeable)&&i.push("Merge Conflict"),e.work_in_progress&&i.push("WIP"),e.is_private&&i.push("Private"),i.length||!t?i:(e.submittable&&t.submitEnabled?i.push("Ready to submit"):i.push("Active"),i)}function Eo(e,t){var i;return!(!e||!t)&&(null===(i=e.owner)||void 0===i?void 0:i._account_id)===t._account_id}function Ao(e,t){const i=Eo(e,t),n=function(e,t){var i;if(!e||!t)return!1;const n=xo(e);return(null===(i=null==n?void 0:n.uploader)||void 0===i?void 0:i._account_id)===t._account_id}(e,t),o=function(e,t){var i;return!(!e||!t)&&(null!==(i=e.reviewers.REVIEWER)&&void 0!==i?i:[]).some(e=>e._account_id===t._account_id)}(e,t),r=function(e,t){var i;return!(!e||!t)&&(null!==(i=e.reviewers.CC)&&void 0!==i?i:[]).some(e=>e._account_id===t._account_id)}(e,t);return i||n||o||r}function xo(e){if((null==e?void 0:e.revisions)&&(null==e?void 0:e.current_revision))return e.revisions[e.current_revision]}function Ro(e,t){var i;return Object.keys(null!==(i=e.revisions)&&void 0!==i?i:[]).find(i=>{var n;return(null===(n=null==e?void 0:e.revisions)||void 0===n?void 0:n[i]._number)===t})}function To(e,t){return!!((null==e?void 0:e.removable_reviewers)&&t)&&e.removable_reviewers.some(e=>e._account_id===t._account_id||!t._account_id&&e.email===t.email)}function ko(e){return void 0!==e._number}function Po(e){return t=>{if(e)if(t.hasOwnProperty("is")){if(e!==t.is)throw new Error("custom element tag names do not match: "+`(${e} !== ${t.is})`)}else Object.defineProperty(t,"is",{value:e});window.customElements.define(t.is,t)}}function Io(e,t,i){e.constructor.hasOwnProperty("properties")||Object.defineProperty(e.constructor,"properties",{value:{}}),e.constructor.properties[t]=Object.assign({},e.constructor.properties[t],i)}function Oo(e){return(t,i)=>{Io(t,i,e)}}function No(...e){return(t,i)=>{t.constructor.hasOwnProperty("observers")||Object.defineProperty(t.constructor,"observers",{value:[]}),t.constructor.observers.push(`${i}(${e.join(",")})`)}}function Lo(e,...t){return(i,n,o)=>{const r=`__compute${n}`;Object.defineProperty(i,r,{value:o.get}),o.get=void 0,Io(i,n,{computed:`${r}(${[e,...t].join(",")})`})}}Do((e,t)=>e.querySelector(t)),Do((e,t)=>e.querySelectorAll(t));function Do(e){return t=>(i,n)=>{Object.defineProperty(i,n,{get(){return e(this.shadowRoot,t)},enumerable:!0,configurable:!0})}}var Mo=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Fo="sendDiffDraft",$o="Saving draft resulted in HTTP 200 (OK) but expected HTTP 201 (Created)",Bo=/^set-cookie$/i;let jo=new Ni,Ho=new Li,Uo={},Go=new _i,zo={};let Vo=class extends fi{constructor(e){super(),this._cache=jo,this._sharedFetchPromises=Ho,this._pendingRequests=Uo,this._etags=Go,this._projectLookup=zo,this.authService=null!=e?e:i.authService,this._restApiHelper=new Di(this._cache,this.authService,this._sharedFetchPromises)}_fetchSharedCacheURL(e){return this._restApiHelper.fetchCacheURL(e)}getResponseObject(e){return this._restApiHelper.getResponseObject(e)}getConfig(e){return e?this._restApiHelper.fetchJSON({url:"/config/server/info",reportUrlAsIs:!0}):this._fetchSharedCacheURL({url:"/config/server/info",reportUrlAsIs:!0})}getRepo(e,t){return this._fetchSharedCacheURL({url:"/projects/"+encodeURIComponent(e),errFn:t,anonymizedUrl:"/projects/*"})}getProjectConfig(e,t){return this._fetchSharedCacheURL({url:"/projects/"+encodeURIComponent(e)+"/config",errFn:t,anonymizedUrl:"/projects/*/config"})}getRepoAccess(e){return this._fetchSharedCacheURL({url:"/access/?project="+encodeURIComponent(e),anonymizedUrl:"/access/?project=*"})}getRepoDashboards(e,t){return this._fetchSharedCacheURL({url:`/projects/${encodeURIComponent(e)}/dashboards?inherited`,errFn:t,anonymizedUrl:"/projects/*/dashboards?inherited"})}saveRepoConfig(e,t){const i=`/projects/${encodeURIComponent(e)}/config`;return this._cache.delete(i),this._restApiHelper.send({method:mn.PUT,url:i,body:t,anonymizedUrl:"/projects/*/config"})}runRepoGC(e){const t=encodeURIComponent(e);return this._restApiHelper.send({method:mn.POST,url:`/projects/${t}/gc`,body:"",anonymizedUrl:"/projects/*/gc"})}createRepo(e){const t=encodeURIComponent(e.name);return this._restApiHelper.send({method:mn.PUT,url:`/projects/${t}`,body:e,anonymizedUrl:"/projects/*"})}createGroup(e){const t=encodeURIComponent(e.name);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${t}`,body:e,anonymizedUrl:"/groups/*"})}getGroupConfig(e,t){return this._restApiHelper.fetchJSON({url:`/groups/${encodeURIComponent(e)}/detail`,errFn:t,anonymizedUrl:"/groups/*/detail"})}deleteRepoBranches(e,t){const i=encodeURIComponent(e),n=encodeURIComponent(t);return this._restApiHelper.send({method:mn.DELETE,url:`/projects/${i}/branches/${n}`,body:"",anonymizedUrl:"/projects/*/branches/*"})}deleteRepoTags(e,t){const i=encodeURIComponent(e),n=encodeURIComponent(t);return this._restApiHelper.send({method:mn.DELETE,url:`/projects/${i}/tags/${n}`,body:"",anonymizedUrl:"/projects/*/tags/*"})}createRepoBranch(e,t,i){const n=encodeURIComponent(e),o=encodeURIComponent(t);return this._restApiHelper.send({method:mn.PUT,url:`/projects/${n}/branches/${o}`,body:i,anonymizedUrl:"/projects/*/branches/*"})}createRepoTag(e,t,i){const n=encodeURIComponent(e),o=encodeURIComponent(t);return this._restApiHelper.send({method:mn.PUT,url:`/projects/${n}/tags/${o}`,body:i,anonymizedUrl:"/projects/*/tags/*"})}getIsGroupOwner(e){const t={url:`/groups/?owned&g=${encodeURIComponent(e)}`,anonymizedUrl:"/groups/owned&g=*"};return this._fetchSharedCacheURL(t).then(t=>o(t,e))}getGroupMembers(e){const t=encodeURIComponent(e);return this._restApiHelper.fetchJSON({url:`/groups/${t}/members/`,anonymizedUrl:"/groups/*/members"})}getIncludedGroup(e){return this._restApiHelper.fetchJSON({url:`/groups/${encodeURIComponent(e)}/groups/`,anonymizedUrl:"/groups/*/groups"})}saveGroupName(e,t){const i=encodeURIComponent(e);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${i}/name`,body:{name:t},anonymizedUrl:"/groups/*/name"})}saveGroupOwner(e,t){const i=encodeURIComponent(e);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${i}/owner`,body:{owner:t},anonymizedUrl:"/groups/*/owner"})}saveGroupDescription(e,t){const i=encodeURIComponent(e);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${i}/description`,body:{description:t},anonymizedUrl:"/groups/*/description"})}saveGroupOptions(e,t){const i=encodeURIComponent(e);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${i}/options`,body:t,anonymizedUrl:"/groups/*/options"})}getGroupAuditLog(e,t){return this._fetchSharedCacheURL({url:`/groups/${e}/log.audit`,errFn:t,anonymizedUrl:"/groups/*/log.audit"})}saveGroupMember(e,t){const i=encodeURIComponent(e),n=encodeURIComponent(`${t}`);return this._restApiHelper.send({method:mn.PUT,url:`/groups/${i}/members/${n}`,parseResponse:!0,anonymizedUrl:"/groups/*/members/*"})}saveIncludedGroup(e,t,i){const n=encodeURIComponent(e),o=encodeURIComponent(t),r={method:mn.PUT,url:`/groups/${n}/groups/${o}`,errFn:i,anonymizedUrl:"/groups/*/groups/*"};return this._restApiHelper.send(r).then(e=>{if(null==e?void 0:e.ok)return this.getResponseObject(e)})}deleteGroupMember(e,t){const i=encodeURIComponent(e),n=encodeURIComponent(`${t}`);return this._restApiHelper.send({method:mn.DELETE,url:`/groups/${i}/members/${n}`,anonymizedUrl:"/groups/*/members/*"})}deleteIncludedGroup(e,t){const i=encodeURIComponent(e),n=encodeURIComponent(t);return this._restApiHelper.send({method:mn.DELETE,url:`/groups/${i}/groups/${n}`,anonymizedUrl:"/groups/*/groups/*"})}getVersion(){return this._fetchSharedCacheURL({url:"/config/server/version",reportUrlAsIs:!0})}getDiffPreferences(){return this.getLoggedIn().then(e=>e?this._fetchSharedCacheURL({url:"/accounts/self/preferences.diff",reportUrlAsIs:!0}):Promise.resolve({context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8}))}getEditPreferences(){return this.getLoggedIn().then(e=>e?this._fetchSharedCacheURL({url:"/accounts/self/preferences.edit",reportUrlAsIs:!0}):Promise.resolve({auto_close_brackets:!1,cursor_blink_rate:0,hide_line_numbers:!1,hide_top_menu:!1,indent_unit:2,indent_with_tabs:!1,key_map_type:"DEFAULT",line_length:100,line_wrapping:!1,match_brackets:!0,show_base:!1,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8,theme:"DEFAULT"}))}savePreferences(e){return e.download_scheme&&(e.download_scheme=e.download_scheme.toLowerCase()),this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/preferences",body:e,reportUrlAsIs:!0})}saveDiffPreferences(e){return this._cache.delete("/accounts/self/preferences.diff"),this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/preferences.diff",body:e,reportUrlAsIs:!0})}saveEditPreferences(e){return this._cache.delete("/accounts/self/preferences.edit"),this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/preferences.edit",body:e,reportUrlAsIs:!0})}getAccount(){return this._fetchSharedCacheURL({url:"/accounts/self/detail",reportUrlAsIs:!0,errFn:e=>{e&&403!==e.status||this._cache.delete("/accounts/self/detail")}})}getAvatarChangeUrl(){return this._fetchSharedCacheURL({url:"/accounts/self/avatar.change.url",reportUrlAsIs:!0,errFn:e=>{e&&403!==e.status||this._cache.delete("/accounts/self/avatar.change.url")}})}getExternalIds(){return this._restApiHelper.fetchJSON({url:"/accounts/self/external.ids",reportUrlAsIs:!0})}deleteAccountIdentity(e){return this._restApiHelper.send({method:mn.POST,url:"/accounts/self/external.ids:delete",body:e,parseResponse:!0,reportUrlAsIs:!0})}getAccountDetails(e){return this._restApiHelper.fetchJSON({url:`/accounts/${encodeURIComponent(e)}/detail`,anonymizedUrl:"/accounts/*/detail"})}getAccountEmails(){return this._fetchSharedCacheURL({url:"/accounts/self/emails",reportUrlAsIs:!0})}addAccountEmail(e){return this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/emails/"+encodeURIComponent(e),anonymizedUrl:"/account/self/emails/*"})}deleteAccountEmail(e){return this._restApiHelper.send({method:mn.DELETE,url:"/accounts/self/emails/"+encodeURIComponent(e),anonymizedUrl:"/accounts/self/email/*"})}setPreferredAccountEmail(e){const t=encodeURIComponent(e),i={method:mn.PUT,url:`/accounts/self/emails/${t}/preferred`,anonymizedUrl:"/accounts/self/emails/*/preferred"};return this._restApiHelper.send(i).then(()=>{const t=this._cache.get("/accounts/self/emails");if(t){const i=t.map(t=>t.email===e?{email:e,preferred:!0}:{email:e});this._cache.set("/accounts/self/emails",i)}})}_updateCachedAccount(e){const t=this._cache.get("/accounts/self/detail");t&&this._cache.set("/accounts/self/detail",{...t,...e})}setAccountName(e){const t={method:mn.PUT,url:"/accounts/self/name",body:{name:e},parseResponse:!0,reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>this._updateCachedAccount({name:e}))}setAccountUsername(e){const t={method:mn.PUT,url:"/accounts/self/username",body:{username:e},parseResponse:!0,reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>this._updateCachedAccount({username:e}))}setAccountDisplayName(e){const t={method:mn.PUT,url:"/accounts/self/displayname",body:{display_name:e},parseResponse:!0,reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>this._updateCachedAccount({display_name:e}))}setAccountStatus(e){const t={method:mn.PUT,url:"/accounts/self/status",body:{status:e},parseResponse:!0,reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>this._updateCachedAccount({status:e}))}getAccountStatus(e){return this._restApiHelper.fetchJSON({url:`/accounts/${encodeURIComponent(e)}/status`,anonymizedUrl:"/accounts/*/status"})}getAccountGroups(){return this._restApiHelper.fetchJSON({url:"/accounts/self/groups",reportUrlAsIs:!0})}getAccountAgreements(){return this._restApiHelper.fetchJSON({url:"/accounts/self/agreements",reportUrlAsIs:!0})}saveAccountAgreement(e){return this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/agreements",body:e,reportUrlAsIs:!0})}getAccountCapabilities(e){let t="";return e&&(t="?q="+e.map(e=>encodeURIComponent(e)).join("&q=")),this._fetchSharedCacheURL({url:"/accounts/self/capabilities"+t,anonymizedUrl:"/accounts/self/capabilities?q=*"})}getLoggedIn(){return this.authService.authCheck()}getIsAdmin(){return this.getLoggedIn().then(e=>e?this.getAccountCapabilities():void 0).then(e=>e&&e.administrateServer)}getDefaultPreferences(){return this._fetchSharedCacheURL({url:"/config/server/preferences",reportUrlAsIs:!0})}getPreferences(){return this.getLoggedIn().then(e=>{if(e){const e={url:"/accounts/self/preferences",reportUrlAsIs:!0};return this._fetchSharedCacheURL(e).then(e=>{if(!e)return e;const t=e;return this._isNarrowScreen()?t.default_diff_view=Gi.UNIFIED:t.default_diff_view=t.diff_view,t})}return{changes_per_page:25,default_diff_view:Gi.SIDE_BY_SIDE,diff_view:Gi.SIDE_BY_SIDE,size_bar_in_change_table:!0}})}getWatchedProjects(){return this._fetchSharedCacheURL({url:"/accounts/self/watched.projects",reportUrlAsIs:!0})}saveWatchedProjects(e){return this._restApiHelper.send({method:mn.POST,url:"/accounts/self/watched.projects",body:e,parseResponse:!0,reportUrlAsIs:!0})}deleteWatchedProjects(e){return this._restApiHelper.send({method:mn.POST,url:"/accounts/self/watched.projects:delete",body:e,reportUrlAsIs:!0})}_isNarrowScreen(){return window.innerWidth<850}getChanges(e,t,i,n){return this.getConfig(!1).then(o=>{n=n||this._getChangesOptionsHex(o),"n,z"===i&&(i=0);const r={O:n,S:i||0};return e&&(r.n=e),t&&t.length>0&&(r.q=t),{url:"/changes/",params:r,reportUrlAsIs:!0}}).then(e=>this._restApiHelper.fetchJSON(e,!0)).then(e=>{if(!e)return;const i=e=>{for(const t of e)this._maybeInsertInLookup(t)};if(t instanceof Array){const n=1===t.length?[e]:e;for(const e of n)i(e);return n}return i(e),e})}_maybeInsertInLookup(e){(null==e?void 0:e.project)&&e._number&&this.setInProjectLookup(e._number,e.project)}getChangeActionURL(e,t,i){return this._changeBaseURL(e,t).then(e=>e+i)}getChangeDetail(e,t,i){return this.getConfig(!1).then(n=>{const o=this._getChangeOptionsHex(n);return this._getChangeDetail(e,o,t,i).then(e=>Dn.parse(e))})}_getChangesOptionsHex(e){var t;if(window.DEFAULT_DETAIL_HEXES&&window.DEFAULT_DETAIL_HEXES.dashboardPage)return window.DEFAULT_DETAIL_HEXES.dashboardPage;const i=[io,lo];return(null===(t=null==e?void 0:e.change)||void 0===t?void 0:t.enable_attention_set)||i.push(ho),vo(...i)}_getChangeOptionsHex(e){var t;if(window.DEFAULT_DETAIL_HEXES&&window.DEFAULT_DETAIL_HEXES.changePage&&(!e||!e.receive||!e.receive.enable_signed_push))return window.DEFAULT_DETAIL_HEXES.changePage;const i=[ao,ro,go,no,po,co,fo,uo,_o];return(null===(t=null==e?void 0:e.receive)||void 0===t?void 0:t.enable_signed_push)&&i.push(mo),vo(...i)}getDiffChangeDetail(e){var t;let i="";return i=(null===(t=window.DEFAULT_DETAIL_HEXES)||void 0===t?void 0:t.diffPage)?window.DEFAULT_DETAIL_HEXES.diffPage:vo(ao,ro,_o),this._getChangeDetail(e,i)}_getChangeDetail(e,t,i,n){return this.getChangeActionURL(e,void 0,"/detail").then(e=>{const o={O:t},r=this._restApiHelper.urlWithParams(e,o),s={url:e,errFn:i,cancelCondition:n,params:o,fetchOptions:this._etags.getOptions(r),anonymizedUrl:"/changes/*~*/detail?O="+t};return this._restApiHelper.fetchRawJSON(s).then(e=>304===(null==e?void 0:e.status)?Oi(this._etags.getCachedPayload(r)):!e||e.ok?e?Ii(e).then(t=>t?(this._etags.collect(r,e,t.raw),this._maybeInsertInLookup(t.parsed),t.parsed):null):Promise.resolve(null):void(i?i.call(null,e):Ei(e,s)))})}getChangeCommitInfo(e,t){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/commit?links",revision:t,reportEndpointAsIs:!0})}getChangeFiles(e,t){let i=void 0;return Gn(t.basePatchNum)?i={parent:to(t.basePatchNum)}:"PARENT"!==t.basePatchNum&&(i={base:t.basePatchNum}),this._getChangeURLAndFetch({changeNum:e,endpoint:"/files",revision:t.patchNum,params:i,reportEndpointAsIs:!0})}getChangeEditFiles(e,t){let i="/edit?list",n=i;return"PARENT"!==t.basePatchNum&&(i+="&base="+encodeURIComponent(`${t.basePatchNum}`),n+="&base=*"),this._getChangeURLAndFetch({changeNum:e,endpoint:i,anonymizedEndpoint:n})}queryChangeFiles(e,t,i){return this._getChangeURLAndFetch({changeNum:e,endpoint:`/files?q=${encodeURIComponent(i)}`,revision:t,anonymizedEndpoint:"/files?q=*"})}getChangeOrEditFiles(e,t){return"edit"===t.patchNum?this.getChangeEditFiles(e,t).then(e=>e&&e.files):this.getChangeFiles(e,t)}getChangeRevisionActions(e,t){const i={changeNum:e,endpoint:"/actions",revision:t,reportEndpointAsIs:!0};return this._getChangeURLAndFetch(i)}getChangeSuggestedReviewers(e,t){return this._getChangeSuggestedGroup(en.REVIEWER,e,t)}getChangeSuggestedCCs(e,t){return this._getChangeSuggestedGroup(en.CC,e,t)}_getChangeSuggestedGroup(e,t,i){const n={n:6,"reviewer-state":e};return i&&(n.q=i),this._getChangeURLAndFetch({changeNum:t,endpoint:"/suggest_reviewers",params:n,reportEndpointAsIs:!0})}getChangeIncludedIn(e){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/in",reportEndpointAsIs:!0})}_computeFilter(e){return e=(null==e?void 0:e.startsWith("^"))?"&r="+encodeURIComponent(e):e?"&m="+encodeURIComponent(e):""}_getGroupsUrl(e,t,i){return`/groups/?n=${t+1}&S=${i=i||0}`+this._computeFilter(e)}_getReposUrl(e,t,i){const n=/[@.\-\s/_]/g;if(i=i||0,e&&!e.includes(":")&&e.match(n)){const t=e;e="",t.split(n).forEach(t=>{t&&(e+=(""===e?"inname:":" AND inname:")+t)})}return e||(e="state:active OR state:read-only"),e=e.trim(),`/projects/?n=${t+1}&S=${i}`+`&query=${encodeURIComponent(e)}`}invalidateGroupsCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/groups/?")}invalidateReposCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/projects/?")}invalidateAccountsCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/accounts/")}invalidateAccountsDetailCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/accounts/self/detail")}getGroups(e,t,i){const n=this._getGroupsUrl(e,t,i);return this._fetchSharedCacheURL({url:n,anonymizedUrl:"/groups/?*"})}getRepos(e,t,i){const n=this._getReposUrl(e,t,i);return this._fetchSharedCacheURL({url:n,anonymizedUrl:"/projects/?*"})}setRepoHead(e,t){return this._restApiHelper.send({method:mn.PUT,url:`/projects/${encodeURIComponent(e)}/HEAD`,body:{ref:t},anonymizedUrl:"/projects/*/HEAD"})}getRepoBranches(e,t,i,n,o){n=n||0;const r=i+1;e=this._computeFilter(e);const s=`/projects/${encodeURIComponent(t)}/branches?n=${r}&S=${n}${e}`;return this._restApiHelper.fetchJSON({url:s,errFn:o,anonymizedUrl:"/projects/*/branches?*"})}getRepoTags(e,t,i,n,o){n=n||0;const r=`/projects/${encodeURIComponent(t)}/tags`+`?n=${i+1}&S=${n}`+this._computeFilter(e);return this._restApiHelper.fetchJSON({url:r,errFn:o,anonymizedUrl:"/projects/*/tags"})}getPlugins(e,t,i,n){const o=`/plugins/?all&n=${t+1}&S=${i=i||0}${this._computeFilter(e)}`;return this._restApiHelper.fetchJSON({url:o,errFn:n,anonymizedUrl:"/plugins/?all"})}getRepoAccessRights(e,t){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/access`,errFn:t,anonymizedUrl:"/projects/*/access"})}setRepoAccessRights(e,t){return this._restApiHelper.send({method:mn.POST,url:`/projects/${encodeURIComponent(e)}/access`,body:t,anonymizedUrl:"/projects/*/access"})}setRepoAccessRightsForReview(e,t){return this._restApiHelper.send({method:mn.PUT,url:`/projects/${encodeURIComponent(e)}/access:review`,body:t,parseResponse:!0,anonymizedUrl:"/projects/*/access:review"})}getSuggestedGroups(e,t){const i={s:e};return t&&(i.n=t),this._restApiHelper.fetchJSON({url:"/groups/",params:i,reportUrlAsIs:!0})}getSuggestedProjects(e,t){const i={m:e,n:25,type:"ALL"};return t&&(i.n=t),this._restApiHelper.fetchJSON({url:"/projects/",params:i,reportUrlAsIs:!0})}getSuggestedAccounts(e,t){if(!e)return Promise.resolve([]);const i={suggest:null,q:e};return t&&(i.n=t),this._restApiHelper.fetchJSON({url:"/accounts/",params:i,anonymizedUrl:"/accounts/?n=*"})}addChangeReviewer(e,t){return this._sendChangeReviewerRequest(mn.POST,e,t)}removeChangeReviewer(e,t){return this._sendChangeReviewerRequest(mn.DELETE,e,t)}_sendChangeReviewerRequest(e,t,i){return this.getChangeActionURL(t,void 0,"/reviewers").then(t=>{let n;switch(e){case mn.POST:n={reviewer:i};break;case mn.DELETE:t+="/"+encodeURIComponent(i);break;default:r(e,`Unsupported HTTP method: ${e}`)}return this._restApiHelper.send({method:e,url:t,body:n})})}getRelatedChanges(e,t){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/related",revision:t,reportEndpointAsIs:!0})}getChangesSubmittedTogether(e){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/submitted_together?o=NON_VISIBLE_CHANGES",reportEndpointAsIs:!0})}getChangeConflicts(e){const t={O:vo(oo,so),q:`status:open conflicts:${e}`};return this._restApiHelper.fetchJSON({url:"/changes/",params:t,anonymizedUrl:"/changes/conflicts:*"})}getChangeCherryPicks(e,t,i){const n={O:vo(oo,so),q:[`project:${e}`,`change:${t}`,`-change:${i}`,"-is:abandoned"].join(" ")};return this._restApiHelper.fetchJSON({url:"/changes/",params:n,anonymizedUrl:"/changes/change:*"})}getChangesWithSameTopic(e,t){const i={O:vo(io,oo,so,no),q:["status:open",`-change:${t}`,`topic:"${e}"`].join(" ")};return this._restApiHelper.fetchJSON({url:"/changes/",params:i,anonymizedUrl:"/changes/topic:*"})}getChangesWithSimilarTopic(e){const t=[`intopic:"${e}"`].join(" ");return this._restApiHelper.fetchJSON({url:"/changes/",params:{q:t},anonymizedUrl:"/changes/intopic:*"})}getReviewedFiles(e,t){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/files?reviewed",revision:t,reportEndpointAsIs:!0})}saveFileReviewed(e,t,i,n){return this._getChangeURLAndSend({changeNum:e,method:n?mn.PUT:mn.DELETE,patchNum:t,endpoint:`/files/${encodeURIComponent(i)}/reviewed`,anonymizedEndpoint:"/files/*/reviewed"})}saveChangeReview(e,t,i,n){const o=[this.awaitPendingDiffDrafts(),this.getChangeActionURL(e,t,"/review")];return Promise.all(o).then(([,e])=>this._restApiHelper.send({method:mn.POST,url:e,body:i,errFn:n}))}getChangeEdit(e,t){const i=t?{"download-commands":!0}:void 0;return this.getLoggedIn().then(t=>t?this._getChangeURLAndFetch({changeNum:e,endpoint:"/edit/",params:i,reportEndpointAsIs:!0},!0):Promise.resolve(!1))}createChange(e,t,i,n,o,r,s,a){return this._restApiHelper.send({method:mn.POST,url:"/changes/",body:{project:e,branch:t,subject:i,topic:n,is_private:o,work_in_progress:r,base_change:s,base_commit:a},parseResponse:!0,reportUrlAsIs:!0})}getFileContent(e,t,i){return("edit"===i?this._getFileInChangeEdit(e,t):this._getFileInRevision(e,t,i,e=>(e&&404!==(null==e?void 0:e.status)&&Ei(e),e))).then(e=>{if(!e||!e.ok)return e;const t=e.headers.get("X-FYI-Content-Type");return this.getResponseObject(e).then(e=>({content:e,type:t,ok:!0}))})}_getFileInRevision(e,t,i,n){return this._getChangeURLAndSend({changeNum:e,method:mn.GET,patchNum:i,endpoint:`/files/${encodeURIComponent(t)}/content`,errFn:n,headers:{Accept:"application/json"},anonymizedEndpoint:"/files/*/content"})}_getFileInChangeEdit(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.GET,endpoint:"/edit/"+encodeURIComponent(t),headers:{Accept:"application/json"},anonymizedEndpoint:"/edit/*"})}rebaseChangeEdit(e){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/edit:rebase",reportEndpointAsIs:!0})}deleteChangeEdit(e){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:"/edit",reportEndpointAsIs:!0})}restoreFileInChangeEdit(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/edit",body:{restore_path:t},reportEndpointAsIs:!0})}renameFileInChangeEdit(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/edit",body:{old_path:t,new_path:i},reportEndpointAsIs:!0})}deleteFileInChangeEdit(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:"/edit/"+encodeURIComponent(t),anonymizedEndpoint:"/edit/*"})}saveChangeEdit(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/edit/"+encodeURIComponent(t),body:i,contentType:"text/plain",anonymizedEndpoint:"/edit/*"})}saveFileUploadChangeEdit(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/edit/"+encodeURIComponent(t),body:{binary_content:i},anonymizedEndpoint:"/edit/*"})}getRobotCommentFixPreview(e,t,i){return this._getChangeURLAndFetch({changeNum:e,revision:t,endpoint:`/fixes/${encodeURIComponent(i)}/preview`,reportEndpointAsId:!0})}applyFixSuggestion(e,t,i){return this._getChangeURLAndSend({method:mn.POST,changeNum:e,patchNum:t,endpoint:`/fixes/${encodeURIComponent(i)}/apply`,reportEndpointAsId:!0})}saveChangeCommitMessageEdit(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/edit:message",body:{message:t},reportEndpointAsIs:!0})}publishChangeEdit(e){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/edit:publish",reportEndpointAsIs:!0})}putChangeCommitMessage(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/message",body:{message:t},reportEndpointAsIs:!0})}deleteChangeCommitMessage(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:`/messages/${t}`,reportEndpointAsIs:!0})}saveChangeStarred(e,t){return this.getFromProjectLookup(e).then(i=>{const n=`/accounts/self/starred.changes/${i?encodeURIComponent(i)+"~":""}${e}`;return this._restApiHelper.send({method:t?mn.PUT:mn.DELETE,url:n,anonymizedUrl:"/accounts/self/starred.changes/*"})})}saveChangeReviewed(e,t){return this.getConfig().then(i=>{if(!(!!i&&!!i.change&&i.change.enable_attention_set))return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:t?"/reviewed":"/unreviewed"})})}send(e,t,i,n,o,r){return this._restApiHelper.send({method:e,url:t,body:i,errFn:n,contentType:o,headers:r})}getDiff(e,t,i,n,o,r){const s={intraline:null,whitespace:o||"IGNORE_NONE"};Gn(t)?s.parent=to(t):"PARENT"!==t&&(s.base=t);const a={changeNum:e,endpoint:`/files/${encodeURIComponent(n)}/diff`,revision:i,errFn:r,params:s,anonymizedEndpoint:"/files/*/diff"};return"edit"===i&&(a.fetchOptions||(a.fetchOptions={}),a.fetchOptions.headers||(a.fetchOptions.headers=new Headers),a.fetchOptions.headers.append("Cache-Control","no-cache")),this._getChangeURLAndFetch(a)}getDiffComments(e,t,i,n){return t||i||n?this._getDiffComments(e,"/comments",{"enable-context":!0,"context-padding":3},t,i,n):this._getDiffComments(e,"/comments",{"enable-context":!0,"context-padding":3})}getDiffRobotComments(e,t,i,n){return t||i||n?this._getDiffComments(e,"/robotcomments",void 0,t,i,n):this._getDiffComments(e,"/robotcomments")}getDiffDrafts(e,t,i,n){return this.getLoggedIn().then(o=>o?t||i||n?this._getDiffComments(e,"/drafts",void 0,t,i,n):this._getDiffComments(e,"/drafts"):{})}_setRange(e,t){if(t.in_reply_to&&!t.range)for(let i=0;i<e.length;i++)if(e[i].id===t.in_reply_to){t.range=e[i].range;break}return t}_setRanges(e){(e=e||[]).sort((e,t)=>Fi(e.updated).valueOf()-Fi(t.updated).valueOf());for(const t of e)this._setRange(e,t);return e}_getDiffComments(e,t,i,n,o,r){const s=n=>this._getChangeURLAndFetch({changeNum:e,endpoint:t,revision:n,reportEndpointAsIs:!0,params:i},!0);if(!n&&!o&&!r)return s();function a(e){return e.side===fn.PARENT}function l(e){return e.side!==fn.PARENT}function c(e){e.path=r}const d=[];let h,p,u;return u=s(o).then(e=>{h=e&&r&&e[r]||[],h=this._setRanges(h),"PARENT"===n&&(p=h.filter(a),p.forEach(c)),h=h.filter(l),h.forEach(c)}),d.push(u),"PARENT"!==n&&(u=s(n).then(e=>{p=(e&&r&&e[r]||[]).filter(l),p=this._setRanges(p),p.forEach(c)}),d.push(u)),Promise.all(d).then(()=>Promise.resolve({baseComments:p,comments:h}))}_getDiffCommentsFetchURL(e,t,i){return this._changeBaseURL(e,i).then(e=>e+t)}getPortedComments(e,t){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/ported_comments/",revision:t,errFn:e=>{e&&console.info(`Fetching ported comments failed, ${e.status}`)}})}getPortedDrafts(e,t){const i=e=>{e&&console.info(`Fetching ported drafts failed, ${e.status}`)};return this.getLoggedIn().then(n=>n?this._getChangeURLAndFetch({changeNum:e,endpoint:"/ported_drafts/",revision:t,errFn:i}):{})}saveDiffDraft(e,t,i){return this._sendDiffDraftRequest(mn.PUT,e,t,i)}deleteDiffDraft(e,t,i){return this._sendDiffDraftRequest(mn.DELETE,e,t,i)}hasPendingDiffDrafts(){const e=this._pendingRequests[Fo];return e&&e.length}awaitPendingDiffDrafts(){return Promise.all(this._pendingRequests[Fo]||[]).then(()=>{this._pendingRequests[Fo]=[]})}_sendDiffDraftRequest(e,t,i,n){const o=!n.id&&e===mn.PUT;let r,s="/drafts",a=s;n.id&&(s+=`/${n.id}`,a+="/*"),e===mn.PUT&&(r=n),this._pendingRequests[Fo]||(this._pendingRequests[Fo]=[]);const l={changeNum:t,method:e,patchNum:i,endpoint:s,body:r,anonymizedEndpoint:a},c=this._getChangeURLAndSend(l);return this._pendingRequests[Fo].push(c),o?this._failForCreate200(c):c}getCommitInfo(e,t){return this._restApiHelper.fetchJSON({url:"/projects/"+encodeURIComponent(e)+"/commits/"+encodeURIComponent(t),anonymizedUrl:"/projects/*/comments/*"})}_fetchB64File(e){return this._restApiHelper.fetch({url:k()+e}).then(e=>{if(!e.ok)return Promise.reject(new Error(e.statusText));const t=e.headers.get("X-FYI-Content-Type");return e.text().then(e=>({body:e,type:t}))})}getB64FileContents(e,t,i,n){const o="number"==typeof n?`?parent=${n}`:"";return this._changeBaseURL(e,t).then(e=>(e=`${e}/files/${encodeURIComponent(i)}/content${o}`,this._fetchB64File(e)))}getImagesForDiff(e,t,i){var n,o;let r,s;return r=(null===(n=t.meta_a)||void 0===n?void 0:n.content_type.startsWith("image/"))?"PARENT"===i.basePatchNum?this.getB64FileContents(e,i.patchNum,t.meta_a.name,1):this.getB64FileContents(e,i.basePatchNum,t.meta_a.name):Promise.resolve(null),s=(null===(o=t.meta_b)||void 0===o?void 0:o.content_type.startsWith("image/"))?this.getB64FileContents(e,i.patchNum,t.meta_b.name):Promise.resolve(null),Promise.all([r,s]).then(e=>({baseImage:e[0]?{...e[0],_expectedType:t.meta_a.content_type,_name:t.meta_a.name}:null,revisionImage:e[1]?{...e[1],_expectedType:t.meta_b.content_type,_name:t.meta_b.name}:null}))}_changeBaseURL(e,t,i){return(i?Promise.resolve(i):this.getFromProjectLookup(e)).then(i=>{let n=`/changes/${encodeURIComponent(i)}~${e}`;return t&&(n+=`/revisions/${t}`),n})}addToAttentionSet(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/attention",body:{user:t,reason:i},reportUrlAsIs:!0})}removeFromAttentionSet(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:`/attention/${t}`,anonymizedEndpoint:"/attention/*",body:{reason:i}})}setChangeTopic(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/topic",body:{topic:t},parseResponse:!0,reportUrlAsIs:!0})}setChangeHashtag(e,t){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,endpoint:"/hashtags",body:t,parseResponse:!0,reportUrlAsIs:!0})}deleteAccountHttpPassword(){return this._restApiHelper.send({method:mn.DELETE,url:"/accounts/self/password.http",reportUrlAsIs:!0})}generateAccountHttpPassword(){return this._restApiHelper.send({method:mn.PUT,url:"/accounts/self/password.http",body:{generate:!0},parseResponse:!0,reportUrlAsIs:!0})}getAccountSSHKeys(){return this._fetchSharedCacheURL({url:"/accounts/self/sshkeys",reportUrlAsIs:!0})}addAccountSSHKey(e){const t={method:mn.POST,url:"/accounts/self/sshkeys",body:e,contentType:"text/plain",reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>!e||e.status<200&&e.status>=300?Promise.reject(new Error("error")):this.getResponseObject(e)).then(e=>e&&e.valid?e:Promise.reject(new Error("error")))}deleteAccountSSHKey(e){return this._restApiHelper.send({method:mn.DELETE,url:"/accounts/self/sshkeys/"+e,anonymizedUrl:"/accounts/self/sshkeys/*"})}getAccountGPGKeys(){return this._restApiHelper.fetchJSON({url:"/accounts/self/gpgkeys",reportUrlAsIs:!0})}addAccountGPGKey(e){const t={method:mn.POST,url:"/accounts/self/gpgkeys",body:e,reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>!e||e.status<200&&e.status>=300?Promise.reject(new Error("error")):this.getResponseObject(e)).then(e=>e||Promise.reject(new Error("error")))}deleteAccountGPGKey(e){return this._restApiHelper.send({method:mn.DELETE,url:`/accounts/self/gpgkeys/${e}`,anonymizedUrl:"/accounts/self/gpgkeys/*"})}deleteVote(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:`/reviewers/${t}/votes/${encodeURIComponent(i)}`,anonymizedEndpoint:"/reviewers/*/votes/*"})}setDescription(e,t,i){return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,patchNum:t,endpoint:"/description",body:{description:i},reportUrlAsIs:!0})}confirmEmail(e){const t={method:mn.PUT,url:"/config/server/email.confirm",body:{token:e},reportUrlAsIs:!0};return this._restApiHelper.send(t).then(e=>204===(null==e?void 0:e.status)?"Email confirmed successfully.":null)}getCapabilities(e){return this._restApiHelper.fetchJSON({url:"/config/server/capabilities",errFn:e,reportUrlAsIs:!0})}getTopMenus(){return this._fetchSharedCacheURL({url:"/config/server/top-menus",reportUrlAsIs:!0})}setAssignee(e,t){const i={assignee:t};return this._getChangeURLAndSend({changeNum:e,method:mn.PUT,endpoint:"/assignee",body:i,reportUrlAsIs:!0})}deleteAssignee(e){return this._getChangeURLAndSend({changeNum:e,method:mn.DELETE,endpoint:"/assignee",reportUrlAsIs:!0})}probePath(e){return fetch(new Request(e,{method:mn.HEAD})).then(e=>e.ok)}startWorkInProgress(e,t){const i=t?{message:t}:{},n={changeNum:e,method:mn.POST,endpoint:"/wip",body:i,reportUrlAsIs:!0};return this._getChangeURLAndSend(n).then(e=>{if(204===(null==e?void 0:e.status))return"Change marked as Work In Progress."})}deleteComment(e,t,i,n){return this._getChangeURLAndSend({changeNum:e,method:mn.POST,patchNum:t,endpoint:`/comments/${i}/delete`,body:{reason:n},parseResponse:!0,anonymizedEndpoint:"/comments/*/delete"})}getChange(e,t){return this._restApiHelper.fetchJSON({url:`/changes/?q=change:${e}`,errFn:t,anonymizedUrl:"/changes/?q=change:*"}).then(e=>{const t=e;return t&&t.length?t[0]:null})}setInProjectLookup(e,t){this._projectLookup[e]&&this._projectLookup[e]!==t&&console.warn("Change set with multiple project nums.One of them must be invalid."),this._projectLookup[e]=t}getFromProjectLookup(e){const t=this._projectLookup[`${e}`];if(t)return Promise.resolve(t);return this.getChange(e,e=>Si(e)).then(t=>{if(t&&t.project)return this.setInProjectLookup(e,t.project),t.project})}_getChangeURLAndSend(e){const t=e.patchNum?"/changes/*~*/revisions/*":"/changes/*~*",i=e.reportEndpointAsIs?e.endpoint:e.anonymizedEndpoint;return this._changeBaseURL(e.changeNum,e.patchNum).then(n=>{const o={method:e.method,url:n+e.endpoint,body:e.body,errFn:e.errFn,contentType:e.contentType,headers:e.headers,parseResponse:e.parseResponse,anonymizedUrl:i?`${t}${i}`:void 0};return this._restApiHelper.send(o)})}_getChangeURLAndFetch(e,t){const i=e.reportEndpointAsIs?e.endpoint:e.anonymizedEndpoint,n=e.revision?"/changes/*~*/revisions/*":"/changes/*~*";return this._changeBaseURL(e.changeNum,e.revision).then(o=>this._restApiHelper.fetchJSON({url:o+e.endpoint,errFn:e.errFn,params:e.params,fetchOptions:e.fetchOptions,anonymizedUrl:i?n+i:void 0},t))}executeChangeAction(e,t,i,n,o,r){return this._getChangeURLAndSend({changeNum:e,method:t,patchNum:n,endpoint:i,body:o,errFn:r})}getBlame(e,t,i,n){const o=encodeURIComponent(i);return this._getChangeURLAndFetch({changeNum:e,endpoint:`/files/${o}/blame`,revision:t,params:n?{base:"t"}:void 0,anonymizedEndpoint:"/files/*/blame"})}_failForCreate200(e){return e.then(e=>{if(200===e.status){const t=Array.from(e.headers.entries()).reduce((e,[t,i])=>(Bo.test(t)||(e[t]=i),e),{});throw new Error([$o,JSON.stringify(t)].join("\n"))}return e})}getDashboard(e,t,i){const n="/projects/"+encodeURIComponent(e)+"/dashboards/"+encodeURIComponent(t);return this._fetchSharedCacheURL({url:n,errFn:i,anonymizedUrl:"/projects/*/dashboards/*"})}getDocumentationSearches(e){e=e.trim();const t=encodeURIComponent(e);return this._fetchSharedCacheURL({url:`/Documentation/?q=${t}`,anonymizedUrl:"/Documentation/?*"})}getMergeable(e){return this._getChangeURLAndFetch({changeNum:e,endpoint:"/revisions/current/mergeable",reportEndpointAsIs:!0})}deleteDraftComments(e){const t={query:e};return this._restApiHelper.send({method:mn.POST,url:"/accounts/self/drafts:delete",body:t})}};Vo=Mo([Po("gr-rest-api-interface")],Vo);var Wo=function(e,t){return(Wo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function qo(e,t){function i(){this.constructor=e}Wo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function Ko(e){return"function"==typeof e}var Yo=!1,Xo={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;Yo=e},get useDeprecatedSynchronousErrorHandling(){return Yo}};function Jo(e){setTimeout((function(){throw e}),0)}var Zo={closed:!0,next:function(e){},error:function(e){if(Xo.useDeprecatedSynchronousErrorHandling)throw e;Jo(e)},complete:function(){}},Qo=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function er(e){return null!==e&&"object"==typeof e}var tr=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),ir=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var i=this._parentOrParents,n=this._ctorUnsubscribe,o=this._unsubscribe,r=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(var s=0;s<i.length;++s){i[s].remove(this)}if(Ko(o)){n&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof tr?nr(e.errors):[e]}}if(Qo(r)){s=-1;for(var a=r.length;++s<a;){var l=r[s];if(er(l))try{l.unsubscribe()}catch(e){t=t||[],e instanceof tr?t=t.concat(nr(e.errors)):t.push(e)}}}if(t)throw new tr(t)}},e.prototype.add=function(t){var i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){var n=i;(i=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=i._parentOrParents;if(null===o)i._parentOrParents=this;else if(o instanceof e){if(o===this)return i;i._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return i;o.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[i]:r.push(i),i},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function nr(e){return e.reduce((function(e,t){return e.concat(t instanceof tr?t.errors:t)}),[])}var or=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),rr=function(e){function t(i,n,o){var r=e.call(this)||this;switch(r.syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,arguments.length){case 0:r.destination=Zo;break;case 1:if(!i){r.destination=Zo;break}if("object"==typeof i){i instanceof t?(r.syncErrorThrowable=i.syncErrorThrowable,r.destination=i,i.add(r)):(r.syncErrorThrowable=!0,r.destination=new sr(r,i));break}default:r.syncErrorThrowable=!0,r.destination=new sr(r,i,n,o)}return r}return qo(t,e),t.prototype[or]=function(){return this},t.create=function(e,i,n){var o=new t(e,i,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(ir),sr=function(e){function t(t,i,n,o){var r,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return Ko(i)?r=i:i&&(r=i.next,n=i.error,o=i.complete,i!==Zo&&(Ko((a=Object.create(i)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=r,s._error=n,s._complete=o,s}return qo(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;Xo.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,i=Xo.useDeprecatedSynchronousErrorHandling;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):Jo(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Jo(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};Xo.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),Xo.useDeprecatedSynchronousErrorHandling)throw e;Jo(e)}},t.prototype.__tryOrSetError=function(e,t,i){if(!Xo.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(t){return Xo.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(Jo(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(rr);function ar(e){for(;e;){var t=e,i=t.closed,n=t.destination,o=t.isStopped;if(i||o)return!1;e=n&&n instanceof rr?n:null}return!0}var lr=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function cr(e){return e}function dr(e){return 0===e.length?cr:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var hr=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(e,t,i){var n=this.operator,o=function(e,t,i){if(e){if(e instanceof rr)return e;if(e[or])return e[or]()}return e||t||i?new rr(e,t,i):new rr(Zo)}(e,t,i);if(n?o.add(n.call(o,this.source)):o.add(this.source||Xo.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Xo.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){Xo.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),ar(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var i=this;return new(t=pr(t))((function(t,n){var o;o=i.subscribe((function(t){try{e(t)}catch(e){n(e),o&&o.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[lr]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:dr(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=pr(e))((function(e,i){var n;t.subscribe((function(e){return n=e}),(function(e){return i(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function pr(e){if(e||(e=Xo.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var ur=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),gr=function(e){function t(t,i){var n=e.call(this)||this;return n.subject=t,n.subscriber=i,n.closed=!1,n}return qo(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}},t}(ir),mr=function(e){function t(t){var i=e.call(this,t)||this;return i.destination=t,i}return qo(t,e),t}(rr),fr=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return qo(t,e),t.prototype[or]=function(){return new mr(this)},t.prototype.lift=function(e){var t=new _r(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ur;if(!this.isStopped)for(var t=this.observers,i=t.length,n=t.slice(),o=0;o<i;o++)n[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new ur;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,i=t.length,n=t.slice(),o=0;o<i;o++)n[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ur;this.isStopped=!0;for(var e=this.observers,t=e.length,i=e.slice(),n=0;n<t;n++)i[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ur;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ur;return this.hasError?(e.error(this.thrownError),ir.EMPTY):this.isStopped?(e.complete(),ir.EMPTY):(this.observers.push(e),new gr(this,e))},t.prototype.asObservable=function(){var e=new hr;return e.source=this,e},t.create=function(e,t){return new _r(e,t)},t}(hr),_r=function(e){function t(t,i){var n=e.call(this)||this;return n.destination=t,n.source=i,n}return qo(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):ir.EMPTY},t}(fr);var vr=function(e){function t(t){var i=e.call(this)||this;return i._value=t,i}return qo(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var i=e.prototype._subscribe.call(this,t);return i&&!i.closed&&t.next(this._value),i},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ur;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(fr),yr=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scheduler=t,n.work=i,n.pending=!1,n}return qo(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,i){return void 0===i&&(i=0),setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,t,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var i=!1,n=void 0;try{this.work(e)}catch(e){i=!0,n=!!e&&e||new Error(e)}if(i)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,i=t.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,i){return e.call(this)||this}return qo(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(ir)),br=function(){function e(t,i){void 0===i&&(i=e.now),this.SchedulerAction=t,this.now=i}return e.prototype.schedule=function(e,t,i){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(i,t)},e.now=function(){return Date.now()},e}(),wr=function(e){function t(i,n){void 0===n&&(n=br.now);var o=e.call(this,i,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():n()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return qo(t,e),t.prototype.schedule=function(i,n,o){return void 0===n&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(i,n,o):e.prototype.schedule.call(this,i,n,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}},t}(br);function Cr(e){return e&&"function"==typeof e.schedule}var Sr,Er=function(e){return function(t){for(var i=0,n=e.length;i<n&&!t.closed;i++)t.next(e[i]);t.complete()}};function Ar(e,t){return new hr((function(i){var n=new ir,o=0;return n.add(t.schedule((function(){o!==e.length?(i.next(e[o++]),i.closed||n.add(this.schedule())):i.complete()}))),n}))}function xr(e,t){return t?Ar(e,t):new hr(Er(e))}function Rr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[e.length-1];return Cr(i)?(e.pop(),Ar(e,i)):xr(e)}Sr||(Sr={});var Tr=new wr(yr);function kr(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new Pr(e,t))}}var Pr=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Ir(e,this.project,this.thisArg))},e}(),Ir=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.project=i,o.count=0,o.thisArg=n||o,o}return qo(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(rr);var Or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qo(t,e),t.prototype.notifyNext=function(e,t,i,n,o){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(rr),Nr=function(e){function t(t,i,n){var o=e.call(this)||this;return o.parent=t,o.outerValue=i,o.outerIndex=n,o.index=0,o}return qo(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(rr);function Lr(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Dr=Lr(),Mr=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Fr(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var $r=function(e){if(e&&"function"==typeof e[lr])return i=e,function(e){var t=i[lr]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Mr(e))return Er(e);if(Fr(e))return function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Jo),t}}(e);if(e&&"function"==typeof e[Dr])return t=e,function(e){for(var i=t[Dr]();;){var n=void 0;try{n=i.next()}catch(t){return e.error(t),e}if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof i.return&&e.add((function(){i.return&&i.return()})),e};var t,i,n=er(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+n+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function Br(e,t,i,n,o){if(void 0===o&&(o=new Nr(e,i,n)),!o.closed)return t instanceof hr?t.subscribe(o):$r(t)(o)}var jr={};function Hr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=void 0,n=void 0;return Cr(e[e.length-1])&&(n=e.pop()),"function"==typeof e[e.length-1]&&(i=e.pop()),1===e.length&&Qo(e[0])&&(e=e[0]),xr(e,n).lift(new Ur(i))}var Ur=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Gr(e,this.resultSelector))},e}(),Gr=function(e){function t(t,i){var n=e.call(this,t)||this;return n.resultSelector=i,n.active=0,n.values=[],n.observables=[],n}return qo(t,e),t.prototype._next=function(e){this.values.push(jr),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var i=0;i<t;i++){var n=e[i];this.add(Br(this,n,void 0,i))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,i){var n=this.values,o=n[i],r=this.toRespond?o===jr?--this.toRespond:this.toRespond:0;n[i]=t,0===r&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Or);function zr(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[lr]}(e))return function(e,t){return new hr((function(i){var n=new ir;return n.add(t.schedule((function(){var o=e[lr]();n.add(o.subscribe({next:function(e){n.add(t.schedule((function(){return i.next(e)})))},error:function(e){n.add(t.schedule((function(){return i.error(e)})))},complete:function(){n.add(t.schedule((function(){return i.complete()})))}}))}))),n}))}(e,t);if(Fr(e))return function(e,t){return new hr((function(i){var n=new ir;return n.add(t.schedule((function(){return e.then((function(e){n.add(t.schedule((function(){i.next(e),n.add(t.schedule((function(){return i.complete()})))})))}),(function(e){n.add(t.schedule((function(){return i.error(e)})))}))}))),n}))}(e,t);if(Mr(e))return Ar(e,t);if(function(e){return e&&"function"==typeof e[Dr]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new hr((function(i){var n,o=new ir;return o.add((function(){n&&"function"==typeof n.return&&n.return()})),o.add(t.schedule((function(){n=e[Dr](),o.add(t.schedule((function(){if(!i.closed){var e,t;try{var o=n.next();e=o.value,t=o.done}catch(e){return void i.error(e)}t?i.complete():(i.next(e),this.schedule())}})))}))),o}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Vr(e,t){return t?zr(e,t):e instanceof hr?e:new hr($r(e))}var Wr=function(e){function t(t){var i=e.call(this)||this;return i.parent=t,i}return qo(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(rr),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qo(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(rr);function Kr(e,t){if(!t.closed){if(e instanceof hr)return e.subscribe(t);var i;try{i=$r(e)(t)}catch(e){t.error(e)}return i}}function Yr(e){return!Qo(e)&&e-parseFloat(e)+1>=0}function Xr(e,t){return function(i){return i.lift(new Jr(e,t))}}var Jr=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Zr(e,this.predicate,this.thisArg))},e}(),Zr=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.predicate=i,o.thisArg=n,o.count=0,o}return qo(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(rr);function Qr(e,t,i){void 0===e&&(e=0);var n=-1;return Yr(t)?n=Number(t)<1?1:Number(t):Cr(t)&&(i=t),Cr(i)||(i=Tr),new hr((function(t){var o=Yr(e)?e:+e-i.now();return i.schedule(es,o,{index:0,period:n,subscriber:t})}))}function es(e){var t=e.index,i=e.period,n=e.subscriber;if(n.next(t),!n.closed){if(-1===i)return n.complete();e.index=t+1,this.schedule(e,i)}}var ts=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new is(e,this.selector,this.caught))},e}(),is=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.selector=i,o.caught=n,o}return qo(t,e),t.prototype.error=function(t){if(!this.isStopped){var i=void 0;try{i=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var n=new Wr(this);this.add(n);var o=Kr(i,n);o!==n&&this.add(o)}},t}(qr);function ns(e,t){return function(i){return i.lift(new os(e,t))}}var os=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new rs(e,this.compare,this.keySelector))},e}(),rs=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.keySelector=n,o.hasKey=!1,"function"==typeof i&&(o.compare=i),o}return qo(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var i=this.keySelector;t=i?i(e):e}catch(e){return this.destination.error(e)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;n||(this.key=t,this.destination.next(e))},t}(rr);function ss(e,t){return"function"==typeof t?function(i){return i.pipe(ss((function(i,n){return Vr(e(i,n)).pipe(kr((function(e,o){return t(i,e,n,o)})))})))}:function(t){return t.lift(new as(e))}}var as=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new ls(e,this.project))},e}(),ls=function(e){function t(t,i){var n=e.call(this,t)||this;return n.project=i,n.index=0,n}return qo(t,e),t.prototype._next=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var i=new Wr(this),n=this.destination;n.add(i),this.innerSubscription=Kr(e,i),this.innerSubscription!==i&&n.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(qr);function cs(e){return function(t){return t.lift(new ds(e))}}var ds=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var i=new hs(e),n=Kr(this.notifier,new Wr(i));return n&&!i.seenValue?(i.add(n),t.subscribe(i)):i},e}(),hs=function(e){function t(t){var i=e.call(this,t)||this;return i.seenValue=!1,i}return qo(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(qr);var ps=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new us(e,this.predicate,this.inclusive))},e}(),us=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.predicate=i,o.inclusive=n,o.index=0,o}return qo(t,e),t.prototype._next=function(e){var t,i=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void i.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var i=this.destination;Boolean(t)?i.next(e):(this.inclusive&&i.next(e),i.complete())},t}(rr);var gs={leading:!0,trailing:!1};function ms(e,t,i){return void 0===t&&(t=Tr),void 0===i&&(i=gs),function(n){return n.lift(new fs(e,t,i.leading,i.trailing))}}var fs=function(){function e(e,t,i,n){this.duration=e,this.scheduler=t,this.leading=i,this.trailing=n}return e.prototype.call=function(e,t){return t.subscribe(new _s(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),_s=function(e){function t(t,i,n,o,r){var s=e.call(this,t)||this;return s.duration=i,s.scheduler=n,s.leading=o,s.trailing=r,s._hasTrailingValue=!1,s._trailingValue=null,s}return qo(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(vs,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(rr);function vs(e){e.subscriber.clearThrottle()}function ys(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var i;"function"==typeof e[e.length-1]&&(i=e.pop());var n=e;return t.lift(new ws(n,i))}}var bs,ws=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new Cs(e,this.observables,this.project))},e}(),Cs=function(e){function t(t,i,n){var o=e.call(this,t)||this;o.observables=i,o.project=n,o.toRespond=[];var r=i.length;o.values=new Array(r);for(var s=0;s<r;s++)o.toRespond.push(s);for(s=0;s<r;s++){var a=i[s];o.add(Br(o,a,void 0,s))}return o}return qo(t,e),t.prototype.notifyNext=function(e,t,i){this.values[i]=t;var n=this.toRespond;if(n.length>0){var o=n.indexOf(i);-1!==o&&n.splice(o,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Or);!function(e){e.ADMIN="admin",e.AGREEMENTS="agreements",e.CHANGE="change",e.DASHBOARD="dashboard",e.DIFF="diff",e.DOCUMENTATION_SEARCH="documentation-search",e.EDIT="edit",e.GROUP="group",e.PLUGIN_SCREEN="plugin-screen",e.REPO="repo",e.ROOT="root",e.SEARCH="search",e.SETTINGS="settings"}(bs||(bs={}));const Ss=new vr({}),Es=Ss;const As=Es.pipe(kr(e=>e.changeNum),ns()),xs=Es.pipe(kr(e=>e.patchNum),ns()),Rs=new vr({}),Ts=Rs;function ks(e){const t=Rs.getValue();void 0!==e&&void 0!==t.change&&e._number!==t.change._number&&Rs.next({...t,change:void 0}),Rs.next({...t,change:e})}const Ps=Hr([Es,Ts]).pipe(Xr(([e,t])=>{var i;const n=null===(i=t.change)||void 0===i?void 0:i._number,o=e.changeNum;return void 0===n||n===o}),ns()),Is=Ts.pipe(kr(e=>e.change),ns()),Os=Is.pipe(kr(e=>null==e?void 0:e._number),ns()),Ns=Is.pipe(kr(e=>null==e?void 0:e.project),ns()),Ls=Is.pipe(kr(e=>Jn(Yn(e))),ns());Ps.pipe(ys(xs,Ls),kr(([e,t,i])=>t||i),ns());class Ds{constructor(){As.subscribe(e=>{e||ks(void 0)})}updateChange(e){ks(e)}}var Ms,Fs,$s,Bs,js,Hs;function Us(e){if(void 0===e)return"launch";switch(e){case js.EXTERNAL:return"launch";case js.IMAGE:return"insert-photo";case js.HISTORY:return"restore";case js.DOWNLOAD:return"download";case js.DOWNLOAD_MOBILE:return"system-update";case js.HELP_PAGE:return"help-outline";case js.REPORT_BUG:return"bug";default:return"launch"}}function Gs(e){if(void 0===e)return"Link to details";switch(e){case js.EXTERNAL:return"Link to details";case js.IMAGE:return"Link to image";case js.HISTORY:return"Link to result history";case js.DOWNLOAD:case js.DOWNLOAD_MOBILE:return"Download";case js.HELP_PAGE:return"Link to help page";case js.REPORT_BUG:return"Link for reporting a problem";default:return"Link to details"}}function zs(e){return Qs(e,$s.ERROR)?$s.ERROR:Qs(e,$s.WARNING)?$s.WARNING:Qs(e,$s.INFO)?$s.INFO:void 0}function Vs(e){switch(e){case $s.ERROR:return"error";case $s.INFO:return"info-outline";case $s.WARNING:return"warning";case"SUCCESS":return"check-circle-outline";default:r(e,`Unsupported category: ${e}`)}}function Ws(e){return qs(e).filter(t=>t.name===function(e){switch(e){case Fs.COMPLETED:return Hs.RERUN;case Fs.RUNNABLE:return Hs.RUN;case Fs.RUNNING:return Hs.CANCEL;default:r(e,`Unsupported status: ${e}`)}}(e.status))[0]}function qs(e){return(null==e?void 0:e.actions)?e.actions.map(t=>function(e,t){let i=e.name.toLowerCase();return t!==Fs.COMPLETED||"run"!==i&&"re-run"!==i||(i=Hs.RERUN),t===Fs.RUNNING&&"stop"===i&&(i=Hs.CANCEL),{...e,name:i}}(t,e.status)):[]}function Ks(e){if(e.status!==Fs.COMPLETED)return Ys(e.status);{const t=zs(e);return t?Vs(t):Ys(e.status)}}function Ys(e){switch(e){case Fs.COMPLETED:return"check-circle-outline";case Fs.RUNNABLE:return"placeholder";case Fs.RUNNING:return"timelapse";default:r(e,`Unsupported status: ${e}`)}}function Xs(e){return e.status===Fs.RUNNING}function Js(e){return e.status===Fs.COMPLETED||e.status===Fs.RUNNING}function Zs(e){var t;return e.status===Fs.COMPLETED&&0===(null!==(t=e.results)&&void 0!==t?t:[]).length}function Qs(e,t){return ea(e,t).length>0}function ea(e,t){var i;return(null!==(i=e.results)&&void 0!==i?i:[]).filter(e=>e.category===t)}function ta(e,t){return ia(zs(t))-ia(zs(e))}function ia(e){if(!e)return-1;switch(e){case $s.INFO:return 0;case $s.WARNING:return 1;case $s.ERROR:return 2}}function na(e,t,i){e.dispatchEvent(new CustomEvent("action-triggered",{detail:{action:t,run:i},composed:!0,bubbles:!0}))}function oa(e){var t;return{...e,internalRunId:"fake",isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],results:(null!==(t=e.results)&&void 0!==t?t:[]).map(ra)}}function ra(e){return{...e,internalResultId:"fake"}}!function(e){e.OK="OK",e.ERROR="ERROR",e.NOT_LOGGED_IN="NOT_LOGGED_IN"}(Ms||(Ms={})),function(e){e.RUNNABLE="RUNNABLE",e.RUNNING="RUNNING",e.COMPLETED="COMPLETED"}(Fs||(Fs={})),function(e){e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}($s||($s={})),function(e){e.GRAY="gray",e.YELLOW="yellow",e.PINK="pink",e.PURPLE="purple",e.CYAN="cyan",e.BROWN="brown"}(Bs||(Bs={})),function(e){e.EXTERNAL="external",e.IMAGE="image",e.HISTORY="history",e.DOWNLOAD="download",e.DOWNLOAD_MOBILE="download_mobile",e.HELP_PAGE="help_page",e.REPORT_BUG="report_bug"}(js||(js={})),function(e){e.RERUN="rerun",e.RUN="run",e.CANCEL="cancel"}(Hs||(Hs={}));const sa=new vr({providerNameToState:{}}),aa=sa,la=aa.pipe(kr(e=>e.patchsetNumber),ns()),ca=aa.pipe(kr(e=>e.providerNameToState),ns()),da=ca.pipe(kr(e=>Object.keys(e).length>0),ns()),ha=ca.pipe(kr(e=>Object.values(e).some(e=>e.loading)),ns()),pa=ca.pipe(kr(e=>{var t;return null===(t=Object.values(e).find(e=>void 0!==e.errorMessage))||void 0===t?void 0:t.errorMessage}),ns()),ua=ca.pipe(kr(e=>{var t;return null===(t=Object.values(e).find(e=>void 0!==e.loginCallback))||void 0===t?void 0:t.loginCallback}),ns()),ga=ca.pipe(kr(e=>Object.values(e).reduce((e,t)=>[...e,...t.actions],[]))),ma=ca.pipe(kr(e=>Object.values(e).reduce((e,t)=>[...e,...t.links],[]))),fa=ca.pipe(kr(e=>Object.values(e).reduce((e,t)=>[...e,...t.runs],[]))),_a=fa.pipe(kr(e=>e.filter(e=>e.isLatestAttempt))),va=ca.pipe(kr(e=>{const t=new Map;for(const[i,n]of Object.entries(e))for(const e of n.runs)t.set(e.checkName,i);return t})),ya=ca.pipe(kr(e=>Object.values(e).reduce((e,t)=>[...e,...t.runs.reduce((e,t)=>{var i;return e.concat(null!==(i=t.results)&&void 0!==i?i:[])},[])],[]).filter(e=>void 0!==e)));const ba={internalRunId:"f0",checkName:"FAKE Error Finder",labelName:"Presubmit",isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],results:[{internalResultId:"f0r0",category:$s.ERROR,summary:"I would like to point out this error: 1 is not equal to 2!",links:[{primary:!0,url:"https://www.google.com",icon:js.EXTERNAL}],tags:[{name:"OBSOLETE"},{name:"E2E"}]},{internalResultId:"f0r1",category:$s.ERROR,summary:"Running the mighty test has failed by crashing.",actions:[{name:"Ignore",tooltip:"Ignore this result",primary:!0,callback:()=>{}},{name:"Flag",tooltip:"Flag this result as not useful",primary:!0,callback:()=>{}},{name:"Upload",tooltip:"Upload the result to the super cloud.",primary:!1,callback:()=>{}}],tags:[{name:"INTERRUPTED"},{name:"WINDOWS"}],links:[{primary:!0,url:"https://google.com",icon:js.EXTERNAL},{primary:!0,url:"https://google.com",icon:js.DOWNLOAD},{primary:!0,url:"https://google.com",icon:js.REPORT_BUG},{primary:!0,url:"https://google.com",icon:js.HELP_PAGE},{primary:!0,url:"https://google.com",icon:js.HISTORY}]}],status:Fs.COMPLETED},wa={internalRunId:"f1",checkName:"FAKE Super Check",labelName:"Verified",isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],results:[{internalResultId:"f1r0",category:$s.WARNING,summary:"We think that you could improve this.",message:"There is a lot to be said. A lot. I say, a lot.\n\n                So please keep reading.",tags:[{name:"INTERRUPTED"},{name:"WINDOWS"}],links:[{primary:!0,url:"https://google.com",icon:js.EXTERNAL},{primary:!0,url:"https://google.com",icon:js.DOWNLOAD},{primary:!0,url:"https://google.com",icon:js.DOWNLOAD_MOBILE},{primary:!0,url:"https://google.com",icon:js.IMAGE}]}],status:Fs.RUNNING},Ca={internalRunId:"f2",checkName:"FAKE Mega Analysis",statusDescription:"This run is nearly completed, but not quite.",statusLink:"https://www.google.com/",checkDescription:"From what the title says you can tell that this check analyses.",checkLink:"https://www.google.com/",scheduledTimestamp:new Date("2021-04-01T03:14:15"),startedTimestamp:new Date("2021-04-01T04:24:25"),finishedTimestamp:new Date("2021-04-01T04:44:44"),isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],actions:[{name:"Re-Run",tooltip:"More powerful run than before",primary:!0,callback:()=>{}},{name:"Monetize",primary:!0,callback:()=>{}},{name:"Delete",primary:!0,callback:()=>{}}],results:[{internalResultId:"f2r0",category:$s.INFO,summary:"This is looking a bit too large.",message:"We are still looking into how large exactly. Stay tuned.\nAnd have a look at https://www.google.com!\n\nOr have a look at change 30000.\nExample code:\n  const constable = '';\n  var variable = '';",tags:[{name:"FLAKY"},{name:"MAC-OS"}]}],status:Fs.COMPLETED},Sa={internalRunId:"f3",checkName:"FAKE Critical Observations",status:Fs.RUNNABLE,isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[]},Ea={internalRunId:"f4",checkName:"FAKE Elimination",status:Fs.COMPLETED,attempt:1,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[]},Aa={internalRunId:"f4",checkName:"FAKE Elimination",status:Fs.COMPLETED,attempt:2,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],results:[{internalResultId:"f42r0",category:$s.INFO,summary:"Please eliminate all the TODOs!"}]},xa={internalRunId:"f4",checkName:"FAKE Elimination",status:Fs.COMPLETED,attempt:3,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],results:[{internalResultId:"f43r0",category:$s.ERROR,summary:"Without eliminating all the TODOs your change will break!"}]},Ra={internalRunId:"f4",checkName:"FAKE Elimination",checkDescription:"Shows you the possible eliminations.",checkLink:"https://www.google.com",status:Fs.RUNNING,statusDescription:"Everything was eliminated already.",statusLink:"https://www.google.com",attempt:4,scheduledTimestamp:new Date("2021-04-02T03:14:15"),startedTimestamp:new Date("2021-04-02T04:24:25"),finishedTimestamp:new Date("2021-04-02T04:25:44"),isSingleAttempt:!1,isLatestAttempt:!0,attemptDetails:[],results:[{internalResultId:"f44r0",category:$s.INFO,summary:"Dont be afraid. All TODOs will be eliminated."}]},Ta=[{name:"Fake Action 1",primary:!1,tooltip:"Tooltip for Fake Action 1",callback:()=>{console.warn("fake action 1 triggered")}},{name:"Fake Action 2",primary:!1,tooltip:"Tooltip for Fake Action 2",callback:()=>{console.warn("fake action 2 triggered")}},{name:"Fake Action 3",primary:!1,tooltip:"Tooltip for Fake Action 3",callback:()=>{console.warn("fake action 3 triggered")}}],ka=[{url:"https://www.google.com",primary:!1,tooltip:"Tooltip for Bug Report Fake Link",icon:js.REPORT_BUG},{url:"https://www.google.com",primary:!1,tooltip:"Tooltip for External Fake Link",icon:js.EXTERNAL}];function Pa(e,t,i=[],n=[]){const o=function(e){const t=new Map;for(const i of e){const e=t.get(i.checkName),n={attempt:i.attempt,icon:Ks(oa(i))};if(void 0!==e){if(!i.attempt||!e.latestAttempt)throw new Error('If multiple run attempts are provided, then each run must have the "attempt" property set.');e.isSingleAttempt=!1,i.attempt>e.latestAttempt&&(e.latestAttempt=i.attempt),e.attempts.push(n)}else t.set(i.checkName,{latestAttempt:i.attempt,isSingleAttempt:!0,attempts:[n]})}return t}(t);for(const e of o.values())e.attempts.sort((e,t)=>{var i,n;return(null!==(i=t.attempt)&&void 0!==i?i:-1)-(null!==(n=e.attempt)&&void 0!==n?n:-1)});const r={...sa.getValue()};r.providerNameToState={...r.providerNameToState},r.providerNameToState[e]={...r.providerNameToState[e],loading:!1,errorMessage:void 0,loginCallback:void 0,runs:t.map(e=>{var t;const i=`${e.checkName}-${e.change}-${e.patchset}-${e.attempt}`,n=o.get(e.checkName);return a(n,"attemptInfo"),{...e,internalRunId:i,isLatestAttempt:n.latestAttempt===e.attempt,isSingleAttempt:n.isSingleAttempt,attemptDetails:n.attempts,results:(null!==(t=e.results)&&void 0!==t?t:[]).map((e,t)=>({...e,internalResultId:`${i}-${t}`}))}}),actions:[...i],links:[...n]},sa.next(r)}function Ia(e){const t={...sa.getValue()};t.patchsetNumber=e,sa.next(t)}class Oa{constructor(){this.providers={},this.reloadSubjects={},this.checkToPluginMap=new Map,this.documentVisibilityChange$=new vr(void 0),va.subscribe(e=>{this.checkToPluginMap=e}),Ls.subscribe(e=>{Ia(e)}),document.addEventListener("visibilitychange",()=>{this.documentVisibilityChange$.next(void 0)})}setPatchset(e){Ia(e)}reload(e){this.reloadSubjects[e].next()}reloadAll(){Object.keys(this.providers).forEach(e=>this.reload(e))}reloadForCheck(e){if(!e)return;const t=this.checkToPluginMap.get(e);t&&this.reload(t)}register(e,t,i){var n;this.providers[e]=t,this.reloadSubjects[e]=new vr(void 0),function(e,t){const i={...sa.getValue()};i.providerNameToState={...i.providerNameToState},i.providerNameToState[e]={pluginName:e,loading:!1,config:t,runs:[],actions:[],links:[]},sa.next(i)}(e,i);const o=1e3*(null!==(n=null==i?void 0:i.fetchPollingIntervalSeconds)&&void 0!==n?n:60);var r,s,l;Hr([Os,la,this.reloadSubjects[e].pipe(ms(1e3)),Qr(0,o),this.documentVisibilityChange$]).pipe((s=t=>!!this.providers[e],void 0===l&&(l=!1),function(e){return e.lift(new ps(s,l))}),Xr(e=>"hidden"!==document.visibilityState),ys(Is),ss(([[t,i],n])=>{var o,r;if(!n||!t||!i||"number"!=typeof i)return Rr({responseCode:Ms.OK,runs:[]});a(n.revisions,"change.revisions");const s=function(e,t){for(const[i,n]of Object.entries(e))if(n._number===t)return i}(n.revisions,i);if(!s)return Rr({responseCode:Ms.OK,runs:[]});const l={changeNumber:t,patchsetNumber:i,patchsetSha:s,repo:n.project,commmitMessage:null===(r=null===(o=xo(n))||void 0===o?void 0:o.commit)||void 0===r?void 0:r.message,changeInfo:n};return function(e){const t={...sa.getValue()};t.providerNameToState={...t.providerNameToState},t.providerNameToState[e]={...t.providerNameToState[e],loading:!0},sa.next(t)}(e),Vr(this.providers[e].fetch(l))}),(r=t=>Rr({responseCode:Ms.ERROR,errorMessage:`Error message from plugin '${e}': ${t}`}),function(e){var t=new ts(r),i=e.lift(t);return t.caught=i})).subscribe(t=>{var i,n,o;switch(t.responseCode){case Ms.ERROR:a(t.errorMessage,"errorMessage"),function(e,t){const i={...sa.getValue()};i.providerNameToState={...i.providerNameToState},i.providerNameToState[e]={...i.providerNameToState[e],loading:!1,errorMessage:t,loginCallback:void 0,runs:[],actions:[]},sa.next(i)}(e,t.errorMessage);break;case Ms.NOT_LOGGED_IN:a(t.loginCallback,"loginCallback"),function(e,t){const i={...sa.getValue()};i.providerNameToState={...i.providerNameToState},i.providerNameToState[e]={...i.providerNameToState[e],loading:!1,errorMessage:void 0,loginCallback:t,runs:[],actions:[]},sa.next(i)}(e,t.loginCallback);break;case Ms.OK:Pa(e,null!==(i=t.runs)&&void 0!==i?i:[],null!==(n=t.actions)&&void 0!==n?n:[],null!==(o=t.links)&&void 0!==o?o:[])}})}}function Na(e){if(!(e instanceof URL))try{e=new URL(e)}catch(e){return console.warn(e),null}if("preloaded:"===e.protocol)return e.pathname;const t=k();let i=e.pathname.replace(t,"");return window.ASSETS_PATH&&e.href.includes(window.ASSETS_PATH)&&(i=e.href.replace(window.ASSETS_PATH,"")),["/static/gerrit-theme.html","/static/gerrit-theme.js"].includes(i)?"gerrit-theme":i.startsWith("/plugins")?i.split("/")[2].split(".")[0]:(console.warn("Plugin not being loaded from /plugins base path:",e.href," Unable to determine name."),null)}function La(e,t,n,o){return i.restApiService.send(e,t,o).then(e=>e.status<200||e.status>=300?e.text().then(t=>t?Promise.reject(new Error(t)):Promise.reject(new Error(`${e.status}`))):i.restApiService.getResponseObject(e)).then(e=>(n&&n(e),e))}class Da{constructor(e,t){this.plugin=e,this.element=t,this._promises=new Map,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"attribute","constructor")}_getChangedEventName(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"-changed"}_elementHasProperty(e){return void 0!==this.element[e]}_reportValue(e,t){try{e(t)}catch(e){console.info(e)}}bind(e,t){this.reporting.trackApi(this.plugin,"attribute","bind");const i=this._getChangedEventName(e),n=e=>this._reportValue(t,e.detail.value);return this.element.addEventListener(i,n),this._elementHasProperty(e)&&this._reportValue(t,this.element[e]),()=>this.element.removeEventListener(i,n)}get(e){if(this.reporting.trackApi(this.plugin,"attribute","get"),this._elementHasProperty(e))return Promise.resolve(this.element[e]);if(!this._promises.has(e)){let t;const i=new Promise(e=>t=e),n=this.bind(e,e=>{t(e),n()});this._promises.set(e,i)}return this._promises.get(e)}set(e,t){this.reporting.trackApi(this.plugin,"attribute","set"),this.element[e]=t,this.element.dispatchEvent(new CustomEvent(this._getChangedEventName(e),{detail:{value:t}}))}}var Ma,Fa,$a,Ba,ja,Ha;!function(e){e.CHANGE_ACTIONS="changeactions",e.REPLY_DIALOG="replydialog"}(Ma||(Ma={})),function(e){e.HISTORY="history",e.LABEL_CHANGE="labelchange",e.SHOW_CHANGE="showchange",e.SUBMIT_CHANGE="submitchange",e.SHOW_REVISION_ACTIONS="show-revision-actions",e.COMMIT_MSG_EDIT="commitmsgedit",e.COMMENT="comment",e.REVERT="revert",e.REVERT_SUBMISSION="revert_submission",e.POST_REVERT="postrevert",e.ANNOTATE_DIFF="annotatediff",e.ADMIN_MENU_LINKS="admin-menu-links",e.HIGHLIGHTJS_LOADED="highlightjs-loaded"}(Fa||(Fa={})),function(e){e.CHANGE="change",e.REVISION="revision"}($a||($a={})),function(e){e[e.CHANGE=2]="CHANGE",e[e.DEFAULT=0]="DEFAULT",e[e.PRIMARY=3]="PRIMARY",e[e.REVIEW=-3]="REVIEW",e[e.REVISION=1]="REVISION"}(Ba||(Ba={})),function(e){e.ABANDON="abandon",e.DELETE="/",e.DELETE_EDIT="deleteEdit",e.EDIT="edit",e.FOLLOW_UP="followup",e.IGNORE="ignore",e.MOVE="move",e.PRIVATE="private",e.PRIVATE_DELETE="private.delete",e.PUBLISH_EDIT="publishEdit",e.REBASE="rebase",e.REBASE_EDIT="rebaseEdit",e.READY="ready",e.RESTORE="restore",e.REVERT="revert",e.REVERT_SUBMISSION="revert_submission",e.REVIEWED="reviewed",e.STOP_EDIT="stopEdit",e.SUBMIT="submit",e.UNIGNORE="unignore",e.UNREVIEWED="unreviewed",e.WIP="wip"}(ja||(ja={})),function(e){e.CHERRYPICK="cherrypick",e.REBASE="rebase",e.SUBMIT="submit",e.DOWNLOAD="download"}(Ha||(Ha={}));class Ua{constructor(e,t){this.plugin=e,this.RevisionActions=Ha,this.ChangeActions=ja,this.ActionType=$a,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"actions","constructor"),this.setEl(t)}setEl(e){e?this.el=e:console.warn("changeActions() is not ready")}ensureEl(){if(!this.el){const e=i.jsApiService;this.setEl(e.getElement(Ma.CHANGE_ACTIONS))}return this.el}addPrimaryActionKey(e){this.reporting.trackApi(this.plugin,"actions","addPrimaryActionKey");const t=this.ensureEl();t.primaryActionKeys.includes(e)||t.push("primaryActionKeys",e)}removePrimaryActionKey(e){this.reporting.trackApi(this.plugin,"actions","removePrimaryActionKey");const t=this.ensureEl();t.primaryActionKeys=t.primaryActionKeys.filter(t=>t!==e)}hideQuickApproveAction(){this.reporting.trackApi(this.plugin,"actions","hideQuickApproveAction"),this.ensureEl().hideQuickApproveAction()}setActionOverflow(e,t,i){return this.reporting.trackApi(this.plugin,"actions","setActionOverflow"),this.ensureEl().setActionOverflow(e,t,i)}setActionPriority(e,t,i){return this.reporting.trackApi(this.plugin,"actions","setActionPriority"),this.ensureEl().setActionPriority(e,t,i)}setActionHidden(e,t,i){return this.reporting.trackApi(this.plugin,"actions","setActionHidden"),this.ensureEl().setActionHidden(e,t,i)}add(e,t){return this.reporting.trackApi(this.plugin,"actions","add"),this.ensureEl().addActionButton(e,t)}remove(e){return this.reporting.trackApi(this.plugin,"actions","remove"),this.ensureEl().removeActionButton(e)}addTapListener(e,t){this.reporting.trackApi(this.plugin,"actions","addTapListener"),this.ensureEl().addEventListener(e+"-tap",t)}removeTapListener(e,t){this.reporting.trackApi(this.plugin,"actions","removeTapListener"),this.ensureEl().removeEventListener(e+"-tap",t)}setLabel(e,t){this.reporting.trackApi(this.plugin,"actions","setLabel"),this.ensureEl().setActionButtonProp(e,"label",t)}setTitle(e,t){this.reporting.trackApi(this.plugin,"actions","setTitle"),this.ensureEl().setActionButtonProp(e,"title",t)}setEnabled(e,t){this.reporting.trackApi(this.plugin,"actions","setEnabled"),this.ensureEl().setActionButtonProp(e,"enabled",t)}setIcon(e,t){this.reporting.trackApi(this.plugin,"actions","setIcon"),this.ensureEl().setActionButtonProp(e,"icon",t)}getActionDetails(e){this.reporting.trackApi(this.plugin,"actions","getActionDetails");const t=this.ensureEl();return t.getActionDetails(e)||t.getActionDetails(this.plugin.getPluginName()+"~"+e)}}class Ga{constructor(e,t){this.plugin=e,this.sharedApiElement=t,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"reply","constructor")}get _el(){return this.sharedApiElement.getElement(Ma.REPLY_DIALOG)}getLabelValue(e){return this.reporting.trackApi(this.plugin,"reply","getLabelValue"),this._el.getLabelValue(e)}setLabelValue(e,t){this.reporting.trackApi(this.plugin,"reply","setLabelValue"),this._el.setLabelValue(e,t)}addReplyTextChangedCallback(e){this.reporting.trackApi(this.plugin,"reply","addReplyTextChangedCb");const t=this.plugin.hook("reply-text"),i=t=>{e(t.detail.value)};t.onAttached(e=>{e.content&&e.content.addEventListener("value-changed",i)}),t.onDetached(e=>{e.content&&e.content.removeEventListener("value-changed",i)})}addLabelValuesChangedCallback(e){this.reporting.trackApi(this.plugin,"reply","addLabelValuesChangedCb");const t=this.plugin.hook("reply-label-scores"),i=t=>{e(t.detail)};t.onAttached(e=>{e.content&&e.content.addEventListener("labels-changed",i)}),t.onDetached(e=>{e.content&&e.content.removeEventListener("labels-changed",i)})}showMessage(e){this.reporting.trackApi(this.plugin,"reply","showMessage"),this._el.setPluginMessage(e)}}class za{constructor(e){this.plugin=e,this.hooks={}}_getHookName(e,t){if(t)return e+" "+t;return(this.plugin.getPluginName()||"unknownplugin").toLowerCase()+"-autogenerated-"+e}getDomHook(e,t){const i=this._getHookName(e,t);return this.hooks[i]||(this.hooks[i]=new Va(i,t)),this.hooks[i]}}class Va{constructor(e,t){this.instances=[],this.attachCallbacks=[],this.detachCallbacks=[],this.lastAttachedPromise=null,t?this.moduleName=t:(this.moduleName=e,this._createPlaceholder(e))}_createPlaceholder(e){class t extends fi{static get is(){return e}static get properties(){return{plugin:Object,content:Object}}}customElements.define(t.is,t)}handleInstanceDetached(e){const t=this.instances.indexOf(e);-1!==t&&this.instances.splice(t,1),this.detachCallbacks.forEach(t=>t(e))}handleInstanceAttached(e){this.instances.push(e),this.attachCallbacks.forEach(t=>t(e))}getLastAttached(){if(this.instances.length)return Promise.resolve(this.instances.slice(-1)[0]);if(!this.lastAttachedPromise){let e;const t=new Promise(t=>{e=t,this.attachCallbacks.push(e)});this.lastAttachedPromise=t.then(t=>{this.lastAttachedPromise=null;const i=this.attachCallbacks.indexOf(e);return-1!==i&&this.attachCallbacks.splice(i,1),t})}return this.lastAttachedPromise}getAllAttached(){return this.instances}onAttached(e){return this.attachCallbacks.push(e),this}onDetached(e){return this.detachCallbacks.push(e),this}getModuleName(){return this.moduleName}}const Wa="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,qa=(e,t,i=null,n=null)=>{for(;t!==i;){const i=t.nextSibling;e.insertBefore(t,n),t=i}},Ka=(e,t,i=null)=>{for(;t!==i;){const i=t.nextSibling;e.removeChild(t),t=i}},Ya=`{{lit-${String(Math.random()).slice(2)}}}`,Xa=`\x3c!--${Ya}--\x3e`,Ja=new RegExp(`${Ya}|${Xa}`);class Za{constructor(e,t){this.parts=[],this.element=t;const i=[],n=[],o=document.createTreeWalker(t.content,133,null,!1);let r=0,s=-1,a=0;const{strings:l,values:{length:c}}=e;for(;a<c;){const e=o.nextNode();if(null!==e){if(s++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:i}=t;let n=0;for(let e=0;e<i;e++)Qa(t[e].name,"$lit$")&&n++;for(;n-- >0;){const t=l[a],i=il.exec(t)[2],n=i.toLowerCase()+"$lit$",o=e.getAttribute(n);e.removeAttribute(n);const r=o.split(Ja);this.parts.push({type:"attribute",index:s,name:i,strings:r}),a+=r.length-1}}"TEMPLATE"===e.tagName&&(n.push(e),o.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(Ya)>=0){const n=e.parentNode,o=t.split(Ja),r=o.length-1;for(let t=0;t<r;t++){let i,r=o[t];if(""===r)i=tl();else{const e=il.exec(r);null!==e&&Qa(e[2],"$lit$")&&(r=r.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),i=document.createTextNode(r)}n.insertBefore(i,e),this.parts.push({type:"node",index:++s})}""===o[r]?(n.insertBefore(tl(),e),i.push(e)):e.data=o[r],a+=r}}else if(8===e.nodeType)if(e.data===Ya){const t=e.parentNode;null!==e.previousSibling&&s!==r||(s++,t.insertBefore(tl(),e)),r=s,this.parts.push({type:"node",index:s}),null===e.nextSibling?e.data="":(i.push(e),s--),a++}else{let t=-1;for(;-1!==(t=e.data.indexOf(Ya,t+1));)this.parts.push({type:"node",index:-1}),a++}}else o.currentNode=n.pop()}for(const e of i)e.parentNode.removeChild(e)}}const Qa=(e,t)=>{const i=e.length-t.length;return i>=0&&e.slice(i)===t},el=e=>-1!==e.index,tl=()=>document.createComment(""),il=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function nl(e,t){const{element:{content:i},parts:n}=e,o=document.createTreeWalker(i,133,null,!1);let r=rl(n),s=n[r],a=-1,l=0;const c=[];let d=null;for(;o.nextNode();){a++;const e=o.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&l++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-l,r=rl(n,r),s=n[r]}c.forEach(e=>e.parentNode.removeChild(e))}const ol=e=>{let t=11===e.nodeType?0:1;const i=document.createTreeWalker(e,133,null,!1);for(;i.nextNode();)t++;return t},rl=(e,t=-1)=>{for(let i=t+1;i<e.length;i++){const t=e[i];if(el(t))return i}return-1};const sl=new WeakMap,al=e=>(...t)=>{const i=e(...t);return sl.set(i,!0),i},ll=e=>"function"==typeof e&&sl.has(e),cl={},dl={};class hl{constructor(e,t,i){this.__parts=[],this.template=e,this.processor=t,this.options=i}update(e){let t=0;for(const i of this.__parts)void 0!==i&&i.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=Wa?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],i=this.template.parts,n=document.createTreeWalker(e,133,null,!1);let o,r=0,s=0,a=n.nextNode();for(;r<i.length;)if(o=i[r],el(o)){for(;s<o.index;)s++,"TEMPLATE"===a.nodeName&&(t.push(a),n.currentNode=a.content),null===(a=n.nextNode())&&(n.currentNode=t.pop(),a=n.nextNode());if("node"===o.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(a.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(a,o.name,o.strings,this.options));r++}else this.__parts.push(void 0),r++;return Wa&&(document.adoptNode(e),customElements.upgrade(e)),e}}const pl=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),ul=` ${Ya} `;class gl{constructor(e,t,i,n){this.strings=e,this.values=t,this.type=i,this.processor=n}getHTML(){const e=this.strings.length-1;let t="",i=!1;for(let n=0;n<e;n++){const e=this.strings[n],o=e.lastIndexOf("\x3c!--");i=(o>-1||i)&&-1===e.indexOf("--\x3e",o+1);const r=il.exec(e);t+=null===r?e+(i?ul:Xa):e.substr(0,r.index)+r[1]+r[2]+"$lit$"+r[3]+Ya}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==pl&&(t=pl.createHTML(t)),e.innerHTML=t,e}}const ml=e=>null===e||!("object"==typeof e||"function"==typeof e),fl=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class _l{constructor(e,t,i){this.dirty=!0,this.element=e,this.name=t,this.strings=i,this.parts=[];for(let e=0;e<i.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new vl(this)}_getValue(){const e=this.strings,t=e.length-1,i=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=i[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!fl(e))return e}let n="";for(let o=0;o<t;o++){n+=e[o];const t=i[o];if(void 0!==t){const e=t.value;if(ml(e)||!fl(e))n+="string"==typeof e?e:String(e);else for(const t of e)n+="string"==typeof t?t:String(t)}}return n+=e[t],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class vl{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===cl||ml(e)&&e===this.value||(this.value=e,ll(e)||(this.committer.dirty=!0))}commit(){for(;ll(this.value);){const e=this.value;this.value=cl,e(this)}this.value!==cl&&this.committer.commit()}}class yl{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(tl()),this.endNode=e.appendChild(tl())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=tl()),e.__insert(this.endNode=tl())}insertAfterPart(e){e.__insert(this.startNode=tl()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;ll(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=cl,e(this)}const e=this.__pendingValue;e!==cl&&(ml(e)?e!==this.value&&this.__commitText(e):e instanceof gl?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):fl(e)?this.__commitIterable(e):e===dl?(this.value=dl,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,i="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=i:this.__commitNode(document.createTextNode(i)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof hl&&this.value.template===t)this.value.update(e.values);else{const i=new hl(t,e.processor,this.options),n=i._clone();i.update(e.values),this.__commitNode(n),this.value=i}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let i,n=0;for(const o of e)i=t[n],void 0===i&&(i=new yl(this.options),t.push(i),0===n?i.appendIntoPart(this):i.insertAfterPart(t[n-1])),i.setValue(o),i.commit(),n++;n<t.length&&(t.length=n,this.clear(i&&i.endNode))}clear(e=this.startNode){Ka(this.startNode.parentNode,e.nextSibling,this.endNode)}}class bl{constructor(e,t,i){if(this.value=void 0,this.__pendingValue=void 0,2!==i.length||""!==i[0]||""!==i[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=i}setValue(e){this.__pendingValue=e}commit(){for(;ll(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=cl,e(this)}if(this.__pendingValue===cl)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=cl}}class wl extends _l{constructor(e,t,i){super(e,t,i),this.single=2===i.length&&""===i[0]&&""===i[1]}_createPart(){return new Cl(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class Cl extends vl{}let Sl=!1;(()=>{try{const e={get capture(){return Sl=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class El{constructor(e,t,i){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=i,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;ll(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=cl,e(this)}if(this.__pendingValue===cl)return;const e=this.__pendingValue,t=this.value,i=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),n=null!=e&&(null==t||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=Al(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=cl}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const Al=e=>e&&(Sl?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);function xl(e){let t=Rl.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},Rl.set(e.type,t));let i=t.stringsArray.get(e.strings);if(void 0!==i)return i;const n=e.strings.join(Ya);return i=t.keyString.get(n),void 0===i&&(i=new Za(e,e.getTemplateElement()),t.keyString.set(n,i)),t.stringsArray.set(e.strings,i),i}const Rl=new Map,Tl=new WeakMap;const kl=new class{handleAttributeExpressions(e,t,i,n){const o=t[0];if("."===o){return new wl(e,t.slice(1),i).parts}return"@"===o?[new El(e,t.slice(1),n.eventContext)]:"?"===o?[new bl(e,t.slice(1),i)]:new _l(e,t,i).parts}handleTextExpression(e){return new yl(e)}};"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const Pl=(e,...t)=>new gl(e,t,"html",kl),Il=(e,t)=>`${e}--${t}`;let Ol=!0;void 0===window.ShadyCSS?Ol=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),Ol=!1);const Nl=e=>t=>{const i=Il(t.type,e);let n=Rl.get(i);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},Rl.set(i,n));let o=n.stringsArray.get(t.strings);if(void 0!==o)return o;const r=t.strings.join(Ya);if(o=n.keyString.get(r),void 0===o){const i=t.getTemplateElement();Ol&&window.ShadyCSS.prepareTemplateDom(i,e),o=new Za(t,i),n.keyString.set(r,o)}return n.stringsArray.set(t.strings,o),o},Ll=["html","svg"],Dl=new Set,Ml=(e,t,i)=>{Dl.add(e);const n=i?i.element:document.createElement("template"),o=t.querySelectorAll("style"),{length:r}=o;if(0===r)return void window.ShadyCSS.prepareTemplateStyles(n,e);const s=document.createElement("style");for(let e=0;e<r;e++){const t=o[e];t.parentNode.removeChild(t),s.textContent+=t.textContent}(e=>{Ll.forEach(t=>{const i=Rl.get(Il(t,e));void 0!==i&&i.keyString.forEach(e=>{const{element:{content:t}}=e,i=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{i.add(e)}),nl(e,i)})})})(e);const a=n.content;i?function(e,t,i=null){const{element:{content:n},parts:o}=e;if(null==i)return void n.appendChild(t);const r=document.createTreeWalker(n,133,null,!1);let s=rl(o),a=0,l=-1;for(;r.nextNode();){for(l++,r.currentNode===i&&(a=ol(t),i.parentNode.insertBefore(t,i));-1!==s&&o[s].index===l;){if(a>0){for(;-1!==s;)o[s].index+=a,s=rl(o,s);return}s=rl(o,s)}}}(i,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(n,e);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(i){a.insertBefore(s,a.firstChild);const e=new Set;e.add(s),nl(i,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const Fl={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},$l=(e,t)=>t!==e&&(t==t||e==e),Bl={attribute:!0,type:String,converter:Fl,reflect:!1,hasChanged:$l};class jl extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,i)=>{const n=this._attributeNameForProperty(i,t);void 0!==n&&(this._attributeToPropertyMap.set(n,i),e.push(n))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=Bl){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const i="symbol"==typeof e?Symbol():`__${e}`,n=this.getPropertyDescriptor(e,i,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}static getPropertyDescriptor(e,t,i){return{get(){return this[t]},set(n){const o=this[e];this[t]=n,this.requestUpdateInternal(e,o,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||Bl}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const i of t)this.createProperty(i,e[i])}}static _attributeNameForProperty(e,t){const i=t.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,i=$l){return i(e,t)}static _propertyValueFromAttribute(e,t){const i=t.type,n=t.converter||Fl,o="function"==typeof n?n:n.fromAttribute;return o?o(e,i):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const i=t.type,n=t.converter;return(n&&n.toAttribute||Fl.toAttribute)(e,i)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,i){t!==i&&this._attributeToProperty(e,i)}_propertyToAttribute(e,t,i=Bl){const n=this.constructor,o=n._attributeNameForProperty(e,i);if(void 0!==o){const e=n._propertyValueToAttribute(t,i);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(o):this.setAttribute(o,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const i=this.constructor,n=i._attributeToPropertyMap.get(e);if(void 0!==n){const e=i.getPropertyOptions(n);this._updateState=16|this._updateState,this[n]=i._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,i){let n=!0;if(void 0!==e){const o=this.constructor;i=i||o.getPropertyOptions(e),o._valueHasChanged(this[e],t,i.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,i))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}jl.finalized=!0;const Hl=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:i,elements:n}=t;return{kind:i,elements:n,finisher(t){window.customElements.define(e,t)}}})(e,t),Ul=(e,t)=>"method"!==t.kind||!t.descriptor||"value"in t.descriptor?{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(i){i.createProperty(t.key,e)}}:Object.assign(Object.assign({},t),{finisher(i){i.createProperty(t.key,e)}});function Gl(e){return(t,i)=>void 0!==i?((e,t,i)=>{t.constructor.createProperty(i,e)})(e,t,i):Ul(e,t)}function zl(e){return Gl({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}function Vl(e,t){return(i,n)=>{const o={get(){return this.renderRoot.querySelector(e)},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof n?Symbol():`__${n}`;o.get=function(){return void 0===this[t]&&(this[t]=this.renderRoot.querySelector(e)),this[t]}}return void 0!==n?Wl(o,i,n):ql(o,i)}}const Wl=(e,t,i)=>{Object.defineProperty(t,i,e)},ql=(e,t)=>({kind:"method",placement:"prototype",key:t.key,descriptor:e});const Kl=Element.prototype;Kl.msMatchesSelector||Kl.webkitMatchesSelector;const Yl=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Xl=Symbol();class Jl{constructor(e,t){if(t!==Xl)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(Yl?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const Zl=(e,...t)=>{const i=t.reduce((t,i,n)=>t+(e=>{if(e instanceof Jl)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(i)+e[n+1],e[0]);return new Jl(i,Xl)};(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const Ql={};class ec extends jl{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,i)=>e.reduceRight((e,i)=>Array.isArray(i)?t(i,e):(e.add(i),e),i),i=t(e,new Set),n=[];i.forEach(e=>n.unshift(e)),this._styles=n}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map(e=>{if(e instanceof CSSStyleSheet&&!Yl){const t=Array.prototype.slice.call(e.cssRules).reduce((e,t)=>e+t.cssText,"");return new Jl(String(t),Xl)}return e})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Yl?this.renderRoot.adoptedStyleSheets=e.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==Ql&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return Ql}}ec.finalized=!0,ec.render=(e,t,i)=>{if(!i||"object"!=typeof i||!i.scopeName)throw new Error("The `scopeName` option is required.");const n=i.scopeName,o=Tl.has(t),r=Ol&&11===t.nodeType&&!!t.host,s=r&&!Dl.has(n),a=s?document.createDocumentFragment():t;if(((e,t,i)=>{let n=Tl.get(t);void 0===n&&(Ka(t,t.firstChild),Tl.set(t,n=new yl(Object.assign({templateFactory:xl},i))),n.appendInto(t)),n.setValue(e),n.commit()})(e,a,Object.assign({templateFactory:Nl(n)},i)),s){const e=Tl.get(a);Tl.delete(a);const i=e.value instanceof hl?e.value.template:void 0;Ml(n,a,i),Ka(t,t.firstChild),t.appendChild(a),Tl.set(t,e)}!o&&r&&window.ShadyCSS.styleElement(t.host)};const tc=document.createElement("template"),ic=Zl`
  /* CSS reset */

  html,
  body,
  button,
  div,
  span,
  applet,
  object,
  iframe,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  blockquote,
  pre,
  a,
  abbr,
  acronym,
  address,
  big,
  cite,
  code,
  del,
  dfn,
  em,
  img,
  ins,
  kbd,
  q,
  s,
  samp,
  small,
  strike,
  strong,
  sub,
  sup,
  tt,
  var,
  b,
  u,
  i,
  center,
  dl,
  dt,
  dd,
  ol,
  ul,
  li,
  fieldset,
  form,
  label,
  legend,
  table,
  caption,
  tbody,
  tfoot,
  thead,
  tr,
  th,
  td,
  article,
  aside,
  canvas,
  details,
  embed,
  figure,
  figcaption,
  footer,
  header,
  hgroup,
  main,
  menu,
  nav,
  output,
  ruby,
  section,
  summary,
  time,
  mark,
  audio,
  video {
    border: 0;
    box-sizing: border-box;
    font-size: 100%;
    font: inherit;
    margin: 0;
    padding: 0;
    vertical-align: baseline;
  }
  *::after,
  *::before {
    box-sizing: border-box;
  }
  input {
    background-color: var(--background-color-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    box-sizing: border-box;
    color: var(--primary-text-color);
    margin: 0;
    padding: var(--spacing-s);
  }
  iron-autogrow-textarea {
    background-color: inherit;
    color: var(--primary-text-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 0;
    box-sizing: border-box;
    /* iron-autogrow-textarea has a "-webkit-appearance: textarea" :host
        css rule, which prevents overriding the border color. Clear that. */
    -webkit-appearance: none;

    --iron-autogrow-textarea: {
      box-sizing: border-box;
      padding: var(--spacing-s);
    }
  }
  a {
    color: var(--link-color);
  }
  input,
  textarea,
  select,
  button {
    font: inherit;
  }
  ol,
  ul {
    list-style: none;
  }
  blockquote,
  q {
    quotes: none;
  }
  blockquote:before,
  blockquote:after,
  q:before,
  q:after {
    content: '';
    content: none;
  }
  table {
    border-collapse: collapse;
    border-spacing: 0;
  }

  /* Fonts */

  .font-normal {
    font-size: var(--font-size-normal);
    font-weight: var(--font-weight-normal);
    line-height: var(--line-height-normal);
  }
  .font-small {
    font-size: var(--font-size-small);
    font-weight: var(--font-weight-normal);
    line-height: var(--line-height-small);
  }
  .heading-1 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h1);
    font-weight: var(--font-weight-h1);
    line-height: var(--line-height-h1);
  }
  .heading-2 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-h2);
    line-height: var(--line-height-h2);
  }
  .heading-3 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-h3);
    line-height: var(--line-height-h3);
  }
  iron-icon {
    color: var(--deemphasized-text-color);
    vertical-align: top;
    --iron-icon-height: 20px;
    --iron-icon-width: 20px;
  }

  /* Stopgap solution until we remove hidden$ attributes. */

  :host([hidden]),
  [hidden] {
    display: none !important;
  }
  .separator {
    border-left: 1px solid var(--border-color);
    height: 20px;
    margin: 0 8px;
  }
  .separator.transparent {
    border-color: transparent;
  }
  paper-toggle-button {
    --paper-toggle-button-checked-bar-color: var(--link-color);
    --paper-toggle-button-checked-button-color: var(--link-color);
  }
  paper-tabs {
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-h3);
    line-height: var(--line-height-h3);
    --paper-font-common-base: {
      font-family: var(--header-font-family);
      -webkit-font-smoothing: initial;
    }
    --paper-tab-content-focused: {
      /* paper-tabs uses 700 here, which can look awkward */
      font-weight: var(--font-weight-h3);
    }
    --paper-tab-content-unselected: {
      /* paper-tabs uses 0.8 here, but we want to control the color directly */
      opacity: 1;
      color: var(--deemphasized-text-color);
    }
  }
  iron-autogrow-textarea {
    /** This is needed for firefox */
    --iron-autogrow-textarea_-_white-space: pre-wrap;
  }
  strong {
    font-weight: var(--font-weight-bold);
  }

  .assistive-tech-only {
    user-select: none;
    clip: rect(1px, 1px, 1px, 1px);
    height: 1px;
    margin: 0;
    overflow: hidden;
    padding: 0;
    position: absolute;
    white-space: nowrap;
    width: 1px;
    z-index: -1000;
  }

  /** BEGIN: loading spiner */
  .loadingSpin {
    border: 2px solid var(--disabled-button-background-color);
    border-top: 2px solid var(--primary-button-background-color);
    border-radius: 50%;
    width: 10px;
    height: 10px;
    animation: spin 2s linear infinite;
    margin-right: var(--spacing-s);
  }
  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
  /** END: loading spiner */
`;tc.innerHTML=`<dom-module id="shared-styles">\n  <template>\n    <style>\n    ${ic.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(tc.content);const nc=mi`
  <style include="shared-styles">
    :host {
      background: var(--dialog-background-color);
      border-radius: var(--border-radius);
      box-shadow: var(--elevation-level-5);
    }

    @media screen and (max-width: 50em) {
      :host {
        height: 100%;
        left: 0;
        position: fixed;
        right: 0;
        top: 0;
        border-radius: 0;
        box-shadow: none;
      }
    }
  </style>
  <slot></slot>
`,oc=!(window.ShadyDOM&&window.ShadyDOM.inUse);let rc,sc;function ac(e){rc=(!e||!e.shimcssproperties)&&(oc||Boolean(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(sc=window.ShadyCSS.cssBuild);const lc=Boolean(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?rc=window.ShadyCSS.nativeCss:window.ShadyCSS?(ac(window.ShadyCSS),window.ShadyCSS=void 0):ac(window.WebComponents&&window.WebComponents.flags);const cc=rc;class dc{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function hc(e){return function e(t,i){let n=i.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=n.trim(),t.parent){let e=t.previous?t.previous.end:t.parent.start;n=i.substring(e,t.start-1),n=function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,(function(){let e=arguments[1],t=6-e.length;for(;t--;)e="0"+e;return"\\"+e}))}(n),n=n.replace(fc.multipleSpaces," "),n=n.substring(n.lastIndexOf(";")+1);let o=t.parsedSelector=t.selector=n.trim();t.atRule=0===o.indexOf(yc),t.atRule?0===o.indexOf(vc)?t.type=uc.MEDIA_RULE:o.match(fc.keyframesRule)&&(t.type=uc.KEYFRAMES_RULE,t.keyframesName=t.selector.split(fc.multipleSpaces).pop()):0===o.indexOf(_c)?t.type=uc.MIXIN_RULE:t.type=uc.STYLE_RULE}let o=t.rules;if(o)for(let t,n=0,r=o.length;n<r&&(t=o[n]);n++)e(t,i);return t}(function(e){let t=new dc;t.start=0,t.end=e.length;let i=t;for(let n=0,o=e.length;n<o;n++)if(e[n]===gc){i.rules||(i.rules=[]);let e=i,t=e.rules[e.rules.length-1]||null;i=new dc,i.start=n+1,i.parent=e,i.previous=t,e.rules.push(i)}else e[n]===mc&&(i.end=n+1,i=i.parent||t);return t}(e=e.replace(fc.comments,"").replace(fc.port,"")),e)}function pc(e,t,i=""){let n="";if(e.cssText||e.rules){let i=e.rules;if(i&&!function(e){let t=e[0];return Boolean(t)&&Boolean(t.selector)&&0===t.selector.indexOf(_c)}(i))for(let e,o=0,r=i.length;o<r&&(e=i[o]);o++)n=pc(e,t,n);else n=t?e.cssText:function(e){return function(e){return e.replace(fc.mixinApply,"").replace(fc.varApply,"")}(e=function(e){return e.replace(fc.customProp,"").replace(fc.mixinProp,"")}(e))}(e.cssText),n=n.trim(),n&&(n="  "+n+"\n")}return n&&(e.selector&&(i+=e.selector+" "+gc+"\n"),i+=n,e.selector&&(i+=mc+"\n\n")),i}const uc={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},gc="{",mc="}",fc={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},_c="--",vc="@media",yc="@",bc=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,wc=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,Cc=/@media\s(.*)/,Sc=new Set;function Ec(e){const t=e.textContent;if(!Sc.has(t)){Sc.add(t);const e=document.createElement("style");e.setAttribute("shady-unscoped",""),e.textContent=t,document.head.appendChild(e)}}function Ac(e){return e.hasAttribute("shady-unscoped")}function xc(e,t){return e?("string"==typeof e&&(e=hc(e)),t&&Tc(e,t),pc(e,cc)):""}function Rc(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=hc(e.textContent)),e.__cssRules||null}function Tc(e,t,i,n){if(!e)return;let o=!1,r=e.type;if(n&&r===uc.MEDIA_RULE){let t=e.selector.match(Cc);t&&(window.matchMedia(t[1]).matches||(o=!0))}r===uc.STYLE_RULE?t(e):i&&r===uc.KEYFRAMES_RULE?i(e):r===uc.MIXIN_RULE&&(o=!0);let s=e.rules;if(s&&!o)for(let e,o=0,r=s.length;o<r&&(e=s[o]);o++)Tc(e,t,i,n)}function kc(e,t){let i=0;for(let n=t,o=e.length;n<o;n++)if("("===e[n])i++;else if(")"===e[n]&&0==--i)return n;return-1}window.ShadyDOM&&window.ShadyDOM.wrap;function Pc(e){if(void 0!==sc)return sc;if(void 0===e.__cssBuild){const t=e.getAttribute("css-build");if(t)e.__cssBuild=t;else{const t=function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;if(t instanceof Comment){const e=t.textContent.trim().split(":");if("css-build"===e[0])return e[1]}return""}(e);""!==t&&function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;t.parentNode.removeChild(t)}(e),e.__cssBuild=t}}return e.__cssBuild||""}function Ic(e){return""!==Pc(e)}function Oc(e,t){for(let i in t)null===i?e.style.removeProperty(i):e.style.setProperty(i,t[i])}function Nc(e,t){const i=window.getComputedStyle(e).getPropertyValue(t);return i?i.trim():""}const Lc=/;\s*/m,Dc=/^\s*(initial)|(inherit)\s*$/,Mc=/\s*!important/;class Fc{constructor(){this._map={}}set(e,t){e=e.trim(),this._map[e]={properties:t,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let $c=null;class Bc{constructor(){this._currentElement=null,this._measureElement=null,this._map=new Fc}detectMixin(e){return function(e){const t=wc.test(e)||bc.test(e);return wc.lastIndex=0,bc.lastIndex=0,t}(e)}gatherStyles(e){const t=function(e){const t=[],i=e.querySelectorAll("style");for(let e=0;e<i.length;e++){const n=i[e];Ac(n)?oc||(Ec(n),n.parentNode.removeChild(n)):(t.push(n.textContent),n.parentNode.removeChild(n))}return t.join("").trim()}(e.content);if(t){const i=document.createElement("style");return i.textContent=t,e.content.insertBefore(i,e.content.firstChild),i}return null}transformTemplate(e,t){void 0===e._gatheredStyle&&(e._gatheredStyle=this.gatherStyles(e));const i=e._gatheredStyle;return i?this.transformStyle(i,t):null}transformStyle(e,t=""){let i=Rc(e);return this.transformRules(i,t),e.textContent=xc(i),i}transformCustomStyle(e){let t=Rc(e);return Tc(t,e=>{":root"===e.selector&&(e.selector="html"),this.transformRule(e)}),e.textContent=xc(t),t}transformRules(e,t){this._currentElement=t,Tc(e,e=>{this.transformRule(e)}),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),":root"===e.selector&&(e.selector=":host > *")}transformCssText(e,t){return e=e.replace(bc,(e,i,n,o)=>this._produceCssProperties(e,i,n,o,t)),this._consumeCssProperties(e,t)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let t=e;for(;t.parent;)t=t.parent;const i={};let n=!1;return Tc(t,t=>{n=n||t===e,n||t.selector===e.selector&&Object.assign(i,this._cssTextToMap(t.parsedCssText))}),i}_consumeCssProperties(e,t){let i=null;for(;i=wc.exec(e);){let n=i[0],o=i[1],r=i.index,s=r+n.indexOf("@apply"),a=r+n.length,l=e.slice(0,s),c=e.slice(a),d=t?this._fallbacksFromPreviousRules(t):{};Object.assign(d,this._cssTextToMap(l));let h=this._atApplyToCssProperties(o,d);e=`${l}${h}${c}`,wc.lastIndex=r+h.length}return e}_atApplyToCssProperties(e,t){e=e.replace(Lc,"");let i=[],n=this._map.get(e);if(n||(this._map.set(e,{}),n=this._map.get(e)),n){let o,r,s;this._currentElement&&(n.dependants[this._currentElement]=!0);const a=n.properties;for(o in a)s=t&&t[o],r=[o,": var(",e,"_-_",o],s&&r.push(",",s.replace(Mc,"")),r.push(")"),Mc.test(a[o])&&r.push(" !important"),i.push(r.join(""))}return i.join("; ")}_replaceInitialOrInherit(e,t){let i=Dc.exec(t);return i&&(t=i[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),t}_cssTextToMap(e,t=!1){let i,n,o=e.split(";"),r={};for(let e,s,a=0;a<o.length;a++)e=o[a],e&&(s=e.split(":"),s.length>1&&(i=s[0].trim(),n=s.slice(1).join(":"),t&&(n=this._replaceInitialOrInherit(i,n)),r[i]=n));return r}_invalidateMixinEntry(e){if($c)for(let t in e.dependants)t!==this._currentElement&&$c(t)}_produceCssProperties(e,t,i,n,o){if(i&&function e(t,i){let n=t.indexOf("var(");if(-1===n)return i(t,"","","");let o=kc(t,n+3),r=t.substring(n+4,o),s=t.substring(0,n),a=e(t.substring(o+1),i),l=r.indexOf(",");return-1===l?i(s,r.trim(),"",a):i(s,r.substring(0,l).trim(),r.substring(l+1).trim(),a)}(i,(e,t)=>{t&&this._map.get(t)&&(n=`@apply ${t};`)}),!n)return e;let r=this._consumeCssProperties(""+n,o),s=e.slice(0,e.indexOf("--")),a=this._cssTextToMap(r,!0),l=a,c=this._map.get(t),d=c&&c.properties;d?l=Object.assign(Object.create(d),a):this._map.set(t,l);let h,p,u=[],g=!1;for(h in l)p=a[h],void 0===p&&(p="initial"),!d||h in d||(g=!0),u.push(`${t}_-_${h}: ${p}`);return g&&this._invalidateMixinEntry(c),c&&(c.properties=l),i&&(s=`${e};${s}`),`${s}${u.join("; ")};`}}Bc.prototype.detectMixin=Bc.prototype.detectMixin,Bc.prototype.transformStyle=Bc.prototype.transformStyle,Bc.prototype.transformCustomStyle=Bc.prototype.transformCustomStyle,Bc.prototype.transformRules=Bc.prototype.transformRules,Bc.prototype.transformRule=Bc.prototype.transformRule,Bc.prototype.transformTemplate=Bc.prototype.transformTemplate,Bc.prototype._separator="_-_",Object.defineProperty(Bc.prototype,"invalidCallback",{get:()=>$c,set(e){$c=e}});const jc={},Hc="_applyShimCurrentVersion",Uc="_applyShimNextVersion",Gc=Promise.resolve();function zc(e){let t=jc[e];t&&function(e){e[Hc]=e[Hc]||0,e._applyShimValidatingVersion=e._applyShimValidatingVersion||0,e[Uc]=(e[Uc]||0)+1}(t)}function Vc(e){return e[Hc]===e[Uc]}function Wc(e){return!Vc(e)&&e._applyShimValidatingVersion===e[Uc]}function qc(e){e._applyShimValidatingVersion=e[Uc],e._validating||(e._validating=!0,Gc.then((function(){e[Hc]=e[Uc],e._validating=!1})))}let Kc,Yc=null,Xc=window.HTMLImports&&window.HTMLImports.whenReady||null;function Jc(e){requestAnimationFrame((function(){Xc?Xc(e):(Yc||(Yc=new Promise(e=>{Kc=e}),"complete"===document.readyState?Kc():document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&Kc()})),Yc.then((function(){e&&e()})))}))}const Zc="__shadyCSSCachedStyle";let Qc=null,ed=null;class td{constructor(){this.customStyles=[],this.enqueued=!1,Jc(()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()})}enqueueDocumentValidation(){!this.enqueued&&ed&&(this.enqueued=!0,Jc(ed))}addCustomStyle(e){e.__seenByShadyCSS||(e.__seenByShadyCSS=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[Zc])return e[Zc];let t;return t=e.getStyle?e.getStyle():e,t}processStyles(){const e=this.customStyles;for(let t=0;t<e.length;t++){const i=e[t];if(i[Zc])continue;const n=this.getStyleForCustomStyle(i);if(n){const e=n.__appliedElement||n;Qc&&Qc(e),i[Zc]=e}}return e}}td.prototype.addCustomStyle=td.prototype.addCustomStyle,td.prototype.getStyleForCustomStyle=td.prototype.getStyleForCustomStyle,td.prototype.processStyles=td.prototype.processStyles,Object.defineProperties(td.prototype,{transformCallback:{get:()=>Qc,set(e){Qc=e}},validateCallback:{get:()=>ed,set(e){let t=!1;ed||(t=!0),ed=e,t&&this.enqueueDocumentValidation()}}});const id=new Bc;class nd{constructor(){this.customStyleInterface=null,id.invalidCallback=zc}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=e=>{id.transformCustomStyle(e)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame(()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()})})}prepareTemplate(e,t){if(this.ensure(),Ic(e))return;jc[t]=e;let i=id.transformTemplate(e,t);e._styleAst=i}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let t=0;t<e.length;t++){let i=e[t],n=this.customStyleInterface.getStyleForCustomStyle(i);n&&id.transformCustomStyle(n)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,t){if(this.ensure(),t&&Oc(e,t),e.shadowRoot){this.styleElement(e);let t=e.shadowRoot.children||e.shadowRoot.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}else{let t=e.children||e.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}}styleElement(e){this.ensure();let{is:t}=function(e){let t=e.localName,i="",n="";return t?t.indexOf("-")>-1?i=t:(n=t,i=e.getAttribute&&e.getAttribute("is")||""):(i=e.is,n=e.extends),{is:i,typeExtension:n}}(e),i=jc[t];if((!i||!Ic(i))&&i&&!Vc(i)){Wc(i)||(this.prepareTemplate(i,t),qc(i));let n=e.shadowRoot;if(n){let e=n.querySelector("style");e&&(e.__cssRules=i._styleAst,e.textContent=xc(i._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const e=new nd;let t=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(t,i,n){e.flushCustomStyles(),e.prepareTemplate(t,i)},prepareTemplateStyles(e,t,i){window.ShadyCSS.prepareTemplate(e,t,i)},prepareTemplateDom(e,t){},styleSubtree(t,i){e.flushCustomStyles(),e.styleSubtree(t,i)},styleElement(t){e.flushCustomStyles(),e.styleElement(t)},styleDocument(t){e.flushCustomStyles(),e.styleDocument(t)},getComputedStyleValue:(e,t)=>Nc(e,t),flushCustomStyles(){e.flushCustomStyles()},nativeCss:cc,nativeShadow:oc,cssBuild:sc,disableRuntime:lc},t&&(window.ShadyCSS.CustomStyleInterface=t)}window.ShadyCSS.ApplyShim=id;class od{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,t){this._asyncModule=e,this._callback=t,this._timer=this._asyncModule.run(()=>{this._timer=null,rd.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),rd.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return null!=this._timer}static debounce(e,t,i){return e instanceof od?e._cancelAsync():e=new od,e.setConfig(t,i),e}}let rd=new Set;const sd=function(e){rd.add(e)},ad=function(){const e=Boolean(rd.size);return rd.forEach(e=>{try{e.flush()}catch(e){setTimeout(()=>{throw e})}}),e};let ld="string"==typeof document.head.style.touchAction,cd="__polymerGesturesHandled",dd="__polymerGesturesTouchAction",hd=["mousedown","mousemove","mouseup","click"],pd=[0,1,4,2],ud=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}();function gd(e){return hd.indexOf(e)>-1}let md=!1;function fd(e){if(!gd(e)&&"touchend"!==e)return ld&&md&&Z?{passive:!0}:void 0}!function(){try{let e=Object.defineProperty({},"passive",{get(){md=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();let _d=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const vd=[],yd={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},bd={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function wd(e){let t=Array.prototype.slice.call(e.labels||[]);if(!t.length){t=[];let i=e.getRootNode();if(e.id){let n=i.querySelectorAll(`label[for = ${e.id}]`);for(let e=0;e<n.length;e++)t.push(n[e])}}return t}let Cd=function(e){let t=e.sourceCapabilities;var i;if((!t||t.firesTouchEvents)&&(e[cd]={skip:!0},"click"===e.type)){let t=!1,n=Td(e);for(let e=0;e<n.length;e++){if(n[e].nodeType===Node.ELEMENT_NODE)if("label"===n[e].localName)vd.push(n[e]);else if(i=n[e],yd[i.localName]){let i=wd(n[e]);for(let e=0;e<i.length;e++)t=t||vd.indexOf(i[e])>-1}if(n[e]===Ad.mouse.target)return}if(t)return;e.preventDefault(),e.stopPropagation()}};function Sd(e){let t=_d?["click"]:hd;for(let i,n=0;n<t.length;n++)i=t[n],e?(vd.length=0,document.addEventListener(i,Cd,!0)):document.removeEventListener(i,Cd,!0)}function Ed(e){let t=e.type;if(!gd(t))return!1;if("mousemove"===t){let t=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!ud&&(t=pd[e.which]||0),Boolean(1&t)}return 0===(void 0===e.button?0:e.button)}let Ad={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function xd(e,t,i){e.movefn=t,e.upfn=i,document.addEventListener("mousemove",t),document.addEventListener("mouseup",i)}function Rd(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}he&&document.addEventListener("touchend",(function(e){if(!he)return;Ad.mouse.mouseIgnoreJob||Sd(!0),Ad.mouse.target=Td(e)[0],Ad.mouse.mouseIgnoreJob=od.debounce(Ad.mouse.mouseIgnoreJob,rt.after(2500),(function(){Sd(),Ad.mouse.target=null,Ad.mouse.mouseIgnoreJob=null}))}),!!md&&{passive:!0});const Td=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:e=>e.composedPath&&e.composedPath()||[],kd={},Pd=[];function Id(e,t){let i=document.elementFromPoint(e,t),n=i;for(;n&&n.shadowRoot&&!window.ShadyDOM;){let o=n;if(n=n.shadowRoot.elementFromPoint(e,t),o===n)break;n&&(i=n)}return i}function Od(e){const t=Td(e);return t.length>0?t[0]:e.target}function Nd(e){let t,i=e.type,n=e.currentTarget.__polymerGestures;if(!n)return;let o=n[i];if(o){if(!e[cd]&&(e[cd]={},"touch"===i.slice(0,5))){let t=(e=e).changedTouches[0];if("touchstart"===i&&1===e.touches.length&&(Ad.touch.id=t.identifier),Ad.touch.id!==t.identifier)return;ld||"touchstart"!==i&&"touchmove"!==i||function(e){let t=e.changedTouches[0],i=e.type;if("touchstart"===i)Ad.touch.x=t.clientX,Ad.touch.y=t.clientY,Ad.touch.scrollDecided=!1;else if("touchmove"===i){if(Ad.touch.scrollDecided)return;Ad.touch.scrollDecided=!0;let i=function(e){let t="auto",i=Td(e);for(let e,n=0;n<i.length;n++)if(e=i[n],e[dd]){t=e[dd];break}return t}(e),n=!1,o=Math.abs(Ad.touch.x-t.clientX),r=Math.abs(Ad.touch.y-t.clientY);e.cancelable&&("none"===i?n=!0:"pan-x"===i?n=r>o:"pan-y"===i&&(n=o>r)),n?e.preventDefault():Bd("track")}}(e)}if(t=e[cd],!t.skip){for(let i,n=0;n<Pd.length;n++)i=Pd[n],o[i.name]&&!t[i.name]&&i.flow&&i.flow.start.indexOf(e.type)>-1&&i.reset&&i.reset();for(let n,r=0;r<Pd.length;r++)n=Pd[r],o[n.name]&&!t[n.name]&&(t[n.name]=!0,n[i](e))}}}function Ld(e,t,i){return!!kd[t]&&(function(e,t,i){let n=kd[t],o=n.deps,r=n.name,s=e.__polymerGestures;s||(e.__polymerGestures=s={});for(let t,i,n=0;n<o.length;n++)t=o[n],_d&&gd(t)&&"click"!==t||(i=s[t],i||(s[t]=i={_count:0}),0===i._count&&e.addEventListener(t,Nd,fd(t)),i[r]=(i[r]||0)+1,i._count=(i._count||0)+1);e.addEventListener(t,i),n.touchAction&&Fd(e,n.touchAction)}(e,t,i),!0)}function Dd(e,t,i){return!!kd[t]&&(function(e,t,i){let n=kd[t],o=n.deps,r=n.name,s=e.__polymerGestures;if(s)for(let t,i,n=0;n<o.length;n++)t=o[n],i=s[t],i&&i[r]&&(i[r]=(i[r]||1)-1,i._count=(i._count||1)-1,0===i._count&&e.removeEventListener(t,Nd,fd(t)));e.removeEventListener(t,i)}(e,t,i),!0)}function Md(e){Pd.push(e);for(let t=0;t<e.emits.length;t++)kd[e.emits[t]]=e}function Fd(e,t){ld&&e instanceof HTMLElement&&lt.run(()=>{e.style.touchAction=t}),e[dd]=t}function $d(e,t,i){let n=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(n.detail=i,Me(e).dispatchEvent(n),n.defaultPrevented){let e=i.preventer||i.sourceEvent;e&&e.preventDefault&&e.preventDefault()}}function Bd(e){let t=function(e){for(let t,i=0;i<Pd.length;i++){t=Pd[i];for(let i,n=0;n<t.emits.length;n++)if(i=t.emits[n],i===e)return t}return null}(e);t.info&&(t.info.prevent=!0)}function jd(e,t,i,n){t&&$d(t,e,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:n,prevent:function(e){return Bd(e)}})}function Hd(e,t,i){if(e.prevent)return!1;if(e.started)return!0;let n=Math.abs(e.x-t),o=Math.abs(e.y-i);return n>=5||o>=5}function Ud(e,t,i){if(!t)return;let n,o=e.moves[e.moves.length-2],r=e.moves[e.moves.length-1],s=r.x-e.x,a=r.y-e.y,l=0;o&&(n=r.x-o.x,l=r.y-o.y),$d(t,"track",{state:e.state,x:i.clientX,y:i.clientY,dx:s,dy:a,ddx:n,ddy:l,sourceEvent:i,hover:function(){return Id(i.clientX,i.clientY)}})}function Gd(e,t,i){let n=Math.abs(t.clientX-e.x),o=Math.abs(t.clientY-e.y),r=Od(i||t);!r||bd[r.localName]&&r.hasAttribute("disabled")||(isNaN(n)||isNaN(o)||n<=25&&o<=25||function(e){if("click"===e.type){if(0===e.detail)return!0;let t=Od(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let i=t.getBoundingClientRect(),n=e.pageX,o=e.pageY;return!(n>=i.left&&n<=i.right&&o>=i.top&&o<=i.bottom)}return!1}(t))&&(e.prevent||$d(r,"tap",{x:t.clientX,y:t.clientY,sourceEvent:t,preventer:i}))}Md({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){Rd(this.info)},mousedown:function(e){if(!Ed(e))return;let t=Od(e),i=this;xd(this.info,(function(e){Ed(e)||(jd("up",t,e),Rd(i.info))}),(function(e){Ed(e)&&jd("up",t,e),Rd(i.info)})),jd("down",t,e)},touchstart:function(e){jd("down",Od(e),e.changedTouches[0],e)},touchend:function(e){jd("up",Od(e),e.changedTouches[0],e)}}),Md({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>2&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,Rd(this.info)},mousedown:function(e){if(!Ed(e))return;let t=Od(e),i=this,n=function(e){let n=e.clientX,o=e.clientY;Hd(i.info,n,o)&&(i.info.state=i.info.started?"mouseup"===e.type?"end":"track":"start","start"===i.info.state&&Bd("tap"),i.info.addMove({x:n,y:o}),Ed(e)||(i.info.state="end",Rd(i.info)),t&&Ud(i.info,t,e),i.info.started=!0)};xd(this.info,n,(function(e){i.info.started&&n(e),Rd(i.info)})),this.info.x=e.clientX,this.info.y=e.clientY},touchstart:function(e){let t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){let t=Od(e),i=e.changedTouches[0],n=i.clientX,o=i.clientY;Hd(this.info,n,o)&&("start"===this.info.state&&Bd("tap"),this.info.addMove({x:n,y:o}),Ud(this.info,t,i),this.info.state="track",this.info.started=!0)},touchend:function(e){let t=Od(e),i=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:i.clientX,y:i.clientY}),Ud(this.info,t,i))}}),Md({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(e){Ed(e)&&(this.info.x=e.clientX,this.info.y=e.clientY)},click:function(e){Ed(e)&&Gd(this.info,e)},touchstart:function(e){const t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchend:function(e){Gd(this.info,e.changedTouches[0],e)}});const zd=Od,Vd=Ld,Wd=Dd,qd=ye(e=>class extends e{_addEventListenerToNode(e,t,i){Ld(e,t,i)||super._addEventListenerToNode(e,t,i)}_removeEventListenerFromNode(e,t,i){Dd(e,t,i)||super._removeEventListenerFromNode(e,t,i)}}),Kd=/:host\(:dir\((ltr|rtl)\)\)/g,Yd=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,Xd=/:dir\((?:ltr|rtl)\)/,Jd=Boolean(window.ShadyDOM&&window.ShadyDOM.inUse),Zd=[];let Qd=null,eh="";function th(){eh=document.documentElement.getAttribute("dir")}function ih(e){if(!e.__autoDirOptOut){e.setAttribute("dir",eh)}}function nh(){th(),eh=document.documentElement.getAttribute("dir");for(let e=0;e<Zd.length;e++)ih(Zd[e])}const oh=ye(e=>{Jd||Qd||(th(),Qd=new MutationObserver(nh),Qd.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const t=ut(e);class i extends t{static _processStyleText(e,i){return e=t._processStyleText.call(this,e,i),!Jd&&Xd.test(e)&&(e=this._replaceDirInCssText(e),this.__activateDir=!0),e}static _replaceDirInCssText(e){let t=e;return t=t.replace(Kd,':host([dir="$1"])'),t=t.replace(Yd,':host([dir="$2"]) $1'),t}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){t.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(Qd&&Qd.takeRecords().length&&nh(),Zd.push(this),ih(this))}disconnectedCallback(){if(t.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const e=Zd.indexOf(this);e>-1&&Zd.splice(e,1)}}}return i.__activateDir=!1,i});let rh=!1,sh=[],ah=[];function lh(){rh=!0,requestAnimationFrame((function(){rh=!1,ch(sh),setTimeout((function(){!function(e){for(let t=0,i=e.length;t<i;t++)dh(e.shift())}(ah)}))}))}function ch(e){for(;e.length;)dh(e.shift())}function dh(e){const t=e[0],i=e[1],n=e[2];try{i.apply(t,n)}catch(e){setTimeout(()=>{throw e})}}function hh(e,t,i){rh||lh(),ah.push([e,t,i])}function ph(){document.body.removeAttribute("unresolved")}function uh(e,t,i){return{index:e,removed:t,addedCount:i}}"interactive"===document.readyState||"complete"===document.readyState?ph():window.addEventListener("DOMContentLoaded",ph);function gh(e,t,i,n,o,r){let s,a=0,l=0,c=Math.min(i-t,r-o);if(0==t&&0==o&&(a=function(e,t,i){for(let n=0;n<i;n++)if(!fh(e[n],t[n]))return n;return i}(e,n,c)),i==e.length&&r==n.length&&(l=function(e,t,i){let n=e.length,o=t.length,r=0;for(;r<i&&fh(e[--n],t[--o]);)r++;return r}(e,n,c-a)),o+=a,r-=l,(i-=l)-(t+=a)==0&&r-o==0)return[];if(t==i){for(s=uh(t,[],0);o<r;)s.removed.push(n[o++]);return[s]}if(o==r)return[uh(t,[],i-t)];let d=function(e){let t=e.length-1,i=e[0].length-1,n=e[t][i],o=[];for(;t>0||i>0;){if(0==t){o.push(2),i--;continue}if(0==i){o.push(3),t--;continue}let r,s=e[t-1][i-1],a=e[t-1][i],l=e[t][i-1];r=a<l?a<s?a:s:l<s?l:s,r==s?(s==n?o.push(0):(o.push(1),n=s),t--,i--):r==a?(o.push(3),t--,n=a):(o.push(2),i--,n=l)}return o.reverse(),o}(function(e,t,i,n,o,r){let s=r-o+1,a=i-t+1,l=new Array(s);for(let e=0;e<s;e++)l[e]=new Array(a),l[e][0]=e;for(let e=0;e<a;e++)l[0][e]=e;for(let i=1;i<s;i++)for(let r=1;r<a;r++)if(fh(e[t+r-1],n[o+i-1]))l[i][r]=l[i-1][r-1];else{let e=l[i-1][r]+1,t=l[i][r-1]+1;l[i][r]=e<t?e:t}return l}(e,t,i,n,o,r));s=void 0;let h=[],p=t,u=o;for(let e=0;e<d.length;e++)switch(d[e]){case 0:s&&(h.push(s),s=void 0),p++,u++;break;case 1:s||(s=uh(p,[],0)),s.addedCount++,p++,s.removed.push(n[u]),u++;break;case 2:s||(s=uh(p,[],0)),s.addedCount++,p++;break;case 3:s||(s=uh(p,[],0)),s.removed.push(n[u]),u++}return s&&h.push(s),h}function mh(e,t){return gh(e,0,e.length,t,0,t.length)}function fh(e,t){return e===t}function _h(e){return"slot"===e.localName}let vh=class{static getFlattenedNodes(e){const t=Me(e);return _h(e)?(e=e,t.assignedNodes({flatten:!0})):Array.from(t.childNodes).map(e=>_h(e)?Me(e=e).assignedNodes({flatten:!0}):[e]).reduce((e,t)=>e.concat(t),[])}constructor(e,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=e,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){_h(this._target)?this._listenSlots([this._target]):Me(this._target).children&&(this._listenSlots(Me(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,e=>{this._processMutations(e)}):(this._nativeChildrenObserver=new MutationObserver(e=>{this._processMutations(e)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){_h(this._target)?this._unlistenSlots([this._target]):Me(this._target).children&&(this._unlistenSlots(Me(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,lt.run(()=>this.flush()))}_processMutations(e){this._processSlotMutations(e),this.flush()}_processSlotMutations(e){if(e)for(let t=0;t<e.length;t++){let i=e[t];i.addedNodes&&this._listenSlots(i.addedNodes),i.removedNodes&&this._unlistenSlots(i.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let e={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),i=mh(t,this._effectiveNodes);for(let t,n=0;n<i.length&&(t=i[n]);n++)for(let i,n=0;n<t.removed.length&&(i=t.removed[n]);n++)e.removedNodes.push(i);for(let n,o=0;o<i.length&&(n=i[o]);o++)for(let i=n.index;i<n.index+n.addedCount;i++)e.addedNodes.push(t[i]);this._effectiveNodes=t;let n=!1;return(e.addedNodes.length||e.removedNodes.length)&&(n=!0,this.callback.call(this._target,e)),n}_listenSlots(e){for(let t=0;t<e.length;t++){let i=e[t];_h(i)&&i.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(e){for(let t=0;t<e.length;t++){let i=e[t];_h(i)&&i.removeEventListener("slotchange",this._boundSchedule)}}};const yh=function(){let e,t;do{e=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),t=ad()}while(e||t)},bh=Element.prototype,wh=bh.matches||bh.matchesSelector||bh.mozMatchesSelector||bh.msMatchesSelector||bh.oMatchesSelector||bh.webkitMatchesSelector,Ch=function(e,t){return wh.call(e,t)};class Sh{constructor(e){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(e),this.node=e}observeNodes(e){return new vh(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(Me(this.node).contains(e))return!0;let t=e,i=e.ownerDocument;for(;t&&t!==i&&t!==this.node;)t=Me(t).parentNode||Me(t).host;return t===this.node}getOwnerRoot(){return Me(this.node).getRootNode()}getDistributedNodes(){return"slot"===this.node.localName?Me(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],t=Me(this.node).assignedSlot;for(;t;)e.push(t),t=Me(t).assignedSlot;return e}importNode(e,t){let i=this.node instanceof Document?this.node:this.node.ownerDocument;return Me(i).importNode(e,t)}getEffectiveChildNodes(){return vh.getFlattenedNodes(this.node)}queryDistributedElements(e){let t=this.getEffectiveChildNodes(),i=[];for(let n,o=0,r=t.length;o<r&&(n=t[o]);o++)n.nodeType===Node.ELEMENT_NODE&&Ch(n,e)&&i.push(n);return i}get activeElement(){let e=this.node;return void 0!==e._activeElement?e._activeElement:e.activeElement}}function Eh(e,t){for(let i=0;i<t.length;i++){let n=t[i];Object.defineProperty(e,n,{get:function(){return this.node[n]},configurable:!0})}}class Ah{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}Sh.prototype.cloneNode,Sh.prototype.appendChild,Sh.prototype.insertBefore,Sh.prototype.removeChild,Sh.prototype.replaceChild,Sh.prototype.setAttribute,Sh.prototype.removeAttribute,Sh.prototype.querySelector,Sh.prototype.querySelectorAll,Sh.prototype.parentNode,Sh.prototype.firstChild,Sh.prototype.lastChild,Sh.prototype.nextSibling,Sh.prototype.previousSibling,Sh.prototype.firstElementChild,Sh.prototype.lastElementChild,Sh.prototype.nextElementSibling,Sh.prototype.previousElementSibling,Sh.prototype.childNodes,Sh.prototype.children,Sh.prototype.classList,Sh.prototype.textContent,Sh.prototype.innerHTML;let xh=Sh;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class e extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(Sh.prototype).forEach(t=>{"activeElement"!=t&&(e.prototype[t]=Sh.prototype[t])}),Eh(e.prototype,["classList"]),xh=e,Object.defineProperties(Ah.prototype,{localTarget:{get(){const e=this.event.currentTarget,t=e&&Th(e).getOwnerRoot(),i=this.path;for(let e=0;e<i.length;e++){const n=i[e];if(Th(n).getOwnerRoot()===t)return n}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else!function(e,t){for(let i=0;i<t.length;i++){let n=t[i];e[n]=function(){return this.node[n].apply(this.node,arguments)}}}(Sh.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),Eh(Sh.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),function(e,t){for(let i=0;i<t.length;i++){let n=t[i];Object.defineProperty(e,n,{get:function(){return this.node[n]},set:function(e){this.node[n]=e},configurable:!0})}}(Sh.prototype,["textContent","innerHTML","className"]);const Rh=xh,Th=function(e){if((e=e||document)instanceof xh)return e;if(e instanceof Ah)return e;let t=e.__domApi;return t||(t=e instanceof Event?new Ah(e):new xh(e),e.__domApi=t),t},kh=window.ShadyDOM,Ph=window.ShadyCSS;function Ih(e,t){return Me(e).getRootNode()===t}const Oh=e=>{for(;e;){const t=Object.getOwnPropertyDescriptor(e,"observedAttributes");if(t)return t.get;e=Object.getPrototypeOf(e.prototype).constructor}return()=>[]};ye(e=>{const t=hi(e);let i=Oh(t);return class extends t{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return i.call(this).concat("disable-upgrade")}_initializeProperties(){this.hasAttribute("disable-upgrade")?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}attributeChangedCallback(e,t,i,n){"disable-upgrade"==e?this.__isUpgradeDisabled&&null==i&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,Me(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(e,t,i,n)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}});let Nh=window.ShadyCSS;const Lh=ye(e=>{const t=qd(hi(e)),i=di?t:oh(t),n=Oh(i),o={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class r extends i{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(e,t,i){(this.__dataAttributes&&this.__dataAttributes[e]||"disable-upgrade"===e)&&this.attributeChangedCallback(e,t,i,null)}setAttribute(e,t){if(me&&!this._legacyForceObservedAttributes){const i=this.getAttribute(e);super.setAttribute(e,t),this.__attributeReaction(e,i,String(t))}else super.setAttribute(e,t)}removeAttribute(e){if(me&&!this._legacyForceObservedAttributes){const t=this.getAttribute(e);super.removeAttribute(e),this.__attributeReaction(e,t,null)}else super.removeAttribute(e)}static get observedAttributes(){return me&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],li(this.prototype)),this.__observedAttributes):n.call(this).concat("disable-upgrade")}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(e,t,i,n){t!==i&&("disable-upgrade"==e?this.__isUpgradeDisabled&&null==i&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,Me(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(e,t,i,n),this.attributeChanged(e,t,i)))}attributeChanged(e,t,i){}_initializeProperties(){if(oe&&this.hasAttribute("disable-upgrade"))this.__isUpgradeDisabled=!0;else{let e=Object.getPrototypeOf(this);e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))||(this._registered(),e.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),me&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){const e=this.attributes;for(let t=0,i=e.length;t<i;t++){const i=e[t];this.__attributeReaction(i.name,null,i.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(e){return this._serializeValue(e)}deserialize(e,t){return this._deserializeValue(e,t)}reflectPropertyToAttribute(e,t,i){this._propertyToAttribute(e,t,i)}serializeValueToAttribute(e,t,i){this._valueToNodeAttribute(i||this,e,t)}extend(e,t){if(!e||!t)return e||t;let i=Object.getOwnPropertyNames(t);for(let n,o=0;o<i.length&&(n=i[o]);o++){let i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}return e}mixin(e,t){for(let i in t)e[i]=t[i];return e}chainObject(e,t){return e&&t&&e!==t&&(e.__proto__=t),e}instanceTemplate(e){let t=this.constructor._contentForTemplate(e);return document.importNode(t,!0)}fire(e,t,i){i=i||{},t=null==t?{}:t;let n=new Event(e,{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});n.detail=t;let o=i.node||this;return Me(o).dispatchEvent(n),n}listen(e,t,i){e=e||this;let n=this.__boundListeners||(this.__boundListeners=new WeakMap),o=n.get(e);o||(o={},n.set(e,o));let r=t+i;o[r]||(o[r]=this._addMethodEventListenerToNode(e,t,i,this))}unlisten(e,t,i){e=e||this;let n=this.__boundListeners&&this.__boundListeners.get(e),o=t+i,r=n&&n[o];r&&(this._removeEventListenerFromNode(e,t,r),n[o]=null)}setScrollDirection(e,t){Fd(t||this,o[e]||"auto")}$$(e){return this.root.querySelector(e)}get domHost(){let e=Me(this).getRootNode();return e instanceof DocumentFragment?e.host:e}distributeContent(){const e=Th(this);window.ShadyDOM&&e.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return Th(this).getEffectiveChildNodes()}queryDistributedElements(e){return Th(this).queryDistributedElements(e)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter((function(e){return e.nodeType===Node.ELEMENT_NODE}))}getEffectiveTextContent(){let e=this.getEffectiveChildNodes(),t=[];for(let i,n=0;i=e[n];n++)i.nodeType!==Node.COMMENT_NODE&&t.push(i.textContent);return t.join("")}queryEffectiveChildren(e){let t=this.queryDistributedElements(e);return t&&t[0]}queryAllEffectiveChildren(e){return this.queryDistributedElements(e)}getContentChildNodes(e){let t=this.root.querySelector(e||"slot");return t?Th(t).getDistributedNodes():[]}getContentChildren(e){return this.getContentChildNodes(e).filter((function(e){return e.nodeType===Node.ELEMENT_NODE}))}isLightDescendant(e){return this!==e&&Me(this).contains(e)&&Me(this).getRootNode()===Me(e).getRootNode()}isLocalDescendant(e){return this.root===Me(e).getRootNode()}scopeSubtree(e,t=!1){return function(e,t=!1){if(!kh||!Ph)return null;if(!kh.handlesDynamicScoping)return null;const i=Ph.ScopingShim;if(!i)return null;const n=i.scopeForNode(e),o=Me(e).getRootNode(),r=e=>{if(!Ih(e,o))return;const t=Array.from(kh.nativeMethods.querySelectorAll.call(e,"*"));t.push(e);for(let e=0;e<t.length;e++){const r=t[e];if(!Ih(r,o))continue;const s=i.currentScopeForNode(r);s!==n&&(""!==s&&i.unscopeNode(r,s),i.scopeNode(r,n))}};if(r(e),t){const t=new MutationObserver(e=>{for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.addedNodes.length;e++){const t=i.addedNodes[e];t.nodeType===Node.ELEMENT_NODE&&r(t)}}});return t.observe(e,{childList:!0,subtree:!0}),t}return null}(e,t)}getComputedStyleValue(e){return Nh.getComputedStyleValue(this,e)}debounce(e,t,i){return this._debouncers=this._debouncers||{},this._debouncers[e]=od.debounce(this._debouncers[e],i>0?rt.after(i):lt,t.bind(this))}isDebouncerActive(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];return!(!t||!t.isActive())}flushDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.flush()}cancelDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.cancel()}async(e,t){return t>0?rt.run(e.bind(this),t):~lt.run(e.bind(this))}cancelAsync(e){e<0?lt.cancel(~e):rt.cancel(e)}create(e,t){let i=document.createElement(e);if(t)if(i.setProperties)i.setProperties(t);else for(let e in t)i[e]=t[e];return i}elementMatches(e,t){return Ch(t||this,e)}toggleAttribute(e,t){let i=this;return 3===arguments.length&&(i=arguments[2]),1==arguments.length&&(t=!i.hasAttribute(e)),t?(Me(i).setAttribute(e,""),!0):(Me(i).removeAttribute(e),!1)}toggleClass(e,t,i){i=i||this,1==arguments.length&&(t=!i.classList.contains(e)),t?i.classList.add(e):i.classList.remove(e)}transform(e,t){(t=t||this).style.webkitTransform=e,t.style.transform=e}translate3d(e,t,i,n){n=n||this,this.transform("translate3d("+e+","+t+","+i+")",n)}arrayDelete(e,t){let i;if(Array.isArray(e)){if(i=e.indexOf(t),i>=0)return e.splice(i,1)}else{if(i=Ve(this,e).indexOf(t),i>=0)return this.splice(e,i,1)}return null}_logger(e,t){switch(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e](...t)}}_log(...e){this._logger("log",e)}_warn(...e){this._logger("warn",e)}_error(...e){this._logger("error",e)}_logf(e,...t){return["[%s::%s]",this.is,e,...t]}}return r.prototype.is="",r}),Dh={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},Mh={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},Fh=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},Mh);function $h(e,t){return Uh({},Lh(t),e)}function Bh(e,t,i,n){!function(e,t,i){const n=e._noAccessors,o=Object.getOwnPropertyNames(e);for(let r=0;r<o.length;r++){let s=o[r];if(!(s in i))if(n)t[s]=e[s];else{let i=Object.getOwnPropertyDescriptor(e,s);i&&(i.configurable=!0,Object.defineProperty(t,s,i))}}}(t,e,n);for(let e in Dh)t[e]&&(i[e]=i[e]||[],i[e].push(t[e]))}function jh(e,t){for(const i in t){const n=e[i],o=t[i];e[i]=!("value"in o)&&n&&"value"in n?Object.assign({value:n.value},o):o}}const Hh=Lh(HTMLElement);function Uh(e,t,i){let n;const o={};class r extends t{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(n)for(let e,t=0;t<n.length;t++)e=n[t],e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties);e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties),this._prepareTemplate()}else t._finalizeClass.call(this)}static get properties(){const t={};if(n)for(let e=0;e<n.length;e++)jh(t,n[e].properties);return jh(t,e.properties),t}static get observers(){let t=[];if(n)for(let e,i=0;i<n.length;i++)e=n[i],e.observers&&(t=t.concat(e.observers));return e.observers&&(t=t.concat(e.observers)),t}created(){super.created();const e=o.created;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}_registered(){const e=r.prototype;if(!e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))){e.__hasRegisterFinished=!0,super._registered(),oe&&s(e);const t=Object.getPrototypeOf(this);let i=o.beforeRegister;if(i)for(let e=0;e<i.length;e++)i[e].call(t);if(i=o.registered,i)for(let e=0;e<i.length;e++)i[e].call(t)}}_applyListeners(){super._applyListeners();const e=o.listeners;if(e)for(let t=0;t<e.length;t++){const i=e[t];if(i)for(let e in i)this._addMethodEventListenerToNode(this,e,i[e])}}_ensureAttributes(){const e=o.hostAttributes;if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];for(let e in i)this._ensureAttribute(e,i[e])}super._ensureAttributes()}ready(){super.ready();let e=o.ready;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attached(){super.attached();let e=o.attached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}detached(){super.detached();let e=o.detached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attributeChanged(e,t,i){super.attributeChanged();let n=o.attributeChanged;if(n)for(let o=0;o<n.length;o++)n[o].call(this,e,t,i)}}if(i){Array.isArray(i)||(i=[i]);let e=t.prototype.behaviors;n=function e(t,i,n){i=i||[];for(let o=t.length-1;o>=0;o--){let r=t[o];r?Array.isArray(r)?e(r,i):i.indexOf(r)<0&&(!n||n.indexOf(r)<0)&&i.unshift(r):console.warn("behavior is null, check for missing or 404 import")}return i}(i,null,e),r.prototype.behaviors=e?e.concat(i):n}const s=t=>{n&&function(e,t,i){for(let n=0;n<t.length;n++)Bh(e,t[n],i,Fh)}(t,n,o),Bh(t,e,o,Mh)};return oe||s(r.prototype),r.generatedFrom=e,r}const Gh=function(e,t){e||console.warn("Polymer.Class requires `info` argument");let i=t?t(Hh):Hh;return i=Uh(e,i,e.behaviors),i.is=i.prototype.is=e.is,i},zh=function(e){let t;return t="function"==typeof e?e:zh.Class(e),e._legacyForceObservedAttributes&&(t.prototype._legacyForceObservedAttributes=e._legacyForceObservedAttributes),customElements.define(t.is,t),t};function Vh(e,t,i,n,o){let r;o&&(r="object"==typeof i&&null!==i,r&&(n=e.__dataTemp[t]));let s=n!==i&&(n==n||i==i);return r&&s&&(e.__dataTemp[t]=i),s}zh.Class=Gh;const Wh=ye(e=>class extends e{_shouldPropertyChange(e,t,i){return Vh(this,e,t,i,!0)}}),qh=ye(e=>class extends e{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(e,t,i){return Vh(this,e,t,i,this.mutableData)}});Wh._mutablePropertyChange=Vh;let Kh=null;function Yh(){return Kh}Yh.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:Yh,writable:!0}});const Xh=ii(Yh),Jh=Wh(Xh);const Zh=ii(class{});function Qh(e,t){for(let i=0;i<t.length;i++){let n=t[i];if(Boolean(e)!=Boolean(n.__hideTemplateChildren__))if(n.nodeType===Node.TEXT_NODE)e?(n.__polymerTextContent__=n.textContent,n.textContent=""):n.textContent=n.__polymerTextContent__;else if("slot"===n.localName)if(e)n.__polymerReplaced__=document.createComment("hidden-slot"),Me(Me(n).parentNode).replaceChild(n.__polymerReplaced__,n);else{const e=n.__polymerReplaced__;e&&Me(Me(e).parentNode).replaceChild(n,e)}else n.style&&(e?(n.__polymerDisplay__=n.style.display,n.style.display="none"):n.style.display=n.__polymerDisplay__);n.__hideTemplateChildren__=e,n._showHideChildren&&n._showHideChildren(e)}}class ep extends Zh{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let t=[];this.children=t;for(let e=this.root.firstChild;e;e=e.nextSibling)t.push(e),e.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let i=this.__templatizeOptions;(e&&i.instanceProps||!i.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let e in this.__hostProps)this._setPendingProperty(e,this.__dataHost["_host_"+e]);for(let t in e)this._setPendingProperty(t,e[t])}forwardHostProp(e,t){this._setPendingPropertyOrPath(e,t,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,t,i){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,t,e=>{e.model=this,i(e)});else{let n=this.__dataHost.__dataHost;n&&n._addEventListenerToNode(e,t,i)}}_showHideChildren(e){Qh(e,this.children)}_setUnmanagedPropertyToNode(e,t,i){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&"textContent"==t?e.__polymerTextContent__=i:super._setUnmanagedPropertyToNode(e,t,i)}get parentModel(){let e=this.__parentModel;if(!e){let t;e=this;do{e=e.__dataHost.__dataHost}while((t=e.__templatizeOptions)&&!t.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}ep.prototype.__dataHost,ep.prototype.__templatizeOptions,ep.prototype._methodHost,ep.prototype.__templatizeOwner,ep.prototype.__hostProps;const tp=Wh(ep);function ip(e){let t=e.__dataHost;return t&&t._methodHost||t}function np(e,t,i){let n=i.mutableData?tp:ep;ap.mixin&&(n=ap.mixin(n));let o=class extends n{};return o.prototype.__templatizeOptions=i,o.prototype._bindTemplate(e),function(e,t,i,n){let o=i.hostProps||{};for(let t in n.instanceProps){delete o[t];let i=n.notifyInstanceProp;i&&e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:sp(t,i)})}if(n.forwardHostProp&&t.__dataHost)for(let t in o)i.hasHostProps||(i.hasHostProps=!0),e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:function(e,t,i){e.__dataHost._setPendingPropertyOrPath("_host_"+t,i[t],!0,!0)}})}(o,e,t,i),o}function op(e,t,i,n){let o=i.forwardHostProp;if(o&&t.hasHostProps){const r="template"==e.localName;let s=t.templatizeTemplateClass;if(!s){if(r){let e=i.mutableData?Jh:Xh;class n extends e{}s=t.templatizeTemplateClass=n}else{const i=e.constructor;class n extends i{}s=t.templatizeTemplateClass=n}let a=t.hostProps;for(let e in a)s.prototype._addPropertyEffect("_host_"+e,s.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:rp(e,o)}),s.prototype._createNotifyingProperty("_host_"+e);se&&n&&function(e,t,i){const n=i.constructor._properties,{propertyEffects:o}=e,{instanceProps:r}=t;for(let e in o)if(!(n[e]||r&&r[e])){const t=o[e];for(let i=0;i<t.length;i++){const{part:n}=t[i].info;if(!n.signature||!n.signature.static){console.warn(`Property '${e}' used in template but not `+"declared in 'properties'; attribute will not be observed.");break}}}}(t,i,n)}if(e.__dataProto&&Object.assign(e.__data,e.__dataProto),r)!function(e,t){Kh=e,Object.setPrototypeOf(e,t.prototype),new t,Kh=null}(e,s),e.__dataTemp={},e.__dataPending=null,e.__dataOld=null,e._enableProperties();else{Object.setPrototypeOf(e,s.prototype);const i=t.hostProps;for(let t in i)if(t="_host_"+t,t in e){const i=e[t];delete e[t],e.__data[t]=i}}}}function rp(e,t){return function(e,i,n){t.call(e.__templatizeOwner,i.substring("_host_".length),n[i])}}function sp(e,t){return function(e,i,n){t.call(e.__templatizeOwner,e,i,n[i])}}function ap(e,t,i){if(ee&&!ip(e))throw new Error("strictTemplatePolicy: template owner not trusted");if(i=i||{},e.__templatizeOwner)throw new Error("A <template> can only be templatized once");e.__templatizeOwner=t;let n=(t?t.constructor:ep)._parseTemplate(e),o=n.templatizeInstanceClass;o||(o=np(e,n,i),n.templatizeInstanceClass=o);const r=ip(e);op(e,n,i,r);let s=class extends o{};return s.prototype._methodHost=r,s.prototype.__dataHost=e,s.prototype.__templatizeOwner=t,s.prototype.__hostProps=n.hostProps,s=s,s}function lp(e,t){let i;for(;t;)if(i=t.__dataHost?t:t.__templatizeInstance){if(i.__dataHost==e)return i;t=i.__dataHost}else t=Me(t).parentNode;return null}const cp={templatize(e,t){this._templatizerTemplate=e,this.ctor=ap(e,this,{mutableData:Boolean(t),parentModel:this._parentModel,instanceProps:this._instanceProps,forwardHostProp:this._forwardHostPropV2,notifyInstanceProp:this._notifyInstancePropV2})},stamp(e){return new this.ctor(e)},modelForElement(e){return lp(this._templatizerTemplate,e)}};let dp=!1;function hp(){if(oe&&!z){if(!dp){dp=!0;const e=document.createElement("style");e.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(e)}return!0}return!1}const pp=qd(qh(ii(HTMLElement)));class up extends pp{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),ee)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(e,t,i,n){this.mutableData=!0}connectedCallback(){hp()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){Me(Me(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(e=e||this.querySelector("template"),!e){let t=new MutationObserver(()=>{if(e=this.querySelector("template"),!e)throw new Error("dom-bind requires a <template> child");t.disconnect(),this.render()});return void t.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",up);const gp=qh(fi);class mp extends gp{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!ge,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),hp()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let e=Me(Me(this).parentNode);for(let t=0;t<this.__instances.length;t++)this.__attachInstance(t,e)}}__ensureTemplatized(){if(!this.__ctor){const e=this;let t=this.template=e._templateInfo?e:this.querySelector("template");if(!t){let e=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}let i={};i[this.as]=!0,i[this.indexAs]=!0,i[this.itemsIndexAs]=!0,this.__ctor=ap(t,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:i,forwardHostProp:function(e,t){let i=this.__instances;for(let n,o=0;o<i.length&&(n=i[o]);o++)n.forwardHostProp(e,t)},notifyInstanceProp:function(e,t,i){if(Ue(this.as,t)){let n=e[this.itemsIndexAs];t==this.as&&(this.items[n]=i);let o=He(this.as,`${JSCompiler_renameProperty("items",this)}.${n}`,t);this.notifyPath(o,i)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if("string"==typeof e){let t=e,i=this.__getMethodHost();return function(){return i[t].apply(i,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let t=this.__observePaths;for(let i=0;i<t.length;i++)0===e.indexOf(t[i])&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||("items"===e.path&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(e,t=0){this.__renderDebouncer=od.debounce(this.__renderDebouncer,t>0?rt.after(t):lt,e.bind(this)),sd(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),yh()}__render(){if(!this.__ensureTemplatized())return;let e=this.items||[];const t=this.__sortAndFilterItems(e),i=this.__calculateLimit(t.length);this.__updateInstances(e,i,t),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame(()=>this.__continueChunking())),this._setRenderedItemCount(this.__instances.length),ge&&!this.notifyDomChange||this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=i;return this.__filterFn&&(t=t.filter((t,i,n)=>this.__filterFn(e[t],i,n))),this.__sortFn&&t.sort((t,i)=>this.__sortFn(e[t],e[i])),t}__calculateLimit(e){let t=e;const i=this.__instances.length;if(this.initialCount){let n;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(t=Math.min(e,this.initialCount),n=Math.max(t-i,0),this.__chunkCount=n||1):(n=Math.min(Math.max(e-i,0),this.__chunkCount),t=Math.min(i+n,e)),this.__shouldMeasureChunk=n===this.__chunkCount,this.__shouldContinueChunking=t<e,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,t}__continueChunking(){if(this.__shouldMeasureChunk){const e=performance.now()-this.__renderStartTime,t=this._targetFrameTime/e;this.__chunkCount=Math.round(this.__chunkCount*t)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(e,t,i){const n=this.__itemsIdxToInstIdx={};let o;for(o=0;o<t;o++){let t=this.__instances[o],r=i[o],s=e[r];n[r]=o,t?(t._setPendingProperty(this.as,s),t._setPendingProperty(this.indexAs,o),t._setPendingProperty(this.itemsIndexAs,r),t._flushProperties()):this.__insertInstance(s,o,r)}for(let e=this.__instances.length-1;e>=o;e--)this.__detachAndRemoveInstance(e)}__detachInstance(e){let t=this.__instances[e];const i=Me(t.root);for(let e=0;e<t.children.length;e++){let n=t.children[e];i.appendChild(n)}return t}__attachInstance(e,t){let i=this.__instances[e];t.insertBefore(i.root,this)}__detachAndRemoveInstance(e){this.__detachInstance(e),this.__instances.splice(e,1)}__stampInstance(e,t,i){let n={};return n[this.as]=e,n[this.indexAs]=t,n[this.itemsIndexAs]=i,new this.__ctor(n)}__insertInstance(e,t,i){const n=this.__stampInstance(e,t,i);let o=this.__instances[t+1],r=o?o.children[0]:this;return Me(Me(this).parentNode).insertBefore(n.root,r),this.__instances[t]=n,n}_showHideChildren(e){for(let t=0;t<this.__instances.length;t++)this.__instances[t]._showHideChildren(e)}__handleItemPath(e,t){let i=e.slice(6),n=i.indexOf("."),o=n<0?i:i.substring(0,n);if(o==parseInt(o,10)){let e=n<0?"":i.substring(n+1);this.__handleObservedPaths(e);let r=this.__itemsIdxToInstIdx[o],s=this.__instances[r];if(s){let i=this.as+(e?"."+e:"");s._setPendingPropertyOrPath(i,t,!1,!0),s._flushProperties()}return!0}}itemForElement(e){let t=this.modelForElement(e);return t&&t[this.as]}indexForElement(e){let t=this.modelForElement(e);return t&&t[this.indexAs]}modelForElement(e){return lp(this.template,e)}}customElements.define(mp.is,mp);class fp extends fi{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=od.debounce(this.__renderDebouncer,lt,()=>this.__render()),sd(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=Me(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||Me(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),hp()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){const e=this;let t=e._templateInfo?e:Me(e).querySelector("template");if(!t){let e=new MutationObserver(()=>{if(!Me(this).querySelector("template"))throw new Error("dom-if requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}this.__template=t}return!0}__ensureInstance(){let e=Me(this).parentNode;if(this.__hasInstance()){let t=this.__getInstanceNodes();if(t&&t.length){if(Me(this).previousSibling!==t[t.length-1])for(let i,n=0;n<t.length&&(i=t[n]);n++)Me(e).insertBefore(i,this)}}else{if(!e)return!1;if(!this.__ensureTemplate())return!1;this.__createAndInsertInstance(e)}return!0}render(){yh()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),ge&&!this.notifyDomChange||this.if==this._lastIf||(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(e){}__teardownInstance(){}_showHideChildren(){}}const _p=ue?class extends fp{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(e){const t=this.__dataHost||this;if(ee&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");const i=t._bindTemplate(this.__template,!0);i.runEffects=(e,t,i)=>{let n=this.__syncInfo;if(this.if)n&&(this.__syncInfo=null,this._showHideChildren(),t=Object.assign(n.changedProps,t)),e(t,i);else if(this.__instance)if(n||(n=this.__syncInfo={runEffects:e,changedProps:{}}),i)for(const e in t){const t=$e(e);n.changedProps[t]=this.__dataHost[t]}else Object.assign(n.changedProps,t)},this.__instance=t._stampTemplate(this.__template,i),Me(e).insertBefore(this.__instance,this)}__syncHostProperties(){const e=this.__syncInfo;e&&(this.__syncInfo=null,e.runEffects(e.changedProps,!1))}__teardownInstance(){const e=this.__dataHost||this;this.__instance&&(e._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,Qh(e,this.__instance.templateInfo.childNodes)),e||this.__syncHostProperties()}}:class extends fp{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(e){this.__ctor||(this.__ctor=ap(this.__template,this,{mutableData:!0,forwardHostProp:function(e,t){this.__instance&&(this.if?this.__instance.forwardHostProp(e,t):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[$e(e)]=!0))}})),this.__instance=new this.__ctor,Me(e).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let t=Me(e[0]).parentNode;if(t){t=Me(t);for(let i,n=0;n<e.length&&(i=e[n]);n++)t.removeChild(i)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let e=this.__invalidProps;if(e){this.__invalidProps=null;for(let t in e)this.__instance._setPendingProperty(t,this.__dataHost[t]);this.__instance._flushProperties()}}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,this.__instance._showHideChildren(e)),e||this.__syncHostProperties()}};customElements.define(_p.is,_p);let vp=ye(e=>{let t=hi(e);return class extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let i=t.path;if(i==JSCompiler_renameProperty("items",this)){let i=t.base||[],n=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),n){let e=mh(i,n);this.__applySplices(e)}this.__lastItems=i,this.__lastMulti=e}else if(t.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(t.value.indexSplices);else{let e=i.slice(`${JSCompiler_renameProperty("items",this)}.`.length),t=parseInt(e,10);e.indexOf(".")<0&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let i=0;i<e.length;i++){let n=e[i];t.forEach((e,i)=>{e<n.index||(e>=n.index+n.removed.length?t.set(i,e+n.addedCount-n.removed.length):t.set(i,-1))});for(let e=0;e<n.addedCount;e++){let i=n.index+e;t.has(this.items[i])&&t.set(this.items[i],i)}}this.__updateLinks();let i=0;t.forEach((e,n)=>{e<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null,t.delete(n)):i++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach(t=>{t>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${t}`,`${JSCompiler_renameProperty("selected",this)}.${e++}`)})}else this.__selectedMap.forEach(e=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${e}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${e}`)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(t>=0){let e=0;this.__selectedMap.forEach((i,n)=>{t==e++&&this.deselect(n)})}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${e}`];if(t)return parseInt(t.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(e){let t=this.__selectedMap.get(e);if(t>=0){let i;this.__selectedMap.delete(e),this.multi&&(i=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),t):this.selected=this.selectedItem=t)}}}),yp=vp(fi);class bp extends yp{static get is(){return"array-selector"}static get template(){return null}}customElements.define(bp.is,bp);const wp=new td;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(e,t,i){},prepareTemplateDom(e,t){},prepareTemplateStyles(e,t,i){},styleSubtree(e,t){wp.processStyles(),Oc(e,t)},styleElement(e){wp.processStyles()},styleDocument(e){wp.processStyles(),Oc(document.body,e)},getComputedStyleValue:(e,t)=>Nc(e,t),flushCustomStyles(){},nativeCss:cc,nativeShadow:oc,cssBuild:sc,disableRuntime:lc}),window.ShadyCSS.CustomStyleInterface=wp;const Cp=window.ShadyCSS.CustomStyleInterface;class Sp extends HTMLElement{constructor(){super(),this._style=null,Cp.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const t=e.getAttribute("include");return t&&(e.removeAttribute("include"),e.textContent=Oe(t)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}}let Ep;window.customElements.define("custom-style",Sp),Ep=Wh._mutablePropertyChange;const Ap={_shouldPropertyChange(e,t,i){return Ep(this,e,t,i,!0)}},xp={properties:{mutableData:Boolean},_shouldPropertyChange(e,t,i){return Ep(this,e,t,i,this.mutableData)}},Rp=Lh(HTMLElement).prototype;let Tp=void 0;const kp={properties:{sizingTarget:{type:Object,value:function(){return this}},fitInto:{type:Object,value:window},noOverlap:{type:Boolean},positionTarget:{type:Element},horizontalAlign:{type:String},verticalAlign:{type:String},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},autoFitOnAttach:{type:Boolean,value:!1},expandSizingTargetForScrollbars:{type:Boolean,value:!1},_fitInfo:{type:Object}},get _fitWidth(){return this.fitInto===window?this.fitInto.innerWidth:this.fitInto.getBoundingClientRect().width},get _fitHeight(){return this.fitInto===window?this.fitInto.innerHeight:this.fitInto.getBoundingClientRect().height},get _fitLeft(){return this.fitInto===window?0:this.fitInto.getBoundingClientRect().left},get _fitTop(){return this.fitInto===window?0:this.fitInto.getBoundingClientRect().top},get _defaultPositionTarget(){var e=Th(this).parentNode;return e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e},get _localeHorizontalAlign(){if(this._isRTL){if("right"===this.horizontalAlign)return"left";if("left"===this.horizontalAlign)return"right"}return this.horizontalAlign},get __shouldPosition(){return(this.horizontalAlign||this.verticalAlign)&&this.positionTarget},get _isRTL(){return void 0===this._memoizedIsRTL&&(this._memoizedIsRTL="rtl"==window.getComputedStyle(this).direction),this._memoizedIsRTL},attached:function(){this.positionTarget=this.positionTarget||this._defaultPositionTarget,this.autoFitOnAttach&&("none"===window.getComputedStyle(this).display?setTimeout(function(){this.fit()}.bind(this)):(window.ShadyDOM&&ShadyDOM.flush(),this.fit()))},detached:function(){this.__deferredFit&&(clearTimeout(this.__deferredFit),this.__deferredFit=null)},fit:function(){this.position(),this.constrain(),this.center()},_discoverInfo:function(){if(!this._fitInfo){var e=window.getComputedStyle(this),t=window.getComputedStyle(this.sizingTarget);this._fitInfo={inlineStyle:{top:this.style.top||"",left:this.style.left||"",position:this.style.position||""},sizerInlineStyle:{maxWidth:this.sizingTarget.style.maxWidth||"",maxHeight:this.sizingTarget.style.maxHeight||"",boxSizing:this.sizingTarget.style.boxSizing||""},positionedBy:{vertically:"auto"!==e.top?"top":"auto"!==e.bottom?"bottom":null,horizontally:"auto"!==e.left?"left":"auto"!==e.right?"right":null},sizedBy:{height:"none"!==t.maxHeight,width:"none"!==t.maxWidth,minWidth:parseInt(t.minWidth,10)||0,minHeight:parseInt(t.minHeight,10)||0},margin:{top:parseInt(e.marginTop,10)||0,right:parseInt(e.marginRight,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0}}}},resetFit:function(){var e=this._fitInfo||{};for(var t in e.sizerInlineStyle)this.sizingTarget.style[t]=e.sizerInlineStyle[t];for(var t in e.inlineStyle)this.style[t]=e.inlineStyle[t];this._fitInfo=null},refit:function(){var e=this.sizingTarget.scrollLeft,t=this.sizingTarget.scrollTop;this.resetFit(),this.fit(),this.sizingTarget.scrollLeft=e,this.sizingTarget.scrollTop=t},position:function(){if(!this.__shouldPosition)return;this._discoverInfo(),window.ShadyDOM&&window.ShadyDOM.flush(),this.style.position="fixed",this.sizingTarget.style.boxSizing="border-box",this.style.left="0px",this.style.top="0px";var e=this.getBoundingClientRect(),t=this.__getNormalizedRect(this.positionTarget),i=this.__getNormalizedRect(this.fitInto);let n,o,r,s;this.expandSizingTargetForScrollbars&&(n=this.sizingTarget.offsetWidth,o=this.sizingTarget.offsetHeight,r=this.sizingTarget.clientWidth,s=this.sizingTarget.clientHeight);var a=this._fitInfo.margin,l={width:e.width+a.left+a.right,height:e.height+a.top+a.bottom},c=this.__getPosition(this._localeHorizontalAlign,this.verticalAlign,l,e,t,i),d=c.left+a.left,h=c.top+a.top,p=Math.min(i.right-a.right,d+e.width),u=Math.min(i.bottom-a.bottom,h+e.height);d=Math.max(i.left+a.left,Math.min(d,p-this._fitInfo.sizedBy.minWidth)),h=Math.max(i.top+a.top,Math.min(h,u-this._fitInfo.sizedBy.minHeight));const g=Math.max(p-d,this._fitInfo.sizedBy.minWidth),m=Math.max(u-h,this._fitInfo.sizedBy.minHeight);this.sizingTarget.style.maxWidth=g+"px",this.sizingTarget.style.maxHeight=m+"px";const f=d-e.left,_=h-e.top;if(this.style.left=`${f}px`,this.style.top=`${_}px`,this.expandSizingTargetForScrollbars){const e=this.sizingTarget.offsetHeight,t=e-this.sizingTarget.clientHeight-(o-s);if(t>0){const n=i.height-a.top-a.bottom,o=Math.min(n,m+t);this.sizingTarget.style.maxHeight=`${o}px`;const r=this.sizingTarget.offsetHeight,s=r-e;let l;"top"===c.verticalAlign?l=_:"middle"===c.verticalAlign?l=_-s/2:"bottom"===c.verticalAlign&&(l=_-s),l=Math.max(i.top+a.top,Math.min(l,i.bottom-a.bottom-r)),this.style.top=`${l}px`}const l=this.sizingTarget.offsetWidth,d=l-this.sizingTarget.clientWidth-(n-r);if(d>0){const e=(()=>{if(void 0!==Tp)return Tp;const e=document.createElement("div");Object.assign(e.style,{overflow:"auto",position:"fixed",left:"0px",top:"0px",maxWidth:"100px",maxHeight:"100px"});const t=document.createElement("div");return t.style.width="200px",t.style.height="200px",e.appendChild(t),document.body.appendChild(e),Tp=Math.abs(e.offsetWidth-100)>1?e.offsetWidth-e.clientWidth:0,document.body.removeChild(e),Tp})(),t=i.width-a.left-a.right,n=Math.min(t,g+d-e);this.sizingTarget.style.maxWidth=`${n}px`;const o=this.sizingTarget.offsetWidth+e,r=o-l;let s;"left"===c.horizontalAlign?s=f:"center"===c.horizontalAlign?s=f-r/2:"right"===c.horizontalAlign&&(s=f-r),s=Math.max(i.left+a.left,Math.min(s,i.right-a.right-o)),this.style.left=`${s}px`}}},constrain:function(){if(!this.__shouldPosition){this._discoverInfo();var e=this._fitInfo;e.positionedBy.vertically||(this.style.position="fixed",this.style.top="0px"),e.positionedBy.horizontally||(this.style.position="fixed",this.style.left="0px"),this.sizingTarget.style.boxSizing="border-box";var t=this.getBoundingClientRect();e.sizedBy.height||this.__sizeDimension(t,e.positionedBy.vertically,"top","bottom","Height"),e.sizedBy.width||this.__sizeDimension(t,e.positionedBy.horizontally,"left","right","Width")}},_sizeDimension:function(e,t,i,n,o){this.__sizeDimension(e,t,i,n,o)},__sizeDimension:function(e,t,i,n,o){var r=this._fitInfo,s=this.__getNormalizedRect(this.fitInto),a="Width"===o?s.width:s.height,l=t===n,c=l?a-e[n]:e[i],d=r.margin[l?i:n],h="offset"+o,p=this[h]-this.sizingTarget[h];this.sizingTarget.style["max"+o]=a-d-c-p+"px"},center:function(){if(!this.__shouldPosition){this._discoverInfo();var e=this._fitInfo.positionedBy;if(!e.vertically||!e.horizontally){this.style.position="fixed",e.vertically||(this.style.top="0px"),e.horizontally||(this.style.left="0px");var t=this.getBoundingClientRect(),i=this.__getNormalizedRect(this.fitInto);if(!e.vertically){var n=i.top-t.top+(i.height-t.height)/2;this.style.top=n+"px"}if(!e.horizontally){var o=i.left-t.left+(i.width-t.width)/2;this.style.left=o+"px"}}}},__getNormalizedRect:function(e){return e===document.documentElement||e===window?{top:0,left:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect()},__getOffscreenArea:function(e,t,i){var n=Math.min(0,e.top)+Math.min(0,i.bottom-(e.top+t.height)),o=Math.min(0,e.left)+Math.min(0,i.right-(e.left+t.width));return Math.abs(n)*t.width+Math.abs(o)*t.height},__getPosition:function(e,t,i,n,o,r){var s,a=[{verticalAlign:"top",horizontalAlign:"left",top:o.top+this.verticalOffset,left:o.left+this.horizontalOffset},{verticalAlign:"top",horizontalAlign:"right",top:o.top+this.verticalOffset,left:o.right-i.width-this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"left",top:o.bottom-i.height-this.verticalOffset,left:o.left+this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"right",top:o.bottom-i.height-this.verticalOffset,left:o.right-i.width-this.horizontalOffset}];if(this.noOverlap){for(var l=0,c=a.length;l<c;l++){var d={};for(var h in a[l])d[h]=a[l][h];a.push(d)}a[0].top=a[1].top+=o.height,a[2].top=a[3].top-=o.height,a[4].left=a[6].left+=o.width,a[5].left=a[7].left-=o.width}t="auto"===t?null:t,(e="auto"===e?null:e)&&"center"!==e||(a.push({verticalAlign:"top",horizontalAlign:"center",top:o.top+this.verticalOffset+(this.noOverlap?o.height:0),left:o.left-n.width/2+o.width/2+this.horizontalOffset}),a.push({verticalAlign:"bottom",horizontalAlign:"center",top:o.bottom-i.height-this.verticalOffset-(this.noOverlap?o.height:0),left:o.left-n.width/2+o.width/2+this.horizontalOffset})),t&&"middle"!==t||(a.push({verticalAlign:"middle",horizontalAlign:"left",top:o.top-n.height/2+o.height/2+this.verticalOffset,left:o.left+this.horizontalOffset+(this.noOverlap?o.width:0)}),a.push({verticalAlign:"middle",horizontalAlign:"right",top:o.top-n.height/2+o.height/2+this.verticalOffset,left:o.right-i.width-this.horizontalOffset-(this.noOverlap?o.width:0)})),"middle"===t&&"center"===e&&a.push({verticalAlign:"middle",horizontalAlign:"center",top:o.top-n.height/2+o.height/2+this.verticalOffset,left:o.left-n.width/2+o.width/2+this.horizontalOffset});for(l=0;l<a.length;l++){var p=a[l],u=p.verticalAlign===t,g=p.horizontalAlign===e;if(!this.dynamicAlign&&!this.noOverlap&&u&&g){s=p;break}var m=(!t||u)&&(!e||g);if(this.dynamicAlign||m){if(p.offscreenArea=this.__getOffscreenArea(p,i,r),0===p.offscreenArea&&m){s=p;break}s=s||p;var f=p.offscreenArea-s.offscreenArea;(f<0||0===f&&(u||g))&&(s=p)}}return s}};var Pp=new Set;const Ip={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this),this._boundOnDescendantIronResize=this._onDescendantIronResize.bind(this)},attached:function(){this._requestResizeNotifications()},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):(Pp.delete(this),window.removeEventListener("resize",this._boundNotifyResize)),this._parentResizable=null},notifyResize:function(){this.isAttached&&(this._interestedResizables.forEach((function(e){this.resizerShouldNotify(e)&&this._notifyDescendant(e)}),this),this._fireResize())},assignParentResizable:function(e){this._parentResizable&&this._parentResizable.stopResizeNotificationsFor(this),this._parentResizable=e,e&&-1===e._interestedResizables.indexOf(this)&&(e._interestedResizables.push(this),e._subscribeIronResize(this))},stopResizeNotificationsFor:function(e){var t=this._interestedResizables.indexOf(e);t>-1&&(this._interestedResizables.splice(t,1),this._unsubscribeIronResize(e))},_subscribeIronResize:function(e){e.addEventListener("iron-resize",this._boundOnDescendantIronResize)},_unsubscribeIronResize:function(e){e.removeEventListener("iron-resize",this._boundOnDescendantIronResize)},resizerShouldNotify:function(e){return!0},_onDescendantIronResize:function(e){this._notifyingDescendant?e.stopPropagation():z||this._fireResize()},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(e){var t=Th(e).rootTarget;t!==this&&(t.assignParentResizable(this),this._notifyDescendant(t),e.stopPropagation())},_parentResizableChanged:function(e){e&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(e){this.isAttached&&(this._notifyingDescendant=!0,e.notifyResize(),this._notifyingDescendant=!1)},_requestResizeNotifications:function(){if(this.isAttached)if("loading"===document.readyState){var e=this._requestResizeNotifications.bind(this);document.addEventListener("readystatechange",(function t(){document.removeEventListener("readystatechange",t),e()}))}else this._findParent(),this._parentResizable?this._parentResizable._interestedResizables.forEach((function(e){e!==this&&e._findParent()}),this):(Pp.forEach((function(e){e!==this&&e._findParent()}),this),window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},_findParent:function(){this.assignParentResizable(null),this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable?Pp.delete(this):Pp.add(this)}};var Op=Element.prototype,Np=Op.matches||Op.matchesSelector||Op.mozMatchesSelector||Op.msMatchesSelector||Op.oMatchesSelector||Op.webkitMatchesSelector;const Lp=new class{getTabbableNodes(e){var t=[];return this._collectTabbableNodes(e,t)?this._sortByTabIndex(t):t}isFocusable(e){return Np.call(e,"input, select, textarea, button, object")?Np.call(e,":not([disabled])"):Np.call(e,"a[href], area[href], iframe, [tabindex], [contentEditable]")}isTabbable(e){return this.isFocusable(e)&&Np.call(e,':not([tabindex="-1"])')&&this._isVisible(e)}_normalizedTabIndex(e){if(this.isFocusable(e)){var t=e.getAttribute("tabindex")||0;return Number(t)}return-1}_collectTabbableNodes(e,t){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var i=e;if(!this._isVisible(i))return!1;var n,o=this._normalizedTabIndex(i),r=o>0;o>=0&&t.push(i),n="content"===i.localName||"slot"===i.localName?Th(i).getDistributedNodes():Th(i.root||i).children;for(var s=0;s<n.length;s++)r=this._collectTabbableNodes(n[s],t)||r;return r}_isVisible(e){var t=e.style;return"hidden"!==t.visibility&&"none"!==t.display&&("hidden"!==(t=window.getComputedStyle(e)).visibility&&"none"!==t.display)}_sortByTabIndex(e){var t=e.length;if(t<2)return e;var i=Math.ceil(t/2),n=this._sortByTabIndex(e.slice(0,i)),o=this._sortByTabIndex(e.slice(i));return this._mergeSortByTabIndex(n,o)}_mergeSortByTabIndex(e,t){for(var i=[];e.length>0&&t.length>0;)this._hasLowerTabOrder(e[0],t[0])?i.push(t.shift()):i.push(e.shift());return i.concat(e,t)}_hasLowerTabOrder(e,t){var i=Math.max(e.tabIndex,0),n=Math.max(t.tabIndex,0);return 0===i||0===n?n>i:i>n}};zh({_template:mi`
    <style>
      :host {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--iron-overlay-backdrop-background-color, #000);
        opacity: 0;
        transition: opacity 0.2s;
        pointer-events: none;
        @apply --iron-overlay-backdrop;
      }

      :host(.opened) {
        opacity: var(--iron-overlay-backdrop-opacity, 0.6);
        pointer-events: auto;
        @apply --iron-overlay-backdrop-opened;
      }
    </style>

    <slot></slot>
`,is:"iron-overlay-backdrop",properties:{opened:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_openedChanged"}},listeners:{transitionend:"_onTransitionend"},created:function(){this.__openedRaf=null},attached:function(){this.opened&&this._openedChanged(this.opened)},prepare:function(){this.opened&&!this.parentNode&&Th(document.body).appendChild(this)},open:function(){this.opened=!0},close:function(){this.opened=!1},complete:function(){this.opened||this.parentNode!==document.body||Th(this.parentNode).removeChild(this)},_onTransitionend:function(e){e&&e.target===this&&this.complete()},_openedChanged:function(e){if(e)this.prepare();else{var t=window.getComputedStyle(this);"0s"!==t.transitionDuration&&0!=t.opacity||this.complete()}this.isAttached&&(this.__openedRaf&&(window.cancelAnimationFrame(this.__openedRaf),this.__openedRaf=null),this.scrollTop=this.scrollTop,this.__openedRaf=window.requestAnimationFrame(function(){this.__openedRaf=null,this.toggleClass("opened",this.opened)}.bind(this)))}});var Dp={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},Mp={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},Fp={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},$p=/[a-z0-9*]/,Bp=/U\+/,jp=/^arrow/,Hp=/^space(bar)?/,Up=/^escape$/;function Gp(e,t){var i="";if(e){var n=e.toLowerCase();" "===n||Hp.test(n)?i="space":Up.test(n)?i="esc":1==n.length?t&&!$p.test(n)||(i=n):i=jp.test(n)?n.replace("arrow",""):"multiply"==n?"*":n}return i}function zp(e,t){return e.key?Gp(e.key,t):e.detail&&e.detail.key?Gp(e.detail.key,t):(i=e.keyIdentifier,n="",i&&(i in Dp?n=Dp[i]:Bp.test(i)?(i=parseInt(i.replace("U+","0x"),16),n=String.fromCharCode(i).toLowerCase()):n=i.toLowerCase()),n||function(e){var t="";return Number(e)&&(t=e>=65&&e<=90?String.fromCharCode(32+e):e>=112&&e<=123?"f"+(e-112+1):e>=48&&e<=57?String(e-48):e>=96&&e<=105?String(e-96):Mp[e]),t}(e.keyCode)||"");var i,n}function Vp(e,t){return zp(t,e.hasModifiers)===e.key&&(!e.hasModifiers||!!t.shiftKey==!!e.shiftKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.altKey==!!e.altKey&&!!t.metaKey==!!e.metaKey)}function Wp(e){return e.trim().split(" ").map((function(e){return function(e){return 1===e.length?{combo:e,key:e,event:"keydown"}:e.split("+").reduce((function(e,t){var i=t.split(":"),n=i[0],o=i[1];return n in Fp?(e[Fp[n]]=!0,e.hasModifiers=!0):(e.key=n,e.event=o||"keydown"),e}),{combo:e.split(":").shift()})}(e)}))}const qp={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(e,t){this._imperativeKeyBindings[e]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(e,t){for(var i=Wp(t),n=0;n<i.length;++n)if(Vp(i[n],e))return!0;return!1},_collectKeyBindings:function(){var e=this.behaviors.map((function(e){return e.keyBindings}));return-1===e.indexOf(this.keyBindings)&&e.push(this.keyBindings),e},_prepKeyBindings:function(){for(var e in this._keyBindings={},this._collectKeyBindings().forEach((function(e){for(var t in e)this._addKeyBinding(t,e[t])}),this),this._imperativeKeyBindings)this._addKeyBinding(e,this._imperativeKeyBindings[e]);for(var t in this._keyBindings)this._keyBindings[t].sort((function(e,t){var i=e[0].hasModifiers;return i===t[0].hasModifiers?0:i?-1:1}))},_addKeyBinding:function(e,t){Wp(e).forEach((function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])}),this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){this.keyEventTarget&&Object.keys(this._keyBindings).forEach((function(e){var t=this._keyBindings[e],i=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,e,i]),this.keyEventTarget.addEventListener(e,i)}),this)},_unlistenKeyEventListeners:function(){for(var e,t,i,n;this._boundKeyHandlers.length;)t=(e=this._boundKeyHandlers.pop())[0],i=e[1],n=e[2],t.removeEventListener(i,n)},_onKeyBindingEvent:function(e,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var i=0;i<e.length;i++){var n=e[i][0],o=e[i][1];if(Vp(n,t)&&(this._triggerKeyHandler(n,o,t),t.defaultPrevented))return}},_triggerKeyHandler:function(e,t,i){var n=Object.create(e);n.keyboardEvent=i;var o=new CustomEvent(e.event,{detail:n,cancelable:!0});this[t].call(this,o),o.defaultPrevented&&i.preventDefault()}};const Kp=new class{constructor(){this._overlays=[],this._minimumZ=101,this._backdropElement=null,Ld(document.documentElement,"tap",(function(){})),document.addEventListener("tap",this._onCaptureClick.bind(this),!0),document.addEventListener("focus",this._onCaptureFocus.bind(this),!0),document.addEventListener("keydown",this._onCaptureKeyDown.bind(this),!0)}get backdropElement(){return this._backdropElement||(this._backdropElement=document.createElement("iron-overlay-backdrop")),this._backdropElement}get deepActiveElement(){var e=document.activeElement;for(e&&e instanceof Element!=!1||(e=document.body);e.root&&Th(e.root).activeElement;)e=Th(e.root).activeElement;return e}_bringOverlayAtIndexToFront(e){var t=this._overlays[e];if(t){var i=this._overlays.length-1,n=this._overlays[i];if(n&&this._shouldBeBehindOverlay(t,n)&&i--,!(e>=i)){var o=Math.max(this.currentOverlayZ(),this._minimumZ);for(this._getZ(t)<=o&&this._applyOverlayZ(t,o);e<i;)this._overlays[e]=this._overlays[e+1],e++;this._overlays[i]=t}}}addOrRemoveOverlay(e){e.opened?this.addOverlay(e):this.removeOverlay(e)}addOverlay(e){var t=this._overlays.indexOf(e);if(t>=0)return this._bringOverlayAtIndexToFront(t),void this.trackBackdrop();var i=this._overlays.length,n=this._overlays[i-1],o=Math.max(this._getZ(n),this._minimumZ),r=this._getZ(e);if(n&&this._shouldBeBehindOverlay(e,n)){this._applyOverlayZ(n,o),i--;var s=this._overlays[i-1];o=Math.max(this._getZ(s),this._minimumZ)}r<=o&&this._applyOverlayZ(e,o),this._overlays.splice(i,0,e),this.trackBackdrop()}removeOverlay(e){var t=this._overlays.indexOf(e);-1!==t&&(this._overlays.splice(t,1),this.trackBackdrop())}currentOverlay(){var e=this._overlays.length-1;return this._overlays[e]}currentOverlayZ(){return this._getZ(this.currentOverlay())}ensureMinimumZ(e){this._minimumZ=Math.max(this._minimumZ,e)}focusOverlay(){var e=this.currentOverlay();e&&e._applyFocus()}trackBackdrop(){var e=this._overlayWithBackdrop();(e||this._backdropElement)&&(this.backdropElement.style.zIndex=this._getZ(e)-1,this.backdropElement.opened=!!e,this.backdropElement.prepare())}getBackdrops(){for(var e=[],t=0;t<this._overlays.length;t++)this._overlays[t].withBackdrop&&e.push(this._overlays[t]);return e}backdropZ(){return this._getZ(this._overlayWithBackdrop())-1}_overlayWithBackdrop(){for(var e=this._overlays.length-1;e>=0;e--)if(this._overlays[e].withBackdrop)return this._overlays[e]}_getZ(e){var t=this._minimumZ;if(e){var i=Number(e.style.zIndex||window.getComputedStyle(e).zIndex);i==i&&(t=i)}return t}_setZ(e,t){e.style.zIndex=t}_applyOverlayZ(e,t){this._setZ(e,t+2)}_overlayInPath(e){e=e||[];for(var t=0;t<e.length;t++)if(e[t]._manager===this)return e[t]}_onCaptureClick(e){var t=this._overlays.length-1;if(-1!==t)for(var i,n=Th(e).path;(i=this._overlays[t])&&this._overlayInPath(n)!==i&&(i._onCaptureClick(e),i.allowClickThrough);)t--}_onCaptureFocus(e){var t=this.currentOverlay();t&&t._onCaptureFocus(e)}_onCaptureKeyDown(e){var t=this.currentOverlay();t&&(qp.keyboardEventMatchesKeys(e,"esc")?t._onCaptureEsc(e):qp.keyboardEventMatchesKeys(e,"tab")&&t._onCaptureTab(e))}_shouldBeBehindOverlay(e,t){return!e.alwaysOnTop&&t.alwaysOnTop}};var Yp,Xp,Jp={pageX:0,pageY:0},Zp=null,Qp=[],eu=["wheel","mousewheel","DOMMouseScroll","touchstart","touchmove"];function tu(e){nu.indexOf(e)>=0||(0===nu.length&&function(){Yp=Yp||su.bind(void 0);for(var e=0,t=eu.length;e<t;e++)document.addEventListener(eu[e],Yp,{capture:!0,passive:!1})}(),nu.push(e),Xp=nu[nu.length-1],ou=[],ru=[])}function iu(e){var t=nu.indexOf(e);-1!==t&&(nu.splice(t,1),Xp=nu[nu.length-1],ou=[],ru=[],0===nu.length&&function(){for(var e=0,t=eu.length;e<t;e++)document.removeEventListener(eu[e],Yp,{capture:!0,passive:!1})}())}const nu=[];let ou=null,ru=null;function su(e){if(e.cancelable&&function(e){var t=Th(e).rootTarget;"touchmove"!==e.type&&Zp!==t&&(Zp=t,Qp=function(e){for(var t=[],i=e.indexOf(Xp),n=0;n<=i;n++)if(e[n].nodeType===Node.ELEMENT_NODE){var o=e[n],r=o.style;"scroll"!==r.overflow&&"auto"!==r.overflow&&(r=window.getComputedStyle(o)),"scroll"!==r.overflow&&"auto"!==r.overflow||t.push(o)}return t}(Th(e).path));if(!Qp.length)return!0;if("touchstart"===e.type)return!1;var i=function(e){var t={deltaX:e.deltaX,deltaY:e.deltaY};if("deltaX"in e);else if("wheelDeltaX"in e&&"wheelDeltaY"in e)t.deltaX=-e.wheelDeltaX,t.deltaY=-e.wheelDeltaY;else if("wheelDelta"in e)t.deltaX=0,t.deltaY=-e.wheelDelta;else if("axis"in e)t.deltaX=1===e.axis?e.detail:0,t.deltaY=2===e.axis?e.detail:0;else if(e.targetTouches){var i=e.targetTouches[0];t.deltaX=Jp.pageX-i.pageX,t.deltaY=Jp.pageY-i.pageY}return t}(e);return!function(e,t,i){if(!t&&!i)return;for(var n=Math.abs(i)>=Math.abs(t),o=0;o<e.length;o++){var r=e[o];if(n?i<0?r.scrollTop>0:r.scrollTop<r.scrollHeight-r.clientHeight:t<0?r.scrollLeft>0:r.scrollLeft<r.scrollWidth-r.clientWidth)return r}}(Qp,i.deltaX,i.deltaY)}(e)&&e.preventDefault(),e.targetTouches){var t=e.targetTouches[0];Jp.pageX=t.pageX,Jp.pageY=t.pageY}}const au={properties:{opened:{observer:"_openedChanged",type:Boolean,value:!1,notify:!0},canceled:{observer:"_canceledChanged",readOnly:!0,type:Boolean,value:!1},withBackdrop:{observer:"_withBackdropChanged",type:Boolean},noAutoFocus:{type:Boolean,value:!1},noCancelOnEscKey:{type:Boolean,value:!1},noCancelOnOutsideClick:{type:Boolean,value:!1},closingReason:{type:Object},restoreFocusOnClose:{type:Boolean,value:!1},allowClickThrough:{type:Boolean},alwaysOnTop:{type:Boolean},scrollAction:{type:String},_manager:{type:Object,value:Kp},_focusedChild:{type:Object}},listeners:{"iron-resize":"_onIronResize"},observers:["__updateScrollObservers(isAttached, opened, scrollAction)"],get backdropElement(){return this._manager.backdropElement},get _focusNode(){return this._focusedChild||Th(this).querySelector("[autofocus]")||this},get _focusableNodes(){return Lp.getTabbableNodes(this)},ready:function(){this.__isAnimating=!1,this.__shouldRemoveTabIndex=!1,this.__firstFocusableNode=this.__lastFocusableNode=null,this.__rafs={},this.__restoreFocusNode=null,this.__scrollTop=this.__scrollLeft=null,this.__onCaptureScroll=this.__onCaptureScroll.bind(this),this.__rootNodes=null,this._ensureSetup()},attached:function(){this.opened&&this._openedChanged(this.opened),this._observer=Th(this).observeNodes(this._onNodesChange)},detached:function(){for(var e in this._observer&&Th(this).unobserveNodes(this._observer),this._observer=null,this.__rafs)null!==this.__rafs[e]&&cancelAnimationFrame(this.__rafs[e]);this.__rafs={},this._manager.removeOverlay(this),this.__isAnimating&&(this.opened?this._finishRenderOpened():(this._applyFocus(),this._finishRenderClosed()))},toggle:function(){this._setCanceled(!1),this.opened=!this.opened},open:function(){this._setCanceled(!1),this.opened=!0},close:function(){this._setCanceled(!1),this.opened=!1},cancel:function(e){this.fire("iron-overlay-canceled",e,{cancelable:!0}).defaultPrevented||(this._setCanceled(!0),this.opened=!1)},invalidateTabbables:function(){this.__firstFocusableNode=this.__lastFocusableNode=null},_ensureSetup:function(){this._overlaySetup||(this._overlaySetup=!0,this.style.outline="none",this.style.display="none")},_openedChanged:function(e){e?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"),this.isAttached&&(this.__isAnimating=!0,this.__deraf("__openedChanged",this.__openedChanged))},_canceledChanged:function(){this.closingReason=this.closingReason||{},this.closingReason.canceled=this.canceled},_withBackdropChanged:function(){this.withBackdrop&&!this.hasAttribute("tabindex")?(this.setAttribute("tabindex","-1"),this.__shouldRemoveTabIndex=!0):this.__shouldRemoveTabIndex&&(this.removeAttribute("tabindex"),this.__shouldRemoveTabIndex=!1),this.opened&&this.isAttached&&this._manager.trackBackdrop()},_prepareRenderOpened:function(){this.__restoreFocusNode=this._manager.deepActiveElement,this._preparePositioning(),this.refit(),this._finishPositioning(),this.noAutoFocus&&document.activeElement===this._focusNode&&(this._focusNode.blur(),this.__restoreFocusNode.focus())},_renderOpened:function(){this._finishRenderOpened()},_renderClosed:function(){this._finishRenderClosed()},_finishRenderOpened:function(){this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-opened")},_finishRenderClosed:function(){this.style.display="none",this.style.zIndex="",this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-closed",this.closingReason)},_preparePositioning:function(){this.style.transition=this.style.webkitTransition="none",this.style.transform=this.style.webkitTransform="none",this.style.display=""},_finishPositioning:function(){this.style.display="none",this.scrollTop=this.scrollTop,this.style.transition=this.style.webkitTransition="",this.style.transform=this.style.webkitTransform="",this.style.display="",this.scrollTop=this.scrollTop},_applyFocus:function(){if(this.opened)this.noAutoFocus||this._focusNode.focus();else{if(this.restoreFocusOnClose&&this.__restoreFocusNode){var e=this._manager.deepActiveElement;(e===document.body||lu(this,e))&&this.__restoreFocusNode.focus()}this.__restoreFocusNode=null,this._focusNode.blur(),this._focusedChild=null}},_onCaptureClick:function(e){this.noCancelOnOutsideClick||this.cancel(e)},_onCaptureFocus:function(e){if(this.withBackdrop){var t=Th(e).path;-1===t.indexOf(this)?(e.stopPropagation(),this._applyFocus()):this._focusedChild=t[0]}},_onCaptureEsc:function(e){this.noCancelOnEscKey||this.cancel(e)},_onCaptureTab:function(e){if(this.withBackdrop){this.__ensureFirstLastFocusables();var t=e.shiftKey,i=t?this.__firstFocusableNode:this.__lastFocusableNode,n=t?this.__lastFocusableNode:this.__firstFocusableNode,o=!1;if(i===n)o=!0;else{var r=this._manager.deepActiveElement;o=r===i||r===this}o&&(e.preventDefault(),this._focusedChild=n,this._applyFocus())}},_onIronResize:function(){this.opened&&!this.__isAnimating&&this.__deraf("refit",this.refit)},_onNodesChange:function(){this.opened&&!this.__isAnimating&&(this.invalidateTabbables(),this.notifyResize())},__ensureFirstLastFocusables:function(){var e=this._focusableNodes;this.__firstFocusableNode=e[0],this.__lastFocusableNode=e[e.length-1]},__openedChanged:function(){this.opened?(this._prepareRenderOpened(),this._manager.addOverlay(this),this._applyFocus(),this._renderOpened()):(this._manager.removeOverlay(this),this._applyFocus(),this._renderClosed())},__deraf:function(e,t){var i=this.__rafs;null!==i[e]&&cancelAnimationFrame(i[e]),i[e]=requestAnimationFrame(function(){i[e]=null,t.call(this)}.bind(this))},__updateScrollObservers:function(e,t,i){e&&t&&this.__isValidScrollAction(i)?("lock"===i&&(this.__saveScrollPosition(),tu(this)),this.__addScrollListeners()):(iu(this),this.__removeScrollListeners())},__addScrollListeners:function(){if(!this.__rootNodes){if(this.__rootNodes=[],z)for(var e=this;e;)e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host&&this.__rootNodes.push(e),e=e.host||e.assignedSlot||e.parentNode;this.__rootNodes.push(document)}this.__rootNodes.forEach((function(e){e.addEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})}),this)},__removeScrollListeners:function(){this.__rootNodes&&this.__rootNodes.forEach((function(e){e.removeEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})}),this),this.isAttached||(this.__rootNodes=null)},__isValidScrollAction:function(e){return"lock"===e||"refit"===e||"cancel"===e},__onCaptureScroll:function(e){if(!(this.__isAnimating||Th(e).path.indexOf(this)>=0))switch(this.scrollAction){case"lock":this.__restoreScrollPosition();break;case"refit":this.__deraf("refit",this.refit);break;case"cancel":this.cancel(e)}},__saveScrollPosition:function(){document.scrollingElement?(this.__scrollTop=document.scrollingElement.scrollTop,this.__scrollLeft=document.scrollingElement.scrollLeft):(this.__scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this.__scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft))},__restoreScrollPosition:function(){document.scrollingElement?(document.scrollingElement.scrollTop=this.__scrollTop,document.scrollingElement.scrollLeft=this.__scrollLeft):(document.documentElement.scrollTop=document.body.scrollTop=this.__scrollTop,document.documentElement.scrollLeft=document.body.scrollLeft=this.__scrollLeft)}},lu=(e,t)=>{for(let n=t;n;n=(i=n).assignedSlot||i.parentNode||i.host)if(n===e)return!0;var i;return!1},cu=[kp,Ip,au];function du(e){return"shadowRoot"in e}function hu(){const e=new Error;console.info(`Calling window.location.reload(): ${e.stack}`),window.location.reload()}function pu(e){if(!e)return"";let t=e.composedPath();if(!t||!t.length){t=[];let i=e.target;for(;i;)t.push(i),i=i.parentNode||i.host}return t.reduce((e,t)=>{const i=function(e){let t="",i="",n="";if(e instanceof Element&&(t=e.tagName,i=e.id,n=e.className),!t||"GR-APP"===t||e instanceof DocumentFragment||e instanceof HTMLSlotElement)return"";let o="";return t&&(o+=t.toLowerCase()),i&&(o+=`#${i}`),n&&(o+=`.${n.replace(/ /g,".")}`),o}(t);return i?e?`${i}>${e}`:i:e},"")}function uu(e,t,i){let n=e.classList.contains(t);for(;!n&&e.parentElement&&(!i||e.parentElement!==i);)n=e.classList.contains(t),e=e.parentElement;return n}function gu(e="",t="generated_"){return`${t}${e.replace(/[^a-zA-Z0-9-_]/g,"_")}`}function mu(e,t){var i,n;return null===e?null:t&&e.activeElement&&e.activeElement.nodeName.toUpperCase().includes("DIALOG")?null:(null===(n=null===(i=e.activeElement)||void 0===i?void 0:i.shadowRoot)||void 0===n?void 0:n.activeElement)?mu(e.activeElement.shadowRoot):e.activeElement?"BODY"===e.activeElement.nodeName.toUpperCase()?null:e.activeElement:null}function fu(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function _u(e,t,i=0){const n=new IntersectionObserver(e=>{s(1===e.length,"Expected one intersection observer entry.");const i=e[0];i.isIntersecting&&(n.unobserve(i.target),t())},{rootMargin:`${i}px`});n.observe(e)}function vu(e,t,i){void 0===i&&(i=!e.classList.contains(t)),i?e.classList.add(t):e.classList.remove(t)}const yu=()=>document.body;const bu=new Map;class wu{constructor(e,t=0){this.callback=e,this.timer=window.setTimeout(()=>{this.timer&&bu.delete(this.timer),this.timer=void 0,this.callback&&this.callback()},t),bu.set(this.timer,this)}cancel(){this.isActive()&&(window.clearTimeout(this.timer),this.timer&&bu.delete(this.timer),this.timer=void 0)}flush(){this.isActive()&&(this.cancel(),this.callback&&this.callback())}isActive(){return void 0!==this.timer}}function Cu(e,t,i=0){return null==e||e.cancel(),new wu(t,i)}var Su=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};function Eu(e={createIfNotExists:!1}){let t=yu().querySelector("#gr-hovercard-container");return!t&&e.createIfNotExists&&(t=document.createElement("div"),t.setAttribute("id","gr-hovercard-container"),yu().appendChild(t)),t}const Au=ye(e=>{class t extends e{constructor(){super(...arguments),this._target=null,this._isShowing=!1,this.offset=14,this.position="right",this.container=null,this.debounceHide=()=>{this.cancelShowTask(),this._isShowing&&!this.isScheduledToHide&&(this.isScheduledToHide=!0,this.hideTask=Cu(this.hideTask,()=>{this.isScheduledToHide&&this.hide()},500))},this.unlock=()=>{iu(this)},this.hide=e=>{var t;this.cancelHideTask(),this.cancelShowTask(),this._isShowing&&(e&&(e.relatedTarget===this||e.target===this&&e.relatedTarget===this._target)||(this._isShowing=!1,this.classList.remove("hovered"),this.style.cssText="",this.$.container.setAttribute("tabindex","-1"),(null===(t=this.container)||void 0===t?void 0:t.contains(this))&&this.container.removeChild(this)))},this.debounceShow=()=>{this.debounceShowBy(550)},this.lock=()=>{tu(this)},this.show=()=>{this.cancelHideTask(),this.cancelShowTask(),!this._isShowing&&this.container&&(this._isShowing=!0,this.setAttribute("tabindex","0"),this.container.appendChild(this),this.classList.add("hide"),this.classList.add("hovered"),yh(),this.updatePosition(),this.classList.remove("hide"))}}connectedCallback(){super.connectedCallback(),this._target||(this._target=this.target),this._target.addEventListener("mouseenter",this.debounceShow),this._target.addEventListener("focus",this.debounceShow),this._target.addEventListener("mouseleave",this.debounceHide),this._target.addEventListener("blur",this.debounceHide),this._target.addEventListener("click",this.hide),this.addEventListener("mouseenter",this.show),this.addEventListener("mouseenter",this.lock),this.addEventListener("mouseleave",this.hide),this.addEventListener("mouseleave",this.unlock)}disconnectedCallback(){this.cancelShowTask(),this.cancelHideTask(),this.unlock(),super.disconnectedCallback()}ready(){super.ready(),this.container=Eu({createIfNotExists:!0})}removeListeners(){var e,t,i,n,o;null===(e=this._target)||void 0===e||e.removeEventListener("mouseenter",this.debounceShow),null===(t=this._target)||void 0===t||t.removeEventListener("focus",this.debounceShow),null===(i=this._target)||void 0===i||i.removeEventListener("mouseleave",this.debounceHide),null===(n=this._target)||void 0===n||n.removeEventListener("blur",this.debounceHide),null===(o=this._target)||void 0===o||o.removeEventListener("click",this.hide)}cancelHideTask(){this.hideTask&&(this.hideTask.cancel(),this.isScheduledToHide=!1)}dispatchEventThroughTarget(e,t){t||(t={}),this._target&&this._target.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}get target(){const e=this.parentNode,t=this.getRootNode();let i;return i=this.for?t.querySelector("#"+this.for):e&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?e:t.host,i}debounceShowBy(e){this.cancelHideTask(),this._isShowing||this.isScheduledToShow||(this.isScheduledToShow=!0,this.showTask=Cu(this.showTask,()=>{this.isScheduledToShow&&this.show()},e))}cancelShowTask(){this.showTask&&(this.showTask.cancel(),this.isScheduledToShow=!1)}updatePosition(){const e=new Set([this.position,"right","bottom-right","top-right","bottom","top","bottom-left","top-left","left"]);for(const t of e)if(this.updatePositionTo(t),this._isInsideViewport())return;console.warn("Could not find a visible position for the hovercard.")}_isInsideViewport(){const e=this.getBoundingClientRect();if(e.top<0)return!1;if(e.left<0)return!1;const t=document.documentElement.getBoundingClientRect();return!(e.bottom>t.height)&&!(e.right>t.width)}updatePositionTo(e){if(!this._target)return;this.style.cssText="";const t=document.documentElement.getBoundingClientRect(),i=this._target.getBoundingClientRect(),n=this.getBoundingClientRect(),o=i.left-t.left,r=i.top-t.top;let s,a;switch(e){case"top":s=o+(i.width-n.width)/2,a=r-n.height-this.offset;break;case"bottom":s=o+(i.width-n.width)/2,a=r+i.height+this.offset;break;case"left":s=o-n.width-this.offset,a=r+(i.height-n.height)/2;break;case"right":s=o+i.width+this.offset,a=r+(i.height-n.height)/2;break;case"bottom-right":s=o+i.width+this.offset,a=r;break;case"bottom-left":s=o-n.width-this.offset,a=r;break;case"top-left":s=o-n.width-this.offset,a=r+i.height-n.height;break;case"top-right":s=o+i.width+this.offset,a=r+i.height-n.height}this.style.left=`${s}px`,this.style.top=`${a}px`}_forChanged(){this._target=this.target}}return Su([Oo({type:Object})],t.prototype,"_target",void 0),Su([Oo({type:Boolean})],t.prototype,"_isShowing",void 0),Su([Oo({type:String})],t.prototype,"for",void 0),Su([Oo({type:Number})],t.prototype,"offset",void 0),Su([Oo({type:String})],t.prototype,"position",void 0),Su([Oo({type:Object})],t.prototype,"container",void 0),Su([No("for")],t.prototype,"_forChanged",null),t});var xu=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Ru=class extends(((e,t)=>$h([cu],e))(fi)){constructor(){super(),this.fullScreenOpen=!1,this._boundHandleClose=()=>super.close(),this.addEventListener("iron-overlay-closed",()=>this._overlayClosed()),this.addEventListener("iron-overlay-cancelled",()=>this._overlayClosed())}static get template(){return nc}get _focusableNodes(){return this.focusableNodes?this.focusableNodes:window.Polymer.IronFocusablesHelper.getTabbableNodes(this)}open(){var e;return this.returnFocusTo=null!==(e=mu(document,!0))&&void 0!==e?e:void 0,window.addEventListener("popstate",this._boundHandleClose),new Promise((e,t)=>{super.open.apply(this),this._isMobile()&&(bi(this,"fullscreen-overlay-opened"),this.fullScreenOpen=!0),this._awaitOpen(e,t)})}_isMobile(){return window.matchMedia("(max-width: 50em)")}_overlayClosed(){window.removeEventListener("popstate",this._boundHandleClose),this.fullScreenOpen&&(bi(this,"fullscreen-overlay-closed"),this.fullScreenOpen=!1),this.returnFocusTo&&(this.returnFocusTo.focus(),this.returnFocusTo=void 0)}_onCaptureFocus(e){const t=Eu();if(t){if(e.composedPath().indexOf(t)>=0)return}super._onCaptureFocus(e)}setFocusStops(e){this.focusableNodes=[e.start,e.end]}_awaitOpen(e,t){let i=0;const n=()=>{setTimeout(()=>{"none"!==this.style.display?e.call(this):i++<10?n.call(this):t(new Error("gr-overlay _awaitOpen failed to resolve"))},5)};n.call(this)}_id(){return this.getAttribute("id")||"global"}};Ru=xu([Po("gr-overlay")],Ru);const Tu=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <gr-overlay id="overlay" with-backdrop="">
    <slot></slot>
  </gr-overlay>
`;let ku=class extends fi{static get template(){return Tu}get opened(){return this.$.overlay.opened}open(){return this.$.overlay.open()}close(){this.$.overlay.close()}};ku=(window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s})([Po("gr-plugin-popup")],ku);class Pu{constructor(e,t=null){this.plugin=e,this.moduleName=t,this.openingPromise=null,this.popup=null,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"popup","constructor")}_getElement(){return Th(this.popup)}open(){return this.reporting.trackApi(this.plugin,"popup","open"),this.openingPromise||(this.openingPromise=this.plugin.hook("plugin-overlay").getLastAttached().then(e=>{const t=document.createElement("gr-plugin-popup");if(this.moduleName){t.appendChild(document.createElement(this.moduleName)).plugin=this.plugin}return this.popup=e.appendChild(t),yh(),this.popup.open().then(()=>this)})),this.openingPromise}close(){this.reporting.trackApi(this.plugin,"popup","close"),this.popup&&(this.popup.close(),this.openingPromise=null)}}class Iu{constructor(e){this.plugin=e,this.menuLinks=[],this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"admin","constructor"),this.plugin.on(Fa.ADMIN_MENU_LINKS,this)}addMenuLink(e,t,i){this.reporting.trackApi(this.plugin,"admin","addMenuLink"),this.menuLinks.push({text:e,url:t,capability:i||null})}getMenuLinks(){return this.reporting.trackApi(this.plugin,"admin","getMenuLinks"),this.menuLinks.slice(0)}}class Ou{constructor(e){this.plugin=e,this.annotationLayers=[],this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"annotation","constructor"),e.on(Fa.ANNOTATE_DIFF,this)}setCoverageProvider(e){return this.reporting.trackApi(this.plugin,"annotation","setCoverageProvider"),this.coverageProvider&&console.warn("Overwriting an existing coverage provider."),this.coverageProvider=e,this}getCoverageProvider(){return this.coverageProvider}notify(e,t,i,n){this.reporting.trackApi(this.plugin,"annotation","notify");for(const o of this.annotationLayers)o.path===e&&o.notifyListeners(t,i,n)}createLayer(e){const t=new Nu(e);return this.annotationLayers.push(t),t}disposeLayer(e){this.annotationLayers=this.annotationLayers.filter(t=>t.path!==e)}}class Nu{constructor(e){this.path=e,this.listeners=[],this.listeners=[]}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}annotate(){}notifyListeners(e,t,i){for(const n of this.listeners)n(e,t,i)}}class Lu{constructor(e,t){this.plugin=e,this.element=t,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"event","constructor")}onTap(e){return this.reporting.trackApi(this.plugin,"event","onTap"),this.onClick(e)}onClick(e){return this.reporting.trackApi(this.plugin,"event","onClick"),this._listen(this.element,e)}_listen(e,t){const i=e=>{const i=e.composedPath();if(i&&-1!==i.indexOf(this.element)){let i=!0;try{i=t(e)}catch(e){console.warn(`Plugin error handing event: ${e}`)}!1===i&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}};e.addEventListener("click",i);return()=>e.removeEventListener("click",i)}}async function Du(e){return await e.text()||`${e.status}`}class Mu extends Error{constructor(e){super(),this.response=e}}class Fu{constructor(e,t=""){this.plugin=e,this.prefix=t,this.restApi=i.restApiService,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"rest","constructor")}getLoggedIn(){return this.reporting.trackApi(this.plugin,"rest","getLoggedIn"),this.restApi.getLoggedIn()}getVersion(){return this.reporting.trackApi(this.plugin,"rest","getVersion"),this.restApi.getVersion()}getConfig(){return this.reporting.trackApi(this.plugin,"rest","getConfig"),this.restApi.getConfig()}invalidateReposCache(){this.reporting.trackApi(this.plugin,"rest","invalidateReposCache"),this.restApi.invalidateReposCache()}getAccount(){return this.reporting.trackApi(this.plugin,"rest","getAccount"),this.restApi.getAccount()}getAccountCapabilities(e){return this.reporting.trackApi(this.plugin,"rest","getAccountCapabilities"),this.restApi.getAccountCapabilities(e)}getRepos(e,t,i){return this.reporting.trackApi(this.plugin,"rest","getRepos"),this.restApi.getRepos(e,t,i)}fetch(e,t,i,n,o){return this.reporting.trackApi(this.plugin,"rest","fetch"),this.restApi.send(e,this.prefix+t,i,n,o)}send(e,t,i,n,o){return this.reporting.trackApi(this.plugin,"rest","send"),n=null!=n?n:(e,t)=>{if(t)throw t;if(e)throw new Mu(e);throw new Error("Generic REST API error.")},this.fetch(e,t,i,n,o).then(e=>{if(!e)throw new Error("plugin rest-api call failed");return e.status<200||e.status>=300?Du(e).then(e=>Promise.reject(new Error(e))):this.restApi.getResponseObject(e)}).catch(e=>{if(e instanceof Mu)return Du(e.response).then(e=>{throw new Error(e)});throw e})}get(e){return this.reporting.trackApi(this.plugin,"rest","get"),this.send(mn.GET,e)}post(e,t,i,n){return this.reporting.trackApi(this.plugin,"rest","post"),this.send(mn.POST,e,t,i,n)}put(e,t,i,n){return this.reporting.trackApi(this.plugin,"rest","put"),this.send(mn.PUT,e,t,i,n)}delete(e){return this.reporting.trackApi(this.plugin,"rest","delete"),this.fetch(mn.DELETE,e).then(e=>204!==e.status?e.text().then(t=>t?Promise.reject(new Error(t)):Promise.reject(new Error(`${e.status}`))):e)}}function $u(e){return void 0!==e}var Bu;function ju(e){return!!e.path}!function(e){e.AUTH="AUTH",e.NETWORK="NETWORK",e.GENERIC="GENERIC"}(Bu||(Bu={}));class Hu{constructor(){this._endpoints=new Map,this._callbacks=new Map,this._dynamicPlugins=new Map,this.pluginLoaded=!1}setPluginsReady(){this.pluginLoaded=!0}onNewEndpoint(e,t){this._callbacks.has(e)||this._callbacks.set(e,[]),this._callbacks.get(e).push(t)}onDetachedEndpoint(e,t){if(this._callbacks.has(e)){const i=this._callbacks.get(e).filter(e=>e!==t);this._callbacks.set(e,i)}}_getOrCreateModuleInfo(e,t){const{endpoint:i,slot:n,type:o,moduleName:r,domHook:s}=t,a=this._endpoints.get(i).find(t=>t.plugin===e&&t.moduleName===r&&t.domHook===s&&t.slot===n);if(a)return a;{const t={moduleName:r,plugin:e,pluginUrl:e._url,type:o,domHook:s,slot:n};return this._endpoints.get(i).push(t),t}}registerModule(e,t){const i=t.endpoint,n=t.dynamicEndpoint;n&&(this._dynamicPlugins.has(n)||this._dynamicPlugins.set(n,new Set),this._dynamicPlugins.get(n).add(i)),this._endpoints.has(i)||this._endpoints.set(i,[]);const o=this._getOrCreateModuleInfo(e,t);this.pluginLoaded&&this._callbacks.has(i)&&this._callbacks.get(i).forEach(e=>e(o))}getDynamicEndpoints(e){const t=this._dynamicPlugins.get(e);return t?Array.from(t):[]}getDetails(e,t){const i=t&&t.type,n=t&&t.moduleName;return this._endpoints.has(e)?this._endpoints.get(e).filter(e=>!(i&&e.type!==i||n&&n!==e.moduleName)):[]}getModules(e,t){const i=this.getDetails(e,t);return i.length?i.map(e=>e.moduleName):[]}getPlugins(e,t){const i=this.getDetails(e,t);return i.length?Array.from(new Set(i.map(e=>e.pluginUrl))).filter($u):[]}}let Uu=new Hu;function Gu(){return Uu}class zu{constructor(e){this.plugin=e,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"reporting","constructor")}reportInteraction(e,t){this.reporting.trackApi(this.plugin,"reporting","reportInteraction"),this.reporting.reportInteraction(`${this.plugin.getPluginName()}-${e}`,t)}reportLifeCycle(e,t){this.reporting.trackApi(this.plugin,"reporting","reportLifeCycle"),this.reporting.reportLifeCycle(d.PLUGIN_LIFE_CYCLE,{...t,pluginName:this.plugin.getPluginName(),eventName:e})}}const Vu={fetchPollingIntervalSeconds:60};var Wu,qu;!function(e){e[e.NOT_REGISTERED=0]="NOT_REGISTERED",e[e.REGISTERED=1]="REGISTERED"}(Wu||(Wu={}));class Ku{constructor(e){this.plugin=e,this.state=Wu.NOT_REGISTERED,this.checksService=i.checksService,this.reporting=i.reportingService,this.reporting.trackApi(this.plugin,"checks","constructor")}announceUpdate(){this.reporting.trackApi(this.plugin,"checks","announceUpdate"),this.checksService.reload(this.plugin.getPluginName())}register(e,t){if(this.reporting.trackApi(this.plugin,"checks","register"),this.state===Wu.REGISTERED)throw new Error("Only one provider can be registered per plugin.");this.state=Wu.REGISTERED,this.checksService.register(this.plugin.getPluginName(),e,null!=t?t:Vu)}}!function(e){e.DECORATE="decorate",e.REPLACE="replace",e.STYLE="style"}(qu||(qu={}));class Yu{constructor(e){var t;if(this._name="NULL",this.jsApi=i.jsApiService,this.report=i.reportingService,this.domHooks=new za(this),!e)return console.warn("Plugin not being loaded from /plugins base path.","Unable to determine name."),this;this._url=new URL(e),this._name=null!==(t=Na(this._url))&&void 0!==t?t:"NULL",this.report.trackApi(this,"plugin","constructor")}getPluginName(){return this._name}registerStyleModule(e,t){this.report.trackApi(this,"plugin","registerStyleModule"),Gu().registerModule(this,{endpoint:e,type:qu.STYLE,moduleName:t})}registerCustomComponent(e,t,i){return this.report.trackApi(this,"plugin","registerCustomComponent"),this._registerCustomComponent(e,t,i)}registerDynamicCustomComponent(e,t,i){this.report.trackApi(this,"plugin","registerDynamicCustomComponent");const n=`${e}-${this.getPluginName()}`;return this._registerCustomComponent(n,t,i,e)}_registerCustomComponent(e,t,i,n){const o=i&&i.replace?qu.REPLACE:qu.DECORATE,r=i&&i.slot||"",s=this.domHooks.getDomHook(e,t);return t=t||s.getModuleName(),Gu().registerModule(this,{slot:r,endpoint:e,type:o,moduleName:t,domHook:s,dynamicEndpoint:n}),s}hook(e,t){return this.report.trackApi(this,"plugin","hook"),this.registerCustomComponent(e,void 0,t)}getServerInfo(){return this.report.trackApi(this,"plugin","getServerInfo"),i.restApiService.getConfig()}on(e,t){this.report.trackApi(this,"plugin","on"),this.jsApi.addEventCallback(e,t)}url(e){if(this.report.trackApi(this,"plugin","url"),!this._url)throw new Error("plugin url not set");const t="/plugins/"+this._name+(e||"/"),i=window.location.origin+`${k()}${t}`;return window.location.origin===this._url.origin?i:"preloaded:"===this._url.protocol?window.ASSETS_PATH?`${window.ASSETS_PATH}${t}`:i:this._url.href.split("/plugins/"+this._name)[0]+t}screenUrl(e){this.report.trackApi(this,"plugin","screenUrl");const t=e?"/"+e:"";return`${location.origin}${k()}/x/${this.getPluginName()}${t}`}_send(e,t,i,n){return La(e,this.url(t),i,n)}annotationApi(){return new Ou(this)}changeActions(){return new Ua(this,this.jsApi.getElement(Ma.CHANGE_ACTIONS))}changeReply(){return new Ga(this,this.jsApi)}checks(){return new Ku(this)}reporting(){return new zu(this)}admin(){return new Iu(this)}restApi(e){return new Fu(this,e)}attributeHelper(e){return new Da(this,e)}eventHelper(e){return new Lu(this,e)}popup(e){return void 0!==e&&"string"!=typeof e?(console.error(".popup(element) deprecated, use .popup(moduleName)!"),Promise.resolve(null)):new Pu(this,e).open()}screen(e,t){if(this.report.trackApi(this,"plugin","screen"),!t||"string"==typeof t)return this.registerCustomComponent(this._getScreenName(e),t);console.error(".screen(pattern, callback) deprecated, use .screen(screenName, moduleName)!")}_getScreenName(e){return this.report.trackApi(this,"plugin","_getScreenName"),`${this.getPluginName()}-screen-${e}`}}var Xu;!function(e){e.PENDING="PENDING",e.LOADED="LOADED",e.LOAD_FAILED="LOAD_FAILED"}(Xu||(Xu={}));class Ju{constructor(){this._pluginListLoaded=!1,this._plugins=new Map,this._reporting=null,this._loadingPromise=null,this._loadingResolver=null}_getReporting(){return this._reporting||(this._reporting=i.reportingService),this._reporting}_getPluginKeyFromUrl(e){return Na(e)||`__$$__${e}`}loadPlugins(e=[]){this._pluginListLoaded=!0,e.forEach(e=>{const t=this._urlFor(e,window.ASSETS_PATH);if(this.isPluginPreloaded(t))return;const i=this._getPluginKeyFromUrl(t);this._plugins.has(i)||(this._plugins.set(i,{name:i,url:t,state:Xu.PENDING,plugin:null}),this._isPathEndsWith(t,".js")?this._loadJsPlugin(e):this._failToLoad(`Unrecognized plugin path ${e}`,e))}),this.awaitPluginsLoaded().then(()=>{this._getReporting().pluginsLoaded(this._getAllInstalledPluginNames())})}_isPathEndsWith(e,t){if(!(e instanceof URL))try{e=new URL(e)}catch(e){return console.warn(e),!1}return e.pathname&&e.pathname.endsWith(t)}_getAllInstalledPluginNames(){const e=[];for(const t of this._plugins.values())t.state===Xu.LOADED&&e.push(t.name);return e}install(e,t,i){var n;const o=document.currentScript,r=null!==(n=null==o?void 0:o.__importElement)&&void 0!==n?n:o;if(!i&&r&&r.src&&(i=r.src),(!i||i.startsWith("data:"))&&r&&r.baseURI&&(i=r&&r.baseURI),!i)return void this._failToLoad("Failed to determine src.");if(t&&"0.1"!==t)return void this._failToLoad(`Plugin ${i} install error: only version 0.1 is supported in PolyGerrit. ${t} was given.`,i);const s=this._urlFor(i),a=this.getPlugin(s);let l=a&&a.plugin;l||(l=new Yu(s));try{e(l),this._pluginInstalled(s,l)}catch(e){this._failToLoad(`${e.name}: ${e.message}`,i)}}arePluginsLoaded(){if(!this._pluginListLoaded)return!1;for(const e of this._plugins.values())if(e.state===Xu.PENDING)return!1;return!0}_checkIfCompleted(){this.arePluginsLoaded()&&(Gu().setPluginsReady(),this._loadingResolver&&(this._loadingResolver(),this._loadingResolver=null,this._loadingPromise=null))}_timeout(){const e=[];for(const t of this._plugins.values())t.state===Xu.PENDING&&(this._updatePluginState(t.url,Xu.LOAD_FAILED),this._checkIfCompleted(),e.push(t.url));return`Timeout when loading plugins: ${e.join(",")}`}_failToLoad(e,t){document.dispatchEvent(new CustomEvent("show-alert",{detail:{message:`Plugin install error: ${e} from ${t}`}})),t&&this._updatePluginState(t,Xu.LOAD_FAILED),this._checkIfCompleted()}_updatePluginState(e,t){const i=this._getPluginKeyFromUrl(e);return this._plugins.has(i)?this._plugins.get(i).state=t:(console.info(`Plugin loaded separately: ${e}`),this._plugins.set(i,{name:i,url:e,state:t,plugin:null})),this._plugins.get(i)}_pluginInstalled(e,t){this._updatePluginState(e,Xu.LOADED).plugin=t,this._getReporting().pluginLoaded(t.getPluginName()||e),console.info(`Plugin ${t.getPluginName()||e} installed.`),this._checkIfCompleted()}installPreloadedPlugins(){const e=window.Gerrit;if(e&&e._preloadedPlugins)for(const t of Object.keys(e._preloadedPlugins)){const i=e._preloadedPlugins[t];this.install(i,"0.1","preloaded:"+t)}}isPluginPreloaded(e){const t=Na(this._urlFor(e)),i=window.Gerrit;return!!(t&&(null==i?void 0:i._preloadedPlugins))&&o(i._preloadedPlugins,t)}isPluginEnabled(e){const t=this._urlFor(e);if(this.isPluginPreloaded(t))return!0;const i=this._getPluginKeyFromUrl(t);return this._plugins.has(i)}getPlugin(e){const t=this._urlFor(e),i=this._getPluginKeyFromUrl(t);return this._plugins.get(i)}isPluginLoaded(e){const t=this._urlFor(e),i=this._getPluginKeyFromUrl(t);return!!this._plugins.has(i)&&this._plugins.get(i).state===Xu.LOADED}_loadJsPlugin(e){const t=this._urlFor(e,window.ASSETS_PATH),i=this._urlFor(e);let n=void 0;t!==i&&(n=()=>this._createScriptTag(i)),this._createScriptTag(t,n)}_createScriptTag(e,t){t||(t=()=>this._failToLoad(`${e} load error`,e));const i=document.createElement("script");return i.defer=!0,i.setAttribute("src",e),i.setAttribute("crossorigin","anonymous"),i.onerror=t,document.body.appendChild(i)}_urlFor(e,t){const i=!e.endsWith("static/gerrit-theme.js")&&t;return e.startsWith("preloaded:")||e.startsWith("http")?e.includes(location.host)&&i&&t?e.replace(location.origin,t):e:(e.startsWith("/")||(e="/"+e),i&&t?t+e:window.location.origin+k()+e)}awaitPluginsLoaded(){if(this._checkIfCompleted(),this.arePluginsLoaded())return Promise.resolve();if(!this._loadingPromise){let e;this._loadingPromise=Promise.race([new Promise(e=>this._loadingResolver=e),new Promise((t,i)=>e=window.setTimeout(()=>{i(new Error(this._timeout()))},1e4))]).finally(()=>{e&&clearTimeout(e)})}return this._loadingPromise}}let Zu=new Ju;function Qu(){return Zu}const eg={},tg={};class ig{constructor(){this.reporting=i.reportingService}handleEvent(e,t){Qu().awaitPluginsLoaded().then(()=>{switch(e){case Fa.HISTORY:this._handleHistory(t);break;case Fa.SHOW_CHANGE:this._handleShowChange(t);break;case Fa.COMMENT:this._handleComment(t);break;case Fa.LABEL_CHANGE:this._handleLabelChange(t);break;case Fa.SHOW_REVISION_ACTIONS:this._handleShowRevisionActions(t);break;case Fa.HIGHLIGHTJS_LOADED:this._handleHighlightjsLoaded(t);break;default:console.warn("handleEvent called with unsupported event type:",e)}})}addElement(e,t){eg[e]=t}getElement(e){return eg[e]}addEventCallback(e,t){tg[e]||(tg[e]=[]),tg[e].push(t)}canSubmitChange(e,t){return!this._getEventCallbacks(Fa.SUBMIT_CHANGE).some(i=>{try{return!1===i(e,t)}catch(e){this.reporting.error(e)}return!1})}_removeEventCallbacks(){for(const e of Object.values(Fa))tg[e]=[]}_handleHistory(e){for(const t of this._getEventCallbacks(Fa.HISTORY))try{t(e.path)}catch(e){this.reporting.error(e)}}_handleShowChange(e){const t={...e.change,get mergeable(){return console.warn("Accessing change.mergeable from SHOW_CHANGE is deprecated! Use info.mergeable instead."),e.info&&e.info.mergeable}},i=e.patchNum,n=e.info;let o;for(const e of Object.values(t.revisions||{}))if(e._number===i){o=e;break}for(const e of this._getEventCallbacks(Fa.SHOW_CHANGE))try{e(t,o,n)}catch(e){this.reporting.error(e)}}_handleShowRevisionActions(e){const t=this._getEventCallbacks(Fa.SHOW_REVISION_ACTIONS);for(const i of t)try{i(e.revisionActions,e.change)}catch(e){this.reporting.error(e)}}handleCommitMessage(e,t){for(const i of this._getEventCallbacks(Fa.COMMIT_MSG_EDIT))try{i(e,t)}catch(e){this.reporting.error(e)}}_handleComment(e){for(const t of this._getEventCallbacks(Fa.COMMENT))try{t(e.node)}catch(e){this.reporting.error(e)}}_handleLabelChange(e){for(const t of this._getEventCallbacks(Fa.LABEL_CHANGE))try{t(e.change)}catch(e){this.reporting.error(e)}}_handleHighlightjsLoaded(e){for(const t of this._getEventCallbacks(Fa.HIGHLIGHTJS_LOADED))try{t(e.hljs)}catch(e){this.reporting.error(e)}}modifyRevertMsg(e,t,i){for(const n of this._getEventCallbacks(Fa.REVERT))try{t=n(e,t,i)}catch(e){this.reporting.error(e)}return t}modifyRevertSubmissionMsg(e,t,i){for(const n of this._getEventCallbacks(Fa.REVERT_SUBMISSION))try{t=n(e,t,i)}catch(e){this.reporting.error(e)}return t}getDiffLayers(e){const t=[];for(const i of this._getEventCallbacks(Fa.ANNOTATE_DIFF)){const n=i;try{const i=n.createLayer(e);i&&t.push(i)}catch(e){this.reporting.error(e)}}return t}disposeDiffLayers(e){for(const t of this._getEventCallbacks(Fa.ANNOTATE_DIFF))try{t.disposeLayer(e)}catch(e){this.reporting.error(e)}}getCoverageAnnotationApis(){return Qu().awaitPluginsLoaded().then(()=>{const e=[];return this._getEventCallbacks(Fa.ANNOTATE_DIFF).forEach(t=>{const i=t;i.getCoverageProvider()&&e.push(i)}),e})}getAdminMenuLinks(){const e=[];for(const t of this._getEventCallbacks(Fa.ADMIN_MENU_LINKS)){const i=t;e.push(...i.getMenuLinks())}return e}getReviewPostRevert(e){let t={};for(const i of this._getEventCallbacks(Fa.POST_REVERT))try{const n=i(e);t=o(n,"labels")?n:{labels:n}}catch(e){this.reporting.error(e)}return t}_getEventCallbacks(e){return tg[e]||[]}}const ng=new Map;ng.set("respectfultip",12096e5),ng.set("draft",864e5),ng.set("editablecontent",864e5);class og{constructor(){this.lastCleanup=0,this.storage=window.localStorage,this.exceededQuota=!1}getDraftComment(e){return this.cleanupItems(),this.getObject(this.getDraftKey(e))}setDraftComment(e,t){const i=this.getDraftKey(e);this.setObject(i,{message:t,updated:Date.now()})}eraseDraftComment(e){const t=this.getDraftKey(e);this.storage.removeItem(t)}getEditableContentItem(e){return this.cleanupItems(),this.getObject(this.getEditableContentKey(e))}setEditableContentItem(e,t){this.setObject(this.getEditableContentKey(e),{message:t,updated:Date.now()})}getRespectfulTipVisibility(){return this.cleanupItems(),this.getObject("respectfultip:visibility")}setRespectfulTipVisibility(e=0){this.cleanupItems(),this.setObject("respectfultip:visibility",{updated:Date.now()+864e5*e})}eraseEditableContentItem(e){this.storage.removeItem(this.getEditableContentKey(e))}getDraftKey(e){const t=e.range?`${e.range.start_line}-${e.range.start_character}`+`-${e.range.end_character}-${e.range.end_line}`:null;let i=["draft",e.changeNum,e.patchNum,e.path,e.line||""].join(":");return t&&(i=i+":"+t),i}getEditableContentKey(e){return`editablecontent:${e}`}cleanupItems(){this.lastCleanup&&Date.now()-this.lastCleanup<864e5||(this.lastCleanup=Date.now(),Object.keys(this.storage).forEach(e=>{const t=ng.entries();for(const[i,n]of t)if(e.startsWith(i)){const t=this.getObject(e);(!t||Date.now()-t.updated>n)&&this.storage.removeItem(e)}}))}getObject(e){const t=this.storage.getItem(e);return t?JSON.parse(t):null}setObject(e,t){if(!this.exceededQuota)try{this.storage.setItem(e,JSON.stringify(t))}catch(e){if(22===e.code)return this.exceededQuota=!0,void console.warn("Local storage quota exceeded: disabling");throw e}}}const rg=new vr({});const sg=rg.pipe(kr(e=>e.repoConfig),ns());class ag{constructor(){this.restApiService=i.restApiService,Ns.pipe(ss(e=>void 0===e?Rr(void 0):Vr(this.restApiService.getProjectConfig(e)))).subscribe(e=>{!function(e){const t=rg.getValue();rg.next({...t,repoConfig:e})}(e)})}}const lg=new Map;!function(e){const t=Object.keys(e).reduce((t,i)=>{const n=i,o=e[n];return t[n]={configurable:!0,get:()=>function(e,t){return lg.has(e)||lg.set(e,t()),lg.get(e)}(n,o)},t},{});Object.defineProperties(i,t)}({flagsService:()=>new n,reportingService:()=>new R(i.flagsService),eventEmitter:()=>new T,authService:()=>new M(i.eventEmitter),restApiService:()=>new Vo(i.authService),changeService:()=>new Ds,checksService:()=>new Oa,jsApiService:()=>new ig,storageService:()=>new og,configService:()=>new ag}),function(e){const t=e.reportingService;document.addEventListener("visibilitychange",()=>{t.onVisibilityChange()})}(i),function(e){const t=e.reportingService;if(window.PerformanceObserver){if((PerformanceObserver.supportedEntryTypes||[]).includes("longtask")){new PerformanceObserver(e=>{for(const i of e.getEntries())i.duration>200&&t.reporter(u,g.UI_LATENCY,`Task ${i.name}`,Math.round(i.duration),{},!1)}).observe({entryTypes:["longtask"]})}}}(i),function(e){const t=e.reportingService,i=e=>{if(e instanceof Error)return e;let t="";t+="string"==typeof e?e:JSON.stringify(e);const i=new Error(t);return i.stack="unknown",i},n=function(e){const n=e||window,o=n.onerror;n.onerror=(e,n,r,s,a)=>function(e,n,o,r,s,a){return e&&e(n,o,r,s,a),a&&(r=null!=r?r:a.lineNumber,s=null!=s?s:a.columnNumber),t.error(i(a),"onError",{line:r,column:s,url:o,msg:n}),!0}(o,e,n,r,s,a),n.addEventListener("unhandledrejection",e=>{t.error(i(e.reason),"unhandledrejection")})};n()}(i);const cg=new URL("..",document.baseURI).href,dg=document.createElement("style");dg.textContent=`\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Thin.ttf",cg)}) format("truetype");\n  font-weight: 100;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-ThinItalic.ttf",cg)}) format("truetype");\n  font-weight: 100;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Light.ttf",cg)}) format("truetype");\n  font-weight: 300;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-LightItalic.ttf",cg)}) format("truetype");\n  font-weight: 300;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Regular.ttf",cg)}) format("truetype");\n  font-weight: 400;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Italic.ttf",cg)}) format("truetype");\n  font-weight: 400;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Medium.ttf",cg)}) format("truetype");\n  font-weight: 500;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-MediumItalic.ttf",cg)}) format("truetype");\n  font-weight: 500;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Bold.ttf",cg)}) format("truetype");\n  font-weight: 700;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-BoldItalic.ttf",cg)}) format("truetype");\n  font-weight: 700;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Black.ttf",cg)}) format("truetype");\n  font-weight: 900;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-BlackItalic.ttf",cg)}) format("truetype");\n  font-weight: 900;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Thin.ttf",cg)}) format("truetype");\n  font-weight: 100;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-ThinItalic.ttf",cg)}) format("truetype");\n  font-weight: 100;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Light.ttf",cg)}) format("truetype");\n  font-weight: 300;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-LightItalic.ttf",cg)}) format("truetype");\n  font-weight: 300;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Regular.ttf",cg)}) format("truetype");\n  font-weight: 400;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Italic.ttf",cg)}) format("truetype");\n  font-weight: 400;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Medium.ttf",cg)}) format("truetype");\n  font-weight: 500;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-MediumItalic.ttf",cg)}) format("truetype");\n  font-weight: 500;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Bold.ttf",cg)}) format("truetype");\n  font-weight: 700;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-BoldItalic.ttf",cg)}) format("truetype");\n  font-weight: 700;\n  font-style: italic;\n  }`,document.head.appendChild(dg),window.COMPILED=window.COMPILED||!1,COMPILED||window.goog||(window.goog={require(e){if("webcomponentsjs.custom_elements.auto_es5_shim"!==e)throw new Error("Called goog.require without loading //javascript/closure:base")}},window.goog.require.isDevModeNoOpImpl=!0),goog.require("webcomponentsjs.custom_elements.auto_es5_shim"),COMPILED||function(){let e=window.goog&&window.goog.declareModuleId||(()=>{});const t=function(t){if(goog.isInEs6ModuleLoader_())return e(t)};window.goog.declareModuleId?goog.declareModuleId=t:(window.goog.isInEs6ModuleLoader_=()=>!1,Object.defineProperty(window.goog,"declareModuleId",{get:()=>t,set:i=>(e=i,t)}))}(),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Boot");const hg=window.Polymer;window.Polymer=function(e){return window.Polymer._polymerFn(e)},hg&&Object.assign(Polymer,hg),Polymer._polymerFn=function(e){throw new Error("Load polymer.html to use the Polymer() function.")};const pg=G,ug=U,gg=H;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.ResolveUrl"),Polymer.ResolveUrl={resolveCss:ug,resolveUrl:gg,pathFromUrl:pg},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Settings"),Polymer.Settings={useShadow:z,useNativeCSSProperties:V,useNativeCustomElements:W,get rootPath(){return K},setRootPath:Y,get sanitizeDOMValue(){return X},setSanitizeDOMValue:J,get passiveTouchGestures(){return Z},setPassiveTouchGestures:Q,get strictTemplatePolicy(){return ee},setStrictTemplatePolicy:te,get allowTemplateFromDomModule(){return ie},setAllowTemplateFromDomModule:ne,get legacyOptimizations(){return oe},setLegacyOptimizations:re,get syncInitialRender(){return ae},setSyncInitialRender:le},void 0!==Polymer.rootPath&&Y(Polymer.rootPath),void 0!==Polymer.sanitizeDOMValue&&J(Polymer.sanitizeDOMValue),void 0!==Polymer.passiveTouchGestures&&Q(Polymer.passiveTouchGestures),void 0!==Polymer.strictTemplatePolicy&&te(Polymer.strictTemplatePolicy),void 0!==Polymer.allowTemplateFromDomModule?ne(Polymer.allowTemplateFromDomModule):ne(!0),void 0!==Polymer.legacyOptimizations&&re(Polymer.legacyOptimizations),void 0!==Polymer.syncInitialRender&&le(Polymer.syncInitialRender),Object.defineProperty(Polymer,"sanitizeDOMValue",{get:()=>X,set(e){J(e)}});const mg=ye;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Mixin"),Polymer.dedupingMixin=mg,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomModule"),Polymer.DomModule=Ee,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.StyleGather");const fg=Ne,_g=function(e){let t=Ae(e);return t?De(t):""},vg=Oe,yg=Le,bg=Te,wg=Pe,Cg=Re,Sg=ke;Polymer.StyleGather={stylesFromModules:Cg,stylesFromModule:bg,stylesFromTemplate:Sg,stylesFromModuleImports:wg,cssFromModules:vg,cssFromModule:fg,cssFromTemplate:yg,cssFromModuleImports:_g};const Eg=Fe,Ag=$e,xg=Be,Rg=je,Tg=He,kg=Ue,Pg=Ge,Ig=ze,Og=Ve,Ng=We,Lg=qe;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Path"),Polymer.Path={isPath:Eg,root:Ag,isAncestor:xg,isDescendant:Rg,translate:Tg,matches:kg,normalize:Pg,split:Ig,get:Og,set:Ng,isDeep:Lg},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.CaseMap");const Dg=Je,Mg=Ze;Polymer.CaseMap={dashToCamelCase:Dg,camelToDashCase:Mg},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Async"),Polymer.Async={timeOut:rt,animationFrame:st,idlePeriod:at,microTask:lt},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Wrap"),Polymer.wrap=Me;const Fg=dt;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertiesChanged"),Polymer.PropertiesChanged=Fg;const $g=ut;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertyAccessors"),Polymer.PropertyAccessors=$g;const Bg=St;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.TemplateStamp"),Polymer.TemplateStamp=Bg;const jg=ii;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertyEffects"),Polymer.PropertyEffects=jg;const Hg=ri,Ug=si,Gg=li,zg=function(){si.forEach(ai)};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Telemetry"),Polymer.telemetry={instanceCount:oi,incrementInstanceCount:Hg,registrations:Ug,register:Gg,dumpRegistrations:zg};const Vg=ci;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertiesMixin"),Polymer.PropertiesMixin=Vg,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Debounce");const Wg=od;Polymer.Debouncer=Wg;const qg=kd,Kg=Pd,Yg=Id,Xg=Ld,Jg=Dd,Zg=Md,Qg=Fd,em=Bd,tm=function(){Ad.mouse.mouseIgnoreJob&&Ad.mouse.mouseIgnoreJob.flush()},im=zd,nm=Vd,om=Wd;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Gestures"),Polymer.Gestures={gestures:qg,recognizers:Kg,deepTargetFind:Yg,addListener:Xg,removeListener:Jg,register:Zg,setTouchAction:Qg,prevent:em,resetMouseCanceller:tm,findOriginalTarget:im,add:nm,remove:om};const rm=qd;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.GestureEventListeners"),Polymer.GestureEventListeners=rm;const sm=oh;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.DirMixin"),Polymer.DirMixin=sm;const am=function(e,t,i){rh||lh(),sh.push([e,t,i])},lm=hh,cm=function(){for(;sh.length||ah.length;)ch(sh),ch(ah);rh=!1};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.RenderStatus"),Polymer.RenderStatus={beforeNextRender:am,afterNextRender:lm,flush:cm},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Unresolved");const dm=mh;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.ArraySplice"),Polymer.ArraySplice={calculateSplices:dm},goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.FlattenedNodesObserver"),Polymer.FlattenedNodesObserver=vh;const hm=sd,pm=yh;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Flush"),Polymer.enqueueDebouncer=hm,Polymer.flush=pm;const um=Rh,gm=Ah,mm=Th,fm=Ch,_m=yh,vm=sd;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.PolymerDom"),Polymer.DomApi=um,Polymer.EventApi=gm,Polymer.dom=mm,Polymer.dom.matchesSelector=fm,Polymer.dom.flush=_m,Polymer.dom.addDebouncer=vm;const ym=hi,bm=pi;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.ElementMixin"),Polymer.ElementMixin=ym,Polymer.updateStyles=bm,Polymer.version="3.4.1";const wm=Lh;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.LegacyElementMixin"),Polymer.LegacyElementMixin=wm,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.Class");const Cm=Gh,Sm=$h;Polymer.Class=Cm,Polymer.mixinBehaviors=Sm,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.PolymerFn"),Polymer._polymerFn=zh;const Em=window.onLegacyPolymerFunctionDefinedCallback;Em&&Em();const Am=qh,xm=Wh;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.MutableData"),Polymer.MutableData=xm,Polymer.OptionalMutableData=Am;const Rm=ap,Tm=lp,km=ep;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Templatize"),Polymer.Templatize={templatize:Rm,modelForElement:Tm},Polymer.TemplateInstanceBase=km,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.TemplatizerBehavior"),Polymer.Templatizer=cp,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomBind"),Polymer.DomBind=up;const Pm=mi,Im=function(e,...t){return new ui(t.reduce((t,i,n)=>t+gi(i)+e[n+1],e[0]))};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.HtmlTag"),Polymer.html=Pm,Polymer.htmlLiteral=Im,goog.declareModuleId("HtmlImportsNamespace.Polymer.PolymerElement");const Om=fi;Polymer.Element=Om,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomRepeat"),Polymer.DomRepeat=mp,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomIf"),Polymer.DomIf=_p,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.ArraySelector"),Polymer.ArraySelectorMixin=vp,Polymer.ArraySelector=bp,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.CustomStyle"),Polymer.CustomStyle=Sp,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.MutableDataBehavior"),Polymer.MutableDataBehavior=Ap,Polymer.OptionalMutableDataBehavior=xp,goog.declareModuleId("HtmlImportsNamespace.Polymer.Polymer");const Nm=Rp;Polymer.Base=Nm,Polymer.IronFocusablesHelper=Lp,goog.declareModuleId("HtmlImportsNamespace.IronOverlayBehavior.IronFocusablesHelper");const Lm=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,Dm={getLength(e){return this.getStringLength(e.textContent||"")},getStringLength:e=>e.replace(Lm,"_").length,annotateWithElement(e,t,i,n){const o=n.tagName,r=n.attributes||{};let s;if(e instanceof Element)s=Array.from(e.childNodes);else{if(!(e instanceof Text))return;s=[e],e=e.parentNode}const a=[];for(let e of s){const n=this.getLength(e);if(t>0&&n<=t)t-=n;else if(t>0&&(e=this.splitNode(e,t),t=0),this.getLength(e)>i&&this.splitNode(e,i),a.push(e),!(i-=this.getLength(e)))break}const l=document.createElement(o),c=X;for(let[e,t]of Object.entries(r))t&&(c&&(t=c(t,e,"attribute",l)),l.setAttribute(e,t));for(const t of a)e.replaceChild(l,t),l.appendChild(t)},annotateElement(e,t,i,n){const o=[].slice.apply(e.childNodes);let r,s;for(const e of o)if(r=this.getLength(e),r<=t)t-=r;else{if(s=Math.min(i,r-t),e instanceof Text?this._annotateText(e,t,s,n):e instanceof HTMLElement&&this.annotateElement(e,t,s,n),!(s<i))break;i-=s,t=0}},wrapInHighlight(e,t){let i;return e instanceof Text||"HL"!==e.tagName?(i=document.createElement("HL"),i.className=t,e.parentElement&&e.parentElement.replaceChild(i,e),i.appendChild(e)):(i=e,i.classList.add(t)),i},splitAndWrapInHighlight(e,t,i,n){return this.getLength(e)===t||0===t?this.wrapInHighlight(e,i):(n?this.splitNode(e,t):e=this.splitNode(e,t),this.wrapInHighlight(e,i))},splitNode(e,t){if(e instanceof Text)return this.splitTextNode(e,t);const i=e.cloneNode(!1);e.parentElement&&e.parentElement.insertBefore(i,e.nextSibling);let n=e.firstChild;for(;n&&(this.getLength(n)<=t||0===this.getLength(n));)t-=this.getLength(n),n=n.nextSibling;for(n&&this.getLength(n)>t&&i.appendChild(this.splitNode(n,t));n&&n.nextSibling;)i.appendChild(n.nextSibling);return i},splitTextNode(e,t){var i;if(null===(i=e.textContent)||void 0===i?void 0:i.match(Lm)){const i=Array.from(e.textContent),n=i.splice(t),o=e.parentNode;e.textContent=i.join("");const r=document.createTextNode(n.join(""));return o&&o.insertBefore(r,e.nextSibling),r}return e.splitText(t)},_annotateText(e,t,i,n){const o=this.getLength(e);0===t&&o===i?this.wrapInHighlight(e,n):0===t?this.splitAndWrapInHighlight(e,i,n,!0):t+i===o?this.splitAndWrapInHighlight(e,t,n,!1):this.splitAndWrapInHighlight(this.splitTextNode(e,t),i,n,!0)}};var Mm,Fm;Mm=window,Fm=function(){var e=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},t=g,i=a,n=function(e){return l(a(e))},o=l,r=u,s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function a(e){for(var t,i=[],n=0,o=0,r="";null!=(t=s.exec(e));){var a=t[0],l=t[1],c=t.index;if(r+=e.slice(o,c),o=c+a.length,l)r+=l[1];else{r&&(i.push(r),r="");var h=t[2],p=t[3],u=t[4],g=t[5],m=t[6],f=t[7],_="+"===m||"*"===m,v="?"===m||"*"===m,y=h||"/",b=u||g||(f?".*":"[^"+y+"]+?");i.push({name:p||n++,prefix:h||"",delimiter:y,optional:v,repeat:_,pattern:d(b)})}}return o<e.length&&(r+=e.substr(o)),r&&i.push(r),i}function l(t){for(var i=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(i[n]=new RegExp("^"+t[n].pattern+"$"));return function(n){for(var o="",r=n||{},s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var l,c=r[a.name];if(null==c){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to be defined')}if(e(c)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but received "'+c+'"');if(0===c.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var d=0;d<c.length;d++){if(l=encodeURIComponent(c[d]),!i[s].test(l))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but received "'+l+'"');o+=(0===d?a.prefix:a.delimiter)+l}}else{if(l=encodeURIComponent(c),!i[s].test(l))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but received "'+l+'"');o+=a.prefix+l}}else o+=a}return o}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function d(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function h(e,t){return e.keys=t,e}function p(e){return e.sensitive?"":"i"}function u(e,t){for(var i=(t=t||{}).strict,n=!1!==t.end,o="",r=e[e.length-1],s="string"==typeof r&&/\/$/.test(r),a=0;a<e.length;a++){var l=e[a];if("string"==typeof l)o+=c(l);else{var d=c(l.prefix),h=l.pattern;l.repeat&&(h+="(?:"+d+h+")*"),o+=h=l.optional?d?"(?:"+d+"("+h+"))?":"("+h+")?":d+"("+h+")"}}return i||(o=(s?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=n?"$":i&&s?"":"(?=\\/|$)",new RegExp("^"+o,p(t))}function g(t,i,n){return e(i=i||[])?n||(n={}):(n=i,i=[]),t instanceof RegExp?function(e,t){var i=e.source.match(/\((?!\?)/g);if(i)for(var n=0;n<i.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return h(e,t)}(t,i):e(t)?function(e,t,i){for(var n=[],o=0;o<e.length;o++)n.push(g(e[o],t,i).source);return h(new RegExp("(?:"+n.join("|")+")",p(i)),t)}(t,i,n):function(e,t,i){for(var n=a(e),o=u(n,i),r=0;r<n.length;r++)"string"!=typeof n[r]&&t.push(n[r]);return h(o,t)}(t,i,n)}t.parse=i,t.compile=n,t.tokensToFunction=o,t.tokensToRegExp=r;var m,f="undefined"!=typeof document,_="undefined"!=typeof window,v="undefined"!=typeof history,y="undefined"!=typeof process,b=f&&document.ontouchstart?"touchstart":"click",w=_&&!(!window.history.location&&!window.location);function C(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function S(e,t){if("function"==typeof e)return S.call(this,"*",e);if("function"==typeof t)for(var i=new x(e,null,this),n=1;n<arguments.length;++n)this.callbacks.push(i.middleware(arguments[n]));else"string"==typeof e?this["string"==typeof t?"redirect":"show"](e,t):this.start(e)}function E(e){if(!e.handled){var t=this._window;(this._hashbang?w&&this._getBase()+t.location.hash.replace("#!",""):w&&t.location.pathname+t.location.search)!==e.canonicalPath&&(this.stop(),e.handled=!1,w&&(t.location.href=e.canonicalPath))}}function A(e,t,i){var n=this.page=i||S,o=n._window,r=n._hashbang,s=n._getBase();"/"===e[0]&&0!==e.indexOf(s)&&(e=s+(r?"#!":"")+e);var a=e.indexOf("?");this.canonicalPath=e;var l=new RegExp("^"+s.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"));if(this.path=e.replace(l,"")||"/",r&&(this.path=this.path.replace("#!","")||"/"),this.title=f&&o.document.title,this.state=t||{},this.state.path=e,this.querystring=~a?n._decodeURLEncodedURIComponent(e.slice(a+1)):"",this.pathname=n._decodeURLEncodedURIComponent(~a?e.slice(0,a):e),this.params={},this.hash="",!r){if(!~this.path.indexOf("#"))return;var c=this.path.split("#");this.path=this.pathname=c[0],this.hash=n._decodeURLEncodedURIComponent(c[1])||"",this.querystring=this.querystring.split("#")[0]}}function x(e,i,n){var o=this.page=n||R,r=i||{};r.strict=r.strict||o._strict,this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=t(this.path,this.keys=[],r)}C.prototype.configure=function(e){var t=e||{};this._window=t.window||_&&window,this._decodeURLComponents=!1!==t.decodeURLComponents,this._popstate=!1!==t.popstate&&_,this._click=!1!==t.click&&f,this._hashbang=!!t.hashbang;var i=this._window;this._popstate?i.addEventListener("popstate",this._onpopstate,!1):_&&i.removeEventListener("popstate",this._onpopstate,!1),this._click?i.document.addEventListener(b,this.clickHandler,!1):f&&i.document.removeEventListener(b,this.clickHandler,!1),this._hashbang&&_&&!v?i.addEventListener("hashchange",this._onpopstate,!1):_&&i.removeEventListener("hashchange",this._onpopstate,!1)},C.prototype.base=function(e){if(0===arguments.length)return this._base;this._base=e},C.prototype._getBase=function(){var e=this._base;if(e)return e;var t=_&&this._window&&this._window.location;return _&&this._hashbang&&t&&"file:"===t.protocol&&(e=t.pathname),e},C.prototype.strict=function(e){if(0===arguments.length)return this._strict;this._strict=e},C.prototype.start=function(e){var t=e||{};if(this.configure(t),!1!==t.dispatch){var i;if(this._running=!0,w){var n=this._window.location;i=this._hashbang&&~n.hash.indexOf("#!")?n.hash.substr(2)+n.search:this._hashbang?n.search+n.hash:n.pathname+n.search+n.hash}this.replace(i,null,!0,t.dispatch)}},C.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var e=this._window;this._click&&e.document.removeEventListener(b,this.clickHandler,!1),_&&e.removeEventListener("popstate",this._onpopstate,!1),_&&e.removeEventListener("hashchange",this._onpopstate,!1)}},C.prototype.show=function(e,t,i,n){var o=new A(e,t,this),r=this.prevContext;return this.prevContext=o,this.current=o.path,!1!==i&&this.dispatch(o,r),!1!==o.handled&&!1!==n&&o.pushState(),o},C.prototype.back=function(e,t){var i=this;if(this.len>0){var n=this._window;v&&n.history.back(),this.len--}else e?setTimeout((function(){i.show(e,t)})):setTimeout((function(){i.show(i._getBase(),t)}))},C.prototype.redirect=function(e,t){var i=this;"string"==typeof e&&"string"==typeof t&&S.call(this,e,(function(e){setTimeout((function(){i.replace(t)}),0)})),"string"==typeof e&&void 0===t&&setTimeout((function(){i.replace(e)}),0)},C.prototype.replace=function(e,t,i,n){var o=new A(e,t,this),r=this.prevContext;return this.prevContext=o,this.current=o.path,o.init=i,o.save(),!1!==n&&this.dispatch(o,r),o},C.prototype.dispatch=function(e,t){var i=0,n=0,o=this;function r(){var t=o.callbacks[i++];if(e.path===o.current)return t?void t(e,r):E.call(o,e);e.handled=!1}t?function e(){var i=o.exits[n++];if(!i)return r();i(t,e)}():r()},C.prototype.exit=function(e,t){if("function"==typeof e)return this.exit("*",e);for(var i=new x(e,null,this),n=1;n<arguments.length;++n)this.exits.push(i.middleware(arguments[n]))},C.prototype.clickHandler=function(e){if(1===this._which(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){var t=e.target,i=e.path||(e.composedPath?e.composedPath():null);if(i)for(var n=0;n<i.length;n++)if(i[n].nodeName&&"A"===i[n].nodeName.toUpperCase()&&i[n].href){t=i[n];break}for(;t&&"A"!==t.nodeName.toUpperCase();)t=t.parentNode;if(t&&"A"===t.nodeName.toUpperCase()){var o="object"==typeof t.href&&"SVGAnimatedString"===t.href.constructor.name;if(!t.hasAttribute("download")&&"external"!==t.getAttribute("rel")){var r=t.getAttribute("href");if((this._hashbang||!this._samePath(t)||!t.hash&&"#"!==r)&&!(r&&r.indexOf("mailto:")>-1)&&(o?!t.target.baseVal:!t.target)&&(o||this.sameOrigin(t.href))){var s=o?t.href.baseVal:t.pathname+t.search+(t.hash||"");s="/"!==s[0]?"/"+s:s,y&&s.match(/^\/[a-zA-Z]:\//)&&(s=s.replace(/^\/[a-zA-Z]:\//,"/"));var a=s,l=this._getBase();0===s.indexOf(l)&&(s=s.substr(l.length)),this._hashbang&&(s=s.replace("#!","")),(!l||a!==s||w&&"file:"===this._window.location.protocol)&&(e.preventDefault(),this.show(a))}}}}},C.prototype._onpopstate=(m=!1,_?(f&&"complete"===document.readyState?m=!0:window.addEventListener("load",(function(){setTimeout((function(){m=!0}),0)})),function(e){if(m)if(e.state){var t=e.state.path;this.replace(t,e.state)}else if(w){var i=this._window.location;this.show(i.pathname+i.search+i.hash,void 0,void 0,!1)}}):function(){}),C.prototype._which=function(e){return null==(e=e||_&&this._window.event).which?e.button:e.which},C.prototype._toURL=function(e){var t=this._window;if("function"==typeof URL&&w)return new URL(e,t.location.toString());if(f){var i=t.document.createElement("a");return i.href=e,i}},C.prototype.sameOrigin=function(e){if(!e||!w)return!1;var t=this._toURL(e),i=this._window.location;return i.protocol===t.protocol&&i.hostname===t.hostname&&(i.port===t.port||""===i.port&&(80==t.port||443==t.port))},C.prototype._samePath=function(e){if(!w)return!1;var t=this._window.location;return e.pathname===t.pathname&&e.search===t.search},C.prototype._decodeURLEncodedURIComponent=function(e){return"string"!=typeof e?e:this._decodeURLComponents?decodeURIComponent(e.replace(/\+/g," ")):e},A.prototype.pushState=function(){var e=this.page,t=e._window,i=e._hashbang;e.len++,v&&t.history.pushState(this.state,this.title,i&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},A.prototype.save=function(){var e=this.page;v&&e._window.history.replaceState(this.state,this.title,e._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},x.prototype.middleware=function(e){var t=this;return function(i,n){if(t.match(i.path,i.params))return i.routePath=t.path,e(i,n);n()}},x.prototype.match=function(e,t){var i=this.keys,n=e.indexOf("?"),o=~n?e.slice(0,n):e,r=this.regexp.exec(decodeURIComponent(o));if(!r)return!1;delete t[0];for(var s=1,a=r.length;s<a;++s){var l=i[s-1],c=this.page._decodeURLEncodedURIComponent(r[s]);void 0===c&&hasOwnProperty.call(t,l.name)||(t[l.name]=c)}return!0};var R=function e(){var t=new C;function i(){return S.apply(t,arguments)}return i.callbacks=t.callbacks,i.exits=t.exits,i.base=t.base.bind(t),i.strict=t.strict.bind(t),i.start=t.start.bind(t),i.stop=t.stop.bind(t),i.show=t.show.bind(t),i.back=t.back.bind(t),i.redirect=t.redirect.bind(t),i.replace=t.replace.bind(t),i.dispatch=t.dispatch.bind(t),i.exit=t.exit.bind(t),i.configure=t.configure.bind(t),i.sameOrigin=t.sameOrigin.bind(t),i.clickHandler=t.clickHandler.bind(t),i.create=e,Object.defineProperty(i,"len",{get:function(){return t.len},set:function(e){t.len=e}}),Object.defineProperty(i,"current",{get:function(){return t.current},set:function(e){t.current=e}}),i.Context=A,i.Route=x,i}(),T=R,k=R;return T.default=k,T},"object"==typeof exports&&"undefined"!=typeof module?module.exports=Fm():"function"==typeof define&&define.amd?define(Fm):Mm.page=Fm();const $m=window.page;class Bm{constructor(e,t,i,n){this.plugin=e,this.action=t,this.change=i,this.revision=n,this.popups=[]}popup(e){this.plugin.popup().then(t=>{const i=t._getElement();if(!i)throw new Error("Popup element not found");i.appendChild(e),this.popups.push(t)})}hide(){for(const e of this.popups)e.close();this.popups.splice(0)}refresh(){hu()}textfield(){return document.createElement("paper-input")}br(){return document.createElement("br")}msg(e){const t=document.createElement("gr-label");return t.appendChild(document.createTextNode(e)),t}div(...e){const t=document.createElement("div");for(const i of e)t.appendChild(i);return t}button(e,t){const i=t&&t.onclick,n=document.createElement("gr-button");return n.appendChild(document.createTextNode(e)),i&&this.plugin.eventHelper(n).onTap(i),n}checkbox(){const e=document.createElement("input");return e.type="checkbox",e}label(e,t){return this.div(e,this.msg(t))}prependLabel(e,t){return this.label(t,e)}call(e,t){this.action.method&&(this.action.__url?this.plugin.restApi().send(this.action.method,this.action.__url,e).then(t).catch(e=>{document.dispatchEvent(new CustomEvent("show-alert",{detail:{message:`Plugin network error: ${e}`}}))}):console.warn(`Unable to ${this.action.method} to ${this.action.__key}!`))}}const jm=()=>{console.warn("Use of uninitialized routing")},Hm=()=>(jm(),""),Um=()=>(jm(),""),Gm=()=>(jm(),[]),zm=()=>(jm(),{}),Vm=/\${user}/g,Wm={name:"Your Turn",query:"attention:${user}",hideIfEmpty:!1,suffixForDashboard:"limit:25",attentionSetOnly:!0},qm={name:"Recently closed",query:"is:closed -is:ignored (-is:wip OR owner:self) (owner:${user} OR reviewer:${user} OR assignee:${user} OR cc:${user})",suffixForDashboard:"-age:4w limit:10"},Km=[{name:"Has draft comments",query:"has:draft",selfOnly:!0,hideIfEmpty:!0,suffixForDashboard:"limit:10"},Wm,{name:"Assigned reviews",query:"assignee:${user} (-is:wip OR owner:self OR assignee:self) is:open -is:ignored",hideIfEmpty:!0,suffixForDashboard:"limit:25",assigneeOnly:!0},{name:"Work in progress",query:"is:open owner:${user} is:wip",selfOnly:!0,hideIfEmpty:!0,suffixForDashboard:"limit:25"},{name:"Outgoing reviews",query:"is:open owner:${user} -is:wip -is:ignored",isOutgoing:!0,suffixForDashboard:"limit:25"},{name:"Incoming reviews",query:"is:open -owner:${user} -is:wip -is:ignored (reviewer:${user} OR assignee:${user})",suffixForDashboard:"limit:25"},{name:"CCed on",query:"is:open -is:ignored cc:${user}",suffixForDashboard:"limit:10"},qm];function Ym(e){return e.view===bs.DIFF}var Xm,Jm,Zm;!function(e){e.MEMBERS="members",e.LOG="log"}(Xm||(Xm={})),function(e){e.ACCESS="access",e.BRANCHES="branches",e.COMMANDS="commands",e.DASHBOARDS="dashboards",e.TAGS="tags"}(Jm||(Jm={})),function(e){e.CHANGE="change",e.FILE="file",e.PATCHSET="patchset"}(Zm||(Zm={}));const Qm={View:bs,GroupDetailView:Xm,RepoDetailView:Jm,WeblinkType:Zm,_navigate:Hm,_generateUrl:Um,_generateWeblinks:Gm,mapCommentlinks:zm,_checkPatchRange(e,t){if(t&&!e)throw new Error("Cannot use base patch number without patch number.")},setup(e,t,i,n){this._navigate=e,this._generateUrl=t,this._generateWeblinks=i,this.mapCommentlinks=n},destroy(){this._navigate=Hm,this._generateUrl=Um,this._generateWeblinks=Gm,this.mapCommentlinks=zm},_getUrlFor(e){return this._generateUrl(e)},getUrlForSearchQuery(e,t){return this._getUrlFor({view:bs.SEARCH,query:e,offset:t})},getUrlForProjectChanges(e,t,i){return this._getUrlFor({view:bs.SEARCH,project:e,statuses:t?["open"]:[],host:i})},getUrlForBranch(e,t,i,n){return this._getUrlFor({view:bs.SEARCH,branch:e,project:t,statuses:i?[i]:void 0,host:n})},getUrlForTopic(e,t){return this._getUrlFor({view:bs.SEARCH,topic:e,host:t})},getUrlForHashtag(e){return this._getUrlFor({view:bs.SEARCH,hashtag:e,statuses:["open","merged"]})},navigateToStatusSearch(e){this._navigate(this._getUrlFor({view:bs.SEARCH,statuses:[e]}))},navigateToSearchQuery(e,t){return this._navigate(this.getUrlForSearchQuery(e,t))},navigateToUserDashboard(){return this._navigate(this.getUrlForUserDashboard("self"))},getUrlForChange(e,t,i,n,o){return"PARENT"===i&&(i=void 0),this._checkPatchRange(t,i),this._getUrlFor({view:bs.CHANGE,changeNum:e._number,project:e.project,patchNum:t,basePatchNum:i,edit:n,host:e.internalHost||void 0,messageHash:o})},getUrlForChangeById(e,t,i){return this._getUrlFor({view:bs.CHANGE,changeNum:e,project:t,patchNum:i})},navigateToChange(e,t,i,n,o){this._navigate(this.getUrlForChange(e,t,i,n),o)},getUrlForDiff(e,t,i,n,o){return this.getUrlForDiffById(e._number,e.project,t,i,n,o)},getUrlForComment(e,t,i){return this._getUrlFor({view:bs.DIFF,changeNum:e,project:t,commentId:i})},getUrlForDiffById(e,t,i,n,o,r,s){return"PARENT"===o&&(o=void 0),this._checkPatchRange(n,o),this._getUrlFor({view:bs.DIFF,changeNum:e,project:t,path:i,patchNum:n,basePatchNum:o,lineNum:r,leftSide:s})},getEditUrlForDiff(e,t,i,n){return this.getEditUrlForDiffById(e._number,e.project,t,i,n)},getEditUrlForDiffById(e,t,i,n,o){return this._getUrlFor({view:bs.EDIT,changeNum:e,project:t,path:i,patchNum:n||"edit",lineNum:o})},navigateToDiff(e,t,i,n,o){this._navigate(this.getUrlForDiff(e,t,i,n,o))},getUrlForOwner(e){return this._getUrlFor({view:bs.SEARCH,owner:e})},getUrlForUserDashboard(e){return this._getUrlFor({view:bs.DASHBOARD,user:e})},getUrlForRoot(){return this._getUrlFor({view:bs.ROOT})},getUrlForRepoDashboard(e,t){return this._getUrlFor({view:bs.DASHBOARD,repo:e,dashboard:t})},navigateToRelativeUrl(e){if(!e.startsWith("/"))throw new Error("navigateToRelativeUrl with non-relative URL");this._navigate(e)},getUrlForRepo(e){return this._getUrlFor({view:bs.REPO,repoName:e})},navigateToRepo(e){this._navigate(this.getUrlForRepo(e))},getUrlForRepoTags(e){return this._getUrlFor({view:bs.REPO,repoName:e,detail:Jm.TAGS})},getUrlForRepoBranches(e){return this._getUrlFor({view:bs.REPO,repoName:e,detail:Qm.RepoDetailView.BRANCHES})},getUrlForRepoAccess(e){return this._getUrlFor({view:bs.REPO,repoName:e,detail:Qm.RepoDetailView.ACCESS})},getUrlForRepoCommands(e){return this._getUrlFor({view:bs.REPO,repoName:e,detail:Qm.RepoDetailView.COMMANDS})},getUrlForRepoDashboards(e){return this._getUrlFor({view:bs.REPO,repoName:e,detail:Qm.RepoDetailView.DASHBOARDS})},getUrlForGroup(e){return this._getUrlFor({view:bs.GROUP,groupId:e})},getUrlForGroupLog(e){return this._getUrlFor({view:bs.GROUP,groupId:e,detail:Qm.GroupDetailView.LOG})},getUrlForGroupMembers(e){return this._getUrlFor({view:bs.GROUP,groupId:e,detail:Xm.MEMBERS})},getUrlForSettings(){return this._getUrlFor({view:bs.SETTINGS})},getFileWebLinks(e,t,i,n){const o={type:Zm.FILE,repo:e,commit:t,file:i};return n&&(o.options=n),[].concat(this._generateWeblinks(o))},getPatchSetWeblink(e,t,i){const n={type:Zm.PATCHSET,repo:e,commit:t};i&&(n.options=i);const o=this._generateWeblinks(n);return Array.isArray(o)?o.pop():o},getChangeWeblinks(e,t,i){const n={type:Zm.CHANGE,repo:e,commit:t};return i&&(n.options=i),[].concat(this._generateWeblinks(n))},getUserDashboard(e="self",t=Km,i="",n={}){const o=n.change&&!!n.change.enable_attention_set,r=n.change&&!!n.change.enable_assignee;return{title:i,sections:t=t.filter(e=>o||!e.attentionSetOnly).filter(e=>r||!e.assigneeOnly).filter(t=>"self"===e||!t.selfOnly).map(t=>({...t,name:t.name,query:t.query.replace(Vm,e)}))}}};function ef(e,t){e.innerHTML=t}function tf(e){return`<style>${e}</style>`}function nf(e){const t=e[0];if(/[<>]/.test(t))throw new Error("Forbidden characters in styleSheet string: "+t);return t}const of=document.createElement("custom-style");function rf(){document.head.appendChild(function(){const e=document.createElement("custom-style");return e.setAttribute("id","dark-theme"),ef(e,tf(nf`
    html {
      /**
       * Sections and variables must stay consistent with app-theme.js.
       *
       * Only modify color variables in this theme file. dark-theme extends
       * app-theme, so there is no need to repeat all variables, but for colors
       * it does make sense to list them all: If you override one color, then
       * you probably want to override all.
       */

      --error-foreground: var(--red-200);
      --error-background: var(--red-tonal);
      --error-background-hover: linear-gradient(var(--white-04), var(--white-04)), var(--red-tonal);
      --error-background-focus: linear-gradient(var(--white-12), var(--white-12)), var(--red-tonal);
      --error-ripple: var(--white-10);

      --warning-foreground: var(--orange-200);
      --warning-background: var(--orange-tonal);
      --warning-background-hover: linear-gradient(var(--white-04), var(--white-04)), var(--orange-tonal);
      --warning-background-focus: linear-gradient(var(--white-12), var(--white-12)), var(--orange-tonal);
      --warning-ripple: var(--white-10);

      --info-foreground: var(--blue-200);
      --info-background: var(--blue-tonal);
      --info-background-hover: linear-gradient(var(--white-04), var(--white-04)), var(--blue-tonal);
      --info-background-focus: linear-gradient(var(--white-12), var(--white-12)), var(--blue-tonal);
      --info-ripple: var(--white-10);

      --primary-button-text-color: black;
      --primary-button-background-color: var(--gerrit-blue-dark);
      --primary-button-background-hover: var(--blue-200-16);
      --primary-button-background-focus: var(--blue-200-24);

      --selected-foreground: var(--blue-200);
      --selected-background: var(--blue-900);

      --success-foreground: var(--green-200);
      --success-background: var(--green-tonal);
      --success-background-hover: linear-gradient(var(--white-04), var(--white-04)), var(--green-tonal);
      --success-background-focus: linear-gradient(var(--white-12), var(--white-12)), var(--green-tonal);
      --success-ripple: var(--white-10);

      --gray-foreground: var(--gray-300);
      --gray-background: var(--gray-tonal);
      --gray-background-hover: linear-gradient(var(--white-04), var(--white-04)), var(--gray-tonal);
      --gray-background-focus: linear-gradient(var(--white-12), var(--white-12)), var(--gray-tonal);
      --gray-ripple: var(--white-10);

      --disabled-foreground: var(--gray-200-38);
      --disabled-background: var(--gray-200-12);

      --chip-color: var(--gray-100);
      --error-color: var(--red-200);
      --tag-background: var(--cyan-900);
      --label-background: var(--red-900);

      /* text colors */
      --primary-text-color: var(--gray-200);
      --link-color: var(--gerrit-blue-dark);
      --comment-text-color: var(--primary-text-color);
      --deemphasized-text-color: var(--gray-500);
      --default-button-text-color: var(--gerrit-blue-dark);
      --chip-selected-text-color: var(--blue-100);
      --error-text-color: var(--red-200);
      /* Used on text color for change list doesn't need user's attention. */
      --reviewed-text-color: var(--gray-300);
      --vote-text-color: black;
      --status-text-color: black;
      --tooltip-text-color: var(--gray-200);
      --negative-red-text-color: var(--red-200);
      --positive-green-text-color: var(--green-200);
      --indirect-ancestor-text-color: var(--green-200);

      /* background colors */
      /* primary background colors */
      --background-color-primary: var(--gray-900);
      --background-color-secondary: #2f3034;
      --background-color-tertiary: var(--gray-800);
      /* directly derived from primary background colors */
      /*   empty, because inheriting from app-theme is just fine
      /* unique background colors */
      --assignee-highlight-color: #3a361c;
      --assignee-highlight-selection-color: #423e24;
      --chip-selected-background-color: #3c4455;
      --edit-mode-background-color: #5c0a36;
      --emphasis-color: #383f4a;
      --hover-background-color: rgba(161, 194, 250, 0.2);
      --disabled-button-background-color: #484a4d;
      --selection-background-color: rgba(161, 194, 250, 0.1);
      --tooltip-background-color: var(--gray-800);

      /* comment background colors */
      --comment-background-color: #3c3f43;
      --robot-comment-background-color: #1e3a5f;
      --unresolved-comment-background-color: #614a19;

      /* vote background colors */
      --vote-color-approved: var(--green-300);
      --vote-color-disliked: var(--red-tonal);
      --vote-outline-disliked: var(--red-200);
      --vote-color-neutral: var(--gray-700);
      --vote-color-recommended: var(--green-tonal);
      --vote-outline-recommended: var(--green-200);
      --vote-color-rejected: var(--red-200);

      --outline-color-focus: var(--gray-100);

      /* misc colors */
      --border-color: var(--gray-700);
      --comment-separator-color: var(--border-color);

      /* checks tag colors */
      --tag-gray: var(--gray-tonal);
      --tag-yellow: var(--yellow-tonal);
      --tag-pink: var(--pink-tonal);
      --tag-purple: var(--purple-tonal);
      --tag-cyan: var(--cyan-tonal);
      --tag-brown: var(--brown-tonal);

      /* status colors */
      --status-merged: var(--green-400);
      --status-abandoned: var(--gray-300);
      --status-wip: #bcaaa4;
      --status-private: var(--purple-200);
      --status-conflict: var(--red-300);
      --status-active: var(--blue-400);
      --status-ready: var(--pink-500);
      --status-custom: var(--purple-400);

      /* file status colors */
      --file-status-added: var(--green-tonal);
      --file-status-changed: var(--red-tonal);
      --file-status-unchanged: var(--grey-700);

      /* fonts */
      --font-weight-bold: 700; /* 700 is the same as 'bold' */

      /* spacing */

      /* header and footer */
      --footer-background-color: var(--background-color-tertiary);
      --footer-border-top: 1px solid var(--border-color);
      --header-background-color: var(--background-color-tertiary);
      --header-border-bottom: 1px solid var(--border-color);
      --header-padding: 0 var(--spacing-l);
      --header-text-color: var(--primary-text-color);

      /* diff colors */
      --dark-add-highlight-color: #133820;
      --dark-rebased-add-highlight-color: rgba(11, 255, 155, 0.15);
      --dark-rebased-remove-highlight-color: rgba(255, 139, 6, 0.15);
      --dark-remove-highlight-color: #62110f;
      --diff-blank-background-color: var(--background-color-secondary);
      --diff-context-control-background-color: #333311;
      --diff-context-control-border-color: var(--border-color);
      --diff-context-control-color: var(--deemphasized-text-color);
      --diff-highlight-range-color: rgba(0, 100, 200, 0.5);
      --diff-highlight-range-hover-color: rgba(0, 150, 255, 0.5);
      --diff-selection-background-color: #3a71d8;
      --diff-tab-indicator-color: var(--deemphasized-text-color);
      --diff-trailing-whitespace-indicator: #ff9ad2;
      --light-add-highlight-color: #0f401f;
      --light-rebased-add-highlight-color: #487165;
      --diff-moved-in-background: #1d4042;
      --diff-moved-out-background: #230e34;
      --diff-moved-in-label-color: var(--cyan-50);
      --diff-moved-out-label-color: var(--purple-50);
      --light-remove-add-highlight-color: #2f3f2f;
      --light-remove-highlight-color: #320404;
      --coverage-covered: #112826;
      --coverage-not-covered: #6b3600;
      --ranged-comment-hint-text-color: var(--blue-50);

      /* syntax colors */
      --syntax-attr-color: #80cbbf;
      --syntax-attribute-color: var(--primary-text-color);
      --syntax-built_in-color: #f7c369;
      --syntax-comment-color: var(--deemphasized-text-color);
      --syntax-default-color: var(--primary-text-color);
      --syntax-doctag-weight: bold;
      --syntax-function-color: var(--primary-text-color);
      --syntax-keyword-color: #cd4cf0;
      --syntax-link-color: #c792ea;
      --syntax-literal-color: #eefff7;
      --syntax-meta-color: #6d7eee;
      --syntax-meta-keyword-color: #eefff7;
      --syntax-number-color: #00998a;
      --syntax-params-color: var(--primary-text-color);
      --syntax-regexp-color: #f77669;
      --syntax-selector-attr-color: #80cbbf;
      --syntax-selector-class-color: #ffcb68;
      --syntax-selector-id-color: #f77669;
      --syntax-selector-pseudo-color: #c792ea;
      --syntax-property-color: #c792ea;
      --syntax-string-color: #c3e88d;
      --syntax-tag-color: #f77669;
      --syntax-template-tag-color: #c792ea;
      --syntax-template-variable-color: #f77669;
      --syntax-title-color: #75a5ff;
      --syntax-type-color: #dd5f5f;
      --syntax-variable-color: #f77669;

      /* misc */
      /* Base 64 encoded 1x1px of #d7aefb; */
      --line-length-indicator: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2O4vu73fwAIYAOAtqAXCQAAAABJRU5ErkJggg==');

      /* paper and iron component overrides */
      --iron-overlay-backdrop-background-color: white;

      /* rules applied to html */
      background-color: var(--view-background-color);
    }
  `)),e}())}of.setAttribute("id","light-theme"),ef(of,tf(nf`
  html {
    /**
     * When adding a new color variable make sure to also add it to the other
     * theme files in the same directory.
     *
     * For colors prefer lower case hex colors.
     *
     * Note that plugins might be using these variables, so removing a variable
     * can be a breaking change that should go into the release notes.
     */

    /* color palette */
    --gerrit-blue-light: #1565c0;
    --gerrit-blue-dark: #90caf9;
    --red-900: #a50e0e;
    --red-700: #c5221f;
    --red-700-04: #c5221f0a;
    --red-700-10: #c5221f1a;
    --red-700-12: #c5221f1f;
    --red-600: #d93025;
    --red-300: #f28b82;
    --red-200: #f6aea9;
    --red-50: #fce8e6;
    --red-tonal: #6c322f;
    --blue-900: #174ea6;
    --blue-800: #185abc;
    --blue-700: #1967d2;
    --blue-700-04: #1967d20a;
    --blue-700-10: #1967d21a;
    --blue-700-12: #1967d21f;
    --blue-700-16: #1967d229;
    --blue-700-24: #1967d23d;
    --blue-400: #669df6;
    --blue-200: #aecbfa;
    --blue-200-16: #aecbfa29;
    --blue-200-24: #aecbfa3d;
    --blue-100: #d2e3fc;
    --blue-50: #e8f0fe;
    --blue-tonal: #314972;
    --orange-900: #b06000;
    --orange-700: #d56e0c;
    --orange-700-04: #d56e0c0a;
    --orange-700-10: #d56e0c1a;
    --orange-700-12: #d56e0c1f;
    --orange-200: #fdc69c;
    --orange-50: #feefe3;
    --orange-tonal: #714625;
    --cyan-900: #007b83;
    --cyan-700: #129eaf;
    --cyan-200: #a1e4f2;
    --cyan-100: #cbf0f8;
    --cyan-50: #e4f7fb;
    --cyan-tonal: #275e6b;
    --green-900: #0d652d;
    --green-700: #188038;
    --green-700-04: #1880380a;
    --green-700-10: #1880381a;
    --green-700-12: #1880381f;
    --green-400: #5bb974;
    --green-300: #81c995;
    --green-200: #a8dab5;
    --green-50: #e6f4ea;
    --green-tonal: #2c553a;
    --gray-900: #202124;
    --gray-800: #3c4043;
    --gray-800-12: #3c40431f;
    --gray-800-38: #3c404361;
    --gray-700: #5f6368;
    --gray-700-04: #5f63680a;
    --gray-700-10: #5f63681a;
    --gray-700-12: #5f63681f;
    --gray-500: #9aa0a6;
    --gray-300: #dadce0;
    --gray-200: #e8eaed;
    --gray-200-12: #e8eaed1f;
    --gray-200-38: #e8eaed61;
    --gray-100: #f1f3f4;
    --gray-50: #f8f9fa;
    --gray-tonal: #505357;
    --purple-900: #681da8;
    --purple-700: #8430ce;
    --purple-500: #a142f4;
    --purple-400: #af5cf7;
    --purple-200: #d7aefb;
    --purple-50: #f3e8fd;
    --purple-tonal: #523272;
    --pink-800: #b80672;
    --pink-500: #f538a0;
    --pink-50: #fde7f3;
    --pink-tonal: #702f55;
    --yellow-50: #fef7e0;
    --yellow-tonal: #6a5619;
    --brown-50: #efebe9;
    --brown-tonal: #6d4c41;
    --white-04: #ffffff0a;
    --white-10: #ffffff1a;
    --white-12: #ffffff1f;

    --error-foreground: var(--red-700);
    --error-background: var(--red-50);
    --error-background-hover: linear-gradient(var(--red-700-04), var(--red-700-04)), var(--red-50);
    --error-background-focus: linear-gradient(var(--red-700-12), var(--red-700-12)), var(--red-50);
    --error-ripple: var(--red-700-10);

    --warning-foreground: var(--orange-700);
    --warning-background: var(--orange-50);
    --warning-background-hover: linear-gradient(var(--orange-700-04), var(--orange-700-04)), var(--orange-50);
    --warning-background-focus: linear-gradient(var(--orange-700-12), var(--orange-700-12)), var(--orange-50);
    --warning-ripple: var(--orange-700-10);

    --info-foreground: var(--blue-700);
    --info-background: var(--blue-50);
    --info-background-hover: linear-gradient(var(--blue-700-04), var(--blue-700-04)), var(--blue-50);
    --info-background-focus: linear-gradient(var(--blue-700-12), var(--blue-700-12)), var(--blue-50);
    --info-ripple: var(--blue-700-10);

    --primary-button-text-color: white;
    --primary-button-background-color: var(--gerrit-blue-light);
    --primary-button-background-hover: var(--blue-700-16);
    --primary-button-background-focus: var(--blue-700-24);

    --selected-foreground: var(--blue-800);
    --selected-background: var(--blue-50);

    --success-foreground: var(--green-700);
    --success-background: var(--green-50);
    --success-background-hover: linear-gradient(var(--green-700-04), var(--green-700-04)), var(--green-50);
    --success-background-focus: linear-gradient(var(--green-700-12), var(--green-700-12)), var(--green-50);
    --success-ripple: var(--green-700-10);

    --gray-foreground: var(--gray-700);
    --gray-background: var(--gray-100);
    --gray-background-hover: linear-gradient(var(--gray-700-04), var(--gray-700-04)), var(--gray-100);
    --gray-background-focus: linear-gradient(var(--gray-700-12), var(--gray-700-12)), var(--gray-100);
    --gray-ripple: var(--gray-700-10);

    --disabled-foreground: var(--gray-800-38);
    --disabled-background: var(--gray-800-12);

    --chip-color: var(--gray-900);
    --error-color: var(--red-900);
    --tag-background: var(--cyan-100);
    --label-background: var(--red-50);

    /* text colors */
    --primary-text-color: var(--gray-900);
    --link-color: var(--gerrit-blue-light);
    --comment-text-color: var(--gray-900);
    --deemphasized-text-color: var(--gray-700);
    --default-button-text-color: var(--gerrit-blue-light);
    --chip-selected-text-color: var(--selected-foreground);
    --error-text-color: var(--red-700);
    /* Used on text color for change list that doesn't need user's attention. */
    --reviewed-text-color: black;
    --vote-text-color: black;
    --status-text-color: white;
    --tooltip-text-color: white;
    --negative-red-text-color: var(--red-600);
    --positive-green-text-color: var(--green-700);
    --indirect-ancestor-text-color: var(--green-700);

    /* background colors */
    /* primary background colors */
    --background-color-primary: white;
    --background-color-secondary: var(--gray-50);
    --background-color-tertiary: var(--gray-100);
    /* directly derived from primary background colors */
    --chip-background-color: var(--background-color-tertiary);
    --default-button-background-color: var(--background-color-primary);
    --dialog-background-color: var(--background-color-primary);
    --dropdown-background-color: var(--background-color-primary);
    --expanded-background-color: var(--background-color-tertiary);
    --select-background-color: var(--background-color-secondary);
    --shell-command-background-color: var(--background-color-secondary);
    --shell-command-decoration-background-color: var(--background-color-tertiary);
    --table-header-background-color: var(--background-color-secondary);
    --table-subheader-background-color: var(--background-color-tertiary);
    --view-background-color: var(--background-color-primary);
    /* unique background colors */
    --assignee-highlight-color: #fcfad6;
    /* TODO: Find a nicer way to combine the --assignee-highlight-color and the
       --selection-background-color than to just invent another unique color. */
    --assignee-highlight-selection-color: #f6f4d0;
    --chip-selected-background-color: var(--blue-50);
    --edit-mode-background-color: #ebf5fb;
    --emphasis-color: #fff9c4;
    --hover-background-color: rgba(161, 194, 250, 0.2);
    --disabled-button-background-color: var(--disabled-background);
    --selection-background-color: rgba(161, 194, 250, 0.1);
    --tooltip-background-color: var(--gray-900);

    /* comment background colors */
    --comment-background-color: var(--gray-200);
    --robot-comment-background-color: var(--blue-50);
    --unresolved-comment-background-color: #fef7e0;

    /* vote background colors */
    --vote-color-approved: var(--green-300);
    --vote-color-disliked: var(--red-50);
    --vote-outline-disliked: var(--red-700);
    --vote-color-neutral: var(--gray-300);
    --vote-color-recommended: var(--green-50);
    --vote-outline-recommended: var(--green-700);
    --vote-color-rejected: var(--red-300);

    --outline-color-focus: var(--gray-900);

    /* misc colors */
    --border-color: var(--gray-300);
    --comment-separator-color: var(--gray-300);

    /* checks tag colors */
    --tag-gray: var(--gray-200);
    --tag-yellow: var(--yellow-50);
    --tag-pink: var(--pink-50);
    --tag-purple: var(--purple-50);
    --tag-cyan: var(--cyan-50);
    --tag-brown: var(--brown-50);

    /* status colors */
    --status-merged: var(--green-700);
    --status-abandoned: var(--gray-700);
    --status-wip: #795548;
    --status-private: var(--purple-500);
    --status-conflict: var(--red-600);
    --status-active: var(--blue-700);
    --status-ready: var(--pink-800);
    --status-custom: var(--purple-900);

    /* file status colors */
    --file-status-added: var(--green-300);
    --file-status-changed: var(--red-200);
    --file-status-unchanged: var(--grey-300);

    /* fonts */
    --font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    --header-font-family: 'Open Sans', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    --monospace-font-family: 'Roboto Mono', 'SF Mono', 'Lucida Console', Monaco, monospace;
    --font-size-code: 12px;     /* 12px mono */
    --font-size-mono: .929rem;  /* 13px mono */
    --font-size-small: .857rem; /* 12px */
    --font-size-normal: 1rem;   /* 14px */
    --font-size-h3: 1.143rem;   /* 16px */
    --font-size-h2: 1.429rem;   /* 20px */
    --font-size-h1: 1.714rem;   /* 24px */
    --line-height-mono: 1.286rem;   /* 18px */
    --line-height-small: 1.143rem;  /* 16px */
    --line-height-normal: 1.429rem; /* 20px */
    --line-height-h3: 1.715rem;     /* 24px */
    --line-height-h2: 2rem;         /* 28px */
    --line-height-h1: 2.286rem;     /* 32px */
    --font-weight-normal: 400; /* 400 is the same as 'normal' */
    --font-weight-bold: 500;
    --font-weight-h1: 400;
    --font-weight-h2: 400;
    --font-weight-h3: 400;
    --context-control-button-font: var(--font-weight-normal) var(--font-size-normal) var(--font-family);
    --code-hint-font-weight: 500;
    --image-diff-button-font: var(--font-weight-normal) var(--font-size-normal) var(--font-family);

    /* spacing */
    --spacing-xxs: 1px;
    --spacing-xs: 2px;
    --spacing-s: 4px;
    --spacing-m: 8px;
    --spacing-l: 12px;
    --spacing-xl: 16px;
    --spacing-xxl: 24px;

    /* header and footer */
    --footer-background-color: transparent;
    --footer-border-top: none;
    --header-background-color: var(--background-color-tertiary);
    --header-border-bottom: 1px solid var(--border-color);
    --header-border-image: '';
    --header-box-shadow: none;
    --header-padding: 0 var(--spacing-l);
    --header-icon-size: 0em;
    --header-icon: none;
    --header-text-color: black;
    --header-title-content: 'Gerrit';
    --header-title-font-size: 1.75rem;

    /* diff colors */
    --dark-add-highlight-color: #aaf2aa;
    --dark-rebased-add-highlight-color: #d7d7f9;
    --dark-rebased-remove-highlight-color: #f7e8b7;
    --dark-remove-highlight-color: #ffcdd2;
    --diff-blank-background-color: var(--background-color-secondary);
    --diff-context-control-background-color: #fff7d4;
    --diff-context-control-border-color: #f6e6a5;
    --diff-context-control-color: var(--default-button-text-color);
    --diff-highlight-range-color: rgba(255, 213, 0, 0.5);
    --diff-highlight-range-hover-color: rgba(255, 255, 0, 0.5);
    --diff-selection-background-color: #c7dbf9;
    --diff-tab-indicator-color: var(--deemphasized-text-color);
    --diff-trailing-whitespace-indicator: #ff9ad2;
    --light-add-highlight-color: #d8fed8;
    --light-rebased-add-highlight-color: #eef;
    --diff-moved-in-background: var(--cyan-50);
    --diff-moved-out-background: var(--purple-50);
    --diff-moved-in-label-color: var(--cyan-900);
    --diff-moved-out-label-color: var(--purple-900);
    --light-remove-add-highlight-color: #fff8dc;
    --light-remove-highlight-color: #ffebee;
    --coverage-covered: #e0f2f1;
    --coverage-not-covered: #ffd1a4;
    --ranged-comment-hint-text-color: var(--orange-900);

    /* syntax colors */
    --syntax-attr-color: #219;
    --syntax-attribute-color: var(--primary-text-color);
    --syntax-built_in-color: #30a;
    --syntax-comment-color: #3f7f5f;
    --syntax-default-color: var(--primary-text-color);
    --syntax-doctag-weight: bold;
    --syntax-function-color: var(--primary-text-color);
    --syntax-keyword-color: #9e0069;
    --syntax-link-color: #219;
    --syntax-literal-color: #219;
    --syntax-meta-color: #ff1717;
    --syntax-meta-keyword-color: #219;
    --syntax-number-color: #164;
    --syntax-params-color: var(--primary-text-color);
    --syntax-regexp-color: #fa8602;
    --syntax-selector-attr-color: #fa8602;
    --syntax-selector-class-color: #164;
    --syntax-selector-id-color: #2a00ff;
    --syntax-property-color: #fa8602;
    --syntax-selector-pseudo-color: #fa8602;
    --syntax-string-color: #2a00ff;
    --syntax-tag-color: #170;
    --syntax-template-tag-color: #fa8602;
    --syntax-template-variable-color: #0000c0;
    --syntax-title-color: #0000c0;
    --syntax-type-color: var(--blue-700);
    --syntax-variable-color: var(--primary-text-color);

    /* elevation */
    --elevation-level-1: 0px 1px 2px 0px rgba(60, 64, 67, .30), 0px 1px 3px 1px rgba(60, 64, 67, .15);
    --elevation-level-2: 0px 1px 2px 0px rgba(60, 64, 67, .30), 0px 2px 6px 2px rgba(60, 64, 67, .15);
    --elevation-level-3: 0px 1px 3px 0px rgba(60, 64, 67, .30), 0px 4px 8px 3px rgba(60, 64, 67, .15);
    --elevation-level-4: 0px 2px 3px 0px rgba(60, 64, 67, .30), 0px 6px 10px 4px rgba(60, 64, 67, .15);
    --elevation-level-5: 0px 4px 4px 0px rgba(60, 64, 67, .30), 0px 8px 12px 6px rgba(60, 64, 67, .15);

    /* misc */
    --border-radius: 4px;
    --reply-overlay-z-index: 1000;
    /* Base 64 encoded 1x1px of #681da8 */
    --line-length-indicator: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2PIlF2xAgAD+AHXfBDdKAAAAABJRU5ErkJggg==');

    /* paper and iron component overrides */
    --iron-overlay-backdrop-background-color: black;
    --iron-overlay-backdrop-opacity: 0.32;
    --iron-overlay-backdrop: {
      transition: none;
    };
    --paper-tooltip-delay-in: 200ms;
    --paper-tooltip-delay-out: 0;
    --paper-tooltip-duration-in: 0;
    --paper-tooltip-duration-out: 0;
    --paper-tooltip-background: var(--tooltip-background-color);
    --paper-tooltip-opacity: 1.0;
    --paper-tooltip-text-color: var(--tooltip-text-color);
    --paper-tooltip: {
      font-size: var(--font-size-small);
    }
  }
  @media screen and (max-width: 50em) {
    html {
      --spacing-xxs: 1px;
      --spacing-xs: 1px;
      --spacing-s: 2px;
      --spacing-m: 4px;
      --spacing-l: 8px;
      --spacing-xl: 12px;
      --spacing-xxl: 16px;
    }
  }`)),document.head.appendChild(of);const sf=document.createElement("template");sf.innerHTML="<dom-module id=\"gr-menu-page-styles\">\n  <template>\n    <style>\n      :host {\n        display: block;\n      }\n      .main {\n        margin: var(--spacing-xxl) auto;\n        max-width: 50em;\n      }\n      .mainHeader {\n        margin-left: 14em;\n        padding: var(--spacing-l) 0 var(--spacing-l) var(--spacing-xxl);\n      }\n      .main.table,\n      .mainHeader {\n        margin-top: 0;\n        margin-right: 0;\n        margin-left: 14em;\n        max-width: none;\n      }\n      h2.edited:after {\n        color: var(--deemphasized-text-color);\n        content: ' *';\n      }\n      .loading {\n        color: var(--deemphasized-text-color);\n        padding: var(--spacing-l);\n      }\n      @media only screen and (max-width: 67em) {\n        .main {\n          margin: var(--spacing-xxl) 0 var(--spacing-xxl) 15em;\n        }\n        .main.table {\n          margin-left: 14em;\n        }\n      }\n      @media only screen and (max-width: 53em) {\n        .loading {\n          padding: 0 var(--spacing-l);\n        }\n        .main {\n          margin: var(--spacing-xxl) var(--spacing-l);\n        }\n        .main.table {\n          margin: 0;\n        }\n        .mainHeader {\n          margin-left: 0;\n          padding: var(--spacing-m) 0 var(--spacing-m) var(--spacing-l);\n        }\n      }\n    </style>\n  </template>\n</dom-module>",document.head.appendChild(sf.content);const af=document.createElement("template");af.innerHTML='<dom-module id="gr-page-nav-styles">\n  <template>\n    <style>\n      .navStyles ul {\n        padding: var(--spacing-l) 0;\n      }\n      .navStyles li {\n        border-bottom: 1px solid transparent;\n        border-top: 1px solid transparent;\n        display: block;\n        padding: 0 var(--spacing-xl);\n      }\n      .navStyles li a {\n        display: block;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n      .navStyles .subsectionItem {\n        padding-left: var(--spacing-xxl);\n      }\n      .navStyles .hideSubsection {\n        display: none;\n      }\n      .navStyles li.sectionTitle {\n        padding: 0 var(--spacing-xxl) 0 var(--spacing-l);\n      }\n      .navStyles li.sectionTitle:not(:first-child) {\n        margin-top: var(--spacing-l);\n      }\n      .navStyles .title {\n        font-weight: var(--font-weight-bold);\n        margin: var(--spacing-s) 0;\n      }\n      .navStyles .selected {\n        background-color: var(--view-background-color);\n        border-bottom: 1px solid var(--border-color);\n        border-top: 1px solid var(--border-color);\n        font-weight: var(--font-weight-bold);\n      }\n      .navStyles a {\n        color: var(--primary-text-color);\n        display: inline-block;\n        margin: var(--spacing-s) 0;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(af.content);const lf={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:String},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(e){this._setFocused("focus"===e.type)},_disabledChanged:function(e,t){this.setAttribute("aria-disabled",e?"true":"false"),this.style.pointerEvents=e?"none":"",e?(this._oldTabIndex=this.getAttribute("tabindex"),this._setFocused(!1),this.tabIndex=-1,this.blur()):void 0!==this._oldTabIndex&&(null===this._oldTabIndex?this.removeAttribute("tabindex"):this.setAttribute("tabindex",this._oldTabIndex))},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}};zh({_template:mi`
    <style>
      :host {
        position: fixed;
      }

      #contentWrapper ::slotted(*) {
        overflow: auto;
      }

      #contentWrapper.animating ::slotted(*) {
        overflow: hidden;
        pointer-events: none;
      }
    </style>

    <div id="contentWrapper">
      <slot id="content" name="dropdown-content"></slot>
    </div>
`,is:"iron-dropdown",behaviors:[lf,qp,cu,[{properties:{animationConfig:{type:Object},entryAnimation:{observer:"_entryAnimationChanged",type:String},exitAnimation:{observer:"_exitAnimationChanged",type:String}},_entryAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.entry=[{name:this.entryAnimation,node:this}]},_exitAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.exit=[{name:this.exitAnimation,node:this}]},_copyProperties:function(e,t){for(var i in t)e[i]=t[i]},_cloneConfig:function(e){var t={isClone:!0};return this._copyProperties(t,e),t},_getAnimationConfigRecursive:function(e,t,i){var n;if(this.animationConfig)if(this.animationConfig.value&&"function"==typeof this.animationConfig.value)this._warn(this._logf("playAnimation","Please put 'animationConfig' inside of your components 'properties' object instead of outside of it."));else if(n=e?this.animationConfig[e]:this.animationConfig,Array.isArray(n)||(n=[n]),n)for(var o,r=0;o=n[r];r++)if(o.animatable)o.animatable._getAnimationConfigRecursive(o.type||e,t,i);else if(o.id){var s=t[o.id];s?(s.isClone||(t[o.id]=this._cloneConfig(s),s=t[o.id]),this._copyProperties(s,o)):t[o.id]=o}else i.push(o)},getAnimationConfig:function(e){var t={},i=[];for(var n in this._getAnimationConfigRecursive(e,t,i),t)i.push(t[n]);return i}},{_configureAnimations:function(e){var t=[],i=[];if(e.length>0)for(let t,n=0;t=e[n];n++){let e=document.createElement(t.name);if(e.isNeonAnimation){let n=null;e.configure||(e.configure=function(e){return null}),n=e.configure(t),i.push({result:n,config:t,neonAnimation:e})}else console.warn(this.is+":",t.name,"not found!")}for(var n=0;n<i.length;n++){let e=i[n].result,o=i[n].config,r=i[n].neonAnimation;try{"function"!=typeof e.cancel&&(e=document.timeline.play(e))}catch(t){e=null,console.warn("Couldnt play","(",o.name,").",t)}e&&t.push({neonAnimation:r,config:o,animation:e})}return t},_shouldComplete:function(e){for(var t=!0,i=0;i<e.length;i++)if("finished"!=e[i].animation.playState){t=!1;break}return t},_complete:function(e){for(var t=0;t<e.length;t++)e[t].neonAnimation.complete(e[t].config);for(t=0;t<e.length;t++)e[t].animation.cancel()},playAnimation:function(e,t){var i=this.getAnimationConfig(e);if(i){this._active=this._active||{},this._active[e]&&(this._complete(this._active[e]),delete this._active[e]);var n=this._configureAnimations(i);if(0!=n.length){this._active[e]=n;for(var o=0;o<n.length;o++)n[o].animation.onfinish=function(){this._shouldComplete(n)&&(this._complete(n),delete this._active[e],this.fire("neon-animation-finish",t,{bubbles:!1}))}.bind(this)}else this.fire("neon-animation-finish",t,{bubbles:!1})}},cancelAnimation:function(){for(var e in this._active){var t=this._active[e];for(var i in t)t[i].animation.cancel()}this._active={}}}]],properties:{horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},openAnimationConfig:{type:Object},closeAnimationConfig:{type:Object},focusTarget:{type:Object},noAnimations:{type:Boolean,value:!1},allowOutsideScroll:{type:Boolean,value:!1,observer:"_allowOutsideScrollChanged"}},listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},observers:["_updateOverlayPosition(positionTarget, verticalAlign, horizontalAlign, verticalOffset, horizontalOffset)"],get containedElement(){for(var e=Th(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},ready:function(){this.scrollAction||(this.scrollAction=this.allowOutsideScroll?"refit":"lock"),this._readied=!0},attached:function(){this.sizingTarget&&this.sizingTarget!==this||(this.sizingTarget=this.containedElement||this)},detached:function(){this.cancelAnimation()},_openedChanged:function(){this.opened&&this.disabled?this.cancel():(this.cancelAnimation(),this._updateAnimationConfig(),au._openedChanged.apply(this,arguments))},_renderOpened:function(){!this.noAnimations&&this.animationConfig.open?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("open")):au._renderOpened.apply(this,arguments)},_renderClosed:function(){!this.noAnimations&&this.animationConfig.close?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("close")):au._renderClosed.apply(this,arguments)},_onNeonAnimationFinish:function(){this.$.contentWrapper.classList.remove("animating"),this.opened?this._finishRenderOpened():this._finishRenderClosed()},_updateAnimationConfig:function(){for(var e=this.containedElement,t=[].concat(this.openAnimationConfig||[]).concat(this.closeAnimationConfig||[]),i=0;i<t.length;i++)t[i].node=e;this.animationConfig={open:this.openAnimationConfig,close:this.closeAnimationConfig}},_updateOverlayPosition:function(){this.isAttached&&this.notifyResize()},_allowOutsideScrollChanged:function(e){this._readied&&(e?this.scrollAction&&"lock"!==this.scrollAction||(this.scrollAction="refit"):this.scrollAction="lock")},_applyFocus:function(){var e=this.focusTarget||this.containedElement;e&&this.opened&&!this.noAutoFocus?e.focus():au._applyFocus.apply(this,arguments)}});const cf=mi`
<custom-style>
  <style is="custom-style">
    [hidden] {
      display: none !important;
    }
  </style>
</custom-style>
<custom-style>
  <style is="custom-style">
    html {

      --layout: {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      };

      --layout-inline: {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      };

      --layout-horizontal: {
        @apply --layout;

        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      };

      --layout-horizontal-reverse: {
        @apply --layout;

        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      };

      --layout-vertical: {
        @apply --layout;

        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      };

      --layout-vertical-reverse: {
        @apply --layout;

        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      };

      --layout-wrap: {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      };

      --layout-wrap-reverse: {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      };

      --layout-flex-auto: {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      };

      --layout-flex-none: {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      };

      --layout-flex: {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      };

      --layout-flex-2: {
        -ms-flex: 2;
        -webkit-flex: 2;
        flex: 2;
      };

      --layout-flex-3: {
        -ms-flex: 3;
        -webkit-flex: 3;
        flex: 3;
      };

      --layout-flex-4: {
        -ms-flex: 4;
        -webkit-flex: 4;
        flex: 4;
      };

      --layout-flex-5: {
        -ms-flex: 5;
        -webkit-flex: 5;
        flex: 5;
      };

      --layout-flex-6: {
        -ms-flex: 6;
        -webkit-flex: 6;
        flex: 6;
      };

      --layout-flex-7: {
        -ms-flex: 7;
        -webkit-flex: 7;
        flex: 7;
      };

      --layout-flex-8: {
        -ms-flex: 8;
        -webkit-flex: 8;
        flex: 8;
      };

      --layout-flex-9: {
        -ms-flex: 9;
        -webkit-flex: 9;
        flex: 9;
      };

      --layout-flex-10: {
        -ms-flex: 10;
        -webkit-flex: 10;
        flex: 10;
      };

      --layout-flex-11: {
        -ms-flex: 11;
        -webkit-flex: 11;
        flex: 11;
      };

      --layout-flex-12: {
        -ms-flex: 12;
        -webkit-flex: 12;
        flex: 12;
      };

      /* alignment in cross axis */

      --layout-start: {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      };

      --layout-center: {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      };

      --layout-end: {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      };

      --layout-baseline: {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      };

      /* alignment in main axis */

      --layout-start-justified: {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      };

      --layout-center-justified: {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      --layout-end-justified: {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      };

      --layout-around-justified: {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      };

      --layout-justified: {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      };

      --layout-center-center: {
        @apply --layout-center;
        @apply --layout-center-justified;
      };

      /* self alignment */

      --layout-self-start: {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      };

      --layout-self-center: {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      };

      --layout-self-end: {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      };

      --layout-self-stretch: {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      };

      --layout-self-baseline: {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      };

      /* multi-line alignment in main axis */

      --layout-start-aligned: {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      };

      --layout-end-aligned: {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      };

      --layout-center-aligned: {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      };

      --layout-between-aligned: {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      };

      --layout-around-aligned: {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      };

      /*******************************
                Other Layout
      *******************************/

      --layout-block: {
        display: block;
      };

      --layout-invisible: {
        visibility: hidden !important;
      };

      --layout-relative: {
        position: relative;
      };

      --layout-fit: {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-scroll: {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      };

      --layout-fullbleed: {
        margin: 0;
        height: 100vh;
      };

      /* fixed position */

      --layout-fixed-top: {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
      };

      --layout-fixed-right: {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
      };

      --layout-fixed-bottom: {
        position: fixed;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-fixed-left: {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
      };

    }
  </style>
</custom-style>`;cf.setAttribute("style","display: none;"),document.head.appendChild(cf.content);var df=document.createElement("style");df.textContent="[hidden] { display: none !important; }",document.head.appendChild(df);const hf=mi`
<custom-style>
  <style is="custom-style">
    html {

      /* Material Design color palette for Google products */

      --google-red-100: #f4c7c3;
      --google-red-300: #e67c73;
      --google-red-500: #db4437;
      --google-red-700: #c53929;

      --google-blue-100: #c6dafc;
      --google-blue-300: #7baaf7;
      --google-blue-500: #4285f4;
      --google-blue-700: #3367d6;

      --google-green-100: #b7e1cd;
      --google-green-300: #57bb8a;
      --google-green-500: #0f9d58;
      --google-green-700: #0b8043;

      --google-yellow-100: #fce8b2;
      --google-yellow-300: #f7cb4d;
      --google-yellow-500: #f4b400;
      --google-yellow-700: #f09300;

      --google-grey-100: #f5f5f5;
      --google-grey-300: #e0e0e0;
      --google-grey-500: #9e9e9e;
      --google-grey-700: #616161;

      /* Material Design color palette from online spec document */

      --paper-red-50: #ffebee;
      --paper-red-100: #ffcdd2;
      --paper-red-200: #ef9a9a;
      --paper-red-300: #e57373;
      --paper-red-400: #ef5350;
      --paper-red-500: #f44336;
      --paper-red-600: #e53935;
      --paper-red-700: #d32f2f;
      --paper-red-800: #c62828;
      --paper-red-900: #b71c1c;
      --paper-red-a100: #ff8a80;
      --paper-red-a200: #ff5252;
      --paper-red-a400: #ff1744;
      --paper-red-a700: #d50000;

      --paper-pink-50: #fce4ec;
      --paper-pink-100: #f8bbd0;
      --paper-pink-200: #f48fb1;
      --paper-pink-300: #f06292;
      --paper-pink-400: #ec407a;
      --paper-pink-500: #e91e63;
      --paper-pink-600: #d81b60;
      --paper-pink-700: #c2185b;
      --paper-pink-800: #ad1457;
      --paper-pink-900: #880e4f;
      --paper-pink-a100: #ff80ab;
      --paper-pink-a200: #ff4081;
      --paper-pink-a400: #f50057;
      --paper-pink-a700: #c51162;

      --paper-purple-50: #f3e5f5;
      --paper-purple-100: #e1bee7;
      --paper-purple-200: #ce93d8;
      --paper-purple-300: #ba68c8;
      --paper-purple-400: #ab47bc;
      --paper-purple-500: #9c27b0;
      --paper-purple-600: #8e24aa;
      --paper-purple-700: #7b1fa2;
      --paper-purple-800: #6a1b9a;
      --paper-purple-900: #4a148c;
      --paper-purple-a100: #ea80fc;
      --paper-purple-a200: #e040fb;
      --paper-purple-a400: #d500f9;
      --paper-purple-a700: #aa00ff;

      --paper-deep-purple-50: #ede7f6;
      --paper-deep-purple-100: #d1c4e9;
      --paper-deep-purple-200: #b39ddb;
      --paper-deep-purple-300: #9575cd;
      --paper-deep-purple-400: #7e57c2;
      --paper-deep-purple-500: #673ab7;
      --paper-deep-purple-600: #5e35b1;
      --paper-deep-purple-700: #512da8;
      --paper-deep-purple-800: #4527a0;
      --paper-deep-purple-900: #311b92;
      --paper-deep-purple-a100: #b388ff;
      --paper-deep-purple-a200: #7c4dff;
      --paper-deep-purple-a400: #651fff;
      --paper-deep-purple-a700: #6200ea;

      --paper-indigo-50: #e8eaf6;
      --paper-indigo-100: #c5cae9;
      --paper-indigo-200: #9fa8da;
      --paper-indigo-300: #7986cb;
      --paper-indigo-400: #5c6bc0;
      --paper-indigo-500: #3f51b5;
      --paper-indigo-600: #3949ab;
      --paper-indigo-700: #303f9f;
      --paper-indigo-800: #283593;
      --paper-indigo-900: #1a237e;
      --paper-indigo-a100: #8c9eff;
      --paper-indigo-a200: #536dfe;
      --paper-indigo-a400: #3d5afe;
      --paper-indigo-a700: #304ffe;

      --paper-blue-50: #e3f2fd;
      --paper-blue-100: #bbdefb;
      --paper-blue-200: #90caf9;
      --paper-blue-300: #64b5f6;
      --paper-blue-400: #42a5f5;
      --paper-blue-500: #2196f3;
      --paper-blue-600: #1e88e5;
      --paper-blue-700: #1976d2;
      --paper-blue-800: #1565c0;
      --paper-blue-900: #0d47a1;
      --paper-blue-a100: #82b1ff;
      --paper-blue-a200: #448aff;
      --paper-blue-a400: #2979ff;
      --paper-blue-a700: #2962ff;

      --paper-light-blue-50: #e1f5fe;
      --paper-light-blue-100: #b3e5fc;
      --paper-light-blue-200: #81d4fa;
      --paper-light-blue-300: #4fc3f7;
      --paper-light-blue-400: #29b6f6;
      --paper-light-blue-500: #03a9f4;
      --paper-light-blue-600: #039be5;
      --paper-light-blue-700: #0288d1;
      --paper-light-blue-800: #0277bd;
      --paper-light-blue-900: #01579b;
      --paper-light-blue-a100: #80d8ff;
      --paper-light-blue-a200: #40c4ff;
      --paper-light-blue-a400: #00b0ff;
      --paper-light-blue-a700: #0091ea;

      --paper-cyan-50: #e0f7fa;
      --paper-cyan-100: #b2ebf2;
      --paper-cyan-200: #80deea;
      --paper-cyan-300: #4dd0e1;
      --paper-cyan-400: #26c6da;
      --paper-cyan-500: #00bcd4;
      --paper-cyan-600: #00acc1;
      --paper-cyan-700: #0097a7;
      --paper-cyan-800: #00838f;
      --paper-cyan-900: #006064;
      --paper-cyan-a100: #84ffff;
      --paper-cyan-a200: #18ffff;
      --paper-cyan-a400: #00e5ff;
      --paper-cyan-a700: #00b8d4;

      --paper-teal-50: #e0f2f1;
      --paper-teal-100: #b2dfdb;
      --paper-teal-200: #80cbc4;
      --paper-teal-300: #4db6ac;
      --paper-teal-400: #26a69a;
      --paper-teal-500: #009688;
      --paper-teal-600: #00897b;
      --paper-teal-700: #00796b;
      --paper-teal-800: #00695c;
      --paper-teal-900: #004d40;
      --paper-teal-a100: #a7ffeb;
      --paper-teal-a200: #64ffda;
      --paper-teal-a400: #1de9b6;
      --paper-teal-a700: #00bfa5;

      --paper-green-50: #e8f5e9;
      --paper-green-100: #c8e6c9;
      --paper-green-200: #a5d6a7;
      --paper-green-300: #81c784;
      --paper-green-400: #66bb6a;
      --paper-green-500: #4caf50;
      --paper-green-600: #43a047;
      --paper-green-700: #388e3c;
      --paper-green-800: #2e7d32;
      --paper-green-900: #1b5e20;
      --paper-green-a100: #b9f6ca;
      --paper-green-a200: #69f0ae;
      --paper-green-a400: #00e676;
      --paper-green-a700: #00c853;

      --paper-light-green-50: #f1f8e9;
      --paper-light-green-100: #dcedc8;
      --paper-light-green-200: #c5e1a5;
      --paper-light-green-300: #aed581;
      --paper-light-green-400: #9ccc65;
      --paper-light-green-500: #8bc34a;
      --paper-light-green-600: #7cb342;
      --paper-light-green-700: #689f38;
      --paper-light-green-800: #558b2f;
      --paper-light-green-900: #33691e;
      --paper-light-green-a100: #ccff90;
      --paper-light-green-a200: #b2ff59;
      --paper-light-green-a400: #76ff03;
      --paper-light-green-a700: #64dd17;

      --paper-lime-50: #f9fbe7;
      --paper-lime-100: #f0f4c3;
      --paper-lime-200: #e6ee9c;
      --paper-lime-300: #dce775;
      --paper-lime-400: #d4e157;
      --paper-lime-500: #cddc39;
      --paper-lime-600: #c0ca33;
      --paper-lime-700: #afb42b;
      --paper-lime-800: #9e9d24;
      --paper-lime-900: #827717;
      --paper-lime-a100: #f4ff81;
      --paper-lime-a200: #eeff41;
      --paper-lime-a400: #c6ff00;
      --paper-lime-a700: #aeea00;

      --paper-yellow-50: #fffde7;
      --paper-yellow-100: #fff9c4;
      --paper-yellow-200: #fff59d;
      --paper-yellow-300: #fff176;
      --paper-yellow-400: #ffee58;
      --paper-yellow-500: #ffeb3b;
      --paper-yellow-600: #fdd835;
      --paper-yellow-700: #fbc02d;
      --paper-yellow-800: #f9a825;
      --paper-yellow-900: #f57f17;
      --paper-yellow-a100: #ffff8d;
      --paper-yellow-a200: #ffff00;
      --paper-yellow-a400: #ffea00;
      --paper-yellow-a700: #ffd600;

      --paper-amber-50: #fff8e1;
      --paper-amber-100: #ffecb3;
      --paper-amber-200: #ffe082;
      --paper-amber-300: #ffd54f;
      --paper-amber-400: #ffca28;
      --paper-amber-500: #ffc107;
      --paper-amber-600: #ffb300;
      --paper-amber-700: #ffa000;
      --paper-amber-800: #ff8f00;
      --paper-amber-900: #ff6f00;
      --paper-amber-a100: #ffe57f;
      --paper-amber-a200: #ffd740;
      --paper-amber-a400: #ffc400;
      --paper-amber-a700: #ffab00;

      --paper-orange-50: #fff3e0;
      --paper-orange-100: #ffe0b2;
      --paper-orange-200: #ffcc80;
      --paper-orange-300: #ffb74d;
      --paper-orange-400: #ffa726;
      --paper-orange-500: #ff9800;
      --paper-orange-600: #fb8c00;
      --paper-orange-700: #f57c00;
      --paper-orange-800: #ef6c00;
      --paper-orange-900: #e65100;
      --paper-orange-a100: #ffd180;
      --paper-orange-a200: #ffab40;
      --paper-orange-a400: #ff9100;
      --paper-orange-a700: #ff6500;

      --paper-deep-orange-50: #fbe9e7;
      --paper-deep-orange-100: #ffccbc;
      --paper-deep-orange-200: #ffab91;
      --paper-deep-orange-300: #ff8a65;
      --paper-deep-orange-400: #ff7043;
      --paper-deep-orange-500: #ff5722;
      --paper-deep-orange-600: #f4511e;
      --paper-deep-orange-700: #e64a19;
      --paper-deep-orange-800: #d84315;
      --paper-deep-orange-900: #bf360c;
      --paper-deep-orange-a100: #ff9e80;
      --paper-deep-orange-a200: #ff6e40;
      --paper-deep-orange-a400: #ff3d00;
      --paper-deep-orange-a700: #dd2c00;

      --paper-brown-50: #efebe9;
      --paper-brown-100: #d7ccc8;
      --paper-brown-200: #bcaaa4;
      --paper-brown-300: #a1887f;
      --paper-brown-400: #8d6e63;
      --paper-brown-500: #795548;
      --paper-brown-600: #6d4c41;
      --paper-brown-700: #5d4037;
      --paper-brown-800: #4e342e;
      --paper-brown-900: #3e2723;

      --paper-grey-50: #fafafa;
      --paper-grey-100: #f5f5f5;
      --paper-grey-200: #eeeeee;
      --paper-grey-300: #e0e0e0;
      --paper-grey-400: #bdbdbd;
      --paper-grey-500: #9e9e9e;
      --paper-grey-600: #757575;
      --paper-grey-700: #616161;
      --paper-grey-800: #424242;
      --paper-grey-900: #212121;

      --paper-blue-grey-50: #eceff1;
      --paper-blue-grey-100: #cfd8dc;
      --paper-blue-grey-200: #b0bec5;
      --paper-blue-grey-300: #90a4ae;
      --paper-blue-grey-400: #78909c;
      --paper-blue-grey-500: #607d8b;
      --paper-blue-grey-600: #546e7a;
      --paper-blue-grey-700: #455a64;
      --paper-blue-grey-800: #37474f;
      --paper-blue-grey-900: #263238;

      /* opacity for dark text on a light background */
      --dark-divider-opacity: 0.12;
      --dark-disabled-opacity: 0.38; /* or hint text or icon */
      --dark-secondary-opacity: 0.54;
      --dark-primary-opacity: 0.87;

      /* opacity for light text on a dark background */
      --light-divider-opacity: 0.12;
      --light-disabled-opacity: 0.3; /* or hint text or icon */
      --light-secondary-opacity: 0.7;
      --light-primary-opacity: 1.0;

    }

  </style>
</custom-style>
`;hf.setAttribute("style","display: none;"),document.head.appendChild(hf.content);const pf=mi`
<custom-style>
  <style is="custom-style">
    html {
      /*
       * You can use these generic variables in your elements for easy theming.
       * For example, if all your elements use \`--primary-text-color\` as its main
       * color, then switching from a light to a dark theme is just a matter of
       * changing the value of \`--primary-text-color\` in your application.
       */
      --primary-text-color: var(--light-theme-text-color);
      --primary-background-color: var(--light-theme-background-color);
      --secondary-text-color: var(--light-theme-secondary-color);
      --disabled-text-color: var(--light-theme-disabled-color);
      --divider-color: var(--light-theme-divider-color);
      --error-color: var(--paper-deep-orange-a700);

      /*
       * Primary and accent colors. Also see color.js for more colors.
       */
      --primary-color: var(--paper-indigo-500);
      --light-primary-color: var(--paper-indigo-100);
      --dark-primary-color: var(--paper-indigo-700);

      --accent-color: var(--paper-pink-a200);
      --light-accent-color: var(--paper-pink-a100);
      --dark-accent-color: var(--paper-pink-a400);


      /*
       * Material Design Light background theme
       */
      --light-theme-background-color: #ffffff;
      --light-theme-base-color: #000000;
      --light-theme-text-color: var(--paper-grey-900);
      --light-theme-secondary-color: #737373;  /* for secondary text and icons */
      --light-theme-disabled-color: #9b9b9b;  /* disabled/hint text */
      --light-theme-divider-color: #dbdbdb;

      /*
       * Material Design Dark background theme
       */
      --dark-theme-background-color: var(--paper-grey-900);
      --dark-theme-base-color: #ffffff;
      --dark-theme-text-color: #ffffff;
      --dark-theme-secondary-color: #bcbcbc;  /* for secondary text and icons */
      --dark-theme-disabled-color: #646464;  /* disabled/hint text */
      --dark-theme-divider-color: #3c3c3c;

      /*
       * Deprecated values because of their confusing names.
       */
      --text-primary-color: var(--dark-theme-text-color);
      --default-primary-color: var(--primary-color);
    }
  </style>
</custom-style>`;if(pf.setAttribute("style","display: none;"),document.head.appendChild(pf.content),!window.polymerSkipLoadingFontRoboto){const e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.crossOrigin="anonymous",e.href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,300,300italic,400italic,500,500italic,700,700italic",document.head.appendChild(e)}const uf=mi`<custom-style>
  <style is="custom-style">
    html {

      /* Shared Styles */
      --paper-font-common-base: {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-code: {
        font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-expensive-kerning: {
        text-rendering: optimizeLegibility;
      };

      --paper-font-common-nowrap: {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      };

      /* Material Font Styles */

      --paper-font-display4: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 112px;
        font-weight: 300;
        letter-spacing: -.044em;
        line-height: 120px;
      };

      --paper-font-display3: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 56px;
        font-weight: 400;
        letter-spacing: -.026em;
        line-height: 60px;
      };

      --paper-font-display2: {
        @apply --paper-font-common-base;

        font-size: 45px;
        font-weight: 400;
        letter-spacing: -.018em;
        line-height: 48px;
      };

      --paper-font-display1: {
        @apply --paper-font-common-base;

        font-size: 34px;
        font-weight: 400;
        letter-spacing: -.01em;
        line-height: 40px;
      };

      --paper-font-headline: {
        @apply --paper-font-common-base;

        font-size: 24px;
        font-weight: 400;
        letter-spacing: -.012em;
        line-height: 32px;
      };

      --paper-font-title: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 20px;
        font-weight: 500;
        line-height: 28px;
      };

      --paper-font-subhead: {
        @apply --paper-font-common-base;

        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
      };

      --paper-font-body2: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-body1: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
      };

      --paper-font-caption: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.011em;
        line-height: 20px;
      };

      --paper-font-menu: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 13px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-button: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 14px;
        font-weight: 500;
        letter-spacing: 0.018em;
        line-height: 24px;
        text-transform: uppercase;
      };

      --paper-font-code2: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 700;
        line-height: 20px;
      };

      --paper-font-code1: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 500;
        line-height: 20px;
      };

    }

  </style>
</custom-style>`;uf.setAttribute("style","display: none;"),document.head.appendChild(uf.content);const gf=document.createElement("template");gf.setAttribute("style","display: none;"),gf.innerHTML="<dom-module id=\"paper-item-shared-styles\">\n  <template>\n    <style>\n      :host, .paper-item {\n        display: block;\n        position: relative;\n        min-height: var(--paper-item-min-height, 48px);\n        padding: 0px 16px;\n      }\n\n      .paper-item {\n        @apply --paper-font-subhead;\n        border:none;\n        outline: none;\n        background: white;\n        width: 100%;\n        text-align: left;\n      }\n\n      :host([hidden]), .paper-item[hidden] {\n        display: none !important;\n      }\n\n      :host(.iron-selected), .paper-item.iron-selected {\n        font-weight: var(--paper-item-selected-weight, bold);\n\n        @apply --paper-item-selected;\n      }\n\n      :host([disabled]), .paper-item[disabled] {\n        color: var(--paper-item-disabled-color, var(--disabled-text-color));\n\n        @apply --paper-item-disabled;\n      }\n\n      :host(:focus), .paper-item:focus {\n        position: relative;\n        outline: 0;\n\n        @apply --paper-item-focused;\n      }\n\n      :host(:focus):before, .paper-item:focus:before {\n        @apply --layout-fit;\n\n        background: currentColor;\n        content: '';\n        opacity: var(--dark-divider-opacity);\n        pointer-events: none;\n\n        @apply --paper-item-focused-before;\n      }\n    </style>\n  </template>\n</dom-module>",document.head.appendChild(gf.content);const mf={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_focusChanged(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_focusChanged:function(e){this._detectKeyboardFocus(e),e||this._setPressed(!1)},_detectKeyboardFocus:function(e){this._setReceivedFocusFromKeyboard(!this.pointerDown&&e)},_userActivate:function(e){this.active!==e&&(this.active=e,this.fire("change"))},_downHandler:function(e){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(e){var t=e.detail.keyboardEvent,i=Th(t).localTarget;this.isLightDescendant(i)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(e){var t=e.detail.keyboardEvent,i=Th(t).localTarget;this.isLightDescendant(i)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async((function(){this.click()}),1)},_pressedChanged:function(e){this._changedButtonState()},_ariaActiveAttributeChanged:function(e,t){t&&t!=e&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(e,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,e?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},ff=[qp,mf];zh({_template:mi`
    <style include="paper-item-shared-styles">
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
      }
    </style>
    <slot></slot>
`,is:"paper-item",behaviors:[[ff,lf,{hostAttributes:{role:"option",tabindex:"0"}}]]});class _f{constructor(e){this.selection=[],this.selectCallback=e}get(){return this.multi?this.selection.slice():this.selection[0]}clear(e){this.selection.slice().forEach((function(t){(!e||e.indexOf(t)<0)&&this.setItemSelected(t,!1)}),this)}isSelected(e){return this.selection.indexOf(e)>=0}setItemSelected(e,t){if(null!=e&&t!==this.isSelected(e)){if(t)this.selection.push(e);else{var i=this.selection.indexOf(e);i>=0&&this.selection.splice(i,1)}this.selectCallback&&this.selectCallback(e,t)}}select(e){this.multi?this.toggle(e):this.get()!==e&&(this.setItemSelected(this.get(),!1),this.setItemSelected(e,!0))}toggle(e){this.setItemSelected(e,!this.isSelected(e))}}const vf={properties:{attrForSelected:{type:String,value:null},selected:{type:String,notify:!0},selectedItem:{type:Object,readOnly:!0,notify:!0},activateEvent:{type:String,value:"tap",observer:"_activateEventChanged"},selectable:String,selectedClass:{type:String,value:"iron-selected"},selectedAttribute:{type:String,value:null},fallbackSelection:{type:String,value:null},items:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}},_excludedLocalNames:{type:Object,value:function(){return{template:1,"dom-bind":1,"dom-if":1,"dom-repeat":1}}}},observers:["_updateAttrForSelected(attrForSelected)","_updateSelected(selected)","_checkFallback(fallbackSelection)"],created:function(){this._bindFilterItem=this._filterItem.bind(this),this._selection=new _f(this._applySelection.bind(this))},attached:function(){this._observer=this._observeItems(this),this._addListener(this.activateEvent)},detached:function(){this._observer&&Th(this).unobserveNodes(this._observer),this._removeListener(this.activateEvent)},indexOf:function(e){return this.items?this.items.indexOf(e):-1},select:function(e){this.selected=e},selectPrevious:function(){var e=this.items.length,t=e-1;void 0!==this.selected&&(t=(Number(this._valueToIndex(this.selected))-1+e)%e),this.selected=this._indexToValue(t)},selectNext:function(){var e=0;void 0!==this.selected&&(e=(Number(this._valueToIndex(this.selected))+1)%this.items.length),this.selected=this._indexToValue(e)},selectIndex:function(e){this.select(this._indexToValue(e))},forceSynchronousItemUpdate:function(){this._observer&&"function"==typeof this._observer.flush?this._observer.flush():this._updateItems()},get _shouldUpdateSelection(){return null!=this.selected},_checkFallback:function(){this._updateSelected()},_addListener:function(e){this.listen(this,e,"_activateHandler")},_removeListener:function(e){this.unlisten(this,e,"_activateHandler")},_activateEventChanged:function(e,t){this._removeListener(t),this._addListener(e)},_updateItems:function(){var e=Th(this).queryDistributedElements(this.selectable||"*");e=Array.prototype.filter.call(e,this._bindFilterItem),this._setItems(e)},_updateAttrForSelected:function(){this.selectedItem&&(this.selected=this._valueForItem(this.selectedItem))},_updateSelected:function(){this._selectSelected(this.selected)},_selectSelected:function(e){if(this.items){var t=this._valueToItem(this.selected);t?this._selection.select(t):this._selection.clear(),this.fallbackSelection&&this.items.length&&void 0===this._selection.get()&&(this.selected=this.fallbackSelection)}},_filterItem:function(e){return!this._excludedLocalNames[e.localName]},_valueToItem:function(e){return null==e?null:this.items[this._valueToIndex(e)]},_valueToIndex:function(e){if(!this.attrForSelected)return Number(e);for(var t,i=0;t=this.items[i];i++)if(this._valueForItem(t)==e)return i},_indexToValue:function(e){if(!this.attrForSelected)return e;var t=this.items[e];return t?this._valueForItem(t):void 0},_valueForItem:function(e){if(!e)return null;if(!this.attrForSelected){var t=this.indexOf(e);return-1===t?null:t}var i=e[Je(this.attrForSelected)];return null!=i?i:e.getAttribute(this.attrForSelected)},_applySelection:function(e,t){this.selectedClass&&this.toggleClass(this.selectedClass,t,e),this.selectedAttribute&&this.toggleAttribute(this.selectedAttribute,t,e),this._selectionChange(),this.fire("iron-"+(t?"select":"deselect"),{item:e})},_selectionChange:function(){this._setSelectedItem(this._selection.get())},_observeItems:function(e){return Th(e).observeNodes((function(e){this._updateItems(),this._updateSelected(),this.fire("iron-items-changed",e,{bubbles:!1,cancelable:!1})}))},_activateHandler:function(e){for(var t=e.target,i=this.items;t&&t!=this;){var n=i.indexOf(t);if(n>=0){var o=this._indexToValue(n);return void this._itemActivate(o,t)}t=t.parentNode}},_itemActivate:function(e,t){this.fire("iron-activate",{selected:e,item:t},{cancelable:!0}).defaultPrevented||this.select(e)}},yf={properties:{multi:{type:Boolean,value:!1,observer:"multiChanged"},selectedValues:{type:Array,notify:!0,value:function(){return[]}},selectedItems:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}}},observers:["_updateSelected(selectedValues.splices)"],select:function(e){this.multi?this._toggleSelected(e):this.selected=e},multiChanged:function(e){this._selection.multi=e,this._updateSelected()},get _shouldUpdateSelection(){return null!=this.selected||null!=this.selectedValues&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this.selectedItems&&this.selectedItems.length>0&&(this.selectedValues=this.selectedItems.map((function(e){return this._indexToValue(this.indexOf(e))}),this).filter((function(e){return null!=e}),this)):vf._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(e){e=e||[];var t=(this._valuesToItems(e)||[]).filter((function(e){return null!=e}));this._selection.clear(t);for(var i=0;i<t.length;i++)this._selection.setItemSelected(t[i],!0);this.fallbackSelection&&!this._selection.get().length&&(this._valueToItem(this.fallbackSelection)&&this.select(this.fallbackSelection))},_selectionChange:function(){var e=this._selection.get();this.multi?(this._setSelectedItems(e),this._setSelectedItem(e.length?e[0]:null)):null!=e?(this._setSelectedItems([e]),this._setSelectedItem(e)):(this._setSelectedItems([]),this._setSelectedItem(null))},_toggleSelected:function(e){var t=this.selectedValues.indexOf(e);t<0?this.push("selectedValues",e):this.splice("selectedValues",t,1)},_valuesToItems:function(e){return null==e?null:e.map((function(e){return this._valueToItem(e)}),this)}},bf=[vf,yf],wf={properties:{focusedItem:{observer:"_focusedItemChanged",readOnly:!0,type:Object},attrForItemTitle:{type:String},disabled:{type:Boolean,value:!1,observer:"_disabledChanged"}},_MODIFIER_KEYS:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","OS","ScrollLock","Shift","Super","Symbol","SymbolLock"],_SEARCH_RESET_TIMEOUT_MS:1e3,_previousTabIndex:0,hostAttributes:{role:"menu"},observers:["_updateMultiselectable(multi)"],listeners:{focus:"_onFocus",keydown:"_onKeydown","iron-items-changed":"_onIronItemsChanged"},keyBindings:{up:"_onUpKey",down:"_onDownKey",esc:"_onEscKey","shift+tab:keydown":"_onShiftTabDown"},attached:function(){this._resetTabindices()},select:function(e){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var t=this._valueToItem(e);t&&t.hasAttribute("disabled")||(this._setFocusedItem(t),yf.select.apply(this,arguments))},_resetTabindices:function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach((function(t){t.setAttribute("tabindex",t===e?"0":"-1"),t.setAttribute("aria-selected",this._selection.isSelected(t))}),this)},_updateMultiselectable:function(e){e?this.setAttribute("aria-multiselectable","true"):this.removeAttribute("aria-multiselectable")},_focusWithKeyboardEvent:function(e){if(-1===this._MODIFIER_KEYS.indexOf(e.key)){this.cancelDebouncer("_clearSearchText");for(var t,i=this._searchText||"",n=(i+=(e.key&&1==e.key.length?e.key:String.fromCharCode(e.keyCode)).toLocaleLowerCase()).length,o=0;t=this.items[o];o++)if(!t.hasAttribute("disabled")){var r=this.attrForItemTitle||"textContent",s=(t[r]||t.getAttribute(r)||"").trim();if(!(s.length<n)&&s.slice(0,n).toLocaleLowerCase()==i){this._setFocusedItem(t);break}}this._searchText=i,this.debounce("_clearSearchText",this._clearSearchText,this._SEARCH_RESET_TIMEOUT_MS)}},_clearSearchText:function(){this._searchText=""},_focusPrevious:function(){for(var e=this.items.length,t=Number(this.indexOf(this.focusedItem)),i=1;i<e+1;i++){var n=this.items[(t-i+e)%e];if(!n.hasAttribute("disabled")){var o=Th(n).getOwnerRoot()||document;if(this._setFocusedItem(n),Th(o).activeElement==n)return}}},_focusNext:function(){for(var e=this.items.length,t=Number(this.indexOf(this.focusedItem)),i=1;i<e+1;i++){var n=this.items[(t+i)%e];if(!n.hasAttribute("disabled")){var o=Th(n).getOwnerRoot()||document;if(this._setFocusedItem(n),Th(o).activeElement==n)return}}},_applySelection:function(e,t){t?e.setAttribute("aria-selected","true"):e.setAttribute("aria-selected","false"),vf._applySelection.apply(this,arguments)},_focusedItemChanged:function(e,t){t&&t.setAttribute("tabindex","-1"),!e||e.hasAttribute("disabled")||this.disabled||(e.setAttribute("tabindex","0"),e.focus())},_onIronItemsChanged:function(e){e.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");wf._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute("tabindex","-1"),this.async((function(){this.setAttribute("tabindex",t),wf._shiftTabPressed=!1}),1)},_onFocus:function(e){if(!wf._shiftTabPressed){var t=Th(e).rootTarget;(t===this||void 0===t.tabIndex||this.isLightDescendant(t))&&(this._defaultFocusAsync=this.async((function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),e?this._setFocusedItem(e):this.items[0]&&this._focusNext()})))}},_onUpKey:function(e){this._focusPrevious(),e.detail.keyboardEvent.preventDefault()},_onDownKey:function(e){this._focusNext(),e.detail.keyboardEvent.preventDefault()},_onEscKey:function(e){var t=this.focusedItem;t&&t.blur()},_onKeydown:function(e){this.keyboardEventMatchesKeys(e,"up down esc")||this._focusWithKeyboardEvent(e),e.stopPropagation()},_activateHandler:function(e){vf._activateHandler.call(this,e),e.stopPropagation()},_disabledChanged:function(e){e?(this._previousTabIndex=this.hasAttribute("tabindex")?this.tabIndex:0,this.removeAttribute("tabindex")):this.hasAttribute("tabindex")||this.setAttribute("tabindex",this._previousTabIndex)},_shiftTabPressed:!1},Cf=[bf,qp,wf];zh({_template:mi`
    <style>
      :host {
        display: block;
        padding: 8px 0;

        background: var(--paper-listbox-background-color, var(--primary-background-color));
        color: var(--paper-listbox-color, var(--primary-text-color));

        @apply --paper-listbox;
      }
    </style>

    <slot></slot>
`,is:"paper-listbox",behaviors:[Cf],hostAttributes:{role:"listbox"}});const Sf=mi`
<custom-style>
  <style is="custom-style">
    html {

      --shadow-transition: {
        transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
      };

      --shadow-none: {
        box-shadow: none;
      };

      /* from http://codepen.io/shyndman/pen/c5394ddf2e8b2a5c9185904b57421cdb */

      --shadow-elevation-2dp: {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                    0 1px 5px 0 rgba(0, 0, 0, 0.12),
                    0 3px 1px -2px rgba(0, 0, 0, 0.2);
      };

      --shadow-elevation-3dp: {
        box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                    0 1px 8px 0 rgba(0, 0, 0, 0.12),
                    0 3px 3px -2px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-4dp: {
        box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                    0 1px 10px 0 rgba(0, 0, 0, 0.12),
                    0 2px 4px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-6dp: {
        box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),
                    0 1px 18px 0 rgba(0, 0, 0, 0.12),
                    0 3px 5px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-8dp: {
        box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),
                    0 3px 14px 2px rgba(0, 0, 0, 0.12),
                    0 5px 5px -3px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-12dp: {
        box-shadow: 0 12px 16px 1px rgba(0, 0, 0, 0.14),
                    0 4px 22px 3px rgba(0, 0, 0, 0.12),
                    0 6px 7px -4px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-16dp: {
        box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                    0  6px 30px 5px rgba(0, 0, 0, 0.12),
                    0  8px 10px -5px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-24dp: {
        box-shadow: 0 24px 38px 3px rgba(0, 0, 0, 0.14),
                    0 9px 46px 8px rgba(0, 0, 0, 0.12),
                    0 11px 15px -7px rgba(0, 0, 0, 0.4);
      };
    }
  </style>
</custom-style>`;Sf.setAttribute("style","display: none;"),document.head.appendChild(Sf.content);const Ef=mi`
<dom-module id="paper-material-styles">
  <template>
    <style>
      html {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      .paper-material {
        @apply --paper-material;
      }
      .paper-material[elevation="1"] {
        @apply --paper-material-elevation-1;
      }
      .paper-material[elevation="2"] {
        @apply --paper-material-elevation-2;
      }
      .paper-material[elevation="3"] {
        @apply --paper-material-elevation-3;
      }
      .paper-material[elevation="4"] {
        @apply --paper-material-elevation-4;
      }
      .paper-material[elevation="5"] {
        @apply --paper-material-elevation-5;
      }

      /* Duplicate the styles because of https://github.com/webcomponents/shadycss/issues/193 */
      :host {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      :host(.paper-material) {
        @apply --paper-material;
      }
      :host(.paper-material[elevation="1"]) {
        @apply --paper-material-elevation-1;
      }
      :host(.paper-material[elevation="2"]) {
        @apply --paper-material-elevation-2;
      }
      :host(.paper-material[elevation="3"]) {
        @apply --paper-material-elevation-3;
      }
      :host(.paper-material[elevation="4"]) {
        @apply --paper-material-elevation-4;
      }
      :host(.paper-material[elevation="5"]) {
        @apply --paper-material-elevation-5;
      }
    </style>
  </template>
</dom-module>`;Ef.setAttribute("style","display: none;"),document.head.appendChild(Ef.content);var Af={distance:function(e,t,i,n){var o=e-i,r=t-n;return Math.sqrt(o*o+r*r)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};function xf(e){this.element=e,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}function Rf(e){this.element=e,this.color=window.getComputedStyle(e).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),Th(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}xf.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(e,t){var i=Af.distance(e,t,0,0),n=Af.distance(e,t,this.width,0),o=Af.distance(e,t,0,this.height),r=Af.distance(e,t,this.width,this.height);return Math.max(i,n,o,r)}},Rf.MAX_RADIUS=300,Rf.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var e;return this.mouseDownStart?(e=Af.now()-this.mouseDownStart,this.mouseUpStart&&(e-=this.mouseUpElapsed),e):0},get mouseUpElapsed(){return this.mouseUpStart?Af.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var e=this.containerMetrics.width*this.containerMetrics.width,t=this.containerMetrics.height*this.containerMetrics.height,i=1.1*Math.min(Math.sqrt(e+t),Rf.MAX_RADIUS)+5,n=1.1-i/Rf.MAX_RADIUS*.2,o=this.mouseInteractionSeconds/n,r=i*(1-Math.pow(80,-o));return Math.abs(r)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var e=.3*this.mouseUpElapsedSeconds,t=this.opacity;return Math.max(0,Math.min(e,t))},get isOpacityFullyDecayed(){return this.opacity<.01&&this.radius>=Math.min(this.maxRadius,Rf.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,Rf.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new xf(this.element)},draw:function(){var e,t,i;this.wave.style.opacity=this.opacity,e=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,i=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+i+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+i+"px, 0)",this.wave.style.webkitTransform="scale("+e+","+e+")",this.wave.style.transform="scale3d("+e+","+e+",1)"},downAction:function(e){var t=this.containerMetrics.width/2,i=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=Af.now(),this.center?(this.xStart=t,this.yStart=i,this.slideDistance=Af.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=e?e.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=e?e.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=i,this.slideDistance=Af.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(e){this.isMouseDown&&(this.mouseUpStart=Af.now())},remove:function(){Th(Th(this.waveContainer).parentNode).removeChild(this.waveContainer)}},zh({_template:mi`
    <style>
      :host {
        display: block;
        position: absolute;
        border-radius: inherit;
        overflow: hidden;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        /* See PolymerElements/paper-behaviors/issues/34. On non-Chrome browsers,
         * creating a node (with a position:absolute) in the middle of an event
         * handler "interrupts" that event handler (which happens when the
         * ripple is created on demand) */
        pointer-events: none;
      }

      :host([animating]) {
        /* This resolves a rendering issue in Chrome (as of 40) where the
           ripple is not properly clipped by its parent (which may have
           rounded corners). See: http://jsbin.com/temexa/4

           Note: We only apply this style conditionally. Otherwise, the browser
           will create a new compositing layer for every ripple element on the
           page, and that would be bad. */
        -webkit-transform: translate(0, 0);
        transform: translate3d(0, 0, 0);
      }

      #background,
      #waves,
      .wave-container,
      .wave {
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #background,
      .wave {
        opacity: 0;
      }

      #waves,
      .wave {
        overflow: hidden;
      }

      .wave-container,
      .wave {
        border-radius: 50%;
      }

      :host(.circle) #background,
      :host(.circle) #waves {
        border-radius: 50%;
      }

      :host(.circle) .wave-container {
        overflow: hidden;
      }
    </style>

    <div id="background"></div>
    <div id="waves"></div>
`,is:"paper-ripple",behaviors:[qp],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){11==Th(this).parentNode.nodeType?this.keyEventTarget=Th(this).getOwnerRoot().host:this.keyEventTarget=Th(this).parentNode;var e=this.keyEventTarget;this.listen(e,"up","uiUpAction"),this.listen(e,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var e=0;e<this.ripples.length;++e)if(!this.ripples[e].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async((function(){this.upAction()}),1)},uiDownAction:function(e){this.noink||this.downAction(e)},downAction:function(e){this.holdDown&&this.ripples.length>0||(this.addRipple().downAction(e),this._animating||(this._animating=!0,this.animate()))},uiUpAction:function(e){this.noink||this.upAction(e)},upAction:function(e){this.holdDown||(this.ripples.forEach((function(t){t.upAction(e)})),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor="",this.fire("transitionend")},addRipple:function(){var e=new Rf(this);return Th(this.$.waves).appendChild(e.waveContainer),this.$.background.style.backgroundColor=e.color,this.ripples.push(e),this._setAnimating(!0),e},removeRipple:function(e){var t=this.ripples.indexOf(e);t<0||(this.ripples.splice(t,1),e.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(this._animating){var e,t;for(e=0;e<this.ripples.length;++e)(t=this.ripples[e]).draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);this.shouldKeepAnimating||0!==this.ripples.length?window.requestAnimationFrame(this._boundAnimate):this.onAnimationComplete()}},animateRipple:function(){return this.animate()},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(e,t){void 0!==t&&(e?this.downAction():this.upAction())}});const Tf={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(e){mf._downHandler.call(this,e),this.pressed&&this.ensureRipple(e)},ensureRipple:function(e){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&Th(t).appendChild(this._ripple),e){var i=Th(this._rippleContainer||this),n=Th(e).rootTarget;i.deepContains(n)&&this._ripple.uiDownAction(e)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return Boolean(this._ripple)},_createRipple:function(){return document.createElement("paper-ripple")},_noinkChanged:function(e){this.hasRipple()&&(this._ripple.noink=e)}},kf={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var e=1;this.disabled?e=0:this.active||this.pressed?e=4:this.receivedFocusFromKeyboard&&(e=3),this._setElevation(e)},_computeKeyboardClass:function(e){this.toggleClass("keyboard-focus",e)},_spaceKeyDownHandler:function(e){mf._spaceKeyDownHandler.call(this,e),this.hasRipple()&&this.getRipple().ripples.length<1&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(e){mf._spaceKeyUpHandler.call(this,e),this.hasRipple()&&this._ripple.uiUpAction()}},Pf=[ff,lf,Tf,kf],If=mi`
  <style include="paper-material-styles">
    /* Need to specify the same specificity as the styles imported from paper-material. */
    :host {
      @apply --layout-inline;
      @apply --layout-center-center;
      position: relative;
      box-sizing: border-box;
      min-width: 5.14em;
      margin: 0 0.29em;
      background: transparent;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      -webkit-tap-highlight-color: transparent;
      font: inherit;
      text-transform: uppercase;
      outline-width: 0;
      border-radius: 3px;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      z-index: 0;
      padding: 0.7em 0.57em;

      @apply --paper-font-common-base;
      @apply --paper-button;
    }

    :host([elevation="1"]) {
      @apply --paper-material-elevation-1;
    }

    :host([elevation="2"]) {
      @apply --paper-material-elevation-2;
    }

    :host([elevation="3"]) {
      @apply --paper-material-elevation-3;
    }

    :host([elevation="4"]) {
      @apply --paper-material-elevation-4;
    }

    :host([elevation="5"]) {
      @apply --paper-material-elevation-5;
    }

    :host([hidden]) {
      display: none !important;
    }

    :host([raised].keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-raised-keyboard-focus;
    }

    :host(:not([raised]).keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-flat-keyboard-focus;
    }

    :host([disabled]) {
      background: none;
      color: #a8a8a8;
      cursor: auto;
      pointer-events: none;

      @apply --paper-button-disabled;
    }

    :host([disabled][raised]) {
      background: #eaeaea;
    }


    :host([animated]) {
      @apply --shadow-transition;
    }

    paper-ripple {
      color: var(--paper-button-ink-color);
    }
  </style>

  <slot></slot>`;If.setAttribute("strip-whitespace",""),zh({_template:If,is:"paper-button",behaviors:[Pf],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?kf._calculateElevation.apply(this):this._setElevation(0)}});const Of=mi`
  <style>
    /* general styles for all buttons */
    :host {
      --background-color: var(
        --button-background-color,
        var(--default-button-background-color)
      );
      --text-color: var(--default-button-text-color);
      display: inline-block;
      position: relative;
    }
    :host([hidden]) {
      display: none;
    }
    :host([no-uppercase]) paper-button {
      text-transform: none;
    }
    paper-button {
      /* The next lines contains a copy of paper-button style.
          Without a copy, the @apply works incorrectly with Polymer 2.
          @apply is deprecated and is not recommended to use. It is expected
          that @apply will be replaced with the ::part CSS pseudo-element.
          After replacement copied lines can be removed.
        */
      @apply --layout-inline;
      @apply --layout-center-center;
      position: relative;
      box-sizing: border-box;
      min-width: 5.14em;
      margin: 0 0.29em;
      background: transparent;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      -webkit-tap-highlight-color: transparent;
      font: inherit;
      text-transform: uppercase;
      outline-width: 0;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      border-bottom-right-radius: var(--border-radius);
      border-bottom-left-radius: var(--border-radius);
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      z-index: 0;
      padding: var(--spacing-m);

      @apply --paper-font-common-base;
      @apply --paper-button;
      /* End of copy*/

      /* paper-button sets this to anti-aliased, which appears different than
          bold font elsewhere on macOS. */
      -webkit-font-smoothing: initial;
      align-items: center;
      background-color: var(--background-color);
      color: var(--text-color);
      display: flex;
      font-family: inherit;
      justify-content: center;
      margin: var(--margin, 0);
      min-width: var(--border, 0);
      padding: var(--padding, 4px 8px);
      @apply --gr-button;
    }
    /* https://github.com/PolymerElements/paper-button/blob/2.x/paper-button.html */
    /* BEGIN: Copy from paper-button */
    paper-button[elevation='1'] {
      @apply --paper-material-elevation-1;
    }
    paper-button[elevation='2'] {
      @apply --paper-material-elevation-2;
    }
    paper-button[elevation='3'] {
      @apply --paper-material-elevation-3;
    }
    paper-button[elevation='4'] {
      @apply --paper-material-elevation-4;
    }
    paper-button[elevation='5'] {
      @apply --paper-material-elevation-5;
    }
    /* END: Copy from paper-button */
    paper-button:hover {
      background: linear-gradient(rgba(0, 0, 0, 0.12), rgba(0, 0, 0, 0.12)),
        var(--background-color);
    }

    /* Some mobile browsers treat focused element as hovered element.
      As a result, element remains hovered after click (has grey background in default theme).
      Use @media (hover:none) to remove background if
      user's primary input mechanism can't hover over elements.
      See: https://developer.mozilla.org/en-US/docs/Web/CSS/@media/hover

      Note 1: not all browsers support this media query
      (see https://caniuse.com/#feat=css-media-interaction).
      If browser doesn't support it, then the whole content of @media .. is ignored.
      This is why the default behavior is placed outside of @media.
      */
    @media (hover: none) {
      paper-button:hover {
        background: transparent;
      }
    }

    :host([primary]) {
      --background-color: var(--primary-button-background-color);
      --text-color: var(--primary-button-text-color);
    }
    :host([link][primary]) {
      --text-color: var(--primary-button-background-color);
    }

    /* Keep below color definition for primary so that this takes precedence
        when disabled. */
    :host([disabled]),
    :host([loading]) {
      --background-color: var(--disabled-button-background-color);
      --text-color: var(--deemphasized-text-color);
      cursor: default;
    }

    /* Styles for link buttons specifically */
    :host([link]) {
      --background-color: transparent;
      --margin: 0;
      --padding: var(--spacing-s);
    }
    :host([disabled][link]),
    :host([loading][link]) {
      --background-color: transparent;
      --text-color: var(--deemphasized-text-color);
      cursor: default;
    }

    /* Styles for the optional down arrow */
    :host(:not([down-arrow])) .downArrow {
      display: none;
    }
    :host([down-arrow]) .downArrow {
      border-top: 0.36em solid #ccc;
      border-left: 0.36em solid transparent;
      border-right: 0.36em solid transparent;
      margin-bottom: var(--spacing-xxs);
      margin-left: var(--spacing-m);
      transition: border-top-color 200ms;
    }
    :host([down-arrow]) paper-button:hover .downArrow {
      border-top-color: var(--deemphasized-text-color);
    }
  </style>
  <paper-button raised="[[!link]]" disabled="[[_disabled]]" tabindex="-1">
    <template is="dom-if" if="[[loading]]">
      <span class="loadingSpin"></span>
    </template>
    <slot></slot>
    <i class="downArrow"></i>
  </paper-button>
`,Nf=mi`
  <style include="shared-styles">
    :host {
      --gr-tooltip-arrow-size: 0.5em;
      --gr-tooltip-arrow-center-offset: 0;

      background-color: var(--tooltip-background-color);
      box-shadow: var(--elevation-level-2);
      color: var(--tooltip-text-color);
      font-size: var(--font-size-small);
      position: absolute;
      z-index: 1000;
      max-width: var(--tooltip-max-width);
    }
    :host .tooltip {
      padding: var(--spacing-m) var(--spacing-l);
    }
    :host .arrowPositionBelow,
    :host([position-below]) .arrowPositionAbove {
      display: none;
    }
    :host([position-below]) .arrowPositionBelow {
      display: initial;
    }
    .arrow {
      border-left: var(--gr-tooltip-arrow-size) solid transparent;
      border-right: var(--gr-tooltip-arrow-size) solid transparent;
      height: 0;
      position: absolute;
      left: calc(50% - var(--gr-tooltip-arrow-size));
      margin-left: var(--gr-tooltip-arrow-center-offset);
      width: 0;
    }
    .arrowPositionAbove {
      border-top: var(--gr-tooltip-arrow-size) solid
        var(--tooltip-background-color);
      bottom: calc(-1 * var(--gr-tooltip-arrow-size));
    }
    .arrowPositionBelow {
      border-bottom: var(--gr-tooltip-arrow-size) solid
        var(--tooltip-background-color);
      top: calc(-1 * var(--gr-tooltip-arrow-size));
    }
  </style>
  <div class="tooltip">
    <i class="arrowPositionBelow arrow"></i>
    [[text]]
    <i class="arrowPositionAbove arrow"></i>
  </div>
`;var Lf=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Df=class extends fi{constructor(){super(...arguments),this.text="",this.maxWidth="",this.positionBelow=!1}static get template(){return Nf}_updateWidth(e){this.updateStyles({"--tooltip-max-width":e})}};Lf([Oo({type:String})],Df.prototype,"text",void 0),Lf([Oo({type:String})],Df.prototype,"maxWidth",void 0),Lf([Oo({type:Boolean,reflectToAttribute:!0})],Df.prototype,"positionBelow",void 0),Lf([No("maxWidth")],Df.prototype,"_updateWidth",null),Df=Lf([Po("gr-tooltip")],Df);var Mf=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Ff=ye(e=>{class t extends e{constructor(...e){super(),this.hasTooltip=!1,this.positionBelow=!1,this._isTouchDevice="ontouchstart"in document.documentElement,this._tooltip=null,this._titleText="",this._hasSetupTooltipListeners=!1,this.windowScrollHandler=()=>this._handleWindowScroll(),this.showHandler=()=>this._handleShowTooltip(),this.hideHandler=()=>this._handleHideTooltip()}disconnectedCallback(){this._handleHideTooltip(),this.mouseenterHandler&&this.removeEventListener("mouseenter",this.mouseenterHandler),window.removeEventListener("scroll",this.windowScrollHandler),super.disconnectedCallback()}_setupTooltipListeners(){if(this.mouseenterHandler||(this.mouseenterHandler=this.showHandler),!this.hasTooltip)return this.removeEventListener("mouseenter",this.mouseenterHandler),void(this._hasSetupTooltipListeners=!1);this._hasSetupTooltipListeners||(this._hasSetupTooltipListeners=!0,this.addEventListener("mouseenter",this.mouseenterHandler))}_handleShowTooltip(){if(this._isTouchDevice)return;if(!this.hasAttribute("title")||""===this.getAttribute("title")||this._tooltip)return;this._titleText=this.getAttribute("title")||"",this.setAttribute("title","");const e=document.createElement("gr-tooltip");e.text=this._titleText,e.maxWidth=this.getAttribute("max-width")||"",e.positionBelow=this.hasAttribute("position-below"),e.style.visibility="hidden",yu().appendChild(e),this._positionTooltip(e),e.style.visibility="initial",this._tooltip=e,window.addEventListener("scroll",this.windowScrollHandler),this.addEventListener("mouseleave",this.hideHandler),this.addEventListener("click",this.hideHandler)}_handleHideTooltip(){var e;this._isTouchDevice||this.hasAttribute("title")&&this._titleText&&(window.removeEventListener("scroll",this.windowScrollHandler),this.removeEventListener("mouseleave",this.hideHandler),this.removeEventListener("click",this.hideHandler),this.setAttribute("title",this._titleText),(null===(e=this._tooltip)||void 0===e?void 0:e.parentNode)&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null)}_handleWindowScroll(){this._tooltip&&this._positionTooltip(this._tooltip)}_positionTooltip(e){yh();const t=this.getBoundingClientRect(),i=e.getBoundingClientRect();if(!e.parentElement)return;const n=e.parentElement.getBoundingClientRect(),o=t.top-n.top,r=t.left-n.left+(t.width-i.width)/2,s=n.width-r-i.width;r<0?e.updateStyles({"--gr-tooltip-arrow-center-offset":`${r}px`}):s<0&&e.updateStyles({"--gr-tooltip-arrow-center-offset":`${-.5*s}px`}),e.style.left=`${Math.max(0,r)}px`,this.positionBelow?e.style.top=`${o+t.height+7.2}px`:(e.style.top=`${Math.max(0,o)}px`,e.style.transform="translateY(calc(-100% - 7.2px))")}}return Mf([Oo({type:Boolean})],t.prototype,"hasTooltip",void 0),Mf([Oo({type:Boolean,reflectToAttribute:!0})],t.prototype,"positionBelow",void 0),Mf([Oo({type:Boolean})],t.prototype,"_isTouchDevice",void 0),Mf([Oo({type:Object})],t.prototype,"_tooltip",void 0),Mf([Oo({type:String})],t.prototype,"_titleText",void 0),Mf([Oo({type:Boolean})],t.prototype,"_hasSetupTooltipListeners",void 0),Mf([No("hasTooltip")],t.prototype,"_setupTooltipListeners",null),t});var $f,Bf=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.DOC_ONLY="DOC_ONLY",e.GO_KEY="GO_KEY",e.V_KEY="V_KEY"}($f||($f={}));var jf,Hf;!function(e){e.ACTIONS="Actions",e.DIFFS="Diffs",e.EVERYWHERE="Global Shortcuts",e.FILE_LIST="File list",e.NAVIGATION="Navigation",e.REPLY_DIALOG="Reply dialog"}(jf||(jf={})),function(e){e.OPEN_SHORTCUT_HELP_DIALOG="OPEN_SHORTCUT_HELP_DIALOG",e.GO_TO_USER_DASHBOARD="GO_TO_USER_DASHBOARD",e.GO_TO_OPENED_CHANGES="GO_TO_OPENED_CHANGES",e.GO_TO_MERGED_CHANGES="GO_TO_MERGED_CHANGES",e.GO_TO_ABANDONED_CHANGES="GO_TO_ABANDONED_CHANGES",e.GO_TO_WATCHED_CHANGES="GO_TO_WATCHED_CHANGES",e.CURSOR_NEXT_CHANGE="CURSOR_NEXT_CHANGE",e.CURSOR_PREV_CHANGE="CURSOR_PREV_CHANGE",e.OPEN_CHANGE="OPEN_CHANGE",e.NEXT_PAGE="NEXT_PAGE",e.PREV_PAGE="PREV_PAGE",e.TOGGLE_CHANGE_REVIEWED="TOGGLE_CHANGE_REVIEWED",e.TOGGLE_CHANGE_STAR="TOGGLE_CHANGE_STAR",e.REFRESH_CHANGE_LIST="REFRESH_CHANGE_LIST",e.OPEN_REPLY_DIALOG="OPEN_REPLY_DIALOG",e.OPEN_DOWNLOAD_DIALOG="OPEN_DOWNLOAD_DIALOG",e.EXPAND_ALL_MESSAGES="EXPAND_ALL_MESSAGES",e.COLLAPSE_ALL_MESSAGES="COLLAPSE_ALL_MESSAGES",e.UP_TO_DASHBOARD="UP_TO_DASHBOARD",e.UP_TO_CHANGE="UP_TO_CHANGE",e.TOGGLE_DIFF_MODE="TOGGLE_DIFF_MODE",e.REFRESH_CHANGE="REFRESH_CHANGE",e.EDIT_TOPIC="EDIT_TOPIC",e.DIFF_AGAINST_BASE="DIFF_AGAINST_BASE",e.DIFF_AGAINST_LATEST="DIFF_AGAINST_LATEST",e.DIFF_BASE_AGAINST_LEFT="DIFF_BASE_AGAINST_LEFT",e.DIFF_RIGHT_AGAINST_LATEST="DIFF_RIGHT_AGAINST_LATEST",e.DIFF_BASE_AGAINST_LATEST="DIFF_BASE_AGAINST_LATEST",e.NEXT_LINE="NEXT_LINE",e.PREV_LINE="PREV_LINE",e.VISIBLE_LINE="VISIBLE_LINE",e.NEXT_CHUNK="NEXT_CHUNK",e.PREV_CHUNK="PREV_CHUNK",e.TOGGLE_ALL_DIFF_CONTEXT="TOGGLE_ALL_DIFF_CONTEXT",e.NEXT_COMMENT_THREAD="NEXT_COMMENT_THREAD",e.PREV_COMMENT_THREAD="PREV_COMMENT_THREAD",e.EXPAND_ALL_COMMENT_THREADS="EXPAND_ALL_COMMENT_THREADS",e.COLLAPSE_ALL_COMMENT_THREADS="COLLAPSE_ALL_COMMENT_THREADS",e.LEFT_PANE="LEFT_PANE",e.RIGHT_PANE="RIGHT_PANE",e.TOGGLE_LEFT_PANE="TOGGLE_LEFT_PANE",e.NEW_COMMENT="NEW_COMMENT",e.SAVE_COMMENT="SAVE_COMMENT",e.OPEN_DIFF_PREFS="OPEN_DIFF_PREFS",e.TOGGLE_DIFF_REVIEWED="TOGGLE_DIFF_REVIEWED",e.NEXT_FILE="NEXT_FILE",e.PREV_FILE="PREV_FILE",e.NEXT_FILE_WITH_COMMENTS="NEXT_FILE_WITH_COMMENTS",e.PREV_FILE_WITH_COMMENTS="PREV_FILE_WITH_COMMENTS",e.NEXT_UNREVIEWED_FILE="NEXT_UNREVIEWED_FILE",e.CURSOR_NEXT_FILE="CURSOR_NEXT_FILE",e.CURSOR_PREV_FILE="CURSOR_PREV_FILE",e.OPEN_FILE="OPEN_FILE",e.TOGGLE_FILE_REVIEWED="TOGGLE_FILE_REVIEWED",e.TOGGLE_ALL_INLINE_DIFFS="TOGGLE_ALL_INLINE_DIFFS",e.TOGGLE_INLINE_DIFF="TOGGLE_INLINE_DIFF",e.TOGGLE_HIDE_ALL_COMMENT_THREADS="TOGGLE_HIDE_ALL_COMMENT_THREADS",e.OPEN_FILE_LIST="OPEN_FILE_LIST",e.OPEN_FIRST_FILE="OPEN_FIRST_FILE",e.OPEN_LAST_FILE="OPEN_LAST_FILE",e.SEARCH="SEARCH",e.SEND_REPLY="SEND_REPLY",e.EMOJI_DROPDOWN="EMOJI_DROPDOWN",e.TOGGLE_BLAME="TOGGLE_BLAME"}(Hf||(Hf={}));const Uf=new Map;function Gf(e,t,i){Uf.has(t)||Uf.set(t,[]);const n=Uf.get(t);n&&n.push({shortcut:e,text:i})}function zf(e){const t=Th(e.detail?e.detail.keyboardEvent:e);return"event"in t&&t.event?t.event:t}Gf(Hf.SEARCH,jf.EVERYWHERE,"Search"),Gf(Hf.OPEN_SHORTCUT_HELP_DIALOG,jf.EVERYWHERE,"Show this dialog"),Gf(Hf.GO_TO_USER_DASHBOARD,jf.EVERYWHERE,"Go to User Dashboard"),Gf(Hf.GO_TO_OPENED_CHANGES,jf.EVERYWHERE,"Go to Opened Changes"),Gf(Hf.GO_TO_MERGED_CHANGES,jf.EVERYWHERE,"Go to Merged Changes"),Gf(Hf.GO_TO_ABANDONED_CHANGES,jf.EVERYWHERE,"Go to Abandoned Changes"),Gf(Hf.GO_TO_WATCHED_CHANGES,jf.EVERYWHERE,"Go to Watched Changes"),Gf(Hf.CURSOR_NEXT_CHANGE,jf.ACTIONS,"Select next change"),Gf(Hf.CURSOR_PREV_CHANGE,jf.ACTIONS,"Select previous change"),Gf(Hf.OPEN_CHANGE,jf.ACTIONS,"Show selected change"),Gf(Hf.NEXT_PAGE,jf.ACTIONS,"Go to next page"),Gf(Hf.PREV_PAGE,jf.ACTIONS,"Go to previous page"),Gf(Hf.OPEN_REPLY_DIALOG,jf.ACTIONS,"Open reply dialog to publish comments and add reviewers"),Gf(Hf.OPEN_DOWNLOAD_DIALOG,jf.ACTIONS,"Open download overlay"),Gf(Hf.EXPAND_ALL_MESSAGES,jf.ACTIONS,"Expand all messages"),Gf(Hf.COLLAPSE_ALL_MESSAGES,jf.ACTIONS,"Collapse all messages"),Gf(Hf.REFRESH_CHANGE,jf.ACTIONS,"Reload the change at the latest patch"),Gf(Hf.TOGGLE_CHANGE_REVIEWED,jf.ACTIONS,"Mark/unmark change as reviewed"),Gf(Hf.TOGGLE_FILE_REVIEWED,jf.ACTIONS,"Toggle review flag on selected file"),Gf(Hf.REFRESH_CHANGE_LIST,jf.ACTIONS,"Refresh list of changes"),Gf(Hf.TOGGLE_CHANGE_STAR,jf.ACTIONS,"Star/unstar change"),Gf(Hf.EDIT_TOPIC,jf.ACTIONS,"Add a change topic"),Gf(Hf.DIFF_AGAINST_BASE,jf.ACTIONS,"Diff against base"),Gf(Hf.DIFF_AGAINST_LATEST,jf.ACTIONS,"Diff against latest patchset"),Gf(Hf.DIFF_BASE_AGAINST_LEFT,jf.ACTIONS,"Diff base against left"),Gf(Hf.DIFF_RIGHT_AGAINST_LATEST,jf.ACTIONS,"Diff right against latest"),Gf(Hf.DIFF_BASE_AGAINST_LATEST,jf.ACTIONS,"Diff base against latest"),Gf(Hf.NEXT_LINE,jf.DIFFS,"Go to next line"),Gf(Hf.PREV_LINE,jf.DIFFS,"Go to previous line"),Gf(Hf.DIFF_AGAINST_BASE,jf.DIFFS,"Diff against base"),Gf(Hf.DIFF_AGAINST_LATEST,jf.DIFFS,"Diff against latest patchset"),Gf(Hf.DIFF_BASE_AGAINST_LEFT,jf.DIFFS,"Diff base against left"),Gf(Hf.DIFF_RIGHT_AGAINST_LATEST,jf.DIFFS,"Diff right against latest"),Gf(Hf.DIFF_BASE_AGAINST_LATEST,jf.DIFFS,"Diff base against latest"),Gf(Hf.VISIBLE_LINE,jf.DIFFS,"Move cursor to currently visible code"),Gf(Hf.NEXT_CHUNK,jf.DIFFS,"Go to next diff chunk"),Gf(Hf.PREV_CHUNK,jf.DIFFS,"Go to previous diff chunk"),Gf(Hf.TOGGLE_ALL_DIFF_CONTEXT,jf.DIFFS,"Toggle all diff context"),Gf(Hf.NEXT_COMMENT_THREAD,jf.DIFFS,"Go to next comment thread"),Gf(Hf.PREV_COMMENT_THREAD,jf.DIFFS,"Go to previous comment thread"),Gf(Hf.EXPAND_ALL_COMMENT_THREADS,jf.DIFFS,"Expand all comment threads"),Gf(Hf.COLLAPSE_ALL_COMMENT_THREADS,jf.DIFFS,"Collapse all comment threads"),Gf(Hf.TOGGLE_HIDE_ALL_COMMENT_THREADS,jf.DIFFS,"Hide/Display all comment threads"),Gf(Hf.LEFT_PANE,jf.DIFFS,"Select left pane"),Gf(Hf.RIGHT_PANE,jf.DIFFS,"Select right pane"),Gf(Hf.TOGGLE_LEFT_PANE,jf.DIFFS,"Hide/show left diff"),Gf(Hf.NEW_COMMENT,jf.DIFFS,"Draft new comment"),Gf(Hf.SAVE_COMMENT,jf.DIFFS,"Save comment"),Gf(Hf.OPEN_DIFF_PREFS,jf.DIFFS,"Show diff preferences"),Gf(Hf.TOGGLE_DIFF_REVIEWED,jf.DIFFS,"Mark/unmark file as reviewed"),Gf(Hf.TOGGLE_DIFF_MODE,jf.DIFFS,"Toggle unified/side-by-side diff"),Gf(Hf.NEXT_UNREVIEWED_FILE,jf.DIFFS,"Mark file as reviewed and go to next unreviewed file"),Gf(Hf.TOGGLE_BLAME,jf.DIFFS,"Toggle blame"),Gf(Hf.NEXT_FILE,jf.NAVIGATION,"Go to next file"),Gf(Hf.PREV_FILE,jf.NAVIGATION,"Go to previous file"),Gf(Hf.NEXT_FILE_WITH_COMMENTS,jf.NAVIGATION,"Go to next file that has comments"),Gf(Hf.PREV_FILE_WITH_COMMENTS,jf.NAVIGATION,"Go to previous file that has comments"),Gf(Hf.OPEN_FIRST_FILE,jf.NAVIGATION,"Go to first file"),Gf(Hf.OPEN_LAST_FILE,jf.NAVIGATION,"Go to last file"),Gf(Hf.UP_TO_DASHBOARD,jf.NAVIGATION,"Up to dashboard"),Gf(Hf.UP_TO_CHANGE,jf.NAVIGATION,"Up to change"),Gf(Hf.CURSOR_NEXT_FILE,jf.FILE_LIST,"Select next file"),Gf(Hf.CURSOR_PREV_FILE,jf.FILE_LIST,"Select previous file"),Gf(Hf.OPEN_FILE,jf.FILE_LIST,"Go to selected file"),Gf(Hf.TOGGLE_ALL_INLINE_DIFFS,jf.FILE_LIST,"Show/hide all inline diffs"),Gf(Hf.TOGGLE_HIDE_ALL_COMMENT_THREADS,jf.FILE_LIST,"Hide/Display all comment threads"),Gf(Hf.TOGGLE_INLINE_DIFF,jf.FILE_LIST,"Show/hide selected inline diff"),Gf(Hf.SEND_REPLY,jf.REPLY_DIALOG,"Send reply"),Gf(Hf.EMOJI_DROPDOWN,jf.REPLY_DIALOG,"Emoji dropdown");const Vf=new class{constructor(){this.activeHosts=new Map,this.bindings=new Map,this.listeners=new Set}_testOnly_getBindings(){return this.bindings}_testOnly_isEmpty(){return 0===this.activeHosts.size&&0===this.listeners.size}bindShortcut(e,...t){this.bindings.set(e,t)}getBindingsForShortcut(e){return this.bindings.get(e)}attachHost(e){if(!("keyboardShortcuts"in e))return;const t=e.keyboardShortcuts();return this.activeHosts.set(e,new Map(Object.entries(t))),this.notifyListeners(),t}detachHost(e){return!!this.activeHosts.delete(e)&&(this.notifyListeners(),!0)}addListener(e){this.listeners.add(e),e(this.directoryView())}removeListener(e){return this.listeners.delete(e)}getDescription(e,t){const i=Uf.get(e);let n="";if(i){const e=i.find(e=>e.shortcut===t);n=e?e.text:""}return n}getShortcut(e){const t=this.bindings.get(e);return t?t.map(e=>this.describeBinding(e).join("+")).join(","):""}activeShortcutsBySection(){const e=new Set;this.activeHosts.forEach(t=>{t.forEach((t,i)=>e.add(i))});const t=new Map;return Uf.forEach((i,n)=>{i.forEach(i=>{e.has(i.shortcut)&&(t.has(n)||t.set(n,[]),t.get(n).push(i))})}),t}directoryView(){const e=new Map;return this.activeShortcutsBySection().forEach((t,i)=>{const n=[];t.forEach(e=>{const t=this.describeBindings(e.shortcut);t&&this.distributeBindingDesc(t).forEach(t=>{n.push({binding:t,text:e.text})})}),e.set(i,n)}),e}distributeBindingDesc(e){if(1===e.length||this.comboSetDisplayWidth(e)<21)return[e];const t=[e[0]];for(let i=1;i<e.length;i++)if(t.push(e[i]),this.comboSetDisplayWidth(t)>=21)return t.pop(),[t].concat(this.distributeBindingDesc(e.slice(i)));return[]}comboSetDisplayWidth(e){return e.reduce((e,t)=>e+(e=>e.reduce((e,t)=>e+t.length,0))(t),0)+2*(e.length-1)}describeBindings(e){const t=this.bindings.get(e);return t?t[0]===$f.GO_KEY?t.slice(1).map(e=>this._describeKey(e)).map(e=>["g"].concat(e)):t[0]===$f.V_KEY?t.slice(1).map(e=>this._describeKey(e)).map(e=>["v"].concat(e)):t.filter(e=>e!==$f.DOC_ONLY).map(e=>this.describeBinding(e)):null}_describeKey(e){switch(e){case"shift":return"Shift";case"meta":return"Meta";case"ctrl":return"Ctrl";case"enter":return"Enter";case"up":return"";case"down":return"";case"left":return"";case"right":return"";default:return e}}describeBinding(e){return 1===e.length?[e]:e.split(":")[0].split("+").map(e=>this._describeKey(e))}notifyListeners(){const e=this.directoryView();this.listeners.forEach(t=>t(e))}};var Wf;!function(e){e.SHIFT_KEY="shiftKey",e.CTRL_KEY="ctrlKey",e.META_KEY="metaKey"}(Wf||(Wf={}));const qf=ye(e=>{class t extends e{constructor(){super(...arguments),this._shortcut_go_key_last_pressed=null,this._shortcut_v_key_last_pressed=null,this._shortcut_go_table=new Map,this._shortcut_v_table=new Map,this.Shortcut=Hf,this.ShortcutSection=jf}modifierPressed(e){const t=zf(e);return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||!!this._inGoKeyMode()||!!this.inVKeyMode()}isModifierPressed(e,t){return zf(e)[t]}shouldSuppressKeyboardShortcut(e){const t=zf(e),i=Th(t).rootTarget,n=i.tagName,o=i.getAttribute("type");if("INPUT"===n&&"checkbox"!==o||"TEXTAREA"===n||13===t.keyCode&&("A"===n||"BUTTON"===n))return!0;for(let e=0;t.path&&e<t.path.length;e++)if("GR-OVERLAY"===t.path[e].tagName)return!0;const r={event:t,goKey:this._inGoKeyMode(),vKey:this.inVKeyMode()};return this.dispatchEvent(new CustomEvent("shortcut-triggered",{detail:r,composed:!0,bubbles:!0})),!1}getKeyboardEvent(e){return zf(e)}getRootTarget(e){return Th(zf(e)).rootTarget}bindShortcut(e,...t){Vf.bindShortcut(e,...t)}createTitle(e,t){const i=Vf.getDescription(t,e),n=Vf.getShortcut(e);return i&&n?`${i} (shortcut: ${n})`:""}_throttleWrap(e){let t;return i=>{void 0!==t&&Date.now()-t<500||(t=Date.now(),e(i))}}_addOwnKeyBindings(e,t){const i=Vf.getBindingsForShortcut(e);i&&i[0]!==$f.DOC_ONLY&&(i[0]===$f.GO_KEY?i.slice(1).forEach(e=>this._shortcut_go_table.set(e,t)):i[0]===$f.V_KEY?i.slice(1).forEach(e=>this._shortcut_v_table.set(e,t)):this.addOwnKeyBinding(i.join(" "),t))}connectedCallback(){super.connectedCallback();const e=Vf.attachHost(this);if(e){for(const t of Object.keys(e))this._addOwnKeyBindings(t,e[t]);this.addOwnKeyBinding("g:keydown","_handleGoKeyDown"),this.addOwnKeyBinding("g:keyup","_handleGoKeyUp"),this._shortcut_go_table.size>0&&this._shortcut_go_table.forEach((e,t)=>{this.addOwnKeyBinding(t,"_handleGoAction")}),this.addOwnKeyBinding("v:keydown","_handleVKeyDown"),this.addOwnKeyBinding("v:keyup","_handleVKeyUp"),this._shortcut_v_table.size>0&&this._shortcut_v_table.forEach((e,t)=>{this.addOwnKeyBinding(t,"_handleVAction")})}}disconnectedCallback(){Vf.detachHost(this)&&this.removeOwnKeyBindings(),super.disconnectedCallback()}keyboardShortcuts(){return{}}addKeyboardShortcutDirectoryListener(e){Vf.addListener(e)}removeKeyboardShortcutDirectoryListener(e){Vf.removeListener(e)}_handleVKeyDown(e){this.shouldSuppressKeyboardShortcut(e)||(this._shortcut_v_key_last_pressed=Date.now())}_handleVKeyUp(){setTimeout(()=>{this._shortcut_v_key_last_pressed=null},1e3)}inVKeyMode(){return!!(this._shortcut_v_key_last_pressed&&Date.now()-this._shortcut_v_key_last_pressed<=1e3)}_handleVAction(e){if(!this.inVKeyMode()||!this._shortcut_v_table.has(e.detail.key)||this.shouldSuppressKeyboardShortcut(e))return;e.preventDefault();const t=this._shortcut_v_table.get(e.detail.key);t&&this[t](e)}_handleGoKeyDown(e){this.shouldSuppressKeyboardShortcut(e)||(this._shortcut_go_key_last_pressed=Date.now())}_handleGoKeyUp(){setTimeout(()=>{this._shortcut_go_key_last_pressed=null},1e3)}_inGoKeyMode(){return!!(this._shortcut_go_key_last_pressed&&Date.now()-this._shortcut_go_key_last_pressed<=1e3)}_handleGoAction(e){if(!this._inGoKeyMode()||!this._shortcut_go_table.has(e.detail.key)||this.shouldSuppressKeyboardShortcut(e))return;e.preventDefault();const t=this._shortcut_go_table.get(e.detail.key);t&&this[t](e)}}return Bf([Oo({type:Number})],t.prototype,"_shortcut_go_key_last_pressed",void 0),Bf([Oo({type:Number})],t.prototype,"_shortcut_v_key_last_pressed",void 0),Bf([Oo({type:Object})],t.prototype,"_shortcut_go_table",void 0),Bf([Oo({type:Object})],t.prototype,"_shortcut_v_table",void 0),t}),Kf=e=>qf($h([qp],e));var Yf=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Xf=class extends(Kf(Ff(fi))){constructor(){super(),this.downArrow=!1,this.link=!1,this.noUppercase=!1,this.loading=!1,this.disabled=null,this.tooltip="",this.reporting=i.reportingService,this._initialTabindex=this.getAttribute("tabindex")||"0",this.addEventListener("click",e=>this._handleAction(e)),this.addEventListener("keydown",e=>this._handleKeydown(e))}static get template(){return Of}get _disabled(){return this.disabled||this.loading}computeAriaDisabled(){return this._disabled}ready(){super.ready(),this._ensureAttribute("role","button"),this._ensureAttribute("tabindex","0")}_handleAction(e){if(this._disabled)return e.preventDefault(),e.stopPropagation(),void e.stopImmediatePropagation();this.reporting.reportInteraction("button-click",{path:pu(e)})}_disabledChanged(e){this.setAttribute("tabindex",e?"-1":this._initialTabindex||"0"),this.updateStyles()}_handleKeydown(e){this.modifierPressed(e)||13!==(e=this.getKeyboardEvent(e)).keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.click())}};Yf([Oo({type:Boolean,reflectToAttribute:!0})],Xf.prototype,"downArrow",void 0),Yf([Oo({type:Boolean,reflectToAttribute:!0})],Xf.prototype,"link",void 0),Yf([Oo({type:Boolean})],Xf.prototype,"noUppercase",void 0),Yf([Oo({type:Boolean,reflectToAttribute:!0})],Xf.prototype,"loading",void 0),Yf([Oo({type:Boolean,reflectToAttribute:!0})],Xf.prototype,"disabled",void 0),Yf([Oo({type:String})],Xf.prototype,"tooltip",void 0),Yf([Oo({type:String})],Xf.prototype,"_initialTabindex",void 0),Yf([Lo("disabled","loading")],Xf.prototype,"_disabled",null),Yf([Oo({computed:"computeAriaDisabled(disabled, loading)",reflectToAttribute:!0,type:Boolean})],Xf.prototype,"ariaDisabled",void 0),Yf([No("disabled")],Xf.prototype,"_disabledChanged",null),Xf=Yf([Po("gr-button")],Xf);const Jf=mi`
  <style>
    :host {
      color: inherit;
      display: inline;
    }
  </style>
  <span>
    [[_computeDateStr(dateStr, _timeFormat, _dateFormat, _relative,
    showDateAndTime, showYesterday)]]
  </span>
`;var Zf=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Qf="h:mm A",e_="h:mm:ss A",t_="HH:mm",i_="HH:mm:ss",n_={short:"MMM DD",full:"MMM DD, YYYY"},o_={short:"MM/DD",full:"MM/DD/YY"},r_={short:"MM-DD",full:"YYYY-MM-DD"},s_={short:"DD. MMM",full:"DD.MM.YYYY"},a_={short:"DD/MM",full:"DD/MM/YYYY"};let l_=class extends(Ff(fi)){constructor(){super(),this.dateStr=null,this.showDateAndTime=!1,this.hasTooltip=!1,this.showYesterday=!1,this.title="",this._relative=!1,this.forceRelative=!1,this.relativeOptionNoAgo=!1,this.restApiService=i.restApiService}static get template(){return Jf}connectedCallback(){super.connectedCallback(),this._loadPreferences()}_getUtcOffsetString(){return function(){const e=-(new Date).getTimezoneOffset(),t=e=>{const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t.toString()};return` UTC${e>=0?"+":"-"}${t(e/60)}:${t(e%60)}`}()}_loadPreferences(){return this._getLoggedIn().then(e=>e?Promise.all([this._loadTimeFormat(),this._loadRelative()]):(this._timeFormat=t_,this._dateFormat=n_,void(this._relative=this.forceRelative)))}_loadTimeFormat(){return this._getPreferences().then(e=>{if(!e)throw Error("Preferences is not set");this._decideTimeFormat(e.time_format),this._decideDateFormat(e.date_format)})}_decideTimeFormat(e){switch(e){case yn.HHMM_12:this._timeFormat=Qf;break;case yn.HHMM_24:this._timeFormat=t_;break;default:r(e,`Invalid time format: ${e}`)}}_decideDateFormat(e){switch(e){case vn.STD:this._dateFormat=n_;break;case vn.US:this._dateFormat=o_;break;case vn.ISO:this._dateFormat=r_;break;case vn.EURO:this._dateFormat=s_;break;case vn.UK:this._dateFormat=a_;break;default:r(e,`Invalid date format: ${e}`)}}_loadRelative(){return this._getPreferences().then(e=>{this._relative=this.forceRelative||!(!e||!e.relative_date_in_change_table)})}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getPreferences(){return this.restApiService.getPreferences()}_computeDateStr(e,t,i,n,o,r){if(!e||!t||!i)return"";const s=Fi(e);if(!$i(s))return"";if(n)return Bi(s,this.relativeOptionNoAgo);const a=new Date;let l=i.full;if(Hi(a,s))l=t;else{if(r&&function(e,t){return e.valueOf()-t.valueOf()<Mi&&t.getDay()!==e.getDay()||(e.setDate(e.getDate()-1),Hi(e,t))}(a,s))return`Yesterday at ${Ui(s,t)}`;(function(e,t){return e.valueOf()-t.valueOf()<180*Mi})(a,s)&&(l=i.short),(this.showDateAndTime||o)&&(l=`${l} ${t}`)}return Ui(s,l)}_timeToSecondsFormat(e){return e===Qf?e_:i_}_computeFullDateStr(e,t,i){if([e,t].includes(void 0)||!i)return;if(!e)return"";const n=Fi(e);if(!$i(n))return"";let o=i.full+", ";return o+=this._timeToSecondsFormat(t),Ui(n,o)+this._getUtcOffsetString()}};Zf([Oo({type:String,notify:!0})],l_.prototype,"dateStr",void 0),Zf([Oo({type:Boolean})],l_.prototype,"showDateAndTime",void 0),Zf([Oo({type:Boolean})],l_.prototype,"hasTooltip",void 0),Zf([Oo({type:Boolean})],l_.prototype,"showYesterday",void 0),Zf([Oo({type:String,reflectToAttribute:!0,computed:"_computeFullDateStr(dateStr, _timeFormat, _dateFormat)"})],l_.prototype,"title",void 0),Zf([Oo({type:Object})],l_.prototype,"_dateFormat",void 0),Zf([Oo({type:String})],l_.prototype,"_timeFormat",void 0),Zf([Oo({type:Boolean})],l_.prototype,"_relative",void 0),Zf([Oo({type:Boolean})],l_.prototype,"forceRelative",void 0),Zf([Oo({type:Boolean})],l_.prototype,"relativeOptionNoAgo",void 0),l_=Zf([Po("gr-date-formatter")],l_);var c_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let d_=class extends fi{constructor(){super(),this.addEventListener("change",()=>this._valueChanged()),this.addEventListener("dom-change",()=>this._updateValue())}static get template(){return mi` <slot></slot> `}get nativeSelect(){return this.querySelector("select")}_updateValue(){void 0!==this.bindValue&&(this.nativeSelect.value=this.bindValue,setTimeout(()=>{this.nativeSelect.value=this.bindValue},1))}_valueChanged(){this.bindValue=this.nativeSelect.value}focus(){this.nativeSelect.focus()}ready(){super.ready(),void 0===this.bindValue&&this.nativeSelect.options.length>0&&(this.bindValue=this.nativeSelect.value)}};c_([Oo({type:String,notify:!0})],d_.prototype,"bindValue",void 0),c_([No("bindValue")],d_.prototype,"_updateValue",null),d_=c_([Po("gr-select")],d_);const h_=mi`
  <style include="shared-styles">
    .status {
      display: inline-block;
      border-radius: var(--border-radius);
      margin-left: var(--spacing-s);
      padding: 0 var(--spacing-m);
      color: var(--primary-text-color);
      font-size: var(--font-size-small);
      background-color: var(--file-status-added);
    }
    .status.invisible,
    .status.M {
      display: none;
    }
    .status.D,
    .status.R,
    .status.W {
      background-color: var(--file-status-changed);
    }
    .status.U {
      background-color: var(--file-status-unchanged);
    }
  </style>
  <span
    class$="[[_computeStatusClass(file)]]"
    tabindex="0"
    title$="[[_computeFileStatusLabel(file.status)]]"
    aria-label$="[[_computeFileStatusLabel(file.status)]]"
  >
    [[_computeFileStatusLabel(file.status)]]
  </span>
`;var p_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const u_={A:"Added",C:"Copied",D:"Deleted",M:"Modified",R:"Renamed",W:"Rewritten",U:"Unchanged"};let g_=class extends fi{static get template(){return h_}_computeFileStatusLabel(e){const t=this._computeFileStatus(e);return o(u_,t)?u_[t]:"Status Unknown"}_computeClass(e,t){const i=[];return e&&i.push(e),t!==Zi.COMMIT_MESSAGE&&t!==Zi.MERGE_LIST||i.push("invisible"),i.join(" ")}_computeFileStatus(e){return e||"M"}_computeStatusClass(e){if(!e)return"";return`${this._computeClass("status",e.__path)} ${this._computeFileStatus(e.status)}`}};p_([Oo({type:Object})],g_.prototype,"file",void 0),g_=p_([Po("gr-file-status-chip")],g_);const m_=mi`
  <style include="shared-styles">
    :host {
      display: inline-block;
    }
    #triggerText {
      -moz-user-select: text;
      -ms-user-select: text;
      -webkit-user-select: text;
      user-select: text;
    }
    .dropdown-trigger {
      cursor: pointer;
      padding: 0;
    }
    .dropdown-content {
      background-color: var(--dropdown-background-color);
      box-shadow: var(--elevation-level-2);
      max-height: 70vh;
      min-width: 266px;
    }
    paper-listbox {
      --paper-listbox: {
        padding: 0;
      }
    }
    paper-item {
      cursor: pointer;
      flex-direction: column;
      font-size: inherit;
      /* This variable was introduced in Dec 2019. We keep both min-height
         * rules around, because --paper-item-min-height is not yet upstreamed.
         */
      --paper-item-min-height: 0;
      --paper-item: {
        min-height: 0;
        padding: 10px 16px;
      }
      --paper-item-focused-before: {
        background-color: var(--selection-background-color);
      }
      --paper-item-focused: {
        background-color: var(--selection-background-color);
      }
    }
    paper-item:hover {
      background-color: var(--hover-background-color);
    }
    paper-item:not(:last-of-type) {
      border-bottom: 1px solid var(--border-color);
    }
    .bottomContent {
      color: var(--deemphasized-text-color);
    }
    .bottomContent,
    .topContent {
      display: flex;
      justify-content: space-between;
      flex-direction: row;
      width: 100%;
    }
    gr-button {
      --gr-button: {
        @apply --trigger-style;
      }
    }
    gr-date-formatter {
      color: var(--deemphasized-text-color);
      margin-left: var(--spacing-xxl);
      white-space: nowrap;
    }
    gr-select {
      display: none;
    }
    /* Because the iron dropdown 'area' includes the trigger, and the entire
       width of the dropdown, we want to treat tapping the area above the
       dropdown content as if it is tapping whatever content is underneath it.
       The next two styles allow this to happen. */
    iron-dropdown {
      max-width: none;
      pointer-events: none;
    }
    paper-listbox {
      pointer-events: auto;
    }
    @media only screen and (max-width: 50em) {
      gr-select {
        display: inline;
        @apply --gr-select-style;
      }
      gr-button,
      iron-dropdown {
        display: none;
      }
      select {
        @apply --native-select-style;
      }
    }
  </style>
  <gr-button
    disabled="[[disabled]]"
    down-arrow=""
    link=""
    id="trigger"
    class="dropdown-trigger"
    on-click="_showDropdownTapHandler"
    slot="dropdown-trigger"
  >
    <span id="triggerText">[[text]]</span>
    <gr-copy-clipboard
      hidden="[[!showCopyForTriggerText]]"
      hide-input=""
      text="[[text]]"
    ></gr-copy-clipboard>
  </gr-button>
  <iron-dropdown
    id="dropdown"
    vertical-align="top"
    horizontal-align="left"
    dynamic-align
    no-overlap
    allow-outside-scroll="true"
    on-click="_handleDropdownClick"
  >
    <paper-listbox
      class="dropdown-content"
      slot="dropdown-content"
      attr-for-selected="data-value"
      selected="{{value}}"
    >
      <template
        is="dom-repeat"
        items="[[items]]"
        initial-count="[[initialCount]]"
      >
        <paper-item disabled="[[item.disabled]]" data-value$="[[item.value]]">
          <div class="topContent">
            <div>[[item.text]]</div>
            <template is="dom-if" if="[[item.date]]">
              <gr-date-formatter date-str="[[item.date]]"></gr-date-formatter>
            </template>
            <template is="dom-if" if="[[item.file]]">
              <gr-file-status-chip file="[[item.file]]"></gr-file-status-chip>
            </template>
          </div>
          <template is="dom-if" if="[[item.bottomText]]">
            <div class="bottomContent">
              <div>[[item.bottomText]]</div>
            </div>
          </template>
        </paper-item>
      </template>
    </paper-listbox>
  </iron-dropdown>
  <gr-select bind-value="{{value}}">
    <select>
      <template is="dom-repeat" items="[[items]]">
        <option disabled$="[[item.disabled]]" value="[[item.value]]">
          [[_computeMobileText(item)]]
        </option>
      </template>
    </select>
  </gr-select>
`;var f_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let __=class extends fi{constructor(){super(...arguments),this.initialCount=75,this.disabled=!1,this.showCopyForTriggerText=!1}static get template(){return m_}_handleDropdownClick(){setTimeout(()=>{this.$.dropdown.close()},1)}_showDropdownTapHandler(){this.open()}open(){this.$.dropdown.open()}_computeMobileText(e){return e.mobileText?e.mobileText:e.text}_handleValueChange(e,t){if(!e||!t)return;const i=t.find(t=>`${t.value}`===`${e}`);if(!i)return;this.text=i.triggerText?i.triggerText:i.text;const n={value:e};this.dispatchEvent(new CustomEvent("value-change",{detail:n,bubbles:!1}))}};f_([Oo({type:Number})],__.prototype,"initialCount",void 0),f_([Oo({type:Object})],__.prototype,"items",void 0),f_([Oo({type:String})],__.prototype,"text",void 0),f_([Oo({type:Boolean})],__.prototype,"disabled",void 0),f_([Oo({type:String,notify:!0})],__.prototype,"value",void 0),f_([Oo({type:Boolean})],__.prototype,"showCopyForTriggerText",void 0),f_([No("value","items")],__.prototype,"_handleValueChange",null),__=f_([Po("gr-dropdown-list")],__);class v_{constructor(e){v_[" "](e),this.type=e&&e.type||"default",this.key=e&&e.key,e&&"value"in e&&(this.value=e.value)}get value(){var e=this.type,t=this.key;if(e&&t)return v_.types[e]&&v_.types[e][t]}set value(e){var t=this.type,i=this.key;t&&i&&(t=v_.types[t]=v_.types[t]||{},null==e?delete t[i]:t[i]=e)}get list(){if(this.type){var e=v_.types[this.type];return e?Object.keys(e).map((function(e){return y_[this.type][e]}),this):[]}}byKey(e){return this.key=e,this.value}}v_[" "]=function(){},v_.types={};var y_=v_.types;zh({is:"iron-meta",properties:{type:{type:String,value:"default"},key:{type:String},value:{type:String,notify:!0},self:{type:Boolean,observer:"_selfChanged"},__meta:{type:Boolean,computed:"__computeMeta(type, key, value)"}},hostAttributes:{hidden:!0},__computeMeta:function(e,t,i){var n=new v_({type:e,key:t});return void 0!==i&&i!==n.value?n.value=i:this.value!==n.value&&(this.value=n.value),n},get list(){return this.__meta&&this.__meta.list},_selfChanged:function(e){e&&(this.value=this)},byKey:function(e){return new v_({type:this.type,key:e}).value}}),zh({_template:mi`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center-center;
        position: relative;

        vertical-align: middle;

        fill: var(--iron-icon-fill-color, currentcolor);
        stroke: var(--iron-icon-stroke-color, none);

        width: var(--iron-icon-width, 24px);
        height: var(--iron-icon-height, 24px);
        @apply --iron-icon;
      }

      :host([hidden]) {
        display: none;
      }
    </style>
`,is:"iron-icon",properties:{icon:{type:String},theme:{type:String},src:{type:String},_meta:{value:Rp.create("iron-meta",{type:"iconset"})}},observers:["_updateIcon(_meta, isAttached)","_updateIcon(theme, isAttached)","_srcChanged(src, isAttached)","_iconChanged(icon, isAttached)"],_DEFAULT_ICONSET:"icons",_iconChanged:function(e){var t=(e||"").split(":");this._iconName=t.pop(),this._iconsetName=t.pop()||this._DEFAULT_ICONSET,this._updateIcon()},_srcChanged:function(e){this._updateIcon()},_usesIconset:function(){return this.icon||!this.src},_updateIcon:function(){this._usesIconset()?(this._img&&this._img.parentNode&&Th(this.root).removeChild(this._img),""===this._iconName?this._iconset&&this._iconset.removeIcon(this):this._iconsetName&&this._meta&&(this._iconset=this._meta.byKey(this._iconsetName),this._iconset?(this._iconset.applyIcon(this,this._iconName,this.theme),this.unlisten(window,"iron-iconset-added","_updateIcon")):this.listen(window,"iron-iconset-added","_updateIcon"))):(this._iconset&&this._iconset.removeIcon(this),this._img||(this._img=document.createElement("img"),this._img.style.width="100%",this._img.style.height="100%",this._img.draggable=!1),this._img.src=this.src,Th(this.root).appendChild(this._img))}}),zh({is:"iron-iconset-svg",properties:{name:{type:String,observer:"_nameChanged"},size:{type:Number,value:24},rtlMirroring:{type:Boolean,value:!1},useGlobalRtlAttribute:{type:Boolean,value:!1}},created:function(){this._meta=new v_({type:"iconset",key:null,value:null})},attached:function(){this.style.display="none"},getIconNames:function(){return this._icons=this._createIconMap(),Object.keys(this._icons).map((function(e){return this.name+":"+e}),this)},applyIcon:function(e,t){this.removeIcon(e);var i=this._cloneIcon(t,this.rtlMirroring&&this._targetIsRTL(e));if(i){var n=Th(e.root||e);return n.insertBefore(i,n.childNodes[0]),e._svgIcon=i}return null},removeIcon:function(e){e._svgIcon&&(Th(e.root||e).removeChild(e._svgIcon),e._svgIcon=null)},_targetIsRTL:function(e){if(null==this.__targetIsRTL)if(this.useGlobalRtlAttribute){var t=document.body&&document.body.hasAttribute("dir")?document.body:document.documentElement;this.__targetIsRTL="rtl"===t.getAttribute("dir")}else e&&e.nodeType!==Node.ELEMENT_NODE&&(e=e.host),this.__targetIsRTL=e&&"rtl"===window.getComputedStyle(e).direction;return this.__targetIsRTL},_nameChanged:function(){this._meta.value=null,this._meta.key=this.name,this._meta.value=this,this.async((function(){this.fire("iron-iconset-added",this,{node:window})}))},_createIconMap:function(){var e=Object.create(null);return Th(this).querySelectorAll("[id]").forEach((function(t){e[t.id]=t})),e},_cloneIcon:function(e,t){return this._icons=this._icons||this._createIconMap(),this._prepareSvgClone(this._icons[e],this.size,t)},_prepareSvgClone:function(e,t,i){if(e){var n=e.cloneNode(!0),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=n.getAttribute("viewBox")||"0 0 "+t+" "+t,s="pointer-events: none; display: block; width: 100%; height: 100%;";return i&&n.hasAttribute("mirror-in-rtl")&&(s+="-webkit-transform:scale(-1,1);transform:scale(-1,1);transform-origin:center;"),o.setAttribute("viewBox",r),o.setAttribute("preserveAspectRatio","xMidYMid meet"),o.setAttribute("focusable","false"),o.style.cssText=s,o.appendChild(n).removeAttribute("id"),o}return null}});const b_=document.createElement("template");b_.innerHTML='<iron-iconset-svg name="gr-icons" size="24">\n  <svg>\n    <defs>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="expand-less"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="expand-more"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#unfold_more --\x3e\n      <g id="unfold-more"><path d="M0 0h24v24H0z" fill="none"></path><path d="M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="search"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="settings"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="create"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="star"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="star-border"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="close"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="more-vert"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="deleteEdit"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/editor-icons.html --\x3e\n      <g id="publishEdit"><path d="M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/editor-icons.html --\x3e\n      <g id="delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="help"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/resources/icons/?icon=help_outline --\x3e\n      <g id="help-outline"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="info"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="info-outline"><path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#ic_hourglass_full--\x3e\n      <g id="hourglass"><path d="M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6z"></path><path d="M0 0h24v24H0V0z" fill="none"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#mode_comment--\x3e\n      <g id="comment"><path d="M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18z"></path><path d="M0 0h24v24H0z" fill="none"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#calendar_today--\x3e\n      <g id="calendar"><path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"></path><path d="M0 0h24v24H0z" fill="none"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="error"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="lightbulb-outline"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="side-by-side"><path d="M17.1578947,10.8888889 L2.84210526,10.8888889 C2.37894737,10.8888889 2,11.2888889 2,11.7777778 L2,17.1111111 C2,17.6 2.37894737,18 2.84210526,18 L17.1578947,18 C17.6210526,18 18,17.6 18,17.1111111 L18,11.7777778 C18,11.2888889 17.6210526,10.8888889 17.1578947,10.8888889 Z M17.1578947,2 L2.84210526,2 C2.37894737,2 2,2.4 2,2.88888889 L2,8.22222222 C2,8.71111111 2.37894737,9.11111111 2.84210526,9.11111111 L17.1578947,9.11111111 C17.6210526,9.11111111 18,8.71111111 18,8.22222222 L18,2.88888889 C18,2.4 17.6210526,2 17.1578947,2 Z M16.1973628,2 L2.78874238,2 C2.35493407,2 2,2.4 2,2.88888889 L2,8.22222222 C2,8.71111111 2.35493407,9.11111111 2.78874238,9.11111111 L16.1973628,9.11111111 C16.6311711,9.11111111 16.9861052,8.71111111 16.9861052,8.22222222 L16.9861052,2.88888889 C16.9861052,2.4 16.6311711,2 16.1973628,2 Z" id="Shape" transform="scale(1.2) translate(10.000000, 10.000000) rotate(-90.000000) translate(-10.000000, -10.000000)"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="unified"><path d="M4,2 L17,2 C18.1045695,2 19,2.8954305 19,4 L19,16 C19,17.1045695 18.1045695,18 17,18 L4,18 C2.8954305,18 2,17.1045695 2,16 L2,4 L2,4 C2,2.8954305 2.8954305,2 4,2 L4,2 Z M4,7 L4,9 L17,9 L17,7 L4,7 Z M4,11 L4,13 L17,13 L17,11 L4,11 Z" id="Combined-Shape" transform="scale(1.12, 1.2)"></path></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons/blob/master/iron-icons.js --\x3e\n      <g id="content-copy"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="check"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#check_circle--\x3e\n      <g id="check-circle"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#check_circle_outline--\x3e\n      <g id="check-circle-outline"><path d="M0 0h24v24H0V0zm0 0h24v24H0V0z" fill="none"/><path d="M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="robot"><path d="M4.137453,5.61015591 L4.54835569,1.5340419 C4.5717665,1.30180904 4.76724872,1.12504213 5.00065859,1.12504213 C5.23327176,1.12504213 5.42730868,1.30282046 5.44761309,1.53454578 L5.76084628,5.10933916 C6.16304484,5.03749412 6.57714381,5 7,5 L17,5 C20.8659932,5 24,8.13400675 24,12 L24,15.1250421 C24,18.9910354 20.8659932,22.1250421 17,22.1250421 L7,22.1250421 C3.13400675,22.1250421 2.19029351e-15,18.9910354 0,15.1250421 L0,12 C-3.48556243e-16,9.15382228 1.69864167,6.70438358 4.137453,5.61015591 Z M5.77553049,6.12504213 C3.04904264,6.69038358 1,9.10590202 1,12 L1,15.1250421 C1,18.4387506 3.6862915,21.1250421 7,21.1250421 L17,21.1250421 C20.3137085,21.1250421 23,18.4387506 23,15.1250421 L23,12 C23,8.6862915 20.3137085,6 17,6 L7,6 C6.60617231,6 6.2212068,6.03794347 5.84855971,6.11037415 L5.84984496,6.12504213 L5.77553049,6.12504213 Z M6.93003717,6.95027711 L17.1232083,6.95027711 C19.8638332,6.95027711 22.0855486,9.17199258 22.0855486,11.9126175 C22.0855486,14.6532424 19.8638332,16.8749579 17.1232083,16.8749579 L6.93003717,16.8749579 C4.18941226,16.8749579 1.9676968,14.6532424 1.9676968,11.9126175 C1.9676968,9.17199258 4.18941226,6.95027711 6.93003717,6.95027711 Z M7.60124392,14.0779303 C9.03787127,14.0779303 10.2024878,12.9691885 10.2024878,11.6014862 C10.2024878,10.2337839 9.03787127,9.12504213 7.60124392,9.12504213 C6.16461657,9.12504213 5,10.2337839 5,11.6014862 C5,12.9691885 6.16461657,14.0779303 7.60124392,14.0779303 Z M16.617997,14.1098288 C18.0638768,14.1098288 19.2359939,12.9939463 19.2359939,11.6174355 C19.2359939,10.2409246 18.0638768,9.12504213 16.617997,9.12504213 C15.1721172,9.12504213 14,10.2409246 14,11.6174355 C14,12.9939463 15.1721172,14.1098288 16.617997,14.1098288 Z M9.79751216,18.1250421 L15,18.1250421 L15,19.1250421 C15,19.6773269 14.5522847,20.1250421 14,20.1250421 L10.7975122,20.1250421 C10.2452274,20.1250421 9.79751216,19.6773269 9.79751216,19.1250421 L9.79751216,18.1250421 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="abandon"><path d="M17.65675,17.65725 C14.77275,20.54125 10.23775,20.75625 7.09875,18.31525 L18.31475,7.09925 C20.75575,10.23825 20.54075,14.77325 17.65675,17.65725 M6.34275,6.34325 C9.22675,3.45925 13.76275,3.24425 16.90075,5.68525 L5.68475,16.90125 C3.24375,13.76325 3.45875,9.22725 6.34275,6.34325 M19.07075,4.92925 C15.16575,1.02425 8.83375,1.02425 4.92875,4.92925 C1.02375,8.83425 1.02375,15.16625 4.92875,19.07125 C8.83375,22.97625 15.16575,22.97625 19.07075,19.07125 C22.97575,15.16625 22.97575,8.83425 19.07075,4.92925"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="edit"><path d="M3,17.2525 L3,21.0025 L6.75,21.0025 L17.81,9.9425 L14.06,6.1925 L3,17.2525 L3,17.2525 Z M20.71,7.0425 C21.1,6.6525 21.1,6.0225 20.71,5.6325 L18.37,3.2925 C17.98,2.9025 17.35,2.9025 16.96,3.2925 L15.13,5.1225 L18.88,8.8725 L20.71,7.0425 L20.71,7.0425 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="rebase"><path d="M15.5759,19.4241 L14.5861,20.4146 L11.7574,23.2426 L10.3434,21.8286 L12.171569,20 L7.82933006,20 C7.41754308,21.1652555 6.30635522,22 5,22 C3.343,22 2,20.657 2,19 C2,17.6936448 2.83474451,16.5824569 4,16.1706699 L4,7.82933006 C2.83474451,7.41754308 2,6.30635522 2,5 C2,3.343 3.343,2 5,2 C6.30635522,2 7.41754308,2.83474451 7.82933006,4 L12.1715,4 L10.3431,2.1716 L11.7571,0.7576 L15.36365,4.3633 L16.0000001,4.99920039 C16.0004321,3.34256796 17.3432665,2 19,2 C20.657,2 22,3.343 22,5 C22,6.30635522 21.1652555,7.41754308 20,7.82933006 L20,16.1706699 C21.1652555,16.5824569 22,17.6936448 22,19 C22,20.657 20.657,22 19,22 C17.343,22 16,20.657 16,19 L15.5759,19.4241 Z M12.1715,18 L10.3431,16.1716 L11.7571,14.7576 L15.36365,18.3633 L16.0000001,18.9992004 C16.0003407,17.6931914 16.8349823,16.5823729 18,16.1706699 L18,7.82933006 C16.8347445,7.41754308 16,6.30635522 16,5 L15.5759,5.4241 L14.5861,6.4146 L11.7574,9.2426 L10.3434,7.8286 L12.171569,6 L7.82933006,6 C7.52807271,6.85248394 6.85248394,7.52807271 6,7.82933006 L6,16.1706699 C6.85248394,16.4719273 7.52807271,17.1475161 7.82933006,18 L12.1715,18 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="rebaseEdit"><path d="M15.5759,19.4241 L14.5861,20.4146 L11.7574,23.2426 L10.3434,21.8286 L12.171569,20 L7.82933006,20 C7.41754308,21.1652555 6.30635522,22 5,22 C3.343,22 2,20.657 2,19 C2,17.6936448 2.83474451,16.5824569 4,16.1706699 L4,7.82933006 C2.83474451,7.41754308 2,6.30635522 2,5 C2,3.343 3.343,2 5,2 C6.30635522,2 7.41754308,2.83474451 7.82933006,4 L12.1715,4 L10.3431,2.1716 L11.7571,0.7576 L15.36365,4.3633 L16.0000001,4.99920039 C16.0004321,3.34256796 17.3432665,2 19,2 C20.657,2 22,3.343 22,5 C22,6.30635522 21.1652555,7.41754308 20,7.82933006 L20,16.1706699 C21.1652555,16.5824569 22,17.6936448 22,19 C22,20.657 20.657,22 19,22 C17.343,22 16,20.657 16,19 L15.5759,19.4241 Z M12.1715,18 L10.3431,16.1716 L11.7571,14.7576 L15.36365,18.3633 L16.0000001,18.9992004 C16.0003407,17.6931914 16.8349823,16.5823729 18,16.1706699 L18,7.82933006 C16.8347445,7.41754308 16,6.30635522 16,5 L15.5759,5.4241 L14.5861,6.4146 L11.7574,9.2426 L10.3434,7.8286 L12.171569,6 L7.82933006,6 C7.52807271,6.85248394 6.85248394,7.52807271 6,7.82933006 L6,16.1706699 C6.85248394,16.4719273 7.52807271,17.1475161 7.82933006,18 L12.1715,18 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="restore"><path d="M12,8 L12,13 L16.28,15.54 L17,14.33 L13.5,12.25 L13.5,8 L12,8 Z M13,3 C8.03,3 4,7.03 4,12 L1,12 L4.89,15.89 L4.96,16.03 L9,12 L6,12 C6,8.13 9.13,5 13,5 C16.87,5 20,8.13 20,12 C20,15.87 16.87,19 13,19 C11.07,19 9.32,18.21 8.06,16.94 L6.64,18.36 C8.27,19.99 10.51,21 13,21 C17.97,21 22,16.97 22,12 C22,7.03 17.97,3 13,3 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="revert"><path d="M12.3,8.5 C9.64999995,8.5 7.24999995,9.49 5.39999995,11.1 L1.79999995,7.5 L1.79999995,16.5 L10.8,16.5 L7.17999995,12.88 C8.56999995,11.72 10.34,11 12.3,11 C15.84,11 18.85,13.31 19.9,16.5 L22.27,15.72 C20.88,11.53 16.95,8.5 12.3,8.5"></path></g>\n      <g id="revert_submission"><path d="M12.3,8.5 C9.64999995,8.5 7.24999995,9.49 5.39999995,11.1 L1.79999995,7.5 L1.79999995,16.5 L10.8,16.5 L7.17999995,12.88 C8.56999995,11.72 10.34,11 12.3,11 C15.84,11 18.85,13.31 19.9,16.5 L22.27,15.72 C20.88,11.53 16.95,8.5 12.3,8.5"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="stopEdit"><path d="M4 4 20 4 20 20 4 20z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="submit"><path d="M22.23,5 L11.65,15.58 L7.47000001,11.41 L6.06000001,12.82 L11.65,18.41 L23.649,6.41 L22.23,5 Z M16.58,5 L10.239,11.34 L11.65,12.75 L17.989,6.41 L16.58,5 Z M0.400000006,12.82 L5.99000001,18.41 L7.40000001,17 L1.82000001,11.41 L0.400000006,12.82 Z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="review"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></g>\n      \x3c!-- This is a custom PolyGerrit SVG --\x3e\n      <g id="zeroState"><path d="M22 9V7h-2V5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2v-2h-2V9h2zm-4 10H4V5h14v14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"></path></g>\n      \x3c!-- This SVG is an adaptation of material.io https://material.io/icons/#label_important--\x3e\n      <g id="attention"><path d="M1 23 l13 0 c.67 0 1.27 -.33 1.63 -.84 l7.37 -10.16 l-7.37 -10.16 c-.36 -.51 -.96 -.84 -1.63 -.84 L1 1 L7 12 z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#pets--\x3e\n      <g id="pets"><circle cx="4.5" cy="9.5" r="2.5"/><circle cx="9" cy="5.5" r="2.5"/><circle cx="15" cy="5.5" r="2.5"/><circle cx="19.5" cy="9.5" r="2.5"/><path d="M17.34 14.86c-.87-1.02-1.6-1.89-2.48-2.91-.46-.54-1.05-1.08-1.75-1.32-.11-.04-.22-.07-.33-.09-.25-.04-.52-.04-.78-.04s-.53 0-.79.05c-.11.02-.22.05-.33.09-.7.24-1.28.78-1.75 1.32-.87 1.02-1.6 1.89-2.48 2.91-1.31 1.31-2.92 2.76-2.62 4.79.29 1.02 1.02 2.03 2.33 2.32.73.15 3.06-.44 5.54-.44h.18c2.48 0 4.81.58 5.54.44 1.31-.29 2.04-1.31 2.33-2.32.31-2.04-1.3-3.49-2.61-4.8z"/><path d="M0 0h24v24H0z" fill="none"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#visibility--\x3e\n      <g id="ready"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></g>\n      \x3c!-- This SVG is a copy from iron-icons https://github.com/PolymerElements/iron-icons --\x3e\n      <g id="schedule"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"></path></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#bug_report--\x3e\n      <g id="bug"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5c-.49 0-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-6 8h-4v-2h4v2zm0-4h-4v-2h4v2z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://fonts.gstatic.com/s/i/googlematerialicons/move_item/v1/24px.svg --\x3e\n      <g id="move-item"><path d="M15,19H5V5h10v4h2V5c0-1.1-0.89-2-2-2H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h10c1.11,0,2-0.9,2-2v-4h-2V19z"/><polygon points="20.01,8.01 18.59,9.41 20.17,11 8,11 8,13 20.17,13 18.59,14.59 20.01,15.99 24,12"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#warning--\x3e\n      <g id="warning"><path d="M0 0h24v24H0z" fill="none"/><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#timelapse--\x3e\n      <g id="timelapse"><path d="M0 0h24v24H0z" fill="none"/><path d="M16.24 7.76C15.07 6.59 13.54 6 12 6v6l-4.24 4.24c2.34 2.34 6.14 2.34 8.49 0 2.34-2.34 2.34-6.14-.01-8.48zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#mark_chat_read--\x3e\n      <g id="markChatRead"><path d="M12,18l-6,0l-4,4V4c0-1.1,0.9-2,2-2h16c1.1,0,2,0.9,2,2v7l-2,0V4H4v12l8,0V18z M23,14.34l-1.41-1.41l-4.24,4.24l-2.12-2.12 l-1.41,1.41L17.34,20L23,14.34z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#message--\x3e\n      <g id="message"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#launch--\x3e\n      <g id="launch"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#filter--\x3e\n      <g id="filter"><path d="M0,0h24 M24,24H0" fill="none"/><path d="M4.25,5.61C6.27,8.2,10,13,10,13v6c0,0.55,0.45,1,1,1h2c0.55,0,1-0.45,1-1v-6c0,0,3.72-4.8,5.74-7.39 C20.25,4.95,19.78,4,18.95,4H5.04C4.21,4,3.74,4.95,4.25,5.61z"/><path d="M0,0h24v24H0V0z" fill="none"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#arrow_drop_down--\x3e\n      <g id="arrowDropDown"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 10l5 5 5-5z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#arrow_drop_up--\x3e\n      <g id="arrowDropUp"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 14l5-5 5 5z"/></g>\n      \x3c!-- This is just a placeholder, i.e. an empty icon that has the same size as a normal icon. --\x3e\n      <g id="placeholder"><path d="M0 0h24v24H0z" fill="none"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#insert_photo--\x3e\n      <g id="insert-photo"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#download--\x3e\n      <g id="download"><path d="M0 0h24v24H0z" fill="none"/><path d="M5,20h14v-2H5V20z M19,9h-4V3H9v6H5l7,7L19,9z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#system_update--\x3e\n      <g id="system-update"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"/></g>\n      \x3c!-- This SVG is a copy from material.io https://material.io/icons/#link--\x3e\n      <g id="link"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></g>\n    </defs>\n  </svg>\n</iron-iconset-svg>',document.head.appendChild(b_.content);const w_=mi`
  <style include="shared-styles">
    #nav {
      background-color: var(--table-header-background-color);
      border: 1px solid var(--border-color);
      border-top: none;
      height: 100%;
      position: absolute;
      top: 0;
      width: 14em;
    }
    #nav.pinned {
      position: fixed;
    }
    @media only screen and (max-width: 53em) {
      #nav {
        display: none;
      }
    }
  </style>
  <nav id="nav" aria-label="Sidebar">
    <slot></slot>
  </nav>
`;var C_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let S_=class extends fi{constructor(){super(),this.bodyScrollHandler=()=>this._handleBodyScroll()}static get template(){return w_}connectedCallback(){super.connectedCallback(),window.addEventListener("scroll",this.bodyScrollHandler)}disconnectedCallback(){window.removeEventListener("scroll",this.bodyScrollHandler),super.disconnectedCallback()}_handleBodyScroll(){if(void 0===this._headerHeight){let e=this._getOffsetTop(this);for(let t=this.offsetParent;t;t=this._getOffsetParent(t))e+=this._getOffsetTop(t);this._headerHeight=e}this.$.nav.classList.toggle("pinned",this._getScrollY()>=(this._headerHeight||0))}_getOffsetParent(e){if(e&&"offsetParent"in e)return e.offsetParent}_getOffsetTop(e){return e.offsetTop}_getScrollY(){return window.scrollY}};C_([Oo({type:Number})],S_.prototype,"_headerHeight",void 0),S_=C_([Po("gr-page-nav")],S_);const E_=document.createElement("template");E_.innerHTML='<dom-module id="gr-table-styles">\n  <template>\n    <style>\n      .genericList {\n        background-color: var(--background-color-primary);\n        border-collapse: collapse;\n        width: 100%;\n      }\n      .genericList th,\n      .genericList td {\n        padding: var(--spacing-m) 0;\n        vertical-align: middle;\n      }\n      .genericList tr {\n        border-bottom: 1px solid var(--border-color);\n      }\n      .genericList tr:hover {\n        background-color: var(--hover-background-color);\n      }\n      .genericList th {\n        white-space: nowrap;\n      }\n      .genericList th,\n      .genericList td {\n        padding-right: var(--spacing-l);\n      }\n      .genericList tr th:first-of-type,\n      .genericList tr td:first-of-type {\n        padding-left: var(--spacing-l);\n      }\n      .genericList tr:first-of-type {\n        border-top: 1px solid var(--border-color);\n      }\n      .genericList tr th:last-of-type,\n      .genericList tr td:last-of-type {\n        border-left: 1px solid var(--border-color);\n        text-align: center;\n        padding-left: var(--spacing-l);\n      }\n      .genericList tr th.delete,\n      .genericList tr td.delete {\n        padding-top: 0;\n        padding-bottom: 0;\n      }\n      .genericList tr th.delete,\n      .genericList tr td.delete,\n      .genericList tr.loadingMsg td,\n      .genericList tr.groupHeader td {\n        border-left: none;\n      }\n      .genericList .loading {\n        border: none;\n        display: none;\n      }\n      .genericList td {\n        flex-shrink: 0;\n      }\n      .genericList .topHeader,\n      .genericList .groupHeader {\n        color: var(--primary-text-color);\n        font-weight: var(--font-weight-bold);\n        text-align: left;\n        vertical-align: middle\n      }\n      .genericList .groupHeader {\n        background-color: var(--background-color-secondary);\n        font-family: var(--header-font-family);\n        font-size: var(--font-size-h3);\n        font-weight: var(--font-weight-h3);\n        line-height: var(--line-height-h3);\n      }\n      .genericList a {\n        color: var(--primary-text-color);\n        text-decoration: none;\n      }\n      .genericList a:hover {\n        text-decoration: underline;\n      }\n      .genericList .description {\n        width: 99%;\n      }\n      .genericList .loadingMsg {\n        color: var(--deemphasized-text-color);\n        display: block;\n        padding: var(--spacing-s) var(--spacing-l);\n      }\n      .genericList .loadingMsg:not(.loading) {\n        display: none;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(E_.content);const A_=mi`
  <style include="shared-styles">
    :host {
      color: var(--primary-text-color);
      display: block;
      max-height: 90vh;
      overflow: auto;
    }
    .container {
      display: flex;
      flex-direction: column;
      max-height: 90vh;
      padding: var(--spacing-xl);
    }
    header {
      flex-shrink: 0;
      padding-bottom: var(--spacing-xl);
    }
    main {
      display: flex;
      flex-shrink: 1;
      width: 100%;
      flex: 1;
      /* IMPORTANT: required for firefox */
      min-height: 0px;
    }
    main .overflow-container {
      flex: 1;
      overflow: auto;
    }
    footer {
      display: flex;
      flex-shrink: 0;
      justify-content: flex-end;
      padding-top: var(--spacing-xl);
    }
    gr-button {
      margin-left: var(--spacing-l);
    }
    .hidden {
      display: none;
    }
  </style>
  <div class="container" on-keydown="_handleKeydown">
    <header class="heading-3"><slot name="header"></slot></header>
    <main>
      <div class="overflow-container">
        <slot name="main"></slot>
      </div>
    </main>
    <footer>
      <slot name="footer"></slot>
      <gr-button
        id="cancel"
        class$="[[_computeCancelClass(cancelLabel)]]"
        link=""
        on-click="_handleCancelTap"
      >
        [[cancelLabel]]
      </gr-button>
      <gr-button
        id="confirm"
        link=""
        primary=""
        on-click="_handleConfirm"
        disabled="[[disabled]]"
        title$="[[confirmTooltip]]"
      >
        [[confirmLabel]]
      </gr-button>
    </footer>
  </div>
`;var x_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let R_=class extends fi{constructor(){super(...arguments),this.confirmLabel="Confirm",this.cancelLabel="Cancel",this.disabled=!1,this.confirmOnEnter=!1}static get template(){return A_}ready(){super.ready(),this._ensureAttribute("role","dialog")}_handleConfirmTooltipUpdate(e){e?this.$.confirm.setAttribute("has-tooltip","true"):this.$.confirm.removeAttribute("has-tooltip")}_handleConfirm(e){this.disabled||(e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1})))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}_handleKeydown(e){this.confirmOnEnter&&13===e.keyCode&&this._handleConfirm(e)}resetFocus(){this.$.confirm.focus()}_computeCancelClass(e){return e.length?"":"hidden"}};x_([Oo({type:String})],R_.prototype,"confirmLabel",void 0),x_([Oo({type:String})],R_.prototype,"cancelLabel",void 0),x_([Oo({type:Boolean})],R_.prototype,"disabled",void 0),x_([Oo({type:Boolean})],R_.prototype,"confirmOnEnter",void 0),x_([Oo({type:String})],R_.prototype,"confirmTooltip",void 0),x_([No("confirmTooltip")],R_.prototype,"_handleConfirmTooltipUpdate",null),R_=x_([Po("gr-dialog")],R_);const T_=zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        position: fixed;
        clip: rect(0px,0px,0px,0px);
      }
    </style>
    <div aria-live$="[[mode]]">[[_text]]</div>
`,is:"iron-a11y-announcer",properties:{mode:{type:String,value:"polite"},timeout:{type:Number,value:150},_text:{type:String,value:""}},created:function(){T_.instance||(T_.instance=this),document.addEventListener("iron-announce",this._onIronAnnounce.bind(this))},announce:function(e){this._text="",this.async((function(){this._text=e}),this.timeout)},_onIronAnnounce:function(e){e.detail&&e.detail.text&&this.announce(e.detail.text)}});T_.instance=null,T_.requestAvailability=function(){T_.instance||(T_.instance=document.createElement("iron-a11y-announcer")),document.body?document.body.appendChild(T_.instance):document.addEventListener("load",(function(){document.body.appendChild(T_.instance)}))};let k_=null;const P_={properties:{validator:{type:String},invalid:{notify:!0,reflectToAttribute:!0,type:Boolean,value:!1,observer:"_invalidChanged"}},registered:function(){k_=new v_({type:"validator"})},_invalidChanged:function(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")},get _validator(){return k_&&k_.byKey(this.validator)},hasValidator:function(){return null!=this._validator},validate:function(e){return void 0===e&&void 0!==this.value?this.invalid=!this._getValidity(this.value):this.invalid=!this._getValidity(e),!this.invalid},_getValidity:function(e){return!this.hasValidator()||this._validator.validate(e)}};zh({_template:mi`
    <style>
      :host {
        display: inline-block;
      }
    </style>
    <slot id="content"></slot>
`,is:"iron-input",behaviors:[P_],properties:{bindValue:{type:String,value:""},value:{type:String,computed:"_computeValue(bindValue)"},allowedPattern:{type:String},autoValidate:{type:Boolean,value:!1},_inputElement:Object},observers:["_bindValueChanged(bindValue, _inputElement)"],listeners:{input:"_onInput",keypress:"_onKeypress"},created:function(){T_.requestAvailability(),this._previousValidInput="",this._patternAlreadyChecked=!1},attached:function(){this._observer=Th(this).observeNodes(function(e){this._initSlottedInput()}.bind(this))},detached:function(){this._observer&&(Th(this).unobserveNodes(this._observer),this._observer=null)},get inputElement(){return this._inputElement},_initSlottedInput:function(){this._inputElement=this.getEffectiveChildren()[0],this.inputElement&&this.inputElement.value&&(this.bindValue=this.inputElement.value),this.fire("iron-input-ready")},get _patternRegExp(){var e;if(this.allowedPattern)e=new RegExp(this.allowedPattern);else switch(this.inputElement.type){case"number":e=/[0-9.,e-]/}return e},_bindValueChanged:function(e,t){t&&(void 0===e?t.value=null:e!==t.value&&(this.inputElement.value=e),this.autoValidate&&this.validate(),this.fire("bind-value-changed",{value:e}))},_onInput:function(){this.allowedPattern&&!this._patternAlreadyChecked&&(this._checkPatternValidity()||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.inputElement.value=this._previousValidInput));this.bindValue=this._previousValidInput=this.inputElement.value,this._patternAlreadyChecked=!1},_isPrintable:function(e){var t=8==e.keyCode||9==e.keyCode||13==e.keyCode||27==e.keyCode,i=19==e.keyCode||20==e.keyCode||45==e.keyCode||46==e.keyCode||144==e.keyCode||145==e.keyCode||e.keyCode>32&&e.keyCode<41||e.keyCode>111&&e.keyCode<124;return!(t||0==e.charCode&&i)},_onKeypress:function(e){if(this.allowedPattern||"number"===this.inputElement.type){var t=this._patternRegExp;if(t&&!(e.metaKey||e.ctrlKey||e.altKey)){this._patternAlreadyChecked=!0;var i=String.fromCharCode(e.charCode);this._isPrintable(e)&&!t.test(i)&&(e.preventDefault(),this._announceInvalidCharacter("Invalid character "+i+" not entered."))}}},_checkPatternValidity:function(){var e=this._patternRegExp;if(!e)return!0;for(var t=0;t<this.inputElement.value.length;t++)if(!e.test(this.inputElement.value[t]))return!1;return!0},validate:function(){if(!this.inputElement)return this.invalid=!1,!0;var e=this.inputElement.checkValidity();return e&&(this.required&&""===this.bindValue?e=!1:this.hasValidator()&&(e=P_.validate.call(this,this.bindValue))),this.invalid=!e,this.fire("iron-input-validate"),e},_announceInvalidCharacter:function(e){this.fire("iron-announce",{text:e})},_computeValue:function(e){return e}});const I_=mi`
  <style include="shared-styles">
    #filter {
      max-width: 25em;
    }
    #filter:focus {
      outline: none;
    }
    #topContainer {
      align-items: center;
      display: flex;
      height: 3rem;
      justify-content: space-between;
      margin: 0 var(--spacing-l);
    }
    #createNewContainer:not(.show) {
      display: none;
    }
    a {
      color: var(--primary-text-color);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    nav {
      align-items: center;
      display: flex;
      height: 3rem;
      justify-content: flex-end;
      margin-right: 20px;
    }
    nav,
    iron-icon {
      color: var(--deemphasized-text-color);
    }
    iron-icon {
      height: 1.85rem;
      margin-left: 16px;
      width: 1.85rem;
    }
  </style>
  <div id="topContainer">
    <div class="filterContainer">
      <label>Filter:</label>
      <iron-input type="text" bind-value="{{filter}}">
        <input
          is="iron-input"
          type="text"
          id="filter"
          bind-value="{{filter}}"
        />
      </iron-input>
    </div>
    <div id="createNewContainer" class$="[[_computeCreateClass(createNew)]]">
      <gr-button primary="" link="" id="createNew" on-click="_createNewItem">
        Create New
      </gr-button>
    </div>
  </div>
  <slot></slot>
  <nav>
    Page [[_computePage(offset, itemsPerPage)]]
    <a
      id="prevArrow"
      href$="[[_computeNavLink(offset, -1, itemsPerPage, filter, path)]]"
      hidden$="[[_hidePrevArrow(loading, offset)]]"
      hidden=""
    >
      <iron-icon icon="gr-icons:chevron-left"></iron-icon>
    </a>
    <a
      id="nextArrow"
      href$="[[_computeNavLink(offset, 1, itemsPerPage, filter, path)]]"
      hidden$="[[_hideNextArrow(loading, items)]]"
      hidden=""
    >
      <iron-icon icon="gr-icons:chevron-right"></iron-icon>
    </a>
  </nav>
`;var O_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let N_=class extends fi{constructor(){super(...arguments),this.itemsPerPage=25}static get template(){return I_}disconnectedCallback(){var e;null===(e=this.reloadTask)||void 0===e||e.cancel(),super.disconnectedCallback()}_filterChanged(e,t){(e||t)&&this._debounceReload(e)}_debounceReload(e){this.reloadTask=Cu(this.reloadTask,()=>{if(this.path)return e?$m.show(`${this.path}/q/filter:`+O(e,!1)):$m.show(this.path)},200)}_createNewItem(){bi(this,"create-clicked")}_computeNavLink(e,t,i,n,o){e=+(e||0);const r=Math.max(0,e+i*t);let s=k()+o;return n&&(s+="/q/filter:"+O(n,!1)),r>0&&(s+=`,${r}`),s}_computeCreateClass(e){return e?"show":""}_hidePrevArrow(e,t){return e||0===t}_hideNextArrow(e,t){if(e||!t||!t.length)return!0;return t.length<this.itemsPerPage+1}_computePage(e,t){return e/t+1}};O_([Oo({type:Boolean})],N_.prototype,"createNew",void 0),O_([Oo({type:Array})],N_.prototype,"items",void 0),O_([Oo({type:Number})],N_.prototype,"itemsPerPage",void 0),O_([Oo({type:String,observer:"_filterChanged"})],N_.prototype,"filter",void 0),O_([Oo({type:Number})],N_.prototype,"offset",void 0),O_([Oo({type:Boolean})],N_.prototype,"loading",void 0),O_([Oo({type:String})],N_.prototype,"path",void 0),N_=O_([Po("gr-list-view")],N_);const L_=document.createElement("template");L_.innerHTML='<dom-module id="gr-form-styles">\n  <template>\n    <style>\n      .gr-form-styles input {\n        background-color: var(--view-background-color);\n        color: var(--primary-text-color);\n      }\n      .gr-form-styles select {\n        background-color: var(--select-background-color);\n        color: var(--primary-text-color);\n      }\n      .gr-form-styles h1,\n      .gr-form-styles h2 {\n        margin-bottom: var(--spacing-s);\n      }\n      .gr-form-styles h4 {\n        font-weight: var(--font-weight-bold);\n      }\n      .gr-form-styles fieldset {\n        border: none;\n        margin-bottom: var(--spacing-xxl);\n      }\n      .gr-form-styles section {\n        display: flex;\n        margin: var(--spacing-s) 0;\n        min-height: 2em;\n      }\n      .gr-form-styles section * {\n        vertical-align: middle;\n      }\n      .gr-form-styles .title,\n      .gr-form-styles .value {\n        display: inline-block;\n      }\n      .gr-form-styles .title {\n        color: var(--deemphasized-text-color);\n        font-weight: var(--font-weight-bold);\n        padding-right: var(--spacing-m);\n        width: 15em;\n      }\n      .gr-form-styles th {\n        color: var(--deemphasized-text-color);\n        text-align: left;\n        vertical-align: bottom;\n      }\n      .gr-form-styles td,\n      .gr-form-styles tfoot th {\n        padding: var(--spacing-s) 0;\n        vertical-align: middle;\n      }\n      .gr-form-styles .emptyHeader {\n        text-align: right;\n      }\n      .gr-form-styles table {\n        width: 50em;\n      }\n      .gr-form-styles th:first-child,\n      .gr-form-styles td:first-child {\n        width: 15em;\n      }\n      .gr-form-styles th:first-child input,\n      .gr-form-styles td:first-child input {\n        width: 14em;\n      }\n      .gr-form-styles input:not([type="checkbox"]),\n      .gr-form-styles select,\n      .gr-form-styles textarea {\n        border: 1px solid var(--border-color);\n        border-radius: var(--border-radius);\n        padding: var(--spacing-s);\n      }\n      .gr-form-styles td:last-child {\n        width: 5em;\n      }\n      .gr-form-styles th:last-child gr-button,\n      .gr-form-styles td:last-child gr-button {\n        width: 100%;\n      }\n      .gr-form-styles iron-autogrow-textarea {\n        height: auto;\n        min-height: 4em;\n      }\n      .gr-form-styles gr-autocomplete {\n        width: 14em;\n      }\n      @media only screen and (max-width: 40em) {\n        .gr-form-styles section {\n          margin-bottom: var(--spacing-l);\n        }\n        .gr-form-styles .title,\n        .gr-form-styles .value {\n          display: block;\n        }\n        .gr-form-styles table {\n          width: 100%;\n        }\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(L_.content);const D_=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    :host {
      display: inline-block;
    }
    input {
      width: 20em;
    }
  </style>
  <div class="gr-form-styles">
    <div id="form">
      <section>
        <span class="title">Group name</span>
        <iron-input bind-value="{{_name}}">
          <input is="iron-input" bind-value="{{_name}}" />
        </iron-input>
      </section>
    </div>
  </div>
`;var M_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let F_=class extends fi{constructor(){super(...arguments),this.hasNewGroupName=!1,this._name="",this._groupCreated=!1,this.restApiService=i.restApiService}static get template(){return D_}_computeGroupUrl(e){return k()+"/admin/groups/"+O(e,!0)}_updateGroupName(e){this.hasNewGroupName=!!e}focus(){var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("input"))||void 0===t||t.focus()}handleCreateGroup(){const e=this._name;return this.restApiService.createGroup({name:e}).then(t=>{if(201===t.status)return this._groupCreated=!0,this.restApiService.getGroupConfig(e).then(e=>{$m.show(this._computeGroupUrl(e.group_id))})})}};M_([Oo({type:Boolean,notify:!0})],F_.prototype,"hasNewGroupName",void 0),M_([Oo({type:String})],F_.prototype,"_name",void 0),M_([Oo({type:Boolean})],F_.prototype,"_groupCreated",void 0),M_([No("_name")],F_.prototype,"_updateGroupName",null),F_=M_([Po("gr-create-group-dialog")],F_);const $_=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <gr-list-view
    create-new="[[_createNewCapability]]"
    filter="[[_filter]]"
    items="[[_groups]]"
    items-per-page="[[_groupsPerPage]]"
    loading="[[_loading]]"
    offset="[[_offset]]"
    on-create-clicked="_handleCreateClicked"
    path="[[_path]]"
  >
    <table id="list" class="genericList">
      <tbody>
        <tr class="headerRow">
          <th class="name topHeader">Group Name</th>
          <th class="description topHeader">Group Description</th>
          <th class="visibleToAll topHeader">Visible To All</th>
        </tr>
        <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
          <td>Loading...</td>
        </tr>
      </tbody>
      <tbody class$="[[computeLoadingClass(_loading)]]">
        <template is="dom-repeat" items="[[_shownGroups]]">
          <tr class="table">
            <td class="name">
              <a href$="[[_computeGroupUrl(item.id)]]">[[item.name]]</a>
            </td>
            <td class="description">[[item.description]]</td>
            <td class="visibleToAll">[[_visibleToAll(item)]]</td>
          </tr>
        </template>
      </tbody>
    </table>
  </gr-list-view>
  <gr-overlay id="createOverlay" with-backdrop="">
    <gr-dialog
      id="createDialog"
      class="confirmDialog"
      disabled="[[!_hasNewGroupName]]"
      confirm-label="Create"
      confirm-on-enter=""
      on-confirm="_handleCreateGroup"
      on-cancel="_handleCloseCreate"
    >
      <div class="header" slot="header">Create Group</div>
      <div class="main" slot="main">
        <gr-create-group-dialog
          has-new-group-name="{{_hasNewGroupName}}"
          id="createNewModal"
        ></gr-create-group-dialog>
      </div>
    </gr-dialog>
  </gr-overlay>
`,B_=ye(e=>class extends e{computeLoadingClass(e){return e?"loading":""}computeShownItems(e){return e.slice(0,25)}getUrl(e,t){return k()+e+O(t,!0)}getFilterValue(e){return e&&e.filter||""}getOffsetValue(e){return(null==e?void 0:e.offset)?Number(e.offset):0}});var j_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let H_=class extends(B_(fi)){constructor(){super(...arguments),this._path="/admin/groups",this._createNewCapability=!1,this._groups=[],this._groupsPerPage=25,this._loading=!0,this._filter="",this.restApiService=i.restApiService}static get template(){return $_}get _shownGroups(){return this.computeShownItems(this._groups)}connectedCallback(){super.connectedCallback(),this._getCreateGroupCapability(),xi(this,"Groups"),this._maybeOpenCreateOverlay(this.params)}_paramsChanged(e){return this._loading=!0,this._filter=this.getFilterValue(e),this._offset=this.getOffsetValue(e),this._getGroups(this._filter,this._groupsPerPage,this._offset)}_maybeOpenCreateOverlay(e){(null==e?void 0:e.openCreateModal)&&this.$.createOverlay.open()}_computeGroupUrl(e){return Qm.getUrlForGroup(decodeURIComponent(e))}_getCreateGroupCapability(){return this.restApiService.getAccount().then(e=>{if(e)return this.restApiService.getAccountCapabilities(["createGroup"]).then(e=>{(null==e?void 0:e.createGroup)&&(this._createNewCapability=!0)})})}_getGroups(e,t,i){return this._groups=[],this.restApiService.getGroups(e,t,i).then(e=>{e&&(this._groups=Object.keys(e).map(t=>{const i=e[t];return i.name=t,i}),this._loading=!1)})}_refreshGroupsList(){return this.restApiService.invalidateGroupsCache(),this._getGroups(this._filter,this._groupsPerPage,this._offset)}_handleCreateGroup(){this.$.createNewModal.handleCreateGroup().then(()=>{this._refreshGroupsList()})}_handleCloseCreate(){this.$.createOverlay.close()}_handleCreateClicked(){this.$.createOverlay.open().then(()=>{this.$.createNewModal.focus()})}_visibleToAll(e){var t;return!0===(null===(t=e.options)||void 0===t?void 0:t.visible_to_all)?"Y":"N"}};j_([Oo({type:Object})],H_.prototype,"params",void 0),j_([Oo({type:Number})],H_.prototype,"_offset",void 0),j_([Oo({type:String})],H_.prototype,"_path",void 0),j_([Oo({type:Boolean})],H_.prototype,"_hasNewGroupName",void 0),j_([Oo({type:Boolean})],H_.prototype,"_createNewCapability",void 0),j_([Oo({type:Array})],H_.prototype,"_groups",void 0),j_([Lo("_groups")],H_.prototype,"_shownGroups",null),j_([Oo({type:Number})],H_.prototype,"_groupsPerPage",void 0),j_([Oo({type:Boolean})],H_.prototype,"_loading",void 0),j_([Oo({type:String})],H_.prototype,"_filter",void 0),j_([No("params")],H_.prototype,"_paramsChanged",null),H_=j_([Po("gr-admin-group-list")],H_),zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        position: relative;
        width: 400px;
        border: 1px solid;
        padding: 2px;
        -moz-appearance: textarea;
        -webkit-appearance: textarea;
        overflow: hidden;
      }

      .mirror-text {
        visibility: hidden;
        word-wrap: break-word;
        @apply --iron-autogrow-textarea;
      }

      .fit {
        @apply --layout-fit;
      }

      textarea {
        position: relative;
        outline: none;
        border: none;
        resize: none;
        background: inherit;
        color: inherit;
        /* see comments in template */
        width: 100%;
        height: 100%;
        font-size: inherit;
        font-family: inherit;
        line-height: inherit;
        text-align: inherit;
        @apply --iron-autogrow-textarea;
      }

      textarea::-webkit-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea::-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-ms-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }
    </style>

    <!-- the mirror sizes the input/textarea so it grows with typing -->
    <!-- use &#160; instead &nbsp; of to allow this element to be used in XHTML -->
    <div id="mirror" class="mirror-text" aria-hidden="true">&nbsp;</div>

    <!-- size the input/textarea with a div, because the textarea has intrinsic size in ff -->
    <div class="textarea-container fit">
      <textarea id="textarea" name$="[[name]]" aria-label$="[[label]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" autocapitalize$="[[autocapitalize]]" inputmode$="[[inputmode]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" disabled$="[[disabled]]" rows$="[[rows]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]"></textarea>
    </div>
`,is:"iron-autogrow-textarea",behaviors:[P_,lf],properties:{value:{observer:"_valueChanged",type:String,notify:!0},bindValue:{observer:"_bindValueChanged",type:String,notify:!0},rows:{type:Number,value:1,observer:"_updateCached"},maxRows:{type:Number,value:0,observer:"_updateCached"},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,value:!1},autocapitalize:{type:String,value:"none"},inputmode:{type:String},placeholder:{type:String},readonly:{type:String},required:{type:Boolean},minlength:{type:Number},maxlength:{type:Number},label:{type:String}},listeners:{input:"_onInput"},get textarea(){return this.$.textarea},get selectionStart(){return this.$.textarea.selectionStart},get selectionEnd(){return this.$.textarea.selectionEnd},set selectionStart(e){this.$.textarea.selectionStart=e},set selectionEnd(e){this.$.textarea.selectionEnd=e},attached:function(){navigator.userAgent.match(/iP(?:[oa]d|hone)/)&&!navigator.userAgent.match(/OS 1[3456789]/)&&(this.$.textarea.style.marginLeft="-3px")},validate:function(){var e=this.$.textarea.validity.valid;return e&&(this.required&&""===this.value?e=!1:this.hasValidator()&&(e=P_.validate.call(this,this.value))),this.invalid=!e,this.fire("iron-input-validate"),e},_bindValueChanged:function(e){this.value=e},_valueChanged:function(e){var t=this.textarea;t&&(t.value!==e&&(t.value=e||0===e?e:""),this.bindValue=e,this.$.mirror.innerHTML=this._valueForMirror(),this.fire("bind-value-changed",{value:this.bindValue}))},_onInput:function(e){var t=Th(e).path;this.value=t?t[0].value:e.target.value},_constrain:function(e){var t;for(e=e||[""],t=this.maxRows>0&&e.length>this.maxRows?e.slice(0,this.maxRows):e.slice(0);this.rows>0&&t.length<this.rows;)t.push("");return t.join("<br/>")+"&#160;"},_valueForMirror:function(){var e=this.textarea;if(e)return this.tokens=e&&e.value?e.value.replace(/&/gm,"&amp;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").split("\n"):[""],this._constrain(this.tokens)},_updateCached:function(){this.$.mirror.innerHTML=this._constrain(this.tokens)}});const U_=document.createElement("template");U_.innerHTML='<dom-module id="gr-subpage-styles">\n  <template>\n    <style>\n      .main {\n        margin: var(--spacing-l);\n      }\n      .loading {\n        display: none;\n      }\n      #loading.loading {\n        display: block;\n      }\n      #loading:not(.loading) {\n        display: none;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(U_.content);const G_={attached:function(){this.fire("addon-attached")},update:function(e){}};zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        float: right;

        @apply --paper-font-caption;
        @apply --paper-input-char-counter;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:dir(rtl)) {
        float: left;
      }
    </style>

    <span>[[_charCounterStr]]</span>
`,is:"paper-input-char-counter",behaviors:[G_],properties:{_charCounterStr:{type:String,value:"0"}},update:function(e){if(e.inputElement){e.value=e.value||"";var t=e.value.toString().length.toString();e.inputElement.hasAttribute("maxlength")&&(t+="/"+e.inputElement.getAttribute("maxlength")),this._charCounterStr=t}}});const z_=mi`
<custom-style>
  <style is="custom-style">
    html {
      --paper-input-container-shared-input-style: {
        position: relative; /* to make a stacking context */
        outline: none;
        box-shadow: none;
        padding: 0;
        margin: 0;
        width: 100%;
        max-width: 100%;
        background: transparent;
        border: none;
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        -webkit-appearance: none;
        text-align: inherit;
        vertical-align: var(--paper-input-container-input-align, bottom);

        @apply --paper-font-subhead;
      };
    }
  </style>
</custom-style>
`;z_.setAttribute("style","display: none;"),document.head.appendChild(z_.content),zh({_template:mi`
    <style>
      :host {
        display: block;
        padding: 8px 0;
        @apply --paper-input-container;
      }

      :host([inline]) {
        display: inline-block;
      }

      :host([disabled]) {
        pointer-events: none;
        opacity: 0.33;

        @apply --paper-input-container-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      [hidden] {
        display: none !important;
      }

      .floated-label-placeholder {
        @apply --paper-font-caption;
      }

      .underline {
        height: 2px;
        position: relative;
      }

      .focused-line {
        @apply --layout-fit;
        border-bottom: 2px solid var(--paper-input-container-focus-color, var(--primary-color));

        -webkit-transform-origin: center center;
        transform-origin: center center;
        -webkit-transform: scale3d(0,1,1);
        transform: scale3d(0,1,1);

        @apply --paper-input-container-underline-focus;
      }

      .underline.is-highlighted .focused-line {
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .underline.is-invalid .focused-line {
        border-color: var(--paper-input-container-invalid-color, var(--error-color));
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .unfocused-line {
        @apply --layout-fit;
        border-bottom: 1px solid var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline;
      }

      :host([disabled]) .unfocused-line {
        border-bottom: 1px dashed;
        border-color: var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline-disabled;
      }

      .input-wrapper {
        @apply --layout-horizontal;
        @apply --layout-center;
        position: relative;
      }

      .input-content {
        @apply --layout-flex-auto;
        @apply --layout-relative;
        max-width: 100%;
      }

      .input-content ::slotted(label),
      .input-content ::slotted(.paper-input-label) {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font: inherit;
        color: var(--paper-input-container-color, var(--secondary-text-color));
        -webkit-transition: -webkit-transform 0.25s, width 0.25s;
        transition: transform 0.25s, width 0.25s;
        -webkit-transform-origin: left top;
        transform-origin: left top;
        /* Fix for safari not focusing 0-height date/time inputs with -webkit-apperance: none; */
        min-height: 1px;

        @apply --paper-font-common-nowrap;
        @apply --paper-font-subhead;
        @apply --paper-input-container-label;
        @apply --paper-transition-easing;
      }


      .input-content ::slotted(label):before,
      .input-content ::slotted(.paper-input-label):before {
        @apply --paper-input-container-label-before;
      }

      .input-content ::slotted(label):after,
      .input-content ::slotted(.paper-input-label):after {
        @apply --paper-input-container-label-after;
      }

      .input-content.label-is-floating ::slotted(label),
      .input-content.label-is-floating ::slotted(.paper-input-label) {
        -webkit-transform: translateY(-75%) scale(0.75);
        transform: translateY(-75%) scale(0.75);

        /* Since we scale to 75/100 of the size, we actually have 100/75 of the
        original space now available */
        width: 133%;

        @apply --paper-input-container-label-floating;
      }

      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(label),
      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(.paper-input-label) {
        right: 0;
        left: auto;
        -webkit-transform-origin: right top;
        transform-origin: right top;
      }

      .input-content.label-is-highlighted ::slotted(label),
      .input-content.label-is-highlighted ::slotted(.paper-input-label) {
        color: var(--paper-input-container-focus-color, var(--primary-color));

        @apply --paper-input-container-label-focus;
      }

      .input-content.is-invalid ::slotted(label),
      .input-content.is-invalid ::slotted(.paper-input-label) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .input-content.label-is-hidden ::slotted(label),
      .input-content.label-is-hidden ::slotted(.paper-input-label) {
        visibility: hidden;
      }

      .input-content ::slotted(input),
      .input-content ::slotted(iron-input),
      .input-content ::slotted(textarea),
      .input-content ::slotted(iron-autogrow-textarea),
      .input-content ::slotted(.paper-input-input) {
        @apply --paper-input-container-shared-input-style;
        /* The apply shim doesn't apply the nested color custom property,
          so we have to re-apply it here. */
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        @apply --paper-input-container-input;
      }

      .input-content ::slotted(input)::-webkit-outer-spin-button,
      .input-content ::slotted(input)::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      .input-content.focused ::slotted(input),
      .input-content.focused ::slotted(iron-input),
      .input-content.focused ::slotted(textarea),
      .input-content.focused ::slotted(iron-autogrow-textarea),
      .input-content.focused ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-focus;
      }

      .input-content.is-invalid ::slotted(input),
      .input-content.is-invalid ::slotted(iron-input),
      .input-content.is-invalid ::slotted(textarea),
      .input-content.is-invalid ::slotted(iron-autogrow-textarea),
      .input-content.is-invalid ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-invalid;
      }

      .prefix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;
        @apply --paper-input-prefix;
      }

      .suffix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;

        @apply --paper-input-suffix;
      }

      /* Firefox sets a min-width on the input, which can cause layout issues */
      .input-content ::slotted(input) {
        min-width: 0;
      }

      .input-content ::slotted(textarea) {
        resize: none;
      }

      .add-on-content {
        position: relative;
      }

      .add-on-content.is-invalid ::slotted(*) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .add-on-content.is-highlighted ::slotted(*) {
        color: var(--paper-input-container-focus-color, var(--primary-color));
      }
    </style>

    <div class="floated-label-placeholder" aria-hidden="true" hidden="[[noLabelFloat]]">&nbsp;</div>

    <div class="input-wrapper">
      <span class="prefix"><slot name="prefix"></slot></span>

      <div class$="[[_computeInputContentClass(noLabelFloat,alwaysFloatLabel,focused,invalid,_inputHasContent)]]" id="labelAndInputContainer">
        <slot name="label"></slot>
        <slot name="input"></slot>
      </div>

      <span class="suffix"><slot name="suffix"></slot></span>
    </div>

    <div class$="[[_computeUnderlineClass(focused,invalid)]]">
      <div class="unfocused-line"></div>
      <div class="focused-line"></div>
    </div>

    <div class$="[[_computeAddOnContentClass(focused,invalid)]]">
      <slot name="add-on"></slot>
    </div>
`,is:"paper-input-container",properties:{noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},attrForValue:{type:String,value:"bind-value"},autoValidate:{type:Boolean,value:!1},invalid:{observer:"_invalidChanged",type:Boolean,value:!1},focused:{readOnly:!0,type:Boolean,value:!1,notify:!0},_addons:{type:Array},_inputHasContent:{type:Boolean,value:!1},_inputSelector:{type:String,value:"input,iron-input,textarea,.paper-input-input"},_boundOnFocus:{type:Function,value:function(){return this._onFocus.bind(this)}},_boundOnBlur:{type:Function,value:function(){return this._onBlur.bind(this)}},_boundOnInput:{type:Function,value:function(){return this._onInput.bind(this)}},_boundValueChanged:{type:Function,value:function(){return this._onValueChanged.bind(this)}}},listeners:{"addon-attached":"_onAddonAttached","iron-input-validate":"_onIronInputValidate"},get _valueChangedEvent(){return this.attrForValue+"-changed"},get _propertyForValue(){return Je(this.attrForValue)},get _inputElement(){return Th(this).querySelector(this._inputSelector)},get _inputElementValue(){return this._inputElement[this._propertyForValue]||this._inputElement.value},ready:function(){this.__isFirstValueUpdate=!0,this._addons||(this._addons=[]),this.addEventListener("focus",this._boundOnFocus,!0),this.addEventListener("blur",this._boundOnBlur,!0)},attached:function(){this.attrForValue?this._inputElement.addEventListener(this._valueChangedEvent,this._boundValueChanged):this.addEventListener("input",this._onInput),this._inputElementValue&&""!=this._inputElementValue?this._handleValueAndAutoValidate(this._inputElement):this._handleValue(this._inputElement)},_onAddonAttached:function(e){this._addons||(this._addons=[]);var t=e.target;-1===this._addons.indexOf(t)&&(this._addons.push(t),this.isAttached&&this._handleValue(this._inputElement))},_onFocus:function(){this._setFocused(!0)},_onBlur:function(){this._setFocused(!1),this._handleValueAndAutoValidate(this._inputElement)},_onInput:function(e){this._handleValueAndAutoValidate(e.target)},_onValueChanged:function(e){var t=e.target;this.__isFirstValueUpdate&&(this.__isFirstValueUpdate=!1,void 0===t.value||""===t.value)||this._handleValueAndAutoValidate(e.target)},_handleValue:function(e){var t=this._inputElementValue;t||0===t||"number"===e.type&&!e.checkValidity()?this._inputHasContent=!0:this._inputHasContent=!1,this.updateAddons({inputElement:e,value:t,invalid:this.invalid})},_handleValueAndAutoValidate:function(e){var t;this.autoValidate&&e&&(t=e.validate?e.validate(this._inputElementValue):e.checkValidity(),this.invalid=!t);this._handleValue(e)},_onIronInputValidate:function(e){this.invalid=this._inputElement.invalid},_invalidChanged:function(){this._addons&&this.updateAddons({invalid:this.invalid})},updateAddons:function(e){for(var t,i=0;t=this._addons[i];i++)t.update(e)},_computeInputContentClass:function(e,t,i,n,o){var r="input-content";if(e)o&&(r+=" label-is-hidden"),n&&(r+=" is-invalid");else{var s=this.querySelector("label");t||o?(r+=" label-is-floating",this.$.labelAndInputContainer.style.position="static",n?r+=" is-invalid":i&&(r+=" label-is-highlighted")):(s&&(this.$.labelAndInputContainer.style.position="relative"),n&&(r+=" is-invalid"))}return i&&(r+=" focused"),r},_computeUnderlineClass:function(e,t){var i="underline";return t?i+=" is-invalid":e&&(i+=" is-highlighted"),i},_computeAddOnContentClass:function(e,t){var i="add-on-content";return t?i+=" is-invalid":e&&(i+=" is-highlighted"),i}}),zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        visibility: hidden;

        color: var(--paper-input-container-invalid-color, var(--error-color));

        @apply --paper-font-caption;
        @apply --paper-input-error;
        position: absolute;
        left:0;
        right:0;
      }

      :host([invalid]) {
        visibility: visible;
      }

      #a11yWrapper {
        visibility: hidden;
      }

      :host([invalid]) #a11yWrapper {
        visibility: visible;
      }
    </style>

    <!--
    If the paper-input-error element is directly referenced by an
    \`aria-describedby\` attribute, such as when used as a paper-input add-on,
    then applying \`visibility: hidden;\` to the paper-input-error element itself
    does not hide the error.

    For more information, see:
    https://www.w3.org/TR/accname-1.1/#mapping_additional_nd_description
    -->
    <div id="a11yWrapper">
      <slot></slot>
    </div>
`,is:"paper-input-error",behaviors:[G_],properties:{invalid:{readOnly:!0,reflectToAttribute:!0,type:Boolean}},update:function(e){this._setInvalid(e.invalid)}});const V_={properties:{name:{type:String},value:{notify:!0,type:String},required:{type:Boolean,value:!1}},attached:function(){},detached:function(){}},W_={NextLabelID:1,NextAddonID:1,NextInputID:1},q_={properties:{label:{type:String},value:{notify:!0,type:String},disabled:{type:Boolean,value:!1},invalid:{type:Boolean,value:!1,notify:!0},allowedPattern:{type:String},type:{type:String},list:{type:String},pattern:{type:String},required:{type:Boolean,value:!1},errorMessage:{type:String},charCounter:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},autoValidate:{type:Boolean,value:!1},validator:{type:String},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,observer:"_autofocusChanged"},inputmode:{type:String},minlength:{type:Number},maxlength:{type:Number},min:{type:String},max:{type:String},step:{type:String},name:{type:String},placeholder:{type:String,value:""},readonly:{type:Boolean,value:!1},size:{type:Number},autocapitalize:{type:String,value:"none"},autocorrect:{type:String,value:"off"},autosave:{type:String},results:{type:Number},accept:{type:String},multiple:{type:Boolean},_ariaDescribedBy:{type:String,value:""},_ariaLabelledBy:{type:String,value:""},_inputId:{type:String,value:""}},listeners:{"addon-attached":"_onAddonAttached"},keyBindings:{"shift+tab:keydown":"_onShiftTabDown"},hostAttributes:{tabindex:0},get inputElement(){return this.$||(this.$={}),this.$.input||(this._generateInputId(),this.$.input=this.$$("#"+this._inputId)),this.$.input},get _focusableElement(){return this.inputElement},created:function(){this._typesThatHaveText=["date","datetime","datetime-local","month","time","week","file"]},attached:function(){this._updateAriaLabelledBy(),!fi&&this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.inputElement.type)&&(this.alwaysFloatLabel=!0)},_appendStringWithSpace:function(e,t){return e=e?e+" "+t:t},_onAddonAttached:function(e){var t=Th(e).rootTarget;if(t.id)this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,t.id);else{var i="paper-input-add-on-"+W_.NextAddonID++;t.id=i,this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,i)}},validate:function(){return this.inputElement.validate()},_focusBlurHandler:function(e){lf._focusBlurHandler.call(this,e),this.focused&&!this._shiftTabPressed&&this._focusableElement&&this._focusableElement.focus()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");this._shiftTabPressed=!0,this.setAttribute("tabindex","-1"),this.async((function(){this.setAttribute("tabindex",t),this._shiftTabPressed=!1}),1)},_handleAutoValidate:function(){this.autoValidate&&this.validate()},updateValueAndPreserveCaret:function(e){try{var t=this.inputElement.selectionStart;this.value=e,this.inputElement.selectionStart=t,this.inputElement.selectionEnd=t}catch(t){this.value=e}},_computeAlwaysFloatLabel:function(e,t){return t||e},_updateAriaLabelledBy:function(){var e,t=Th(this.root).querySelector("label");t?(t.id?e=t.id:(e="paper-input-label-"+W_.NextLabelID++,t.id=e),this._ariaLabelledBy=e):this._ariaLabelledBy=""},_generateInputId:function(){this._inputId&&""!==this._inputId||(this._inputId="input-"+W_.NextInputID++)},_onChange:function(e){this.shadowRoot&&this.fire(e.type,{sourceEvent:e},{node:this,bubbles:e.bubbles,cancelable:e.cancelable})},_autofocusChanged:function(){if(this.autofocus&&this._focusableElement){var e=document.activeElement;e instanceof HTMLElement&&e!==document.body&&e!==document.documentElement||this._focusableElement.focus()}}};var K_;zh({is:"paper-input",_template:mi`
    <style>
      :host {
        display: block;
      }

      :host([focused]) {
        outline: none;
      }

      :host([hidden]) {
        display: none !important;
      }

      input {
        /* Firefox sets a min-width on the input, which can cause layout issues */
        min-width: 0;
      }

      /* In 1.x, the <input> is distributed to paper-input-container, which styles it.
      In 2.x the <iron-input> is distributed to paper-input-container, which styles
      it, but in order for this to work correctly, we need to reset some
      of the native input's properties to inherit (from the iron-input) */
      iron-input > input {
        @apply --paper-input-container-shared-input-style;
        font-family: inherit;
        font-weight: inherit;
        font-size: inherit;
        letter-spacing: inherit;
        word-spacing: inherit;
        line-height: inherit;
        text-shadow: inherit;
        color: inherit;
        cursor: inherit;
      }

      input:disabled {
        @apply --paper-input-container-input-disabled;
      }

      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      input::-webkit-clear-button {
        @apply --paper-input-container-input-webkit-clear;
      }

      input::-webkit-calendar-picker-indicator {
        @apply --paper-input-container-input-webkit-calendar-picker-indicator;
      }

      input::-webkit-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input:-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-ms-clear {
        @apply --paper-input-container-ms-clear;
      }

      input::-ms-reveal {
        @apply --paper-input-container-ms-reveal;
      }

      input:-ms-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container id="container" no-label-float="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <slot name="prefix" slot="prefix"></slot>

      <label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label>

      <!-- Need to bind maxlength so that the paper-input-char-counter works correctly -->
      <iron-input bind-value="{{value}}" slot="input" class="input-element" id$="[[_inputId]]" maxlength$="[[maxlength]]" allowed-pattern="[[allowedPattern]]" invalid="{{invalid}}" validator="[[validator]]">
        <input aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" disabled$="[[disabled]]" title$="[[title]]" type$="[[type]]" pattern$="[[pattern]]" required$="[[required]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" min$="[[min]]" max$="[[max]]" step$="[[step]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" list$="[[list]]" size$="[[size]]" autocapitalize$="[[autocapitalize]]" autocorrect$="[[autocorrect]]" on-change="_onChange" tabindex$="[[tabIndex]]" autosave$="[[autosave]]" results$="[[results]]" accept$="[[accept]]" multiple$="[[multiple]]" role$="[[inputRole]]" aria-haspopup$="[[inputAriaHaspopup]]">
      </iron-input>

      <slot name="suffix" slot="suffix"></slot>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter slot="add-on"></paper-input-char-counter>
      </template>

    </paper-input-container>
  `,behaviors:[[lf,qp,q_],V_],properties:{value:{type:String},inputRole:{type:String,value:void 0},inputAriaHaspopup:{type:String,value:void 0}},get _focusableElement(){return this.inputElement._inputElement},listeners:{"iron-input-ready":"_onIronInputReady"},_onIronInputReady:function(){this.$.nativeInput||(this.$.nativeInput=this.$$("input")),this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.$.nativeInput.type)&&(this.alwaysFloatLabel=!0),this.inputElement.bindValue&&this.$.container._handleValueAndAutoValidate(this.inputElement)}}),function(e){e[e.MOVED=0]="MOVED",e[e.NO_STOPS=1]="NO_STOPS",e[e.CLIPPED=2]="CLIPPED",e[e.ABORTED=3]="ABORTED"}(K_||(K_={}));class Y_{}function X_(e){return!(e instanceof Y_)}class J_{constructor(){this.targetSubject=new vr(null),this.target$=this.targetSubject.asObservable(),this._targetHeight=null,this.index=-1,this.cursorTargetClass=null,this.scrollMode=Xi.NEVER,this.focusOnMove=!1,this.stopsInternal=[]}get target(){return this.targetSubject.getValue()}set target(e){this.targetSubject.next(e),this._scrollToTarget()}set stops(e){this.stopsInternal=e,this._updateIndex()}get stops(){return this.stopsInternal}get targetableStops(){return this.stops.filter(X_)}next(e={}){return this._moveCursor(1,e)}previous(e={}){return this._moveCursor(-1,e)}moveToVisibleArea(e){if(!this.stops||!this._isIntersectionObserverSupported())return;const t=e?this.targetableStops.filter(e):this.targetableStops,i=this._getWindowDims(),n=Math.round(i.innerHeight/2);let o=null,r=null,s=t.length;const a=new IntersectionObserver(e=>{e.forEach(e=>{if(a.unobserve(e.target),!(e.isIntersecting||e.intersectionRatio>0))return;const t=e.boundingClientRect.top+Math.round(e.boundingClientRect.height/2),i=Math.abs(t-n);(null===r||i<r)&&(o=e.target,r=i)}),s-=e.length,0===s&&o&&this.setCursor(o,!0)});t.forEach(e=>{a.observe(e)})}_isIntersectionObserverSupported(){return"IntersectionObserver"in window}setCursor(e,t){if(!this.targetableStops.includes(e))return void this.unsetCursor();let i;t&&(i=this.scrollMode,this.scrollMode=Xi.NEVER),this.unsetCursor(),this.target=e,this._updateIndex(),this._decorateTarget(),t&&i&&(this.scrollMode=i)}unsetCursor(){this._unDecorateTarget(),this.index=-1,this.target=null,this._targetHeight=null}isAtStart(){return 0===this.stops.length||0===this.index}isAtEnd(){return 0===this.stops.length||this.index===this.stops.length-1}moveToStart(){this.stops.length&&this.setCursorAtIndex(0)}moveToEnd(){this.stops.length&&this.setCursorAtIndex(this.stops.length-1)}setCursorAtIndex(e,t){const i=this.stops[e];X_(i)&&this.setCursor(i,t)}_moveCursor(e,{filter:t,getTargetHeight:i,clipToTop:n}={}){if(!this.stops.length)return this.unsetCursor(),K_.NO_STOPS;let o=this.index;-1===this.index&&e<0&&(o=this.stops.length);let r,s=!1;do{if(o+=e,e>0&&o>=this.stops.length||e<0&&o<0){o=e<0||n?0:this.stops.length-1,r=this.stops[o],s=!0;break}r=this.stops[o]}while(X_(r)&&t&&!t(r));return X_(r)?(this._unDecorateTarget(),this.index=o,this.target=r,this._targetHeight=i?i(this.target):this.target.scrollHeight,this.focusOnMove&&this.target.focus(),this._decorateTarget(),s?K_.CLIPPED:K_.MOVED):K_.ABORTED}_decorateTarget(){this.target&&this.cursorTargetClass&&this.target.classList.add(this.cursorTargetClass)}_unDecorateTarget(){this.target&&this.cursorTargetClass&&this.target.classList.remove(this.cursorTargetClass)}_updateIndex(){if(!this.target)return void(this.index=-1);const e=this.stops.indexOf(this.target);-1===e?this.unsetCursor():this.index=e}_getTop(e){let t=e.offsetTop;for(let i=e.offsetParent;i;i=i.offsetParent)t+=i.offsetTop;return t}_targetIsVisible(e){const t=this._getWindowDims();return this.scrollMode===Xi.KEEP_VISIBLE&&e>t.pageYOffset&&e<t.pageYOffset+t.innerHeight}_calculateScrollToValue(e,t){return e+-this._getWindowDims().innerHeight/3+t.offsetHeight/2}_scrollToTarget(){if(!this.target||this.scrollMode===Xi.NEVER)return;const e=this._getWindowDims(),t=this._getTop(this.target),i=!this._targetHeight||this._targetIsVisible(t+this._targetHeight),n=this._calculateScrollToValue(t,this.target);this._targetIsVisible(t)&&(i||n<e.scrollY)||window.scrollTo(e.scrollX,n)}_getWindowDims(){return{scrollX:window.scrollX,scrollY:window.scrollY,innerHeight:window.innerHeight,pageYOffset:window.pageYOffset}}}const Z_=mi`
  <style include="shared-styles">
    :host {
      z-index: 100;
    }
    :host([is-hidden]) {
      display: none;
    }
    ul {
      list-style: none;
    }
    li {
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-m) var(--spacing-l);
    }
    li:last-of-type {
      border: none;
    }
    li:focus {
      outline: none;
    }
    li:hover {
      background-color: var(--hover-background-color);
    }
    li.selected {
      background-color: var(--selection-background-color);
    }
    .dropdown-content {
      background: var(--dropdown-background-color);
      box-shadow: var(--elevation-level-2);
      border-radius: var(--border-radius);
      max-height: 50vh;
      overflow: auto;
    }
    @media only screen and (max-height: 35em) {
      .dropdown-content {
        max-height: 80vh;
      }
    }
    .label {
      color: var(--deemphasized-text-color);
      padding-left: var(--spacing-l);
    }
    .hide {
      display: none;
    }
  </style>
  <div
    class="dropdown-content"
    slot="dropdown-content"
    id="suggestions"
    role="listbox"
  >
    <ul>
      <template is="dom-repeat" items="[[suggestions]]">
        <li
          data-index$="[[index]]"
          data-value$="[[item.dataValue]]"
          tabindex="-1"
          aria-label$="[[item.name]]"
          class="autocompleteOption"
          role="option"
          on-click="_handleClickItem"
        >
          <span>[[item.text]]</span>
          <span class$="label [[_computeLabelClass(item)]]"
            >[[item.label]]</span
          >
        </li>
      </template>
    </ul>
  </div>
`;var Q_=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let ev=class extends(((e,t)=>$h([kp],e))(Kf(fi))){constructor(){super(),this.index=null,this.isHidden=!0,this.verticalOffset=null,this.horizontalOffset=null,this.suggestions=[],this.cursor=new J_,this.cursor.cursorTargetClass="selected",this.cursor.focusOnMove=!0}static get template(){return Z_}get keyBindings(){return{up:"_handleUp",down:"_handleDown",enter:"_handleEnter",esc:"_handleEscape",tab:"_handleTab"}}disconnectedCallback(){this.cursor.unsetCursor(),super.disconnectedCallback()}close(){this.isHidden=!0}open(){this.isHidden=!1,this._resetCursorStops(),this.refit()}getCurrentText(){var e;return(null===(e=this.getCursorTarget())||void 0===e?void 0:e.dataset.value)||""}_handleUp(e){this.isHidden||(e.preventDefault(),e.stopPropagation(),this.cursorUp())}_handleDown(e){this.isHidden||(e.preventDefault(),e.stopPropagation(),this.cursorDown())}cursorDown(){this.isHidden||this.cursor.next()}cursorUp(){this.isHidden||this.cursor.previous()}_handleTab(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("item-selected",{detail:{trigger:"tab",selected:this.cursor.target},composed:!0,bubbles:!0}))}_handleEnter(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("item-selected",{detail:{trigger:"enter",selected:this.cursor.target},composed:!0,bubbles:!0}))}_handleEscape(){this._fireClose(),this.close()}_handleClickItem(e){e.preventDefault(),e.stopPropagation();let t=e.target;for(;!t.classList.contains("autocompleteOption");){if(!t||t===this)return;t=t.parentElement}this.dispatchEvent(new CustomEvent("item-selected",{detail:{trigger:"click",selected:t},composed:!0,bubbles:!0}))}_fireClose(){bi(this,"dropdown-closed")}getCursorTarget(){return this.cursor.target}_resetCursorStops(){this.suggestions.length>0?this.isHidden||(yh(),this.cursor.stops=Array.from(this.$.suggestions.querySelectorAll("li")),this._resetCursorIndex()):this.cursor.stops=[]}_setIndex(){this.cursor.index=this.index||-1}_resetCursorIndex(){this.cursor.setCursorAtIndex(0)}_computeLabelClass(e){return e.label?"":"hide"}};Q_([Oo({type:Number})],ev.prototype,"index",void 0),Q_([Oo({type:Boolean,reflectToAttribute:!0})],ev.prototype,"isHidden",void 0),Q_([Oo({type:Number})],ev.prototype,"verticalOffset",void 0),Q_([Oo({type:Number})],ev.prototype,"horizontalOffset",void 0),Q_([Oo({type:Array})],ev.prototype,"suggestions",void 0),Q_([No("suggestions")],ev.prototype,"_resetCursorStops",null),Q_([No("index")],ev.prototype,"_setIndex",null),ev=Q_([Po("gr-autocomplete-dropdown")],ev);const tv=mi`
  <style include="shared-styles">
    .searchIcon {
      display: none;
    }
    .searchIcon.showSearchIcon {
      display: inline-block;
    }
    iron-icon {
      margin: 0 var(--spacing-xs);
      vertical-align: top;
    }
    paper-input.borderless {
      border: none;
      padding: 0;
    }
    paper-input {
      background-color: var(--view-background-color);
      color: var(--primary-text-color);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      padding: var(--spacing-s);
      --paper-input-container: {
        padding: 0;
      }
      --paper-input-container-input: {
        font-size: var(--font-size-normal);
        line-height: var(--line-height-normal);
      }
      /* This is a hack for not being able to set height:0 on the underline
           of a paper-input 2.2.3 element. All the underline fixes below only
           actually work in 3.x.x, so the height must be adjusted directly as
           a workaround until we are on Polymer 3. */
      height: var(--line-height-normal);
      --paper-input-container-underline-height: 0;
      --paper-input-container-underline-wrapper-height: 0;
      --paper-input-container-underline-focus-height: 0;
      --paper-input-container-underline-legacy-height: 0;
      --paper-input-container-underline: {
        height: 0;
        display: none;
      }
      --paper-input-container-underline-focus: {
        height: 0;
        display: none;
      }
      --paper-input-container-underline-disabled: {
        height: 0;
        display: none;
      }
      /* Hide label for input. The label is still visible for
      screen readers. Workaround found at:
      https://github.com/PolymerElements/paper-input/issues/478 */
      --paper-input-container-label: {
        display: none;
      }
    }
    paper-input.warnUncommitted {
      --paper-input-container-input: {
        color: var(--error-text-color);
        font-size: inherit;
      }
    }
  </style>
  <paper-input
    no-label-float=""
    id="input"
    class$="[[_computeClass(borderless)]]"
    disabled$="[[disabled]]"
    value="{{text}}"
    placeholder="[[placeholder]]"
    on-keydown="_handleKeydown"
    on-focus="_onInputFocus"
    on-blur="_onInputBlur"
    autocomplete="off"
    label="[[label]]"
  >
    <!-- prefix as attribute is required to for polymer 1 -->
    <div slot="prefix" prefix="">
      <iron-icon
        icon="gr-icons:search"
        class$="searchIcon [[_computeShowSearchIconClass(showSearchIcon)]]"
      >
      </iron-icon>
    </div>

    <!-- suffix as attribute is required to for polymer 1 -->
    <div slot="suffix" suffix="">
      <slot name="suffix"></slot>
    </div>
  </paper-input>
  <gr-autocomplete-dropdown
    vertical-align="top"
    vertical-offset="[[verticalOffset]]"
    horizontal-align="left"
    id="suggestions"
    on-item-selected="_handleItemSelect"
    on-keydown="_handleKeydown"
    suggestions="[[_suggestions]]"
    role="listbox"
    index="[[_index]]"
    position-target="[[_inputElement]]"
  >
  </gr-autocomplete-dropdown>
`;var iv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const nv=/(?:[^\s"]+|"[^"]*")+/g;let ov=class extends(Kf(fi)){constructor(){super(...arguments),this.query=()=>Promise.resolve([]),this.threshold=1,this.allowNonSuggestedValues=!1,this.borderless=!1,this.disabled=!1,this.showSearchIcon=!1,this.verticalOffset=31,this.text="",this.placeholder="",this.clearOnCommit=!1,this.tabComplete=!1,this.value="",this.multi=!1,this.warnUncommitted=!1,this.noDebounce=!1,this._suggestions=[],this._suggestionEls=[],this._disableSuggestions=!1,this._focused=!1,this.label="",this._selected=null,this.handleBodyClick=e=>{const t=e.composedPath();if(t){for(let e=0;e<t.length;e++)if(t[e]===this)return;this._focused=!1}}}static get template(){return tv}get _nativeInput(){return this.$.input.$.nativeInput||this.$.input.inputElement}connectedCallback(){super.connectedCallback(),document.addEventListener("click",this.handleBodyClick)}disconnectedCallback(){var e;document.removeEventListener("click",this.handleBodyClick),null===(e=this.updateSuggestionsTask)||void 0===e||e.cancel(),super.disconnectedCallback()}get focusStart(){return this.$.input}focus(){this._nativeInput.focus()}selectAll(){const e=this._nativeInput;this.$.input.value&&e.setSelectionRange(0,this.$.input.value.length)}clear(){this.text=""}_handleItemSelect(e){"click"===e.detail.trigger&&(this._selected=e.detail.selected,this._commit())}get _inputElement(){return this.$&&this.$.input}setText(e){this._disableSuggestions=!0,this.text=e,this._disableSuggestions=!1}_onInputFocus(){this._focused=!0,this._updateSuggestions(this.text,this.threshold,this.noDebounce),this.$.input.classList.remove("warnUncommitted"),this.updateStyles()}_onInputBlur(){this.$.input.classList.toggle("warnUncommitted",this.warnUncommitted&&!!this.text.length&&!this._focused),this.updateStyles()}_updateSuggestions(e,t,i){if(void 0===e||void 0===t||void 0===i)return;if(this._suggestions=[],this._disableSuggestions)return;if(e.length<t)return void(this.value="");if(!this._focused)return;const n=()=>{this.query(e).then(t=>{if(e===this.text){for(const e of t)e.text=e.name;this._suggestions=t,yh(),-1===this._index&&(this.value="")}})};i?n():this.updateSuggestionsTask=Cu(this.updateSuggestionsTask,n,200)}_maybeOpenDropdown(e,t){return e.length>0&&t?this.$.suggestions.open():this.$.suggestions.close()}_computeClass(e){return e?"borderless":""}_handleKeydown(e){switch(this._focused=!0,e.keyCode){case 38:e.preventDefault(),this.$.suggestions.cursorUp();break;case 40:e.preventDefault(),this.$.suggestions.cursorDown();break;case 27:e.preventDefault(),this._cancel();break;case 9:this._suggestions.length>0&&this.tabComplete?(e.preventDefault(),this._handleInputCommit(!0),this.focus()):this._focused=!1;break;case 13:if(this.modifierPressed(e))break;e.preventDefault(),this._handleInputCommit();break;default:this.focus(),this._suggestions=[]}this.dispatchEvent(new CustomEvent("input-keydown",{detail:{keyCode:e.keyCode,input:this.$.input},composed:!0,bubbles:!0}))}_cancel(){this._suggestions.length?this.set("_suggestions",[]):bi(this,"cancel")}_handleInputCommit(e){!this.allowNonSuggestedValues&&this.$.suggestions.isHidden||(this._selected=this.$.suggestions.getCursorTarget(),this._commit(e))}_updateValue(e,t){if(!e)return;const i=Number(e.dataset.index);if(isNaN(i))return;const n=t[i].value;if(null!=n)if(this.multi){const e=this.text.match(nv);(null==e?void 0:e.length)&&(e[e.length-1]=n,this.value=e.join(" "))}else this.value=n}_commit(e){this._suggestions.length>0?this._updateValue(this._selected,this._suggestions):this.value=this.text||"";const t=this.value;if(this.multi)this.setText(this.value);else if(!this.clearOnCommit&&this._selected){const e=this._selected.dataset;if(e){const t=Number(e.index);if(isNaN(t))return;this.setText(this._suggestions[t].name||"")}}else this.clear();this._suggestions=[],e||this.dispatchEvent(new CustomEvent("commit",{detail:{value:t},composed:!0,bubbles:!0}))}_computeShowSearchIconClass(e){return e?"showSearchIcon":""}};iv([Oo({type:Object})],ov.prototype,"query",void 0),iv([Oo({type:Number})],ov.prototype,"threshold",void 0),iv([Oo({type:Boolean})],ov.prototype,"allowNonSuggestedValues",void 0),iv([Oo({type:Boolean})],ov.prototype,"borderless",void 0),iv([Oo({type:Boolean})],ov.prototype,"disabled",void 0),iv([Oo({type:Boolean})],ov.prototype,"showSearchIcon",void 0),iv([Oo({type:Number})],ov.prototype,"verticalOffset",void 0),iv([Oo({type:String,notify:!0})],ov.prototype,"text",void 0),iv([Oo({type:String})],ov.prototype,"placeholder",void 0),iv([Oo({type:Boolean})],ov.prototype,"clearOnCommit",void 0),iv([Oo({type:Boolean})],ov.prototype,"tabComplete",void 0),iv([Oo({type:String,notify:!0})],ov.prototype,"value",void 0),iv([Oo({type:Boolean})],ov.prototype,"multi",void 0),iv([Oo({type:Boolean})],ov.prototype,"warnUncommitted",void 0),iv([Oo({type:Boolean})],ov.prototype,"noDebounce",void 0),iv([Oo({type:Array})],ov.prototype,"_suggestions",void 0),iv([Oo({type:Array})],ov.prototype,"_suggestionEls",void 0),iv([Oo({type:Number})],ov.prototype,"_index",void 0),iv([Oo({type:Boolean})],ov.prototype,"_disableSuggestions",void 0),iv([Oo({type:Boolean})],ov.prototype,"_focused",void 0),iv([Oo({type:String})],ov.prototype,"label",void 0),iv([Oo({type:Object})],ov.prototype,"_selected",void 0),iv([No("text","threshold","noDebounce")],ov.prototype,"_updateSuggestions",null),iv([No("_suggestions","_focused")],ov.prototype,"_maybeOpenDropdown",null),ov=iv([Po("gr-autocomplete")],ov);const rv=mi`
  <style>
    .text {
      align-items: center;
      display: flex;
      flex-wrap: wrap;
    }
    .copyText {
      flex-grow: 1;
      margin-right: var(--spacing-s);
    }
    .hideInput {
      display: none;
    }
    input#input {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      @apply --text-container-style;
      width: 100%;
    }
    /*
       * Typically icons are 20px, which is the normal line-height.
       * The copy icon is too prominent at 20px, so we choose 16px
       * here, but add 2x2px padding below, so the entire
       * component should still fit nicely into a normal inline
       * layout flow.
       */
    #icon {
      height: 16px;
      width: 16px;
    }
    iron-icon {
      color: var(--deemphasized-text-color);
      vertical-align: top;
      --iron-icon-height: 20px;
      --iron-icon-width: 20px;
    }
    gr-button {
      --gr-button: {
        padding: 2px;
      }
    }
  </style>
  <div class="text">
    <iron-input
      class="copyText"
      type="text"
      bind-value="[[text]]"
      on-click="_handleInputClick"
      readonly=""
    >
      <input
        id="input"
        is="iron-input"
        class$="[[_computeInputClass(hideInput)]]"
        type="text"
        bind-value="[[text]]"
        on-click="_handleInputClick"
        readonly=""
      />
    </iron-input>
    <gr-button
      id="button"
      link=""
      has-tooltip="[[hasTooltip]]"
      class="copyToClipboard"
      title="[[buttonTitle]]"
      on-click="_copyToClipboard"
      aria-label="Click to copy to clipboard"
    >
      <iron-icon id="icon" icon="gr-icons:content-copy"></iron-icon>
    </gr-button>
  </div>
`;var sv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let av=class extends fi{constructor(){super(...arguments),this.hasTooltip=!1,this.hideInput=!1}static get template(){return rv}focusOnCopy(){this.$.button.focus()}_computeInputClass(e){return e?"hideInput":""}_handleInputClick(e){e.preventDefault(),Th(e).rootTarget.select()}_copyToClipboard(e){e.preventDefault(),e.stopPropagation(),this.hideInput&&(this.$.input.style.display="block"),this.$.input.focus(),this.$.input.select(),document.execCommand("copy"),this.hideInput&&(this.$.input.style.display="none"),this.$.icon.icon="gr-icons:check",setTimeout(()=>this.$.icon.icon="gr-icons:content-copy",1e3)}};sv([Oo({type:String})],av.prototype,"text",void 0),sv([Oo({type:String})],av.prototype,"buttonTitle",void 0),sv([Oo({type:Boolean})],av.prototype,"hasTooltip",void 0),sv([Oo({type:Boolean})],av.prototype,"hideInput",void 0),av=sv([Po("gr-copy-clipboard")],av);const lv=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    h3.edited:after {
      color: var(--deemphasized-text-color);
      content: ' *';
    }
    .inputUpdateBtn {
      margin-top: var(--spacing-s);
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="main gr-form-styles read-only">
    <div id="loading" class$="[[_computeLoadingClass(_loading)]]">
      Loading...
    </div>
    <div id="loadedContent" class$="[[_computeLoadingClass(_loading)]]">
      <h1 id="Title" class="heading-1">[[_groupName]]</h1>
      <h2 id="configurations" class="heading-2">General</h2>
      <div id="form">
        <fieldset>
          <h3 id="groupUUID" class="heading-3">Group UUID</h3>
          <fieldset>
            <gr-copy-clipboard
              id="uuid"
              text="[[_getGroupUUID(_groupConfig.id)]]"
            ></gr-copy-clipboard>
          </fieldset>
          <h3
            id="groupName"
            class$="heading-3 [[_computeHeaderClass(_rename)]]"
          >
            Group Name
          </h3>
          <fieldset>
            <span class="value">
              <gr-autocomplete
                id="groupNameInput"
                text="{{_groupConfig.name}}"
                disabled="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
              ></gr-autocomplete>
            </span>
            <span
              class="value"
              disabled$="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
            >
              <gr-button
                id="inputUpdateNameBtn"
                on-click="_handleSaveName"
                disabled="[[!_rename]]"
              >
                Rename Group</gr-button
              >
            </span>
          </fieldset>
          <h3
            id="groupOwner"
            class$="heading-3 [[_computeHeaderClass(_owner)]]"
          >
            Owners
          </h3>
          <fieldset>
            <span class="value">
              <gr-autocomplete
                id="groupOwnerInput"
                text="{{_groupConfig.owner}}"
                value="{{_groupConfigOwner}}"
                query="[[_query]]"
                disabled="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
              >
              </gr-autocomplete>
            </span>
            <span
              class="value"
              disabled$="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
            >
              <gr-button
                id="inputUpdateOwnerBtn"
                on-click="_handleSaveOwner"
                disabled="[[!_owner]]"
              >
                Change Owners</gr-button
              >
            </span>
          </fieldset>
          <h3 class$="heading-3 [[_computeHeaderClass(_description)]]">
            Description
          </h3>
          <fieldset>
            <div>
              <iron-autogrow-textarea
                class="description"
                autocomplete="on"
                bind-value="{{_groupConfig.description}}"
                disabled="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
              ></iron-autogrow-textarea>
            </div>
            <span
              class="value"
              disabled$="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
            >
              <gr-button
                on-click="_handleSaveDescription"
                disabled="[[!_description]]"
              >
                Save Description
              </gr-button>
            </span>
          </fieldset>
          <h3 id="options" class$="heading-3 [[_computeHeaderClass(_options)]]">
            Group Options
          </h3>
          <fieldset>
            <section>
              <span class="title">
                Make group visible to all registered users
              </span>
              <span class="value">
                <gr-select
                  id="visibleToAll"
                  bind-value="{{_groupConfig.options.visible_to_all}}"
                >
                  <select
                    disabled$="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
                  >
                    <template is="dom-repeat" items="[[_submitTypes]]">
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <span
              class="value"
              disabled$="[[_computeGroupDisabled(_groupOwner, _isAdmin, _groupIsInternal)]]"
            >
              <gr-button on-click="_handleSaveOptions" disabled="[[!_options]]">
                Save Group Options
              </gr-button>
            </span>
          </fieldset>
        </fieldset>
      </div>
    </div>
  </div>
`;var cv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const dv=/^[\da-f]{40}$/,hv={submitFalse:{value:!1,label:"False"},submitTrue:{value:!0,label:"True"}};let pv=class extends fi{constructor(){super(),this._rename=!1,this._groupIsInternal=!1,this._description=!1,this._owner=!1,this._options=!1,this._loading=!0,this._groupOwner=!1,this._submitTypes=Object.values(hv),this._isAdmin=!1,this.restApiService=i.restApiService,this._query=e=>this._getGroupSuggestions(e)}static get template(){return lv}connectedCallback(){super.connectedCallback(),this._loadGroup()}_loadGroup(){if(!this.groupId)return;const e=[];return this.restApiService.getGroupConfig(this.groupId,e=>{Si(e)}).then(t=>t&&t.name?(this._groupName=t.name,this._groupIsInternal=!!t.id.match(dv),e.push(this.restApiService.getIsAdmin().then(e=>{this._isAdmin=!!e})),e.push(this.restApiService.getIsGroupOwner(t.name).then(e=>{this._groupOwner=!!e})),t.options&&!t.options.visible_to_all&&(t.options.visible_to_all=!1),this._groupConfig=t,xi(this,t.name),Promise.all(e).then(()=>{this._loading=!1})):Promise.resolve())}_computeLoadingClass(e){return e?"loading":""}_isLoading(){return this._loading||void 0===this._loading}_handleSaveName(){const e=this._groupConfig;if(!this.groupId||!e||!e.name)return Promise.reject(new Error("invalid groupId or config name"));const t=e.name;return this.restApiService.saveGroupName(this.groupId,t).then(e=>{if(200===e.status){this._groupName=t;const e={name:t,external:!this._groupIsInternal};bi(this,"name-changed"),this.dispatchEvent(new CustomEvent("name-changed",{detail:e,composed:!0,bubbles:!0})),this._rename=!1}})}_handleSaveOwner(){if(!this.groupId||!this._groupConfig)return;let e=this._groupConfig.owner;return this._groupConfigOwner&&(e=decodeURIComponent(this._groupConfigOwner)),e?this.restApiService.saveGroupOwner(this.groupId,e).then(()=>{this._owner=!1}):void 0}_handleSaveDescription(){if(this.groupId&&this._groupConfig&&this._groupConfig.description)return this.restApiService.saveGroupDescription(this.groupId,this._groupConfig.description).then(()=>{this._description=!1})}_handleSaveOptions(){if(!this.groupId||!this._groupConfig||!this._groupConfig.options)return;const e={visible_to_all:this._groupConfig.options.visible_to_all};return this.restApiService.saveGroupOptions(this.groupId,e).then(()=>{this._options=!1})}_handleConfigName(){this._isLoading()||(this._rename=!0)}_handleConfigOwner(){this._isLoading()||(this._owner=!0)}_handleConfigDescription(){this._isLoading()||(this._description=!0)}_handleConfigOptions(){this._isLoading()||(this._options=!0)}_computeHeaderClass(e){return e?"edited":""}_getGroupSuggestions(e){return this.restApiService.getSuggestedGroups(e).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:decodeURIComponent(n.id)});return t})}_computeGroupDisabled(e,t,i){return!(i&&(t||e))}_getGroupUUID(e){if(e)return e.match(dv)?e:decodeURIComponent(e)}};cv([Oo({type:String})],pv.prototype,"groupId",void 0),cv([Oo({type:Boolean})],pv.prototype,"_rename",void 0),cv([Oo({type:Boolean})],pv.prototype,"_groupIsInternal",void 0),cv([Oo({type:Boolean})],pv.prototype,"_description",void 0),cv([Oo({type:Boolean})],pv.prototype,"_owner",void 0),cv([Oo({type:Boolean})],pv.prototype,"_options",void 0),cv([Oo({type:Boolean})],pv.prototype,"_loading",void 0),cv([Oo({type:Object})],pv.prototype,"_groupConfig",void 0),cv([Oo({type:String})],pv.prototype,"_groupConfigOwner",void 0),cv([Oo({type:Object})],pv.prototype,"_groupName",void 0),cv([Oo({type:Boolean})],pv.prototype,"_groupOwner",void 0),cv([Oo({type:Array})],pv.prototype,"_submitTypes",void 0),cv([Oo({type:Object})],pv.prototype,"_query",void 0),cv([Oo({type:Boolean})],pv.prototype,"_isAdmin",void 0),cv([No("_groupConfig.name")],pv.prototype,"_handleConfigName",null),cv([No("_groupConfig.owner","_groupConfigOwner")],pv.prototype,"_handleConfigOwner",null),cv([No("_groupConfig.description")],pv.prototype,"_handleConfigDescription",null),cv([No("_groupConfig.options.visible_to_all")],pv.prototype,"_handleConfigOptions",null),pv=cv([Po("gr-group")],pv);const uv=mi`
  <style>
    :host {
      display: inline-block;
      border-radius: 50%;
      background-size: cover;
      background-color: var(--avatar-background-color, var(--gray-background));
    }
  </style>
`;var gv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let mv=class extends fi{constructor(){super(...arguments),this.imageSize=16,this._hasAvatars=!1,this.restApiService=i.restApiService}static get template(){return uv}connectedCallback(){super.connectedCallback(),Promise.all([this._getConfig(),Qu().awaitPluginsLoaded()]).then(([e])=>{this._hasAvatars=!!(e&&e.plugin&&e.plugin.has_avatars),this._updateAvatarURL()})}_getConfig(){return this.restApiService.getConfig()}_accountChanged(){this._updateAvatarURL()}_updateAvatarURL(){if(!this._hasAvatars||!this.account)return void(this.hidden=!0);this.hidden=!1;const e=this._buildAvatarURL(this.account);e&&(this.style.backgroundImage='url("'+e+'")')}_getAccounts(e){return e._account_id||e.email||e.username||e.name}_buildAvatarURL(e){if(!e)return"";const t=e.avatars||[];if(0===t.length)return"";for(let e=0;e<t.length;e++)if(t[e].height===this.imageSize)return t[e].url;return this._getAccounts(e)?`${k()}/accounts/`+encodeURIComponent(`${this._getAccounts(e)}`)+`/avatar?s=${this.imageSize}`:""}};gv([Oo({type:Object,observer:"_accountChanged"})],mv.prototype,"account",void 0),gv([Oo({type:Number})],mv.prototype,"imageSize",void 0),gv([Oo({type:Boolean})],mv.prototype,"_hasAvatars",void 0),mv=gv([Po("gr-avatar")],mv);const fv=document.createElement("dom-module");fv.innerHTML='<template>\n    <style include="shared-styles">\n      :host {\n        position: absolute;\n        display: none;\n        z-index: 200;\n        max-width: 600px;\n        outline: none;\n      }\n      :host(.hovered) {\n        display: block;\n      }\n      :host(.hide) {\n        visibility: hidden;\n      }\n      /* You have to use a <div class="container"> in your hovercard in order\n         to pick up this consistent styling. */\n      #container {\n        background: var(--dialog-background-color);\n        border: 1px solid var(--border-color);\n        border-radius: var(--border-radius);\n        box-shadow: var(--elevation-level-5);\n      }\n    </style>\n  </template>',fv.register("gr-hovercard-shared-style");const _v=mi`
  <style include="gr-hovercard-shared-style">
    .top,
    .attention,
    .status,
    .voteable {
      padding: var(--spacing-s) var(--spacing-l);
    }
    .top {
      display: flex;
      padding-top: var(--spacing-xl);
      min-width: 300px;
    }
    gr-avatar {
      height: 48px;
      width: 48px;
      margin-right: var(--spacing-l);
    }
    .title,
    .email {
      color: var(--deemphasized-text-color);
    }
    .action {
      border-top: 1px solid var(--border-color);
      padding: var(--spacing-s) var(--spacing-l);
      --gr-button: {
        padding: var(--spacing-s) var(--spacing-m);
      }
    }
    .attention {
      background-color: var(--emphasis-color);
    }
    .attention a {
      text-decoration: none;
    }
    iron-icon {
      vertical-align: top;
    }
    .status iron-icon {
      width: 14px;
      height: 14px;
      position: relative;
      top: 2px;
    }
    iron-icon.attentionIcon {
      width: 14px;
      height: 14px;
      position: relative;
      top: 3px;
    }
    .reason {
      padding-top: var(--spacing-s);
    }
  </style>
  <div id="container" role="tooltip" tabindex="-1">
    <template is="dom-if" if="[[_isShowing]]">
      <div class="top">
        <div class="avatar">
          <gr-avatar account="[[account]]" image-size="56"></gr-avatar>
        </div>
        <div class="account">
          <h3 class="name heading-3">[[account.name]]</h3>
          <div class="email">[[account.email]]</div>
        </div>
      </div>
      <template is="dom-if" if="[[account.status]]">
        <div class="status">
          <span class="title">
            <iron-icon icon="gr-icons:calendar"></iron-icon>
            Status:
          </span>
          <span class="value">[[account.status]]</span>
        </div>
      </template>
      <template is="dom-if" if="[[voteableText]]">
        <div class="voteable">
          <span class="title">Voteable:</span>
          <span class="value">[[voteableText]]</span>
        </div>
      </template>
      <template
        is="dom-if"
        if="[[_computeShowLabelNeedsAttention(_config, highlightAttention, account, change)]]"
      >
        <div class="attention">
          <div>
            <iron-icon
              class="attentionIcon"
              icon="gr-icons:attention"
            ></iron-icon>
            <span>
              [[_computeText(account, _selfAccount)]] turn to take action.
            </span>
            <a
              href="https://gerrit-review.googlesource.com/Documentation/user-attention-set.html"
              target="_blank"
            >
              <iron-icon
                icon="gr-icons:help-outline"
                title="read documentation"
              ></iron-icon>
            </a>
          </div>
          <div class="reason">
            <span class="title">Reason:</span>
            <span class="value">[[_computeReason(change)]]</span>
            <template is="dom-if" if="[[_computeLastUpdate(change)]]">
              (<gr-date-formatter
                has-tooltip
                date-str="[[_computeLastUpdate(change)]]"
              ></gr-date-formatter
              >)
            </template>
          </div>
        </div>
      </template>
      <template
        is="dom-if"
        if="[[_computeShowActionAddToAttentionSet(_config, highlightAttention, account, change, _selfAccount)]]"
      >
        <div class="action">
          <gr-button
            class="addToAttentionSet"
            link=""
            no-uppercase=""
            on-click="_handleClickAddToAttentionSet"
          >
            Add to attention set
          </gr-button>
        </div>
      </template>
      <template
        is="dom-if"
        if="[[_computeShowActionRemoveFromAttentionSet(_config, highlightAttention, account, change, _selfAccount)]]"
      >
        <div class="action">
          <gr-button
            class="removeFromAttentionSet"
            link=""
            no-uppercase=""
            on-click="_handleClickRemoveFromAttentionSet"
          >
            Remove from attention set
          </gr-button>
        </div>
      </template>
      <template
        is="dom-if"
        if="[[_showReviewerOrCCActions(account, change, _selfAccount)]]"
      >
        <div class="action">
          <gr-button
            class="removeReviewerOrCC"
            link=""
            no-uppercase=""
            on-click="_handleRemoveReviewerOrCC"
          >
            Remove [[_computeReviewerOrCCText(account, change)]]
          </gr-button>
        </div>
        <div class="action">
          <gr-button
            class="changeReviewerOrCC"
            link=""
            no-uppercase=""
            on-click="_handleChangeReviewerOrCCStatus"
          >
            [[_computeChangeReviewerOrCCText(account, change)]]
          </gr-button>
        </div>
      </template>
    </template>
  </div>
`;function vv(e,t){return(null==t?void 0:t.name)?t.name:(null==t?void 0:t.username)?t.username:(null==t?void 0:t.email)?t.email:e&&e.user&&"Anonymous Coward"!==e.user.anonymous_coward_name?e.user.anonymous_coward_name:"Anonymous"}function yv(e,t,i=!1){var n;if(null==t?void 0:t.display_name)return t.display_name;if(!t||!t.name)return vv(e,t);const o=null===(n=null==e?void 0:e.accounts)||void 0===n?void 0:n.default_display_name;return i||o===sn.FIRST_NAME?t.name.trim().split(" ")[0]:o===sn.USERNAME&&t.username?t.username:t.name}function bv(e,t){return[vv(e,t),wv(t.email),t.status?"("+t.status+")":""].filter(e=>e.length>0).join(" ")}function wv(e){return void 0!==e?"<"+e+">":""}const Cv={change:{enable_attention_set:!0}};function Sv(e){var t;return!!(null===(t=null==e?void 0:e.change)||void 0===t?void 0:t.enable_attention_set)}function Ev(e){return!!(null==e?void 0:e._account_id)&&!Pn(e)}function Av(e,t,i){return Sv(e)&&Ev(t)&&!!(null==i?void 0:i.attention_set)&&o(null==i?void 0:i.attention_set,t._account_id)}var xv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Rv=class extends(Au(fi)){constructor(){super(),this.highlightAttention=!1,this.restApiService=i.restApiService,this.reporting=i.reportingService}static get template(){return _v}connectedCallback(){super.connectedCallback(),this.restApiService.getConfig().then(e=>{this._config=e}),this.restApiService.getAccount().then(e=>{this._selfAccount=e})}_computeText(e,t){return e&&t?In(e,t)?"Your":"Their":""}get isAttentionEnabled(){return Sv(this._config)&&!!this.highlightAttention&&!!this.change&&Ev(this.account)}get hasUserAttention(){return Av(this._config,this.account,this.change)}_computeReason(e){return function(e,t){if(!Av(Cv,e,t))return"";const i=t.attention_set[e._account_id];return(null==i?void 0:i.reason)?i.reason:""}(this.account,e)}_computeLastUpdate(e){return function(e,t){if(!Av(Cv,e,t))return"";const i=t.attention_set[e._account_id];return(null==i?void 0:i.last_update)?i.last_update:""}(this.account,e)}_showReviewerOrCCActions(e,t){return!!this._selfAccount&&To(t,e)}_getReviewerState(e,t){var i;return(null===(i=t.reviewers[en.REVIEWER])||void 0===i?void 0:i.some(t=>t._account_id===e._account_id))?en.REVIEWER:en.CC}_computeReviewerOrCCText(e,t){return t&&e?this._getReviewerState(e,t)===en.REVIEWER?"Reviewer":"CC":""}_computeChangeReviewerOrCCText(e,t){return t&&e?this._getReviewerState(e,t)===en.REVIEWER?"Move Reviewer to CC":"Move CC to Reviewer":""}_handleChangeReviewerOrCCStatus(){a(this.change,"change");const e=kn(this.account);this.dispatchEventThroughTarget("show-alert",{message:"Reloading page..."});const t={};t.reviewers=[{reviewer:e,state:this._getReviewerState(this.account,this.change)===en.CC?en.REVIEWER:en.CC}],this.restApiService.saveChangeReview(this.change._number,"current",t).then(e=>{if(!e||!e.ok)throw new Error("something went wrong when toggling"+this._getReviewerState(this.account,this.change));this.dispatchEventThroughTarget("reload",{clearPatchset:!0})})}_handleRemoveReviewerOrCC(){var e,t,i,n;if(!this.change||!((null===(e=this.account)||void 0===e?void 0:e._account_id)||(null===(t=this.account)||void 0===t?void 0:t.email)))throw new Error("Missing change or account.");this.dispatchEventThroughTarget("show-alert",{message:"Reloading page..."}),this.restApiService.removeChangeReviewer(this.change._number,(null===(i=this.account)||void 0===i?void 0:i._account_id)||(null===(n=this.account)||void 0===n?void 0:n.email)).then(e=>{if(!e||!e.ok)throw new Error("something went wrong when removing user");return this.dispatchEventThroughTarget("reload",{clearPatchset:!0}),e})}_computeShowLabelNeedsAttention(){return this.isAttentionEnabled&&this.hasUserAttention}_computeShowActionAddToAttentionSet(){return(Ao(this.change,this._selfAccount)||In(this.account,this._selfAccount))&&this.isAttentionEnabled&&!this.hasUserAttention}_computeShowActionRemoveFromAttentionSet(){return(Ao(this.change,this._selfAccount)||In(this.account,this._selfAccount))&&this.isAttentionEnabled&&this.hasUserAttention}_handleClickAddToAttentionSet(){if(!this.change||!this.account._account_id)return;this.dispatchEventThroughTarget("show-alert",{message:"Saving attention set update ...",dismissOnNavigation:!0});const e=`Added by ${yv(this._config,this._selfAccount)} using the hovercard menu`;this.change.attention_set||(this.change.attention_set={}),this.change.attention_set[this.account._account_id]={account:this.account,reason:e},this.dispatchEventThroughTarget("attention-set-updated"),this.reporting.reportInteraction("attention-hovercard-add",this._reportingDetails()),this.restApiService.addToAttentionSet(this.change._number,this.account._account_id,e).then(()=>{this.dispatchEventThroughTarget("hide-alert")}),this.hide()}_handleClickRemoveFromAttentionSet(){if(!this.change||!this.account._account_id)return;this.dispatchEventThroughTarget("show-alert",{message:"Saving attention set update ...",dismissOnNavigation:!0});const e=`Removed by ${yv(this._config,this._selfAccount)} using the hovercard menu`;this.change.attention_set&&delete this.change.attention_set[this.account._account_id],this.dispatchEventThroughTarget("attention-set-updated"),this.reporting.reportInteraction("attention-hovercard-remove",this._reportingDetails()),this.restApiService.removeFromAttentionSet(this.change._number,this.account._account_id,e).then(()=>{this.dispatchEventThroughTarget("hide-alert")}),this.hide()}_reportingDetails(){const e=this.account._account_id,t=this.change&&this.change.owner&&this.change.owner._account_id||-1,i=this._selfAccount&&this._selfAccount._account_id||-1,n=(this.change&&this.change.reviewers&&this.change.reviewers.REVIEWER?[...this.change.reviewers.REVIEWER]:[]).map(e=>e._account_id).filter(e=>e!==t);return{actionByOwner:i===t,actionByReviewer:-1!==i&&n.includes(i),targetIsOwner:e===t,targetIsReviewer:n.includes(e),targetIsSelf:e===i}}};xv([Oo({type:Object})],Rv.prototype,"account",void 0),xv([Oo({type:Object})],Rv.prototype,"_selfAccount",void 0),xv([Oo({type:Object})],Rv.prototype,"change",void 0),xv([Oo({type:String})],Rv.prototype,"voteableText",void 0),xv([Oo({type:Boolean})],Rv.prototype,"highlightAttention",void 0),xv([Oo({type:Object})],Rv.prototype,"_config",void 0),Rv=xv([Po("gr-hovercard-account")],Rv);const Tv=mi`
  <style>
    :host {
      display: inline-block;
      vertical-align: top;
      position: relative;
      border-radius: var(--label-border-radius);
      box-sizing: border-box;
      white-space: nowrap;
      padding: 0 var(--account-label-padding-horizontal, 0);
    }
    /* If the first element is the avatar, then we cancel the left padding, so
       we can fit nicely into the gr-account-chip rounding.
       The obvious alternative of 'chip has padding' and 'avatar gets negative
       margin' does not work, because we need 'overflow:hidden' on the label. */
    :host([cancel-left-padding]) {
      padding-left: 0;
    }
    :host::after {
      content: var(--account-label-suffix);
    }
    :host([deselected]) {
      background-color: var(--background-color-primary);
      border: 1px solid var(--comment-separator-color);
      border-radius: 8px;
      color: var(--deemphasized-text-color);
    }
    :host([selected]) {
      background-color: var(--chip-selected-background-color);
      border: 1px solid var(--chip-selected-background-color);
      border-radius: 8px;
      color: var(--chip-selected-text-color);
    }
    :host([selected]) iron-icon.attention {
      color: var(--chip-selected-text-color);
    }
    gr-avatar {
      height: calc(var(--line-height-normal) - 2px);
      width: calc(var(--line-height-normal) - 2px);
      vertical-align: top;
      position: relative;
      top: 1px;
    }
    .text {
      @apply --gr-account-label-text-style;
    }
    .text:hover {
      @apply --gr-account-label-text-hover-style;
    }
    #attentionButton {
      /* This negates the 4px horizontal padding, which we appreciate as a
         larger click target, but which we don't want to consume space. :-) */
      margin: 0 -4px 0 -4px;
      vertical-align: top;
    }
    iron-icon.attention {
      color: var(--deemphasized-text-color);
      width: 12px;
      height: 12px;
      vertical-align: top;
    }
    iron-icon.status {
      color: var(--deemphasized-text-color);
      width: 14px;
      height: 14px;
      vertical-align: top;
      position: relative;
      top: 2px;
    }
    .name {
      display: inline-block;
      vertical-align: top;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: var(--account-max-length, 180px);
    }
    .hasAttention .name {
      font-weight: var(--font-weight-bold);
    }
  </style>
  <span>
    <template is="dom-if" if="[[!hideHovercard]]">
      <gr-hovercard-account
        for="hovercardTarget"
        account="[[account]]"
        change="[[change]]"
        highlight-attention="[[highlightAttention]]"
        voteable-text="[[voteableText]]"
      >
      </gr-hovercard-account>
    </template>
    <template
      is="dom-if"
      if="[[_hasAttention(_config, highlightAttention, account, change, forceAttention)]]"
    >
      <gr-button
        id="attentionButton"
        link=""
        aria-label="Remove user from attention set"
        on-click="_handleRemoveAttentionClick"
        disabled="[[!_computeAttentionButtonEnabled(_config, highlightAttention, account, change, _selfAccount, selected)]]"
        has-tooltip="[[_computeAttentionButtonEnabled(_config, highlightAttention, account, change, _selfAccount, false)]]"
        title="[[_computeAttentionIconTitle(_config, highlightAttention, account, change, _selfAccount, forceAttention, selected)]]"
        ><iron-icon class="attention" icon="gr-icons:attention"></iron-icon>
      </gr-button>
    </template>
  </span>
  <span
    id="hovercardTarget"
    class$="[[_computeHasAttentionClass(_config, highlightAttention, account, change, forceAttention)]]"
  >
    <template is="dom-if" if="[[!hideAvatar]]">
      <gr-avatar account="[[account]]" image-size="32"></gr-avatar>
    </template>
    <span class="text">
      <span class="name">[[_computeName(account, _config, firstName)]]</span>
      <template is="dom-if" if="[[!hideStatus]]">
        <template is="dom-if" if="[[account.status]]">
          <iron-icon class="status" icon="gr-icons:calendar"></iron-icon>
        </template>
      </template>
    </span>
  </span>
`;var kv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Pv=class extends fi{constructor(){super(),this.forceAttention=!1,this.firstName=!1,this.highlightAttention=!1,this.hideHovercard=!1,this.hideAvatar=!1,this.cancelLeftPadding=!1,this.hideStatus=!1,this.selected=!1,this.deselected=!1,this.restApiService=i.restApiService,this.reporting=i.reportingService}static get template(){return Tv}ready(){super.ready(),this.restApiService.getConfig().then(e=>{this._config=e}),this.restApiService.getAccount().then(e=>{this._selfAccount=e}),this.addEventListener("attention-set-updated",()=>{this.change={...this.change}})}_isAttentionSetEnabled(e,t,i,n){return!(!e||!e.change||!e.change.enable_attention_set||!t||!n||!i||Pn(i))}_computeCancelLeftPadding(e,t,i,n,o,r){var s;const a=!!(null===(s=null==t?void 0:t.plugin)||void 0===s?void 0:s.has_avatars);return!e&&!this._hasAttention(t,i,n,o,r)&&a}_hasAttention(e,t,i,n,o){return o||this._hasUnforcedAttention(e,t,i,n)}_hasUnforcedAttention(e,t,i,n){return this._isAttentionSetEnabled(e,t,i,n)&&n.attention_set&&!!i._account_id&&o(n.attention_set,i._account_id)}_computeHasAttentionClass(e,t,i,n,o){return this._hasAttention(e,t,i,n,o)?"hasAttention":""}_computeName(e,t,i){return yv(t,e,i)}_handleRemoveAttentionClick(e){if(this.selected)return;if(e.preventDefault(),e.stopPropagation(),!this.account._account_id)return;this.dispatchEvent(new CustomEvent("show-alert",{detail:{message:"Saving attention set update ...",dismissOnNavigation:!0},composed:!0,bubbles:!0}));const t=`Removed by ${yv(this._config,this._selfAccount)} by clicking the attention icon`;this.change.attention_set&&delete this.change.attention_set[this.account._account_id],this.change={...this.change},this.reporting.reportInteraction("attention-icon-remove",this._reportingDetails()),this.restApiService.removeFromAttentionSet(this.change._number,this.account._account_id,t).then(()=>{bi(this,"hide-alert")})}_reportingDetails(){var e;const t=this.account._account_id,i=this.change&&this.change.owner&&this.change.owner._account_id||-1,n=(null===(e=this._selfAccount)||void 0===e?void 0:e._account_id)||-1,o=(this.change&&this.change.reviewers&&this.change.reviewers.REVIEWER?[...this.change.reviewers.REVIEWER]:[]).map(e=>e._account_id).filter(e=>e!==i);return{actionByOwner:n===i,actionByReviewer:-1!==n&&o.includes(n),targetIsOwner:t===i,targetIsReviewer:o.includes(t),targetIsSelf:t===n}}_computeAttentionButtonEnabled(e,t,i,n,o,r){return!!r||this._hasUnforcedAttention(e,t,i,n)&&(Ao(n,o)||In(i,o))}_computeAttentionIconTitle(e,t,i,n,o,r,s){return this._computeAttentionButtonEnabled(e,t,i,n,o,s)?"Click to remove the user from the attention set":r?'Disabled. Use "Modify" to make changes.':"Disabled. Only involved users can change."}};kv([Oo({type:Object})],Pv.prototype,"account",void 0),kv([Oo({type:Object})],Pv.prototype,"_selfAccount",void 0),kv([Oo({type:Object})],Pv.prototype,"change",void 0),kv([Oo({type:String})],Pv.prototype,"voteableText",void 0),kv([Oo({type:Boolean})],Pv.prototype,"forceAttention",void 0),kv([Oo({type:Boolean})],Pv.prototype,"firstName",void 0),kv([Oo({type:Boolean})],Pv.prototype,"highlightAttention",void 0),kv([Oo({type:Boolean})],Pv.prototype,"hideHovercard",void 0),kv([Oo({type:Boolean})],Pv.prototype,"hideAvatar",void 0),kv([Oo({type:Boolean,reflectToAttribute:!0,computed:"_computeCancelLeftPadding(hideAvatar, _config, highlightAttention, account, change, forceAttention)"})],Pv.prototype,"cancelLeftPadding",void 0),kv([Oo({type:Boolean})],Pv.prototype,"hideStatus",void 0),kv([Oo({type:Object})],Pv.prototype,"_config",void 0),kv([Oo({type:Boolean,reflectToAttribute:!0})],Pv.prototype,"selected",void 0),kv([Oo({type:Boolean,reflectToAttribute:!0})],Pv.prototype,"deselected",void 0),Pv=kv([Po("gr-account-label")],Pv);const Iv=mi`
  <style>
    :host {
      display: inline-block;
      vertical-align: top;
    }
    a {
      color: var(--primary-text-color);
      text-decoration: none;
    }
    gr-account-label {
      --gr-account-label-text-hover-style: {
        text-decoration: underline;
      }
    }
  </style>
  <span>
    <a href$="[[_computeOwnerLink(account)]]">
      <gr-account-label
        account="[[account]]"
        change="[[change]]"
        force-attention="[[forceAttention]]"
        highlight-attention="[[highlightAttention]]"
        hide-avatar="[[hideAvatar]]"
        hide-status="[[hideStatus]]"
        first-name="[[firstName]]"
        voteable-text="[[voteableText]]"
      >
      </gr-account-label>
    </a>
  </span>
`;var Ov=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Nv=class extends fi{constructor(){super(...arguments),this.forceAttention=!1,this.highlightAttention=!1,this.hideAvatar=!1,this.hideStatus=!1,this.firstName=!1}static get template(){return Iv}_computeOwnerLink(e){if(e)return Qm.getUrlForOwner(e.email||e.username||e.name||`${e._account_id}`)}};Ov([Oo({type:String})],Nv.prototype,"voteableText",void 0),Ov([Oo({type:Object})],Nv.prototype,"account",void 0),Ov([Oo({type:Object})],Nv.prototype,"change",void 0),Ov([Oo({type:Boolean})],Nv.prototype,"forceAttention",void 0),Ov([Oo({type:Boolean})],Nv.prototype,"highlightAttention",void 0),Ov([Oo({type:Boolean})],Nv.prototype,"hideAvatar",void 0),Ov([Oo({type:Boolean})],Nv.prototype,"hideStatus",void 0),Ov([Oo({type:Boolean})],Nv.prototype,"firstName",void 0),Nv=Ov([Po("gr-account-link")],Nv);const Lv=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* GenericList style centers the last column, but we don't want that here. */
    .genericList tr th:last-of-type,
    .genericList tr td:last-of-type {
      text-align: left;
    }
  </style>
  <table id="list" class="genericList">
    <tbody>
      <tr class="headerRow">
        <th class="date topHeader">Date</th>
        <th class="type topHeader">Type</th>
        <th class="member topHeader">Member</th>
        <th class="by-user topHeader">By User</th>
      </tr>
      <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
        <td>Loading...</td>
      </tr>
    </tbody>
    <tbody class$="[[computeLoadingClass(_loading)]]">
      <template is="dom-repeat" items="[[_auditLog]]">
        <tr class="table">
          <td class="date">
            <gr-date-formatter has-tooltip="" date-str="[[item.date]]">
            </gr-date-formatter>
          </td>
          <td class="type">[[itemType(item.type)]]</td>
          <td class="member">
            <template is="dom-if" if="[[_isGroupEvent(item.type)]]">
              <a href$="[[_computeGroupUrl(item.member)]]">
                [[_getNameForGroup(item.member)]]
              </a>
            </template>
            <template is="dom-if" if="[[!_isGroupEvent(item.type)]]">
              <gr-account-link account="[[item.member]]"></gr-account-link>
              [[_getIdForUser(item.member)]]
            </template>
          </td>
          <td class="by-user">
            <gr-account-link account="[[item.user]]"></gr-account-link>
            [[_getIdForUser(item.user)]]
          </td>
        </tr>
      </template>
    </tbody>
  </table>
`;var Dv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Mv=["ADD_GROUP","REMOVE_GROUP"];let Fv=class extends(B_(fi)){constructor(){super(...arguments),this._loading=!0,this.restApiService=i.restApiService}static get template(){return Lv}connectedCallback(){super.connectedCallback(),xi(this,"Audit Log")}ready(){super.ready(),this._getAuditLogs()}_getAuditLogs(){if(!this.groupId)return"";return this.restApiService.getGroupAuditLog(this.groupId,e=>{Si(e)}).then(e=>{e?(this._auditLog=e,this._loading=!1):this._auditLog=[]})}itemType(e){let t;switch(e){case"ADD_GROUP":case"ADD_USER":t="Added";break;case"REMOVE_GROUP":case"REMOVE_USER":t="Removed";break;default:t=""}return t}_isGroupEvent(e){return-1!==Mv.indexOf(e)}_computeGroupUrl(e){return e&&e.url&&e.id?Qm.getUrlForGroup(e.id):""}_getIdForUser(e){return e._account_id?` (${e._account_id})`:""}_getNameForGroup(e){return e&&e.name?e.name:e&&e.id?decodeURIComponent(e.id):""}};Dv([Oo({type:String})],Fv.prototype,"groupId",void 0),Dv([Oo({type:Array})],Fv.prototype,"_auditLog",void 0),Dv([Oo({type:Boolean})],Fv.prototype,"_loading",void 0),Fv=Dv([Po("gr-group-audit-log")],Fv);const $v=mi`
  <style include="shared-styles">
    :host {
      display: block;
      width: 30em;
    }
  </style>
  <gr-dialog
    confirm-label="Delete [[_computeItemName(itemType)]]"
    confirm-on-enter=""
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">
      [[_computeItemName(itemType)]] Deletion
    </div>
    <div class="main" slot="main">
      <label for="branchInput">
        Do you really want to delete the following
        [[_computeItemName(itemType)]]?
      </label>
      <div>[[item]]</div>
    </div>
  </gr-dialog>
`;var Bv,jv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.BRANCHES="branches",e.ID="id",e.TAGS="tags"}(Bv||(Bv={}));let Hv=class extends fi{static get template(){return $v}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}_computeItemName(e){return e===Bv.BRANCHES?"Branch":e===Bv.TAGS?"Tag":e===Bv.ID?"ID":""}};jv([Oo({type:String})],Hv.prototype,"item",void 0),jv([Oo({type:String})],Hv.prototype,"itemType",void 0),Hv=jv([Po("gr-confirm-delete-item-dialog")],Hv);const Uv=mi`
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    .input {
      width: 15em;
    }
    gr-autocomplete {
      width: 20em;
    }
    a {
      color: var(--primary-text-color);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    th {
      border-bottom: 1px solid var(--border-color);
      font-weight: var(--font-weight-bold);
      text-align: left;
    }
    .canModify #groupMemberSearchInput,
    .canModify #saveGroupMember,
    .canModify .deleteHeader,
    .canModify .deleteColumn,
    .canModify #includedGroupSearchInput,
    .canModify #saveIncludedGroups,
    .canModify .deleteIncludedHeader,
    .canModify #saveIncludedGroups {
      display: none;
    }
  </style>
  <div
    class$="main gr-form-styles [[_computeHideItemClass(_groupOwner, _isAdmin)]]"
  >
    <div id="loading" class$="[[_computeLoadingClass(_loading)]]">
      Loading...
    </div>
    <div id="loadedContent" class$="[[_computeLoadingClass(_loading)]]">
      <h1 id="Title" class="heading-1">[[_groupName]]</h1>
      <div id="form">
        <h3 id="members" class="heading-3">Members</h3>
        <fieldset>
          <span class="value">
            <gr-autocomplete
              id="groupMemberSearchInput"
              text="{{_groupMemberSearchName}}"
              value="{{_groupMemberSearchId}}"
              query="[[_queryMembers]]"
              placeholder="Name Or Email"
            >
            </gr-autocomplete>
          </span>
          <gr-button
            id="saveGroupMember"
            on-click="_handleSavingGroupMember"
            disabled="[[!_groupMemberSearchId]]"
          >
            Add
          </gr-button>
          <table id="groupMembers">
            <tbody>
              <tr class="headerRow">
                <th class="nameHeader">Name</th>
                <th class="emailAddressHeader">Email Address</th>
                <th class="deleteHeader">Delete Member</th>
              </tr>
            </tbody>
            <tbody>
              <template is="dom-repeat" items="[[_groupMembers]]">
                <tr>
                  <td class="nameColumn">
                    <gr-account-link account="[[item]]"></gr-account-link>
                  </td>
                  <td>[[item.email]]</td>
                  <td class="deleteColumn">
                    <gr-button
                      class="deleteMembersButton"
                      on-click="_handleDeleteMember"
                    >
                      Delete
                    </gr-button>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </fieldset>
        <h3 id="includedGroups" class="heading-3">Included Groups</h3>
        <fieldset>
          <span class="value">
            <gr-autocomplete
              id="includedGroupSearchInput"
              text="{{_includedGroupSearchName}}"
              value="{{_includedGroupSearchId}}"
              query="[[_queryIncludedGroup]]"
              placeholder="Group Name"
            >
            </gr-autocomplete>
          </span>
          <gr-button
            id="saveIncludedGroups"
            on-click="_handleSavingIncludedGroups"
            disabled="[[!_includedGroupSearchId]]"
          >
            Add
          </gr-button>
          <table id="includedGroups">
            <tbody>
              <tr class="headerRow">
                <th class="groupNameHeader">Group Name</th>
                <th class="descriptionHeader">Description</th>
                <th class="deleteIncludedHeader">Delete Group</th>
              </tr>
            </tbody>
            <tbody>
              <template is="dom-repeat" items="[[_includedGroups]]">
                <tr>
                  <td class="nameColumn">
                    <template is="dom-if" if="[[item.url]]">
                      <a href$="[[_computeGroupUrl(item.url)]]" rel="noopener">
                        [[item.name]]
                      </a>
                    </template>
                    <template is="dom-if" if="[[!item.url]]">
                      [[item.name]]
                    </template>
                  </td>
                  <td>[[item.description]]</td>
                  <td class="deleteColumn">
                    <gr-button
                      class="deleteIncludedGroupButton"
                      on-click="_handleDeleteIncludedGroup"
                    >
                      Delete
                    </gr-button>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </fieldset>
      </div>
    </div>
  </div>
  <gr-overlay id="overlay" with-backdrop="">
    <gr-confirm-delete-item-dialog
      class="confirmDialog"
      on-confirm="_handleDeleteConfirm"
      on-cancel="_handleConfirmDialogCancel"
      item="[[_itemName]]"
      item-type="[[_itemType]]"
    ></gr-confirm-delete-item-dialog>
  </gr-overlay>
`;var Gv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let zv=class extends fi{constructor(){super(),this._loading=!0,this._groupOwner=!1,this._isAdmin=!1,this.restApiService=i.restApiService,this._queryMembers=e=>this._getAccountSuggestions(e),this._queryIncludedGroup=e=>this._getGroupSuggestions(e)}static get template(){return Uv}connectedCallback(){super.connectedCallback(),this._loadGroupDetails(),xi(this,"Members")}_loadGroupDetails(){if(!this.groupId)return;const e=[];return this.restApiService.getGroupConfig(this.groupId,e=>{Si(e)}).then(t=>t&&t.name?(this._groupName=t.name,e.push(this.restApiService.getIsAdmin().then(e=>{this._isAdmin=!!e})),e.push(this.restApiService.getIsGroupOwner(this._groupName).then(e=>{this._groupOwner=!!e})),e.push(this.restApiService.getGroupMembers(this._groupName).then(e=>{this._groupMembers=e})),e.push(this.restApiService.getIncludedGroup(this._groupName).then(e=>{this._includedGroups=e})),Promise.all(e).then(()=>{this._loading=!1})):Promise.resolve())}_computeLoadingClass(e){return e?"loading":""}_isLoading(){return this._loading||void 0===this._loading}_computeGroupUrl(e){if(!e)return;return new RegExp("^(?:[a-z]+:)?//","i").test(e)?e:e.startsWith("#")?k()+e.slice(1):k()+e}_handleSavingGroupMember(){return this._groupName?this.restApiService.saveGroupMember(this._groupName,this._groupMemberSearchId).then(e=>{e&&this._groupName&&(this.restApiService.getGroupMembers(this._groupName).then(e=>{this._groupMembers=e}),this._groupMemberSearchName="",this._groupMemberSearchId=void 0)}):Promise.reject(new Error("group name undefined"))}_handleDeleteConfirm(){return this._groupName?(this.$.overlay.close(),"member"===this._itemType?this.restApiService.deleteGroupMember(this._groupName,this._itemId).then(e=>{204===e.status&&this._groupName&&this.restApiService.getGroupMembers(this._groupName).then(e=>{this._groupMembers=e})}):"includedGroup"===this._itemType?this.restApiService.deleteIncludedGroup(this._groupName,this._itemId).then(e=>{204!==e.status&&205!==e.status||!this._groupName||this.restApiService.getIncludedGroup(this._groupName).then(e=>{this._includedGroups=e})}):Promise.reject(new Error("Unrecognized item type"))):Promise.reject(new Error("group name undefined"))}_handleConfirmDialogCancel(){this.$.overlay.close()}_handleDeleteMember(e){const t=e.model.get("item._account_id"),i=e.model.get("item.name"),n=e.model.get("item.username"),o=e.model.get("item.email"),r=n||i||o||t;r&&(this._itemName=r,this._itemId=t,this._itemType="member",this.$.overlay.open())}_handleSavingIncludedGroups(){return this._groupName&&this._includedGroupSearchId?this.restApiService.saveIncludedGroup(this._groupName,this._includedGroupSearchId.replace(/\+/g," "),(e,t)=>{if(e){if(404===e.status)return Ci(this,"Group may not exist, or you may not have permission to add it"),e;throw Error(e.statusText)}throw t}).then(e=>{e&&this._groupName&&(this.restApiService.getIncludedGroup(this._groupName).then(e=>{this._includedGroups=e}),this._includedGroupSearchName="",this._includedGroupSearchId="")}):Promise.reject(new Error("group name or includedGroupSearchId undefined"))}_handleDeleteIncludedGroup(e){const t=decodeURIComponent(`${e.model.get("item.id")}`).replace(/\+/g," "),i=e.model.get("item.name")||t;i&&(this._itemName=i,this._itemId=t,this._itemType="includedGroup",this.$.overlay.open())}_getAccountSuggestions(e){return 0===e.length?Promise.resolve([]):this.restApiService.getSuggestedAccounts(e,15).then(e=>{var t;if(!e)return[];const i=[];for(const n of e){let e;e=void 0!==n.email?`${n.name} <${n.email}>`:n.name,i.push({name:e,value:null===(t=n._account_id)||void 0===t?void 0:t.toString()})}return i})}_getGroupSuggestions(e){return this.restApiService.getSuggestedGroups(e).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:decodeURIComponent(n.id)});return t})}_computeHideItemClass(e,t){return t||e?"":"canModify"}};Gv([Oo({type:Number})],zv.prototype,"groupId",void 0),Gv([Oo({type:Number})],zv.prototype,"_groupMemberSearchId",void 0),Gv([Oo({type:String})],zv.prototype,"_groupMemberSearchName",void 0),Gv([Oo({type:String})],zv.prototype,"_includedGroupSearchId",void 0),Gv([Oo({type:String})],zv.prototype,"_includedGroupSearchName",void 0),Gv([Oo({type:Boolean})],zv.prototype,"_loading",void 0),Gv([Oo({type:String})],zv.prototype,"_groupName",void 0),Gv([Oo({type:Object})],zv.prototype,"_groupMembers",void 0),Gv([Oo({type:Object})],zv.prototype,"_includedGroups",void 0),Gv([Oo({type:String})],zv.prototype,"_itemName",void 0),Gv([Oo({type:String})],zv.prototype,"_itemType",void 0),Gv([Oo({type:Object})],zv.prototype,"_queryMembers",void 0),Gv([Oo({type:Object})],zv.prototype,"_queryIncludedGroup",void 0),Gv([Oo({type:Boolean})],zv.prototype,"_groupOwner",void 0),Gv([Oo({type:Boolean})],zv.prototype,"_isAdmin",void 0),zv=Gv([Po("gr-group-members")],zv);const Vv=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    .placeholder {
      color: var(--deemphasized-text-color);
    }
  </style>
  <gr-list-view
    filter="[[_filter]]"
    items-per-page="[[_pluginsPerPage]]"
    items="[[_plugins]]"
    loading="[[_loading]]"
    offset="[[_offset]]"
    path="[[_path]]"
  >
    <table id="list" class="genericList">
      <tbody>
        <tr class="headerRow">
          <th class="name topHeader">Plugin Name</th>
          <th class="version topHeader">Version</th>
          <th class="apiVersion topHeader">API Version</th>
          <th class="status topHeader">Status</th>
        </tr>
        <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
          <td>Loading...</td>
        </tr>
      </tbody>
      <tbody class$="[[computeLoadingClass(_loading)]]">
        <template is="dom-repeat" items="[[_shownPlugins]]">
          <tr class="table">
            <td class="name">
              <template is="dom-if" if="[[item.index_url]]">
                <a href$="[[_computePluginUrl(item.index_url)]]">[[item.id]]</a>
              </template>
              <template is="dom-if" if="[[!item.index_url]]">
                [[item.id]]
              </template>
            </td>
            <td class="version">
              <template is="dom-if" if="[[item.version]]">
                [[item.version]]
              </template>
              <template is="dom-if" if="[[!item.version]]">
                <span class="placeholder">--</span>
              </template>
            </td>
            <td class="apiVersion">
              <template is="dom-if" if="[[item.api_version]]">
                [[item.api_version]]
              </template>
              <template is="dom-if" if="[[!item.api_version]]">
                <span class="placeholder">--</span>
              </template>
            </td>
            <td class="status">[[_status(item)]]</td>
          </tr>
        </template>
      </tbody>
    </table>
  </gr-list-view>
`;var Wv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let qv=class extends(B_(fi)){constructor(){super(...arguments),this._offset=0,this._path="/admin/plugins",this._pluginsPerPage=25,this._loading=!0,this._filter="",this.restApiService=i.restApiService}static get template(){return Vv}connectedCallback(){super.connectedCallback(),xi(this,"Plugins")}_paramsChanged(e){return this._loading=!0,this._filter=this.getFilterValue(e),this._offset=this.getOffsetValue(e),this._getPlugins(this._filter,this._pluginsPerPage,this._offset)}_getPlugins(e,t,i){return this.restApiService.getPlugins(e,t,i,e=>{Si(e)}).then(e=>{e?(this._plugins=Object.keys(e).map(t=>({...e[t],name:t})),this._loading=!1):this._plugins=[]})}_status(e){return!0===e.disabled?"Disabled":"Enabled"}_computePluginUrl(e){return this.getUrl("/",e)}};Wv([Oo({type:Object,observer:"_paramsChanged"})],qv.prototype,"params",void 0),Wv([Oo({type:Number})],qv.prototype,"_offset",void 0),Wv([Oo({type:String})],qv.prototype,"_path",void 0),Wv([Oo({type:Array})],qv.prototype,"_plugins",void 0),Wv([Oo({type:Array,computed:"computeShownItems(_plugins)"})],qv.prototype,"_shownPlugins",void 0),Wv([Oo({type:Number})],qv.prototype,"_pluginsPerPage",void 0),Wv([Oo({type:Boolean})],qv.prototype,"_loading",void 0),Wv([Oo({type:String})],qv.prototype,"_filter",void 0),qv=Wv([Po("gr-plugin-list")],qv);const Kv=mi` <slot></slot> `;var Yv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Xv=class extends fi{constructor(){super(...arguments),this._domHooks=new Map,this._initializedPlugins=new Map,this._endpointCallBack=()=>{}}static get template(){return Kv}disconnectedCallback(){for(const[e,t]of this._domHooks)t.handleInstanceDetached(e);Gu().onDetachedEndpoint(this.name,this._endpointCallBack),super.disconnectedCallback()}_initDecoration(e,t,i){const n=document.createElement(e);return this._initProperties(n,t,this.firstElementChild).then(e=>{const t=i?this.querySelector(`gr-endpoint-slot[name=${i}]`):null;return i&&(null==t?void 0:t.parentNode)?t.parentNode.insertBefore(e,t.nextSibling):this._appendChild(e),e})}_initReplacement(e,t){var i,n;[...[...this.childNodes],...[...null!==(n=null===(i=this.shadowRoot)||void 0===i?void 0:i.childNodes)&&void 0!==n?n:[]]].filter(e=>"GR-ENDPOINT-PARAM"!==e.nodeName).filter(e=>"SLOT"!==e.nodeName).forEach(e=>e.remove());const o=document.createElement(e);return this._initProperties(o,t).then(e=>this._appendChild(e))}_getEndpointParams(){return Array.from(this.querySelectorAll("gr-endpoint-param"))}_initProperties(e,t,i){const n=e;n.plugin=t,i&&(n.content=i);const o=this._getEndpointParams().map(e=>{const i=t.attributeHelper(e),o=e.getAttribute("name");if(!o)throw Error("plugin endpoint parameter missing a name");return i.get("value").then(()=>i.bind("value",e=>t.attributeHelper(n).set(o,e)))});let r;const s=new Promise(()=>r=window.setTimeout(()=>{console.warn("Timeout waiting for endpoint properties initialization: "+`plugin ${t.getPluginName()}, endpoint ${this.name}`)},1e4));return Promise.race([s,Promise.all(o)]).then(()=>n).finally(()=>{r&&clearTimeout(r)})}_appendChild(e){if(!this.root)throw Error("plugin endpoint decorator missing root");return this.root.appendChild(e)}_initModule({moduleName:e,plugin:t,type:i,domHook:n,slot:o}){const r=t.getPluginName()+"."+e;if(this._initializedPlugins.get(r))return;let s;switch(i){case"decorate":s=this._initDecoration(e,t,o);break;case"replace":s=this._initReplacement(e,t)}if(!s)throw Error(`unknown endpoint type ${i} used by plugin ${r}`);this._initializedPlugins.set(r,!0),s.then(e=>{n&&(n.handleInstanceAttached(e),this._domHooks.set(e,n))})}ready(){super.ready(),this._endpointCallBack=e=>this._initModule(e),Gu().onNewEndpoint(this.name,this._endpointCallBack),this.name&&Qu().awaitPluginsLoaded().then(()=>Gu().getDetails(this.name).forEach(this._initModule,this))}};Yv([Oo({type:String})],Xv.prototype,"name",void 0),Yv([Oo({type:Object})],Xv.prototype,"_domHooks",void 0),Yv([Oo({type:Object})],Xv.prototype,"_initializedPlugins",void 0),Xv=Yv([Po("gr-endpoint-decorator")],Xv);var Jv=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Zv=class extends fi{constructor(){super(...arguments),this.name=""}_valueChanged(e){this.dispatchEvent(new CustomEvent("value-changed",{detail:{value:e}}))}};Jv([Oo({type:String,reflectToAttribute:!0})],Zv.prototype,"name",void 0),Jv([Oo({type:Object,notify:!0,observer:"_valueChanged"})],Zv.prototype,"value",void 0),Zv=Jv([Po("gr-endpoint-param")],Zv);const Qv={observers:["_focusedChanged(receivedFocusFromKeyboard)"],_focusedChanged:function(e){e&&this.ensureRipple(),this.hasRipple()&&(this._ripple.holdDown=e)},_createRipple:function(){var e=Tf._createRipple();return e.id="ink",e.setAttribute("center",""),e.classList.add("circle"),e}},ey=[ff,lf,Tf,Qv];zh({is:"paper-icon-button",_template:mi`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        cursor: pointer;
        z-index: 0;
        line-height: 1;

        width: 40px;
        height: 40px;

        /*
          NOTE: Both values are needed, since some phones require the value to
          be \`transparent\`.
        */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        /* Because of polymer/2558, this style has lower specificity than * */
        box-sizing: border-box !important;

        @apply --paper-icon-button;
      }

      :host #ink {
        color: var(--paper-icon-button-ink-color, var(--primary-text-color));
        opacity: 0.6;
      }

      :host([disabled]) {
        color: var(--paper-icon-button-disabled-text, var(--disabled-text-color));
        pointer-events: none;
        cursor: auto;

        @apply --paper-icon-button-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:hover) {
        @apply --paper-icon-button-hover;
      }

      iron-icon {
        --iron-icon-width: 100%;
        --iron-icon-height: 100%;
      }
    </style>

    <iron-icon id="icon" src="[[src]]" icon="[[icon]]"
               alt$="[[alt]]"></iron-icon>
  `,hostAttributes:{role:"button",tabindex:"0"},behaviors:[ey],registered:function(){this._template.setAttribute("strip-whitespace","")},properties:{src:{type:String},icon:{type:String},alt:{type:String,observer:"_altChanged"}},_altChanged:function(e,t){var i=this.getAttribute("aria-label");i&&t!=i||this.setAttribute("aria-label",e)}});const ty=mi`<iron-iconset-svg name="paper-tabs" size="24">
<svg><defs>
<g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>
<g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(ty.content),zh({_template:mi`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center;
        @apply --layout-center-justified;
        @apply --layout-flex-auto;

        position: relative;
        padding: 0 12px;
        overflow: hidden;
        cursor: pointer;
        vertical-align: middle;

        @apply --paper-font-common-base;
        @apply --paper-tab;
      }

      :host(:focus) {
        outline: none;
      }

      :host([link]) {
        padding: 0;
      }

      .tab-content {
        height: 100%;
        transform: translateZ(0);
          -webkit-transform: translateZ(0);
        transition: opacity 0.1s cubic-bezier(0.4, 0.0, 1, 1);
        @apply --layout-horizontal;
        @apply --layout-center-center;
        @apply --layout-flex-auto;
        @apply --paper-tab-content;
      }

      :host(:not(.iron-selected)) > .tab-content {
        opacity: 0.8;

        @apply --paper-tab-content-unselected;
      }

      :host(:focus) .tab-content {
        opacity: 1;
        font-weight: 700;

        @apply --paper-tab-content-focused;
      }

      paper-ripple {
        color: var(--paper-tab-ink, var(--paper-yellow-a100));
      }

      .tab-content > ::slotted(a) {
        @apply --layout-flex-auto;

        height: 100%;
      }
    </style>

    <div class="tab-content">
      <slot></slot>
    </div>
`,is:"paper-tab",behaviors:[lf,ff,Tf],properties:{link:{type:Boolean,value:!1,reflectToAttribute:!0}},hostAttributes:{role:"tab"},listeners:{down:"_updateNoink",tap:"_onTap"},attached:function(){this._updateNoink()},get _parentNoink(){var e=Th(this).parentNode;return!!e&&!!e.noink},_updateNoink:function(){this.noink=!!this.noink||!!this._parentNoink},_onTap:function(e){if(this.link){var t=this.queryEffectiveChildren("a");if(!t)return;if(e.target===t)return;t.click()}}}),zh({_template:mi`
    <style>
      :host {
        @apply --layout;
        @apply --layout-center;

        height: 48px;
        font-size: 14px;
        font-weight: 500;
        overflow: hidden;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;

        /* NOTE: Both values are needed, since some phones require the value to be \`transparent\`. */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        @apply --paper-tabs;
      }

      :host(:dir(rtl)) {
        @apply --layout-horizontal-reverse;
      }

      #tabsContainer {
        position: relative;
        height: 100%;
        white-space: nowrap;
        overflow: hidden;
        @apply --layout-flex-auto;
        @apply --paper-tabs-container;
      }

      #tabsContent {
        height: 100%;
        -moz-flex-basis: auto;
        -ms-flex-basis: auto;
        flex-basis: auto;
        @apply --paper-tabs-content;
      }

      #tabsContent.scrollable {
        position: absolute;
        white-space: nowrap;
      }

      #tabsContent:not(.scrollable),
      #tabsContent.scrollable.fit-container {
        @apply --layout-horizontal;
      }

      #tabsContent.scrollable.fit-container {
        min-width: 100%;
      }

      #tabsContent.scrollable.fit-container > ::slotted(*) {
        /* IE - prevent tabs from compressing when they should scroll. */
        -ms-flex: 1 0 auto;
        -webkit-flex: 1 0 auto;
        flex: 1 0 auto;
      }

      .hidden {
        display: none;
      }

      .not-visible {
        opacity: 0;
        cursor: default;
      }

      paper-icon-button {
        width: 48px;
        height: 48px;
        padding: 12px;
        margin: 0 4px;
      }

      #selectionBar {
        position: absolute;
        height: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border-bottom: 2px solid var(--paper-tabs-selection-bar-color, var(--paper-yellow-a100));
          -webkit-transform: scale(0);
        transform: scale(0);
          -webkit-transform-origin: left center;
        transform-origin: left center;
          transition: -webkit-transform;
        transition: transform;

        @apply --paper-tabs-selection-bar;
      }

      #selectionBar.align-bottom {
        top: 0;
        bottom: auto;
      }

      #selectionBar.expand {
        transition-duration: 0.15s;
        transition-timing-function: cubic-bezier(0.4, 0.0, 1, 1);
      }

      #selectionBar.contract {
        transition-duration: 0.18s;
        transition-timing-function: cubic-bezier(0.0, 0.0, 0.2, 1);
      }

      #tabsContent > ::slotted(:not(#selectionBar)) {
        height: 100%;
      }
    </style>

    <paper-icon-button icon="paper-tabs:chevron-left" class$="[[_computeScrollButtonClass(_leftHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onLeftScrollButtonDown" tabindex="-1"></paper-icon-button>

    <div id="tabsContainer" on-track="_scroll" on-down="_down">
      <div id="tabsContent" class$="[[_computeTabsContentClass(scrollable, fitContainer)]]">
        <div id="selectionBar" class$="[[_computeSelectionBarClass(noBar, alignBottom)]]" on-transitionend="_onBarTransitionEnd"></div>
        <slot></slot>
      </div>
    </div>

    <paper-icon-button icon="paper-tabs:chevron-right" class$="[[_computeScrollButtonClass(_rightHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onRightScrollButtonDown" tabindex="-1"></paper-icon-button>
`,is:"paper-tabs",behaviors:[Ip,[Cf,{hostAttributes:{role:"menubar"},keyBindings:{left:"_onLeftKey",right:"_onRightKey"},_onUpKey:function(e){this.focusedItem.click(),e.detail.keyboardEvent.preventDefault()},_onDownKey:function(e){this.focusedItem.click(),e.detail.keyboardEvent.preventDefault()},get _isRTL(){return"rtl"===window.getComputedStyle(this).direction},_onLeftKey:function(e){this._isRTL?this._focusNext():this._focusPrevious(),e.detail.keyboardEvent.preventDefault()},_onRightKey:function(e){this._isRTL?this._focusPrevious():this._focusNext(),e.detail.keyboardEvent.preventDefault()},_onKeydown:function(e){this.keyboardEventMatchesKeys(e,"up down left right esc")||this._focusWithKeyboardEvent(e)}}]],properties:{noink:{type:Boolean,value:!1,observer:"_noinkChanged"},noBar:{type:Boolean,value:!1},noSlide:{type:Boolean,value:!1},scrollable:{type:Boolean,value:!1},fitContainer:{type:Boolean,value:!1},disableDrag:{type:Boolean,value:!1},hideScrollButtons:{type:Boolean,value:!1},alignBottom:{type:Boolean,value:!1},selectable:{type:String,value:"paper-tab"},autoselect:{type:Boolean,value:!1},autoselectDelay:{type:Number,value:0},_step:{type:Number,value:10},_holdDelay:{type:Number,value:1},_leftHidden:{type:Boolean,value:!1},_rightHidden:{type:Boolean,value:!1},_previousTab:{type:Object}},hostAttributes:{role:"tablist"},listeners:{"iron-resize":"_onTabSizingChanged","iron-items-changed":"_onTabSizingChanged","iron-select":"_onIronSelect","iron-deselect":"_onIronDeselect"},keyBindings:{"left:keyup right:keyup":"_onArrowKeyup"},created:function(){this._holdJob=null,this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,this._bindDelayedActivationHandler=this._delayedActivationHandler.bind(this),this.addEventListener("blur",this._onBlurCapture.bind(this),!0)},ready:function(){this.setScrollDirection("y",this.$.tabsContainer)},detached:function(){this._cancelPendingActivation()},_noinkChanged:function(e){Th(this).querySelectorAll("paper-tab").forEach(e?this._setNoinkAttribute:this._removeNoinkAttribute)},_setNoinkAttribute:function(e){e.setAttribute("noink","")},_removeNoinkAttribute:function(e){e.removeAttribute("noink")},_computeScrollButtonClass:function(e,t,i){return!t||i?"hidden":e?"not-visible":""},_computeTabsContentClass:function(e,t){return e?"scrollable"+(t?" fit-container":""):" fit-container"},_computeSelectionBarClass:function(e,t){return e?"hidden":t?"align-bottom":""},_onTabSizingChanged:function(){this.debounce("_onTabSizingChanged",(function(){this._scroll(),this._tabChanged(this.selectedItem)}),10)},_onIronSelect:function(e){this._tabChanged(e.detail.item,this._previousTab),this._previousTab=e.detail.item,this.cancelDebouncer("tab-changed")},_onIronDeselect:function(e){this.debounce("tab-changed",(function(){this._tabChanged(null,this._previousTab),this._previousTab=null}),1)},_activateHandler:function(){this._cancelPendingActivation(),wf._activateHandler.apply(this,arguments)},_scheduleActivation:function(e,t){this._pendingActivationItem=e,this._pendingActivationTimeout=this.async(this._bindDelayedActivationHandler,t)},_delayedActivationHandler:function(){var e=this._pendingActivationItem;this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,e.fire(this.activateEvent,null,{bubbles:!0,cancelable:!0})},_cancelPendingActivation:function(){void 0!==this._pendingActivationTimeout&&(this.cancelAsync(this._pendingActivationTimeout),this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0)},_onArrowKeyup:function(e){this.autoselect&&this._scheduleActivation(this.focusedItem,this.autoselectDelay)},_onBlurCapture:function(e){e.target===this._pendingActivationItem&&this._cancelPendingActivation()},get _tabContainerScrollSize(){return Math.max(0,this.$.tabsContainer.scrollWidth-this.$.tabsContainer.offsetWidth)},_scroll:function(e,t){if(this.scrollable){var i=t&&-t.ddx||0;this._affectScroll(i)}},_down:function(e){this.async((function(){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null)}),1)},_affectScroll:function(e){this.$.tabsContainer.scrollLeft+=e;var t=this.$.tabsContainer.scrollLeft;this._leftHidden=0===t,this._rightHidden=t===this._tabContainerScrollSize},_onLeftScrollButtonDown:function(){this._scrollToLeft(),this._holdJob=setInterval(this._scrollToLeft.bind(this),this._holdDelay)},_onRightScrollButtonDown:function(){this._scrollToRight(),this._holdJob=setInterval(this._scrollToRight.bind(this),this._holdDelay)},_onScrollButtonUp:function(){clearInterval(this._holdJob),this._holdJob=null},_scrollToLeft:function(){this._affectScroll(-this._step)},_scrollToRight:function(){this._affectScroll(this._step)},_tabChanged:function(e,t){if(!e)return this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),void this._positionBar(0,0);var i=this.$.tabsContent.getBoundingClientRect(),n=i.width,o=e.getBoundingClientRect(),r=o.left-i.left;if(this._pos={width:this._calcPercent(o.width,n),left:this._calcPercent(r,n)},this.noSlide||null==t)return this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),void this._positionBar(this._pos.width,this._pos.left);var s=t.getBoundingClientRect(),a=this.items.indexOf(t),l=this.items.indexOf(e);this.$.selectionBar.classList.add("expand");var c=a<l;this._isRTL&&(c=!c),c?this._positionBar(this._calcPercent(o.left+o.width-s.left,n)-5,this._left):this._positionBar(this._calcPercent(s.left+s.width-o.left,n)-5,this._calcPercent(r,n)+5),this.scrollable&&this._scrollToSelectedIfNeeded(o.width,r)},_scrollToSelectedIfNeeded:function(e,t){var i=t-this.$.tabsContainer.scrollLeft;i<0?this.$.tabsContainer.scrollLeft+=i:(i+=e-this.$.tabsContainer.offsetWidth)>0&&(this.$.tabsContainer.scrollLeft+=i)},_calcPercent:function(e,t){return 100*e/t},_positionBar:function(e,t){e=e||0,t=t||0,this._width=e,this._left=t,this.transform("translateX("+t+"%) scaleX("+e/100+")",this.$.selectionBar)},_onBarTransitionEnd:function(e){var t=this.$.selectionBar.classList;t.contains("expand")?(t.remove("expand"),t.add("contract"),this._positionBar(this._pos.width,this._pos.left)):t.contains("contract")&&t.remove("contract")}});const iy=mi`
  <style include="shared-styles">
    .commandContainer {
      margin-bottom: var(--spacing-m);
    }
    .commandContainer {
      background-color: var(--shell-command-background-color);
      /* Should be spacing-m larger than the :before width. */
      padding: var(--spacing-m) var(--spacing-m) var(--spacing-m)
        calc(3 * var(--spacing-m) + 0.5em);
      position: relative;
      width: 100%;
    }
    .commandContainer:before {
      content: '$';
      position: absolute;
      display: block;
      box-sizing: border-box;
      background: var(--shell-command-decoration-background-color);
      top: 0;
      bottom: 0;
      left: 0;
      /* Should be spacing-m smaller than the .commandContainer padding-left. */
      width: calc(2 * var(--spacing-m) + 0.5em);
      /* Should vertically match the padding of .commandContainer. */
      padding: var(--spacing-m);
      /* Should roughly match the height of .commandContainer without padding. */
      line-height: 26px;
    }
    .commandContainer gr-copy-clipboard {
      --text-container-style: {
        border: none;
      }
    }
  </style>
  <label>[[label]]</label>
  <div class="commandContainer">
    <gr-copy-clipboard text="[[command]]"></gr-copy-clipboard>
  </div>
`;var ny=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let oy=class extends fi{static get template(){return iy}focusOnCopy(){if(null!==this.shadowRoot){const e=this.shadowRoot.querySelector("gr-copy-clipboard");null!==e&&e.focusOnCopy()}}};ny([Oo({type:String})],oy.prototype,"command",void 0),ny([Oo({type:String})],oy.prototype,"label",void 0),oy=ny([Po("gr-shell-command")],oy);const ry=mi`
  <style include="shared-styles">
    paper-tabs {
      height: 3rem;
      margin-bottom: var(--spacing-m);
      --paper-tabs-selection-bar-color: var(--link-color);
    }
    paper-tab {
      max-width: 15rem;
      text-transform: uppercase;
      --paper-tab-ink: var(--link-color);
    }
    label,
    input {
      display: block;
    }
    label {
      font-weight: var(--font-weight-bold);
    }
    .schemes {
      display: flex;
      justify-content: space-between;
    }
    .commands {
      display: flex;
      flex-direction: column;
    }
    gr-shell-command {
      margin-bottom: var(--spacing-m);
    }
    .hidden {
      display: none;
    }
  </style>
  <div class="schemes">
    <paper-tabs
      id="downloadTabs"
      class$="[[_computeShowTabs(schemes)]]"
      selected="[[_computeSelected(schemes, selectedScheme)]]"
      on-selected-changed="_handleTabChange"
    >
      <template is="dom-repeat" items="[[schemes]]" as="scheme">
        <paper-tab data-scheme$="[[scheme]]">[[scheme]]</paper-tab>
      </template>
    </paper-tabs>
  </div>
  <div class="commands" hidden$="[[!schemes.length]]" hidden="">
    <template is="dom-repeat" items="[[commands]]" as="command">
      <gr-shell-command
        class$="[[_computeClass(command.title)]]"
        label="[[command.title]]"
        command="[[command.command]]"
      ></gr-shell-command>
    </template>
  </div>
`;var sy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let ay=class extends fi{constructor(){super(...arguments),this._loggedIn=!1,this.schemes=[],this.restApiService=i.restApiService}static get template(){return ry}connectedCallback(){super.connectedCallback(),this._getLoggedIn().then(e=>{this._loggedIn=e})}focusOnCopy(){this.shadowRoot.querySelector("gr-shell-command").focusOnCopy()}_getLoggedIn(){return this.restApiService.getLoggedIn()}_loggedInChanged(e){if(e)return this.restApiService.getPreferences().then(e=>{(null==e?void 0:e.download_scheme)&&(this.selectedScheme=e.download_scheme.toLowerCase())})}_handleTabChange(e){const t=this.schemes[e.detail.value];t&&t!==this.selectedScheme&&(this.set("selectedScheme",t),this._loggedIn&&this.restApiService.savePreferences({download_scheme:this.selectedScheme}))}_computeSelected(e,t){return`${e.findIndex(e=>e===t)||0}`}_computeShowTabs(e){return e.length>1?"":"hidden"}_computeClass(e){return"_label_"+e.replace(/[^a-z]+/gi,"").toLowerCase()}};sy([Oo({type:Array})],ay.prototype,"commands",void 0),sy([Oo({type:Boolean})],ay.prototype,"_loggedIn",void 0),sy([Oo({type:Array})],ay.prototype,"schemes",void 0),sy([Oo({type:String,notify:!0})],ay.prototype,"selectedScheme",void 0),sy([No("_loggedIn")],ay.prototype,"_loggedInChanged",null),ay=sy([Po("gr-download-commands")],ay);const ly={properties:{checked:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0,observer:"_checkedChanged"},toggles:{type:Boolean,value:!0,reflectToAttribute:!0},value:{type:String,value:"on",observer:"_valueChanged"}},observers:["_requiredChanged(required)"],created:function(){this._hasIronCheckedElementBehavior=!0},_getValidity:function(e){return this.disabled||!this.required||this.checked},_requiredChanged:function(){this.required?this.setAttribute("aria-required","true"):this.removeAttribute("aria-required")},_checkedChanged:function(){this.active=this.checked,this.fire("iron-change")},_valueChanged:function(){void 0!==this.value&&null!==this.value||(this.value="on")}},cy=[ey,[V_,P_,ly],{_checkedChanged:function(){ly._checkedChanged.call(this),this.hasRipple()&&(this.checked?this._ripple.setAttribute("checked",""):this._ripple.removeAttribute("checked"))},_buttonStateChanged:function(){Tf._buttonStateChanged.call(this),this.disabled||this.isAttached&&(this.checked=this.active)}}],dy=mi`

    <style>
      :host {
        display: inline-block;
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-common-base;
      }

      :host([disabled]) {
        pointer-events: none;
      }

      :host(:focus) {
        outline:none;
      }

      .toggle-bar {
        position: absolute;
        height: 100%;
        width: 100%;
        border-radius: 8px;
        pointer-events: none;
        opacity: 0.4;
        transition: background-color linear .08s;
        background-color: var(--paper-toggle-button-unchecked-bar-color, #000000);

        @apply --paper-toggle-button-unchecked-bar;
      }

      .toggle-button {
        position: absolute;
        top: -3px;
        left: 0;
        height: 20px;
        width: 20px;
        border-radius: 50%;
        box-shadow: 0 1px 5px 0 rgba(0, 0, 0, 0.6);
        transition: -webkit-transform linear .08s, background-color linear .08s;
        transition: transform linear .08s, background-color linear .08s;
        will-change: transform;
        background-color: var(--paper-toggle-button-unchecked-button-color, var(--paper-grey-50));

        @apply --paper-toggle-button-unchecked-button;
      }

      .toggle-button.dragging {
        -webkit-transition: none;
        transition: none;
      }

      :host([checked]:not([disabled])) .toggle-bar {
        opacity: 0.5;
        background-color: var(--paper-toggle-button-checked-bar-color, var(--primary-color));

        @apply --paper-toggle-button-checked-bar;
      }

      :host([disabled]) .toggle-bar {
        background-color: #000;
        opacity: 0.12;
      }

      :host([checked]) .toggle-button {
        -webkit-transform: translate(16px, 0);
        transform: translate(16px, 0);
      }

      :host([checked]:not([disabled])) .toggle-button {
        background-color: var(--paper-toggle-button-checked-button-color, var(--primary-color));

        @apply --paper-toggle-button-checked-button;
      }

      :host([disabled]) .toggle-button {
        background-color: #bdbdbd;
        opacity: 1;
      }

      .toggle-ink {
        position: absolute;
        top: -14px;
        left: -14px;
        right: auto;
        bottom: auto;
        width: 48px;
        height: 48px;
        opacity: 0.5;
        pointer-events: none;
        color: var(--paper-toggle-button-unchecked-ink-color, var(--primary-text-color));

        @apply --paper-toggle-button-unchecked-ink;
      }

      :host([checked]) .toggle-ink {
        color: var(--paper-toggle-button-checked-ink-color, var(--primary-color));

        @apply --paper-toggle-button-checked-ink;
      }

      .toggle-container {
        display: inline-block;
        position: relative;
        width: 36px;
        height: 14px;
        /* The toggle button has an absolute position of -3px; The extra 1px
        /* accounts for the toggle button shadow box. */
        margin: 4px 1px;
      }

      .toggle-label {
        position: relative;
        display: inline-block;
        vertical-align: middle;
        padding-left: var(--paper-toggle-button-label-spacing, 8px);
        pointer-events: none;
        color: var(--paper-toggle-button-label-color, var(--primary-text-color));
      }

      /* invalid state */
      :host([invalid]) .toggle-bar {
        background-color: var(--paper-toggle-button-invalid-bar-color, var(--error-color));
      }

      :host([invalid]) .toggle-button {
        background-color: var(--paper-toggle-button-invalid-button-color, var(--error-color));
      }

      :host([invalid]) .toggle-ink {
        color: var(--paper-toggle-button-invalid-ink-color, var(--error-color));
      }
    </style>

    <div class="toggle-container">
      <div id="toggleBar" class="toggle-bar"></div>
      <div id="toggleButton" class="toggle-button"></div>
    </div>

    <div class="toggle-label"><slot></slot></div>

  `;dy.setAttribute("strip-whitespace",""),zh({_template:dy,is:"paper-toggle-button",behaviors:[cy],hostAttributes:{role:"button","aria-pressed":"false",tabindex:0},properties:{},listeners:{track:"_ontrack"},attached:function(){hh(this,(function(){Fd(this,"pan-y")}))},_ontrack:function(e){var t=e.detail;"start"===t.state?this._trackStart(t):"track"===t.state?this._trackMove(t):"end"===t.state&&this._trackEnd(t)},_trackStart:function(e){this._width=this.$.toggleBar.offsetWidth/2,this._trackChecked=this.checked,this.$.toggleButton.classList.add("dragging")},_trackMove:function(e){var t=e.dx;this._x=Math.min(this._width,Math.max(0,this._trackChecked?this._width+t:t)),this.translate3d(this._x+"px",0,0,this.$.toggleButton),this._userActivate(this._x>this._width/2)},_trackEnd:function(e){this.$.toggleButton.classList.remove("dragging"),this.transform("",this.$.toggleButton)},_createRipple:function(){this._rippleContainer=this.$.toggleButton;var e=Tf._createRipple();return e.id="ink",e.setAttribute("recenters",""),e.classList.add("circle","toggle-ink"),e}});const hy=mi`
  <style>
    iron-icon {
      width: var(--line-height-normal);
      height: var(--line-height-normal);
      vertical-align: top;
    }
  </style>
  <slot></slot
  ><!--
 --><iron-icon icon="gr-icons:info" hidden$="[[!showIcon]]"></iron-icon>
`;var py=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let uy=class extends(Ff(fi)){constructor(){super(...arguments),this.showIcon=!1}static get template(){return hy}};py([Oo({type:String,reflectToAttribute:!0})],uy.prototype,"maxWidth",void 0),py([Oo({type:Boolean})],uy.prototype,"showIcon",void 0),uy=py([Po("gr-tooltip-content")],uy);const gy=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    .wrapper {
      width: 30em;
    }
    .existingItems {
      background: var(--table-header-background-color);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
    }
    gr-button {
      float: right;
      margin-left: var(--spacing-m);
      width: 4.5em;
    }
    .row {
      align-items: center;
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-m) 0;
      width: 100%;
    }
    .existingItems .row {
      padding: var(--spacing-m);
    }
    .existingItems .row:not(:first-of-type) {
      border-top: 1px solid var(--border-color);
    }
    input {
      flex-grow: 1;
    }
    .hide {
      display: none;
    }
    .placeholder {
      color: var(--deemphasized-text-color);
      padding-top: var(--spacing-m);
    }
  </style>
  <div class="wrapper gr-form-styles">
    <template is="dom-if" if="[[pluginOption.info.values.length]]">
      <div class="existingItems">
        <template is="dom-repeat" items="[[pluginOption.info.values]]">
          <div class="row">
            <span>[[item]]</span>
            <gr-button
              link=""
              disabled$="[[disabled]]"
              data-item$="[[item]]"
              on-click="_handleDelete"
              >Delete</gr-button
            >
          </div>
        </template>
      </div>
    </template>
    <template is="dom-if" if="[[!pluginOption.info.values.length]]">
      <div class="row placeholder">None configured.</div>
    </template>
    <div class$="row [[_computeShowInputRow(disabled)]]">
      <iron-input on-keydown="_handleInputKeydown" bind-value="{{_newValue}}">
        <input
          is="iron-input"
          id="input"
          on-keydown="_handleInputKeydown"
          bind-value="{{_newValue}}"
        />
      </iron-input>
      <gr-button
        id="addButton"
        disabled$="[[!_newValue.length]]"
        link=""
        on-click="_handleAddTap"
        >Add</gr-button
      >
    </div>
  </div>
`;var my=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let fy=class extends fi{constructor(){super(...arguments),this._newValue=""}static get template(){return gy}_computeDisabled(e){return!(e&&e.base&&e.base.info&&e.base.info.editable)}_handleAddTap(e){e.preventDefault(),this._handleAdd()}_handleInputKeydown(e){13===e.keyCode&&(e.preventDefault(),this._handleAdd())}_handleAdd(){this._newValue.length&&(this._dispatchChanged(this.pluginOption.info.values.concat([this._newValue])),this._newValue="")}_handleDelete(e){const t=Th(e).localTarget.dataset.item;this._dispatchChanged(this.pluginOption.info.values.filter(e=>e!==t))}_dispatchChanged(e){const{_key:t,info:i}=this.pluginOption,n={_key:t,info:{...i,values:e},notifyPath:`${t}.values`};this.dispatchEvent(new CustomEvent("plugin-config-option-changed",{detail:n}))}_computeShowInputRow(e){return e?"hide":""}};my([Oo({type:String})],fy.prototype,"_newValue",void 0),my([Oo({type:Object})],fy.prototype,"pluginOption",void 0),my([Oo({type:Boolean,computed:"_computeDisabled(pluginOption.*)"})],fy.prototype,"disabled",void 0),fy=my([Po("gr-plugin-config-array-editor")],fy);const _y=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    .inherited {
      color: var(--deemphasized-text-color);
      margin-left: var(--spacing-m);
    }
    section.section:not(.ARRAY) .title {
      align-items: center;
      display: flex;
    }
    section.section.ARRAY .title {
      padding-top: var(--spacing-m);
    }
  </style>
  <div class="gr-form-styles">
    <fieldset>
      <h4>[[pluginData.name]]</h4>
      <template is="dom-repeat" items="[[_pluginConfigOptions]]" as="option">
        <section class$="section [[option.info.type]]">
          <span class="title">
            <gr-tooltip-content
              has-tooltip="[[option.info.description]]"
              show-icon="[[option.info.description]]"
              title="[[option.info.description]]"
            >
              <span>[[option.info.display_name]]</span>
            </gr-tooltip-content>
          </span>
          <span class="value">
            <template is="dom-if" if="[[_isArray(option.info.type)]]">
              <gr-plugin-config-array-editor
                on-plugin-config-option-changed="_handleArrayChange"
                plugin-option="[[option]]"
              ></gr-plugin-config-array-editor>
            </template>
            <template is="dom-if" if="[[_isBoolean(option.info.type)]]">
              <paper-toggle-button
                checked="[[_computeChecked(option.info.value)]]"
                on-change="_handleBooleanChange"
                data-option-key$="[[option._key]]"
                disabled$="[[_computeDisabled(option.info.editable)]]"
                on-click="_onTapPluginBoolean"
              ></paper-toggle-button>
            </template>
            <template is="dom-if" if="[[_isList(option.info.type)]]">
              <gr-select
                bind-value$="[[option.info.value]]"
                on-change="_handleListChange"
              >
                <select
                  data-option-key$="[[option._key]]"
                  disabled$="[[_computeDisabled(option.info.editable)]]"
                >
                  <template
                    is="dom-repeat"
                    items="[[option.info.permitted_values]]"
                    as="value"
                  >
                    <option value$="[[value]]">[[value]]</option>
                  </template>
                </select>
              </gr-select>
            </template>
            <template is="dom-if" if="[[_isString(option.info.type)]]">
              <iron-input
                bind-value="[[option.info.value]]"
                on-input="_handleStringChange"
                data-option-key$="[[option._key]]"
                disabled$="[[_computeDisabled(option.info.editable)]]"
              >
                <input
                  is="iron-input"
                  value="[[option.info.value]]"
                  on-input="_handleStringChange"
                  data-option-key$="[[option._key]]"
                  disabled$="[[_computeDisabled(option.info.editable)]]"
                />
              </iron-input>
            </template>
            <template is="dom-if" if="[[option.info.inherited_value]]">
              <span class="inherited">
                (Inherited: [[option.info.inherited_value]])
              </span>
            </template>
          </span>
        </section>
      </template>
    </fieldset>
  </div>
`;var vy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let yy=class extends fi{static get template(){return _y}_computePluginConfigOptions(e){if(!e||!e.base||!e.base.config)return[];const t=e.base.config;return Object.keys(t).map(e=>({_key:e,info:t[e]}))}_isArray(e){return e===ln.ARRAY}_isBoolean(e){return e===ln.BOOLEAN}_isList(e){return e===ln.LIST}_isString(e){return e===ln.STRING||e===ln.INT||e===ln.LONG}_computeDisabled(e){return"false"===e}_computeChecked(e="false"){return JSON.parse(e)}_handleStringChange(e){const t=Th(e).localTarget,i=t.getAttribute("data-option-key"),n=this._buildConfigChangeInfo(t.value,i);this._handleChange(n)}_handleListChange(e){const t=Th(e).localTarget,i=t.getAttribute("data-option-key"),n=this._buildConfigChangeInfo(t.value,i);this._handleChange(n)}_handleBooleanChange(e){const t=Th(e).localTarget,i=t.getAttribute("data-option-key"),n=this._buildConfigChangeInfo(JSON.stringify(t.checked),i);this._handleChange(n)}_buildConfigChangeInfo(e,t){const i=this.pluginData.config[t];return i.value=null!==e?e:void 0,{_key:t,info:i,notifyPath:`${t}.value`}}_handleArrayChange(e){this._handleChange(e.detail)}_handleChange({_key:e,info:t,notifyPath:i}){const{name:n,config:o}=this.pluginData,r={name:n,config:{...o,[e]:t},notifyPath:`${n}.${i}`};this.dispatchEvent(new CustomEvent("plugin-config-changed",{detail:r,bubbles:!0,composed:!0}))}_onTapPluginBoolean(e){e.preventDefault()}};vy([Oo({type:Object})],yy.prototype,"pluginData",void 0),vy([Oo({type:Array,computed:"_computePluginConfigOptions(pluginData.*)"})],yy.prototype,"_pluginConfigOptions",void 0),yy=vy([Po("gr-repo-plugin-config")],yy);const by=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    h2.edited:after {
      color: var(--deemphasized-text-color);
      content: ' *';
    }
    .loading,
    .hide {
      display: none;
    }
    #loading.loading {
      display: block;
    }
    #loading:not(.loading) {
      display: none;
    }
    #options .repositorySettings {
      display: none;
    }
    #options .repositorySettings.showConfig {
      display: block;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="main gr-form-styles read-only">
    <style include="shared-styles">
      /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
    </style>
    <div class="info">
      <h1 id="Title" class="heading-1">[[repo]]</h1>
      <hr />
      <div>
        <a href$="[[_computeBrowseUrl(weblinks)]]"
          ><gr-button link disabled="[[!_computeBrowseUrl(weblinks)]]"
            >Browse</gr-button
          ></a
        ><a href$="[[_computeChangesUrl(repo)]]"
          ><gr-button link>View Changes</gr-button></a
        >
      </div>
    </div>
    <div id="loading" class$="[[_computeLoadingClass(_loading)]]">
      Loading...
    </div>
    <div id="loadedContent" class$="[[_computeLoadingClass(_loading)]]">
      <div id="downloadContent" class$="[[_computeHideClass(_schemes)]]">
        <h2 id="download" class="heading-2">Download</h2>
        <fieldset>
          <gr-download-commands
            id="downloadCommands"
            commands="[[_computeCommands(repo, _schemesObj, _selectedScheme)]]"
            schemes="[[_schemes]]"
            selected-scheme="{{_selectedScheme}}"
          ></gr-download-commands>
        </fieldset>
      </div>
      <h2
        id="configurations"
        class$="heading-2 [[_computeHeaderClass(_configChanged)]]"
      >
        Configurations
      </h2>
      <div id="form">
        <fieldset>
          <h3 id="Description" class="heading-3">Description</h3>
          <fieldset>
            <iron-autogrow-textarea
              id="descriptionInput"
              class="description"
              autocomplete="on"
              placeholder="<Insert repo description here>"
              bind-value="{{_repoConfig.description}}"
              disabled$="[[_readOnly]]"
            ></iron-autogrow-textarea>
          </fieldset>
          <h3 id="Options" class="heading-3">Repository Options</h3>
          <fieldset id="options">
            <section>
              <span class="title">State</span>
              <span class="value">
                <gr-select id="stateSelect" bind-value="{{_repoConfig.state}}">
                  <select disabled$="[[_readOnly]]">
                    <template is="dom-repeat" items="[[_states]]">
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Submit type</span>
              <span class="value">
                <gr-select
                  id="submitTypeSelect"
                  bind-value="{{_repoConfig.submit_type}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatSubmitTypeSelect(_repoConfig)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Allow content merges</span>
              <span class="value">
                <gr-select
                  id="contentMergeSelect"
                  bind-value="{{_repoConfig.use_content_merge.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.use_content_merge)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">
                Create a new change for every commit not in the target branch
              </span>
              <span class="value">
                <gr-select
                  id="newChangeSelect"
                  bind-value="{{_repoConfig.create_new_change_for_all_not_in_target.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.create_new_change_for_all_not_in_target)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Require Change-Id in commit message</span>
              <span class="value">
                <gr-select
                  id="requireChangeIdSelect"
                  bind-value="{{_repoConfig.require_change_id.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.require_change_id)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section
              id="enableSignedPushSettings"
              class$="repositorySettings [[_computeRepositoriesClass(_repoConfig.enable_signed_push)]]"
            >
              <span class="title">Enable signed push</span>
              <span class="value">
                <gr-select
                  id="enableSignedPush"
                  bind-value="{{_repoConfig.enable_signed_push.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.enable_signed_push)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section
              id="requireSignedPushSettings"
              class$="repositorySettings [[_computeRepositoriesClass(_repoConfig.require_signed_push)]]"
            >
              <span class="title">Require signed push</span>
              <span class="value">
                <gr-select
                  id="requireSignedPush"
                  bind-value="{{_repoConfig.require_signed_push.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.require_signed_push)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">
                Reject implicit merges when changes are pushed for review</span
              >
              <span class="value">
                <gr-select
                  id="rejectImplicitMergesSelect"
                  bind-value="{{_repoConfig.reject_implicit_merges.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.reject_implicit_merges)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">
                Enable adding unregistered users as reviewers and CCs on
                changes</span
              >
              <span class="value">
                <gr-select
                  id="unRegisteredCcSelect"
                  bind-value="{{_repoConfig.enable_reviewer_by_email.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.enable_reviewer_by_email)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title"> Set all new changes private by default</span>
              <span class="value">
                <gr-select
                  id="setAllnewChangesPrivateByDefaultSelect"
                  bind-value="{{_repoConfig.private_by_default.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.private_by_default)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">
                Set new changes to "work in progress" by default</span
              >
              <span class="value">
                <gr-select
                  id="setAllNewChangesWorkInProgressByDefaultSelect"
                  bind-value="{{_repoConfig.work_in_progress_by_default.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.work_in_progress_by_default)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Maximum Git object size limit</span>
              <span class="value">
                <iron-input
                  id="maxGitObjSizeIronInput"
                  bind-value="{{_repoConfig.max_object_size_limit.configured_value}}"
                  type="text"
                  disabled$="[[_readOnly]]"
                >
                  <input
                    id="maxGitObjSizeInput"
                    bind-value="{{_repoConfig.max_object_size_limit.configured_value}}"
                    is="iron-input"
                    type="text"
                    disabled$="[[_readOnly]]"
                  />
                </iron-input>
                <template
                  is="dom-if"
                  if="[[_repoConfig.max_object_size_limit.value]]"
                >
                  effective: [[_repoConfig.max_object_size_limit.value]] bytes
                </template>
              </span>
            </section>
            <section>
              <span class="title"
                >Match authored date with committer date upon submit</span
              >
              <span class="value">
                <gr-select
                  id="matchAuthoredDateWithCommitterDateSelect"
                  bind-value="{{_repoConfig.match_author_to_committer_date.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.match_author_to_committer_date)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Reject empty commit upon submit</span>
              <span class="value">
                <gr-select
                  id="rejectEmptyCommitSelect"
                  bind-value="{{_repoConfig.reject_empty_commit.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.reject_empty_commit)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
          </fieldset>
          <h3 id="Options" class="heading-3">Contributor Agreements</h3>
          <fieldset id="agreements">
            <section>
              <span class="title">
                Require a valid contributor agreement to upload</span
              >
              <span class="value">
                <gr-select
                  id="contributorAgreementSelect"
                  bind-value="{{_repoConfig.use_contributor_agreements.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.use_contributor_agreements)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
            <section>
              <span class="title">Require Signed-off-by in commit message</span>
              <span class="value">
                <gr-select
                  id="useSignedOffBySelect"
                  bind-value="{{_repoConfig.use_signed_off_by.configured_value}}"
                >
                  <select disabled$="[[_readOnly]]">
                    <template
                      is="dom-repeat"
                      items="[[_formatBooleanSelect(_repoConfig.use_signed_off_by)]]"
                    >
                      <option value="[[item.value]]">[[item.label]]</option>
                    </template>
                  </select>
                </gr-select>
              </span>
            </section>
          </fieldset>
          <div
            class$="pluginConfig [[_computeHideClass(_pluginData)]]"
            on-plugin-config-changed="_handlePluginConfigChanged"
          >
            <h3 class="heading-3">Plugins</h3>
            <template is="dom-repeat" items="[[_pluginData]]" as="data">
              <gr-repo-plugin-config
                plugin-data="[[data]]"
              ></gr-repo-plugin-config>
            </template>
          </div>
          <gr-button
            on-click="_handleSaveRepoConfig"
            disabled$="[[_computeButtonDisabled(_readOnly, _configChanged)]]"
            >Save changes</gr-button
          >
        </fieldset>
        <gr-endpoint-decorator name="repo-config">
          <gr-endpoint-param
            name="repoName"
            value="[[repo]]"
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="readOnly"
            value="[[_readOnly]]"
          ></gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    </div>
  </div>
`;var wy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Cy={active:{value:an.ACTIVE,label:"Active"},readOnly:{value:an.READ_ONLY,label:"Read Only"},hidden:{value:an.HIDDEN,label:"Hidden"}},Sy={mergeIfNecessary:{value:"MERGE_IF_NECESSARY",label:"Merge if necessary"},fastForwardOnly:{value:"FAST_FORWARD_ONLY",label:"Fast forward only"},rebaseAlways:{value:"REBASE_ALWAYS",label:"Rebase Always"},rebaseIfNecessary:{value:"REBASE_IF_NECESSARY",label:"Rebase if necessary"},mergeAlways:{value:"MERGE_ALWAYS",label:"Merge always"},cherryPick:{value:"CHERRY_PICK",label:"Cherry pick"}};let Ey=class extends fi{constructor(){super(...arguments),this._configChanged=!1,this._loading=!0,this._loggedIn=!1,this._readOnly=!0,this._states=Object.values(Cy),this._schemes=[],this._schemesDefault=[],this._selectedCommand="Clone",this.weblinks=[],this.restApiService=i.restApiService}static get template(){return by}connectedCallback(){super.connectedCallback(),this._loadRepo(),xi(this,`${this.repo}`)}_computePluginData(e){if(!e||!e.base)return[];const t=e.base;return Object.keys(t).map(e=>({name:e,config:t[e]}))}_loadRepo(){if(!this.repo)return Promise.resolve();const e=[];return e.push(this._getLoggedIn().then(e=>{if(this._loggedIn=e,e){const e=this.repo;if(!e)throw new Error("undefined repo");this.restApiService.getRepo(e).then(e=>{(null==e?void 0:e.web_links)&&(this.weblinks=e.web_links)}),this.restApiService.getRepoAccess(e).then(t=>{t&&this.repo===e&&(this._readOnly=!t[e].is_owner)})}})),e.push(this.restApiService.getProjectConfig(this.repo,e=>{Si(e)}).then(e=>{e&&(e.default_submit_type&&(e.submit_type=e.default_submit_type.configured_value),e.state||(e.state=Cy.active.value),this._repoConfig=e,this._loading=!1)})),e.push(this.restApiService.getConfig().then(e=>{e&&(this._schemesObj=e.download.schemes)})),Promise.all(e)}_computeLoadingClass(e){return e?"loading":""}_computeHideClass(e){return e&&e.length?"":"hide"}_loggedInChanged(e){e&&this.restApiService.getPreferences().then(e=>{(null==e?void 0:e.download_scheme)&&(this._selectedScheme=e.download_scheme.toLowerCase())})}_formatBooleanSelect(e){if(!e)return;let t="Inherit";return void 0!==e.inherited_value&&(t=`Inherit (${e.inherited_value})`),[{label:t,value:"INHERIT"},{label:"True",value:"TRUE"},{label:"False",value:"FALSE"}]}_formatSubmitTypeSelect(e){if(!e)return;const t=Object.values(Sy),i=e.default_submit_type;if(!i)return t;let n="Inherit";if(i.inherited_value){n=`Inherit (${i.inherited_value})`;for(const e of t)if(e.value===i.inherited_value){n=`Inherit (${e.label})`;break}}return[{label:n,value:"INHERIT"},...t]}_isLoading(){return this._loading||void 0===this._loading}_getLoggedIn(){return this.restApiService.getLoggedIn()}_formatRepoConfigForSave(e){const t={};for(const i of Object.keys(e)){const n=i;if("default_submit_type"!==n)if("plugin_config"===n)t.plugin_config_values=e.plugin_config;else if("object"==typeof e[n]){const i=e[n];i.configured_value&&(t[n]=i.configured_value)}else t[n]=e[n]}return t}_handleSaveRepoConfig(){return this._repoConfig&&this.repo?this.restApiService.saveRepoConfig(this.repo,this._formatRepoConfigForSave(this._repoConfig)).then(()=>{this._configChanged=!1}):Promise.reject(new Error("undefined repoConfig or repo"))}_handleConfigChanged(){this._isLoading()||(this._configChanged=!0)}_computeButtonDisabled(e,t){return e||!t}_computeHeaderClass(e){return e?"edited":""}_computeSchemes(e,t){return t?Object.keys(t):e}_schemesChanged(e){0!==e.length&&(this._selectedScheme&&e.includes(this._selectedScheme)||(this._selectedScheme=e.sort()[0]))}_computeCommands(e,t,i){if(!t||!e||!i)return[];if(!o(t,i))return[];const n=t[i].clone_commands,r=[];for(const[t,i]of Object.entries(n))r.push({title:t,command:i.replace(/\${project}/gi,encodeURI(e)).replace(/\${project-base-name}/gi,encodeURI(e.substring(e.lastIndexOf("/")+1)))});return r}_computeRepositoriesClass(e){return e?"showConfig":""}_computeChangesUrl(e){return Qm.getUrlForProjectChanges(e)}_computeBrowseUrl(e){var t;return null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.url}_handlePluginConfigChanged({detail:{name:e,config:t,notifyPath:i}}){var n;(null===(n=this._repoConfig)||void 0===n?void 0:n.plugin_config)&&(this._repoConfig.plugin_config[e]=t,this.notifyPath("_repoConfig.plugin_config."+i))}};wy([Oo({type:String})],Ey.prototype,"repo",void 0),wy([Oo({type:Boolean})],Ey.prototype,"_configChanged",void 0),wy([Oo({type:Boolean})],Ey.prototype,"_loading",void 0),wy([Oo({type:Boolean,observer:"_loggedInChanged"})],Ey.prototype,"_loggedIn",void 0),wy([Oo({type:Object})],Ey.prototype,"_repoConfig",void 0),wy([Oo({type:Array,computed:"_computePluginData(_repoConfig.plugin_config.*)"})],Ey.prototype,"_pluginData",void 0),wy([Oo({type:Boolean})],Ey.prototype,"_readOnly",void 0),wy([Oo({type:Array})],Ey.prototype,"_states",void 0),wy([Oo({type:Array,computed:"_computeSchemes(_schemesDefault, _schemesObj)",observer:"_schemesChanged"})],Ey.prototype,"_schemes",void 0),wy([Oo({type:Array})],Ey.prototype,"_schemesDefault",void 0),wy([Oo({type:String})],Ey.prototype,"_selectedCommand",void 0),wy([Oo({type:String})],Ey.prototype,"_selectedScheme",void 0),wy([Oo({type:Object})],Ey.prototype,"_schemesObj",void 0),wy([Oo({type:Array})],Ey.prototype,"weblinks",void 0),wy([No("_repoConfig.*")],Ey.prototype,"_handleConfigChanged",null),Ey=wy([Po("gr-repo")],Ey);const Ay=mi`
  <style include="shared-styles">
    :host {
      border-bottom: 1px solid var(--border-color);
      padding: var(--spacing-m);
      display: block;
    }
    #removeBtn {
      display: none;
    }
    .editing #removeBtn {
      display: flex;
    }
    #options {
      align-items: baseline;
      display: flex;
    }
    #options > * {
      margin-right: var(--spacing-m);
    }
    #mainContainer {
      align-items: baseline;
      display: flex;
      flex-wrap: nowrap;
      justify-content: space-between;
    }
    #deletedContainer.deleted {
      align-items: baseline;
      display: flex;
      justify-content: space-between;
    }
    #undoBtn,
    #force,
    #deletedContainer,
    #mainContainer.deleted {
      display: none;
    }
    #undoBtn.modified,
    #force.force {
      display: block;
    }
    .groupPath {
      color: var(--deemphasized-text-color);
    }
  </style>
  <style include="gr-form-styles">
    iron-autogrow-textarea {
      width: 14em;
    }
  </style>
  <div
    id="mainContainer"
    class$="gr-form-styles [[_computeSectionClass(editing, _deleted)]]"
  >
    <div id="options">
      <gr-select
        id="action"
        bind-value="{{rule.value.action}}"
        on-change="_handleValueChange"
      >
        <select disabled$="[[!editing]]">
          <template is="dom-repeat" items="[[_computeOptions(permission)]]">
            <option value="[[item]]">[[item]]</option>
          </template>
        </select>
      </gr-select>
      <template is="dom-if" if="[[label]]">
        <gr-select
          id="labelMin"
          bind-value="{{rule.value.min}}"
          on-change="_handleValueChange"
        >
          <select disabled$="[[!editing]]">
            <template is="dom-repeat" items="[[label.values]]">
              <option value="[[item.value]]">[[item.value]]</option>
            </template>
          </select>
        </gr-select>
        <gr-select
          id="labelMax"
          bind-value="{{rule.value.max}}"
          on-change="_handleValueChange"
        >
          <select disabled$="[[!editing]]">
            <template is="dom-repeat" items="[[label.values]]">
              <option value="[[item.value]]">[[item.value]]</option>
            </template>
          </select>
        </gr-select>
      </template>
      <template is="dom-if" if="[[hasRange]]">
        <iron-autogrow-textarea
          id="minInput"
          class="min"
          autocomplete="on"
          placeholder="Min value"
          bind-value="{{rule.value.min}}"
          disabled$="[[!editing]]"
        ></iron-autogrow-textarea>
        <iron-autogrow-textarea
          id="maxInput"
          class="max"
          autocomplete="on"
          placeholder="Max value"
          bind-value="{{rule.value.max}}"
          disabled$="[[!editing]]"
        ></iron-autogrow-textarea>
      </template>
      <a class="groupPath" href$="[[_computeGroupPath(groupId)]]">
        [[groupName]]
      </a>
      <gr-select
        id="force"
        class$="[[_computeForceClass(permission, rule.value.action)]]"
        bind-value="{{rule.value.force}}"
        on-change="_handleValueChange"
      >
        <select disabled$="[[!editing]]">
          <template
            is="dom-repeat"
            items="[[_computeForceOptions(permission, rule.value.action)]]"
          >
            <option value="[[item.value]]">[[item.name]]</option>
          </template>
        </select>
      </gr-select>
    </div>
    <gr-button link="" id="removeBtn" on-click="_handleRemoveRule"
      >Remove</gr-button
    >
  </div>
  <div
    id="deletedContainer"
    class$="gr-form-styles [[_computeSectionClass(editing, _deleted)]]"
  >
    [[groupName]] was deleted
    <gr-button link="" id="undoRemoveBtn" on-click="_handleUndoRemove"
      >Undo</gr-button
    >
  </div>
`;var xy;!function(e){e.ABANDON="abandon",e.ADD_PATCH_SET="addPatchSet",e.CREATE="create",e.CREATE_TAG="createTag",e.CREATE_SIGNED_TAG="createSignedTag",e.DELETE="delete",e.DELETE_CHANGES="deleteChanges",e.DELETE_OWN_CHANGES="deleteOwnChanges",e.EDIT_ASSIGNEE="editAssignee",e.EDIT_HASHTAGS="editHashtags",e.EDIT_TOPIC_NAME="editTopicName",e.FORGE_AUTHOR="forgeAuthor",e.FORGE_COMMITTER="forgeCommitter",e.FORGE_SERVER_AS_COMMITTER="forgeServerAsCommitter",e.OWNER="owner",e.PUSH="push",e.PUSH_MERGE="pushMerge",e.READ="read",e.REBASE="rebase",e.REVERT="revert",e.REMOVE_REVIEWER="removeReviewer",e.SUBMIT="submit",e.SUBMIT_AS="submitAs",e.TOGGLE_WIP_STATE="toggleWipState",e.VIEW_PRIVATE_CHANGES="viewPrivateChanges",e.PRIORITY="priority"}(xy||(xy={}));const Ry={[xy.ABANDON]:{id:xy.ABANDON,name:"Abandon"},[xy.ADD_PATCH_SET]:{id:xy.ADD_PATCH_SET,name:"Add Patch Set"},[xy.CREATE]:{id:xy.CREATE,name:"Create Reference"},[xy.CREATE_TAG]:{id:xy.CREATE_TAG,name:"Create Annotated Tag"},[xy.CREATE_SIGNED_TAG]:{id:xy.CREATE_SIGNED_TAG,name:"Create Signed Tag"},[xy.DELETE]:{id:xy.DELETE,name:"Delete Reference"},[xy.DELETE_CHANGES]:{id:xy.DELETE_CHANGES,name:"Delete Changes"},[xy.DELETE_OWN_CHANGES]:{id:xy.DELETE_OWN_CHANGES,name:"Delete Own Changes"},[xy.EDIT_ASSIGNEE]:{id:xy.EDIT_ASSIGNEE,name:"Edit Assignee"},[xy.EDIT_HASHTAGS]:{id:xy.EDIT_HASHTAGS,name:"Edit Hashtags"},[xy.EDIT_TOPIC_NAME]:{id:xy.EDIT_TOPIC_NAME,name:"Edit Topic Name"},[xy.FORGE_AUTHOR]:{id:xy.FORGE_AUTHOR,name:"Forge Author Identity"},[xy.FORGE_COMMITTER]:{id:xy.FORGE_COMMITTER,name:"Forge Committer Identity"},[xy.FORGE_SERVER_AS_COMMITTER]:{id:xy.FORGE_SERVER_AS_COMMITTER,name:"Forge Server Identity"},[xy.OWNER]:{id:xy.OWNER,name:"Owner"},[xy.PUSH]:{id:xy.PUSH,name:"Push"},[xy.PUSH_MERGE]:{id:xy.PUSH_MERGE,name:"Push Merge Commit"},[xy.READ]:{id:xy.READ,name:"Read"},[xy.REBASE]:{id:xy.REBASE,name:"Rebase"},[xy.REVERT]:{id:xy.REVERT,name:"Revert"},[xy.REMOVE_REVIEWER]:{id:xy.REMOVE_REVIEWER,name:"Remove Reviewer"},[xy.SUBMIT]:{id:xy.SUBMIT,name:"Submit"},[xy.SUBMIT_AS]:{id:xy.SUBMIT_AS,name:"Submit (On Behalf Of)"},[xy.TOGGLE_WIP_STATE]:{id:xy.TOGGLE_WIP_STATE,name:"Toggle Work In Progress State"},[xy.VIEW_PRIVATE_CHANGES]:{id:xy.VIEW_PRIVATE_CHANGES,name:"View Private Changes"}};function Ty(e){return e?Object.keys(e).map(t=>({id:t,value:e[t]})).sort((e,t)=>e.id.localeCompare(t.id)):[]}var ky=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Py=["BATCH","INTERACTIVE"],Iy="ALLOW",Oy="DENY",Ny="BLOCK",Ly=[Iy,Oy,Ny],Dy=[{name:"Allow pushing (but not force pushing)",value:!1},{name:"Allow pushing with or without force",value:!0}],My=[{name:"Block pushing with or without force",value:!1},{name:"Block force pushing",value:!0}],Fy=[{name:"No Force Edit",value:!1},{name:"Force Edit",value:!0}];let $y=class extends fi{constructor(){super(),this.editing=!1,this._deleted=!1,this.addEventListener("access-saved",()=>this._handleAccessSaved())}static get template(){return Ay}ready(){super.ready(),this.rule&&this._setupValues(this.rule)}connectedCallback(){super.connectedCallback(),!this._originalRuleValues&&this.rule&&this._setOriginalRuleValues(this.rule.value)}_setupValues(e){e.value||this._setDefaultRuleValues()}_computeForce(e,t){return xy.PUSH===e&&t!==Oy||xy.EDIT_TOPIC_NAME===e}_computeForceClass(e,t){return this._computeForce(e,t)?"force":""}_computeGroupPath(e){return`${k()}/admin/groups/${O(e,!0)}`}_handleAccessSaved(){this.rule&&this._setOriginalRuleValues(this.rule.value)}_handleEditingChanged(e,t){t&&(e||this._handleUndoChange())}_computeSectionClass(e,t){const i=[];return e&&i.push("editing"),t&&i.push("deleted"),i.join(" ")}_computeForceOptions(e,t){return e===xy.PUSH?t===Iy?Dy:t===Ny?My:[]:e===xy.EDIT_TOPIC_NAME?Fy:[]}_getDefaultRuleValues(e,t){const i=Iy,n={};return e===xy.PRIORITY?(n.action=Py[0],n):(t?(n.min=t.values[0].value,n.max=t.values[t.values.length-1].value):this._computeForce(e,i)&&(n.force=this._computeForceOptions(e,i)[0].value),n.action=Ly[0],n)}_setDefaultRuleValues(){this.set("rule.value",this._getDefaultRuleValues(this.permission,this.label))}_computeOptions(e){return"priority"===e?Py:Ly}_handleRemoveRule(){this.rule&&(this.rule.value.added&&bi(this,"added-rule-removed"),this._deleted=!0,this.rule.value.deleted=!0,bi(this,"access-modified"))}_handleUndoRemove(){this.rule&&(this._deleted=!1,delete this.rule.value.deleted)}_handleUndoChange(){this.rule&&(this.rule.value.added||(this.set("rule.value",{...this._originalRuleValues}),this._deleted=!1,delete this.rule.value.deleted,delete this.rule.value.modified))}_handleValueChange(){this._originalRuleValues&&this.rule&&(this.rule.value.modified=!0,bi(this,"access-modified"))}_setOriginalRuleValues(e){this._originalRuleValues={...e}}};ky([Oo({type:Boolean})],$y.prototype,"hasRange",void 0),ky([Oo({type:Object})],$y.prototype,"label",void 0),ky([Oo({type:Boolean,observer:"_handleEditingChanged"})],$y.prototype,"editing",void 0),ky([Oo({type:String})],$y.prototype,"groupId",void 0),ky([Oo({type:String})],$y.prototype,"groupName",void 0),ky([Oo({type:String})],$y.prototype,"permission",void 0),ky([Oo({type:Object,notify:!0})],$y.prototype,"rule",void 0),ky([Oo({type:String})],$y.prototype,"section",void 0),ky([Oo({type:Boolean})],$y.prototype,"_deleted",void 0),ky([Oo({type:Object})],$y.prototype,"_originalRuleValues",void 0),ky([No("rule.value.*")],$y.prototype,"_handleValueChange",null),$y=ky([Po("gr-rule-editor")],$y);const By=mi`
  <style include="shared-styles">
    :host {
      display: block;
      margin-bottom: var(--spacing-m);
    }
    .header {
      align-items: baseline;
      display: flex;
      justify-content: space-between;
      margin: var(--spacing-s) var(--spacing-m);
    }
    .rules {
      background: var(--table-header-background-color);
      border: 1px solid var(--border-color);
      border-bottom: 0;
    }
    .editing .rules {
      border-bottom: 1px solid var(--border-color);
    }
    .title {
      margin-bottom: var(--spacing-s);
    }
    #addRule,
    #removeBtn {
      display: none;
    }
    .right {
      display: flex;
      align-items: center;
    }
    .editing #removeBtn {
      display: block;
      margin-left: var(--spacing-xl);
    }
    .editing #addRule {
      display: block;
      padding: var(--spacing-m);
    }
    #deletedContainer,
    .deleted #mainContainer {
      display: none;
    }
    .deleted #deletedContainer {
      align-items: baseline;
      border: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-m);
    }
    #mainContainer {
      display: block;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-menu-page-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <section
    id="permission"
    class$="gr-form-styles [[_computeSectionClass(editing, _deleted)]]"
  >
    <div id="mainContainer">
      <div class="header">
        <span class="title">[[name]]</span>
        <div class="right">
          <template
            is="dom-if"
            if="[[!_permissionIsOwnerOrGlobal(permission.id, section)]]"
          >
            <paper-toggle-button
              id="exclusiveToggle"
              checked="{{permission.value.exclusive}}"
              on-change="_handleValueChange"
              disabled$="[[!editing]]"
              on-click="_onTapExclusiveToggle"
            ></paper-toggle-button
            >Exclusive
          </template>
          <gr-button link="" id="removeBtn" on-click="_handleRemovePermission"
            >Remove</gr-button
          >
        </div>
      </div>
      <!-- end header -->
      <div class="rules">
        <template is="dom-repeat" items="{{_rules}}" as="rule">
          <gr-rule-editor
            has-range="[[_computeHasRange(name)]]"
            label="[[_label]]"
            editing="[[editing]]"
            group-id="[[rule.id]]"
            group-name="[[_computeGroupName(groups, rule.id)]]"
            permission="[[permission.id]]"
            rule="{{rule}}"
            section="[[section]]"
            on-added-rule-removed="_handleAddedRuleRemoved"
          ></gr-rule-editor>
        </template>
        <div id="addRule">
          <gr-autocomplete
            id="groupAutocomplete"
            text="{{_groupFilter}}"
            query="[[_query]]"
            placeholder="Add group"
            on-commit="_handleAddRuleItem"
          >
          </gr-autocomplete>
        </div>
        <!-- end addRule -->
      </div>
      <!-- end rules -->
    </div>
    <!-- end mainContainer -->
    <div id="deletedContainer">
      <span>[[name]] was deleted</span>
      <gr-button link="" id="undoRemoveBtn" on-click="_handleUndoRemove"
        >Undo</gr-button
      >
    </div>
    <!-- end deletedContainer -->
  </section>
`;var jy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Hy=["QUERY LIMIT","BATCH CHANGES LIMIT"];let Uy=class extends fi{constructor(){super(),this.editing=!1,this._deleted=!1,this.restApiService=i.restApiService,this._query=()=>this._getGroupSuggestions(),this.addEventListener("access-saved",()=>this._handleAccessSaved())}static get template(){return By}ready(){super.ready(),this._setupValues()}_setupValues(){this.permission&&(this._originalExclusiveValue=!!this.permission.value.exclusive,yh())}_handleAccessSaved(){this._setupValues()}_permissionIsOwnerOrGlobal(e,t){return"owner"===e||"GLOBAL_CAPABILITIES"===t}_handleEditingChanged(e,t){if(t&&this.permission&&this._rules&&!e){this._deleted=!1,delete this.permission.value.deleted,this._groupFilter="",this._rules=this._rules.filter(e=>!e.value.added);for(const e of Object.keys(this.permission.value.rules))this.permission.value.rules[e].added&&delete this.permission.value.rules[e];this.set(["permission","value","exclusive"],this._originalExclusiveValue)}}_handleAddedRuleRemoved(e){if(!this._rules)return;const t=e.model.index;this._rules=this._rules.slice(0,t).concat(this._rules.slice(t+1,this._rules.length))}_handleValueChange(){this.permission&&(this.permission.value.modified=!0,bi(this,"access-modified"))}_handleRemovePermission(){this.permission&&(this.permission.value.added&&bi(this,"added-permission-removed"),this._deleted=!0,this.permission.value.deleted=!0,bi(this,"access-modified"))}_handleRulesChanged(){this._rules&&(this._groupsWithRules=this._computeGroupsWithRules(this._rules))}_sortPermission(e){this._rules=Ty(e.value.rules)}_computeSectionClass(e,t){const i=[];return e&&i.push("editing"),t&&i.push("deleted"),i.join(" ")}_handleUndoRemove(){this.permission&&(this._deleted=!1,delete this.permission.value.deleted)}_computeLabel(e,t){if(!(t&&e&&e.value&&e.value.label))return;const i=e.value.label;return t[i]?{name:i,values:this._computeLabelValues(t[i].values)}:void 0}_computeLabelValues(e){const t=[],i=Object.keys(e).sort((e,t)=>Number(e)-Number(t));for(const n of i){let i=e[n];i||(i=""),t.push({value:Number(n),text:i})}return t}_computeGroupsWithRules(e){const t={};for(const i of e)t[i.id]=!0;return t}_computeGroupName(e,t){return e&&e[t]&&e[t].name?e[t].name:t}_getGroupSuggestions(){return this.restApiService.getSuggestedGroups(this._groupFilter||"",20).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:n});return t.filter(e=>this._groupsWithRules&&!this._groupsWithRules[e.value.id]).map(e=>({name:e.name,value:e.value.id}))})}_handleAddRuleItem(e){if(!this.permission||!this._rules)return;const t=decodeURIComponent(e.detail.value).replace(/\+/g," ");this.permission.value.rules[t]={},this.push("_rules",{id:t}),this.groups&&!this.groups[t]&&(this.groups[t]={name:this.$.groupAutocomplete.text}),yh();const i=this._rules[this._rules.length-1].value;i.added=!0,this.permission.value.rules[t]=i,bi(this,"access-modified")}_computeHasRange(e){return!!e&&Hy.includes(e.toUpperCase())}_onTapExclusiveToggle(e){e.preventDefault()}};jy([Oo({type:Object})],Uy.prototype,"labels",void 0),jy([Oo({type:String})],Uy.prototype,"name",void 0),jy([Oo({type:Object,observer:"_sortPermission",notify:!0})],Uy.prototype,"permission",void 0),jy([Oo({type:Object})],Uy.prototype,"groups",void 0),jy([Oo({type:String})],Uy.prototype,"section",void 0),jy([Oo({type:Boolean,observer:"_handleEditingChanged"})],Uy.prototype,"editing",void 0),jy([Oo({type:Object,computed:"_computeLabel(permission, labels)"})],Uy.prototype,"_label",void 0),jy([Oo({type:String})],Uy.prototype,"_groupFilter",void 0),jy([Oo({type:Object})],Uy.prototype,"_query",void 0),jy([Oo({type:Array})],Uy.prototype,"_rules",void 0),jy([Oo({type:Object})],Uy.prototype,"_groupsWithRules",void 0),jy([Oo({type:Boolean})],Uy.prototype,"_deleted",void 0),jy([Oo({type:Boolean})],Uy.prototype,"_originalExclusiveValue",void 0),jy([No("_rules.splices")],Uy.prototype,"_handleRulesChanged",null),Uy=jy([Po("gr-permission")],Uy);const Gy=mi`
  <style include="shared-styles">
    :host {
      display: block;
      margin-bottom: var(--spacing-l);
    }
    fieldset {
      border: 1px solid var(--border-color);
    }
    .name {
      align-items: center;
      display: flex;
    }
    .header,
    #deletedContainer {
      align-items: center;
      background: var(--table-header-background-color);
      border-bottom: 1px dotted var(--border-color);
      display: flex;
      justify-content: space-between;
      min-height: 3em;
      padding: 0 var(--spacing-m);
    }
    #deletedContainer {
      border-bottom: 0;
    }
    .sectionContent {
      padding: var(--spacing-m);
    }
    #editBtn,
    .editing #editBtn.global,
    #deletedContainer,
    .deleted #mainContainer,
    #addPermission,
    #deleteBtn,
    .editingRef .name,
    .editRefInput {
      display: none;
    }
    .editing #editBtn,
    .editingRef .editRefInput {
      display: flex;
    }
    .deleted #deletedContainer {
      display: flex;
    }
    .editing #addPermission,
    #mainContainer,
    .editing #deleteBtn {
      display: block;
    }
    .editing #deleteBtn,
    #undoRemoveBtn {
      padding-right: var(--spacing-m);
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <fieldset
    id="section"
    class$="gr-form-styles [[_computeSectionClass(editing, canUpload, ownerOf, _editingRef, _deleted)]]"
  >
    <div id="mainContainer">
      <div class="header">
        <div class="name">
          <h3 class="heading-3">[[_computeSectionName(section.id)]]</h3>
          <gr-button
            id="editBtn"
            link=""
            class$="[[_computeEditBtnClass(section.id)]]"
            on-click="editReference"
          >
            <iron-icon id="icon" icon="gr-icons:create"></iron-icon>
          </gr-button>
        </div>
        <iron-input
          class="editRefInput"
          bind-value="{{section.id}}"
          type="text"
          on-input="_handleValueChange"
        >
          <input
            class="editRefInput"
            bind-value="{{section.id}}"
            is="iron-input"
            type="text"
            on-input="_handleValueChange"
          />
        </iron-input>
        <gr-button link="" id="deleteBtn" on-click="_handleRemoveReference"
          >Remove</gr-button
        >
      </div>
      <!-- end header -->
      <div class="sectionContent">
        <template is="dom-repeat" items="{{_permissions}}" as="permission">
          <gr-permission
            name="[[_computePermissionName(section.id, permission, capabilities)]]"
            permission="{{permission}}"
            labels="[[labels]]"
            section="[[section.id]]"
            editing="[[editing]]"
            groups="[[groups]]"
            on-added-permission-removed="_handleAddedPermissionRemoved"
          >
          </gr-permission>
        </template>
        <div id="addPermission">
          Add permission:
          <select id="permissionSelect">
            <!-- called with a third parameter so that permissions update
                  after a new section is added. -->
            <template
              is="dom-repeat"
              items="[[_computePermissions(section.id, capabilities, labels, section.value.permissions.*)]]"
            >
              <option value="[[item.value.id]]">[[item.value.name]]</option>
            </template>
          </select>
          <gr-button link="" id="addBtn" on-click="_handleAddPermission"
            >Add</gr-button
          >
        </div>
        <!-- end addPermission -->
      </div>
      <!-- end sectionContent -->
    </div>
    <!-- end mainContainer -->
    <div id="deletedContainer">
      <span>[[_computeSectionName(section.id)]] was deleted</span>
      <gr-button link="" id="undoRemoveBtn" on-click="_handleUndoRemove"
        >Undo</gr-button
      >
    </div>
    <!-- end deletedContainer -->
  </fieldset>
`;var zy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Vy="GLOBAL_CAPABILITIES";let Wy=class extends fi{constructor(){super(),this.editing=!1,this._editingRef=!1,this._deleted=!1,this.addEventListener("access-saved",()=>this._handleAccessSaved())}static get template(){return Gy}_updateSection(e){this._permissions=Ty(e.value.permissions),this._originalId=e.id}_handleAccessSaved(){this.section&&this._updateSection(this.section)}_handleValueChange(){this.section&&(this.section.value.added||(this.section.value.modified=this.section.id!==this._originalId,bi(this,"access-modified")),this.section.value.updatedId=this.section.id)}_handleEditingChanged(e,t){if(t&&this.section&&this._permissions&&!e){this._editingRef=!1,this._deleted=!1,delete this.section.value.deleted,this.set(["section","id"],this._originalId),this._permissions=this._permissions.filter(e=>!e.value.added);for(const e of Object.keys(this.section.value.permissions))this.section.value.permissions[e].added&&delete this.section.value.permissions[e]}}_computePermissions(e,t,i){let n;const o=this.section;if(!o||!o.value)return[];if(e===Vy)n=Ty(t);else{n=this._computeLabelOptions(i).concat(Ty(Ry))}return n.filter(e=>!o.value.permissions[e.id])}_computeHideEditClass(e){return"GLOBAL_CAPABILITIES"===e.id?"hide":""}_handleAddedPermissionRemoved(e){if(!this._permissions)return;const t=e.model.index;this._permissions=this._permissions.slice(0,t).concat(this._permissions.slice(t+1,this._permissions.length))}_computeLabelOptions(e){const t=[];if(!e)return[];for(const i of Object.keys(e))t.push({id:"label-"+i,value:{name:`Label ${i}`,id:"label-"+i}}),t.push({id:"labelAs-"+i,value:{name:`Label ${i} (On Behalf Of)`,id:"labelAs-"+i}});return t}_computePermissionName(e,t,i){if(e===Vy)return i[t.id].name;if(Ry[t.id])return Ry[t.id].name;if(t.value.label){let e="";return t.id.startsWith("labelAs-")&&(e="(On Behalf Of)"),`Label ${t.value.label}${e}`}}_computeSectionName(e){return e||(this._editingRef=!0,e="refs/heads/*",this.set("section.id",e)),e===Vy?"Global Capabilities":e.startsWith("refs/")?`Reference: ${e}`:e}_handleRemoveReference(){this.section&&(this.section.value.added&&bi(this,"added-section-removed"),this._deleted=!0,this.section.value.deleted=!0,bi(this,"access-modified"))}_handleUndoRemove(){this.section&&(this._deleted=!1,delete this.section.value.deleted)}editRefInput(){return this.root.querySelector(fi?"iron-input.editRefInput":"input[is=iron-input].editRefInput")}editReference(){this._editingRef=!0,this.editRefInput().focus()}_isEditEnabled(e,t,i){return e||t&&t.indexOf(i)>=0}_computeSectionClass(e,t,i,n,o){const r=[];return e&&this.section&&this._isEditEnabled(t,i,this.section.id)&&r.push("editing"),n&&r.push("editingRef"),o&&r.push("deleted"),r.join(" ")}_computeEditBtnClass(e){return e===Vy?"global":""}_handleAddPermission(){const e=this.$.permissionSelect.value,t={id:e,value:{rules:{},added:!0}};e.startsWith("label")&&(t.value.label=e.replace("label-","").replace("labelAs-","")),this.push("_permissions",t),this.set(["section.value.permissions",t.id],t.value)}};zy([Oo({type:Object})],Wy.prototype,"capabilities",void 0),zy([Oo({type:Object,notify:!0,observer:"_updateSection"})],Wy.prototype,"section",void 0),zy([Oo({type:Object})],Wy.prototype,"groups",void 0),zy([Oo({type:Object})],Wy.prototype,"labels",void 0),zy([Oo({type:Boolean,observer:"_handleEditingChanged"})],Wy.prototype,"editing",void 0),zy([Oo({type:Boolean})],Wy.prototype,"canUpload",void 0),zy([Oo({type:Array})],Wy.prototype,"ownerOf",void 0),zy([Oo({type:String})],Wy.prototype,"_originalId",void 0),zy([Oo({type:Boolean})],Wy.prototype,"_editingRef",void 0),zy([Oo({type:Boolean})],Wy.prototype,"_deleted",void 0),zy([Oo({type:Array})],Wy.prototype,"_permissions",void 0),Wy=zy([Po("gr-access-section")],Wy);const qy=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    gr-button,
    #inheritsFrom,
    #editInheritFromInput,
    .editing #inheritFromName,
    .weblinks,
    .editing .invisible {
      display: none;
    }
    #inheritsFrom.show {
      display: flex;
      min-height: 2em;
      align-items: center;
    }
    .weblink {
      margin-right: var(--spacing-xs);
    }
    gr-access-section {
      margin-top: var(--spacing-l);
    }
    .weblinks.show,
    .referenceContainer {
      display: block;
    }
    .rightsText {
      margin-right: var(--spacing-s);
    }

    .editing gr-button,
    .admin #editBtn {
      display: inline-block;
      margin: var(--spacing-l) 0;
    }
    .editing #editInheritFromInput {
      display: inline-block;
    }
  </style>
  <style include="gr-menu-page-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class$="main [[_computeMainClass(_ownerOf, _canUpload, _editing)]]">
    <div id="loading" class$="[[_computeLoadingClass(_loading)]]">
      Loading...
    </div>
    <div id="loadedContent" class$="[[_computeLoadingClass(_loading)]]">
      <h3
        id="inheritsFrom"
        class$="heading-3 [[_computeShowInherit(_inheritsFrom)]]"
      >
        <span class="rightsText">Rights Inherit From</span>
        <a
          href$="[[_computeParentHref(_inheritsFrom.name)]]"
          rel="noopener"
          id="inheritFromName"
        >
          [[_inheritsFrom.name]]</a
        >
        <gr-autocomplete
          id="editInheritFromInput"
          text="{{_inheritFromFilter}}"
          query="[[_query]]"
          on-commit="_handleUpdateInheritFrom"
        ></gr-autocomplete>
      </h3>
      <div class$="weblinks [[_computeWebLinkClass(_weblinks)]]">
        History:
        <template is="dom-repeat" items="[[_weblinks]]" as="link">
          <a
            href="[[link.url]]"
            class="weblink"
            rel="noopener"
            target="[[link.target]]"
          >
            [[link.name]]
          </a>
        </template>
      </div>
      <template
        is="dom-repeat"
        items="{{_sections}}"
        initial-count="5"
        target-framerate="60"
        as="section"
      >
        <gr-access-section
          capabilities="[[_capabilities]]"
          section="{{section}}"
          labels="[[_labels]]"
          can-upload="[[_canUpload]]"
          editing="[[_editing]]"
          owner-of="[[_ownerOf]]"
          groups="[[_groups]]"
          on-added-section-removed="_handleAddedSectionRemoved"
        ></gr-access-section>
      </template>
      <div class="referenceContainer">
        <gr-button id="addReferenceBtn" on-click="_handleCreateSection"
          >Add Reference</gr-button
        >
      </div>
      <div>
        <gr-button id="editBtn" on-click="_handleEdit"
          >[[_editOrCancel(_editing)]]</gr-button
        >
        <gr-button
          id="saveBtn"
          primary=""
          class$="[[_computeSaveBtnClass(_ownerOf)]]"
          on-click="_handleSave"
          disabled="[[!_modified]]"
          >Save</gr-button
        >
        <gr-button
          id="saveReviewBtn"
          primary=""
          class$="[[_computeSaveReviewBtnClass(_canUpload)]]"
          on-click="_handleSaveForReview"
          disabled="[[!_modified]]"
          >Save for review</gr-button
        >
      </div>
    </div>
  </div>
`;var Ky=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Yy=class extends fi{constructor(){super(),this._canUpload=!1,this._editing=!1,this._modified=!1,this._loading=!0,this.restApiService=i.restApiService,this._query=()=>this._getInheritFromSuggestions(),this.addEventListener("access-modified",()=>this._handleAccessModified())}static get template(){return qy}_handleAccessModified(){this._modified=!0}_repoChanged(e){return this._loading=!0,e?this._reload(e):Promise.resolve()}_reload(e){const t=e=>{Si(e)};this._editing=!1,this._sections=[];const i=this.restApiService.getRepoAccessRights(e,t).then(e=>e?(this._inheritsFrom=e.inherits_from?{...e.inherits_from}:null,this.originalInheritsFrom=e.inherits_from?{...e.inherits_from}:null,this._inheritFromFilter=e.inherits_from?e.inherits_from.name:"",this._local=e.local,this._groups=e.groups,this._weblinks=e.config_web_links||[],this._canUpload=e.can_upload,this._ownerOf=e.owner_of||[],Ty(this._local)):Promise.resolve(void 0)),n=this.restApiService.getCapabilities(t).then(e=>e||Promise.resolve(void 0)),o=this.restApiService.getRepo(e,t).then(e=>e?e.labels:Promise.resolve(void 0));return Promise.all([i,n,o]).then(([e,t,i])=>{this._capabilities=t,this._labels=i,this._sections=e,this._loading=!1})}_handleUpdateInheritFrom(e){const t={id:e.detail.value,name:this._inheritFromFilter};if(this._inheritsFrom){const e=this._inheritsFrom;e.id=t.id,e.name=t.name}else this._inheritsFrom=t;this._handleAccessModified()}_getInheritFromSuggestions(){return this.restApiService.getRepos(this._inheritFromFilter,50).then(e=>{const t=[];if(!e)return t;for(const i of e)t.push({name:i.name,value:i.id});return t})}_computeLoadingClass(e){return e?"loading":""}_handleEdit(){this._editing=!this._editing}_editOrCancel(e){return e?"Cancel":"Edit"}_computeWebLinkClass(e){return e&&e.length?"show":""}_computeShowInherit(e){return e?"show":""}_handleAddedSectionRemoved(e){if(!this._sections)return;const t=Number(e.model.index);isNaN(t)||(this._sections=this._sections.slice(0,t).concat(this._sections.slice(t+1,this._sections.length)))}_handleEditingChanged(e,t){if(t&&!e){if(this._sections&&(this._sections=this._sections.filter(e=>!e.value.added)),this._inheritsFrom){const e=this.originalInheritsFrom?{...this.originalInheritsFrom}:{};this._inheritsFrom=e,this._inheritFromFilter="name"in e?e.name:void 0}if(this._local)for(const e of Object.keys(this._local))this._local[e].added&&delete this._local[e]}}_updateRemoveObj(e,t){let i=e.remove;for(const e of t)i[e]||(e===t[t.length-1]?"permissions"===t[t.length-2]?i[e]={rules:{}}:1===t.length?i[e]={permissions:{}}:i[e]={}:i[e]={}),i=i[e];return e}_updateAddObj(e,t,i){let n=e.add;for(const e of t)n[e]||(e===t[t.length-1]?n[e]=i:n[e]={}),n=n[e];return e}_recursivelyRemoveDeleted(e){if(e)for(const t of Object.keys(e)){const i=e[t];if("object"==typeof i){if(i.deleted)return void delete e[t];this._recursivelyRemoveDeleted(i)}}}_recursivelyUpdateAddRemoveObj(e,t,i=[]){if(e)for(const n of Object.keys(e)){const o=e[n];if("object"==typeof o){const e=o.updatedId,r=e||n;if(o.deleted){this._updateRemoveObj(t,i.concat(n));continue}if(o.modified){this._updateRemoveObj(t,i.concat(n)),this._updateAddObj(t,i.concat(r),o),e&&e!==n&&this._recursivelyRemoveDeleted(t.add[e]);continue}if(o.added){this._updateAddObj(t,i.concat(r),o),this._recursivelyRemoveDeleted(t.add[n]);continue}this._recursivelyUpdateAddRemoveObj(o,t,i.concat(n))}}}_computeAddAndRemove(){const e={add:{},remove:{}},t=this.originalInheritsFrom?N(this.originalInheritsFrom.id):null,i=this._inheritsFrom?N(this._inheritsFrom.id):null,n=t&&t!==i||!t&&i;return this._local?(this._recursivelyUpdateAddRemoveObj(this._local,e),n&&(e.parent=i),e):e}_handleCreateSection(){if(!this._local)return;let e="refs/for/*";for(;this._local[e];)e=`${e}*`;const t={permissions:{},added:!0};this.push("_sections",{id:e,value:t}),this.set(["_local",e],t),yh(),this.root.querySelector("gr-access-section:last-of-type").editReference()}_getObjforSave(){const e=this._computeAddAndRemove();if(!Object.keys(e.add).length&&!Object.keys(e.remove).length&&!e.parent)return void Ci(this,"No changes to save.");const t={add:e.add,remove:e.remove};return e.parent&&(t.parent=e.parent),t}_handleSave(e){const t=this._getObjforSave();if(!t)return;const i=e&&e.target;i&&(i.loading=!0);const n=this.repo;return n?this.restApiService.setRepoAccessRights(n,t).then(()=>{this._reload(n)}).finally(()=>{this._modified=!1,i&&(i.loading=!1)}):Promise.resolve()}_handleSaveForReview(e){const t=this._getObjforSave();if(!t)return;const i=e&&e.target;return i&&(i.loading=!0),this.repo?this.restApiService.setRepoAccessRightsForReview(this.repo,t).then(e=>{Qm.navigateToChange(e)}).finally(()=>{this._modified=!1,i&&(i.loading=!1)}):void 0}_computeSaveReviewBtnClass(e){return e?"":"invisible"}_computeSaveBtnClass(e){return e&&0===e.length?"invisible":""}_computeMainClass(e,t,i){const n=[];return(e&&e.length>0||t)&&n.push("admin"),i&&n.push("editing"),n.join(" ")}_computeParentHref(e){return k()+`/admin/repos/${O(e,!0)},access`}};Ky([Oo({type:String,observer:"_repoChanged"})],Yy.prototype,"repo",void 0),Ky([Oo({type:String})],Yy.prototype,"path",void 0),Ky([Oo({type:Boolean})],Yy.prototype,"_canUpload",void 0),Ky([Oo({type:String})],Yy.prototype,"_inheritFromFilter",void 0),Ky([Oo({type:Object})],Yy.prototype,"_query",void 0),Ky([Oo({type:Array})],Yy.prototype,"_ownerOf",void 0),Ky([Oo({type:Object})],Yy.prototype,"_capabilities",void 0),Ky([Oo({type:Object})],Yy.prototype,"_groups",void 0),Ky([Oo({type:Object})],Yy.prototype,"_inheritsFrom",void 0),Ky([Oo({type:Object})],Yy.prototype,"_labels",void 0),Ky([Oo({type:Object})],Yy.prototype,"_local",void 0),Ky([Oo({type:Boolean,observer:"_handleEditingChanged"})],Yy.prototype,"_editing",void 0),Ky([Oo({type:Boolean})],Yy.prototype,"_modified",void 0),Ky([Oo({type:Array})],Yy.prototype,"_sections",void 0),Ky([Oo({type:Array})],Yy.prototype,"_weblinks",void 0),Ky([Oo({type:Boolean})],Yy.prototype,"_loading",void 0),Yy=Ky([Po("gr-repo-access")],Yy);const Xy=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    input:not([type='checkbox']),
    gr-autocomplete,
    iron-autogrow-textarea {
      width: 100%;
    }
    .value {
      width: 32em;
    }
    .hide {
      display: none;
    }
    @media only screen and (max-width: 40em) {
      .value {
        width: 29em;
      }
    }
  </style>
  <div class="gr-form-styles">
    <section class$="[[_computeBranchClass(baseChange)]]">
      <span class="title">Select branch for new change</span>
      <span class="value">
        <gr-autocomplete
          id="branchInput"
          text="{{branch}}"
          query="[[_query]]"
          placeholder="Destination branch"
        >
        </gr-autocomplete>
      </span>
    </section>
    <section class$="[[_computeBranchClass(baseChange)]]">
      <span class="title">Provide base commit sha1 for change</span>
      <span class="value">
        <iron-input
          maxlength="40"
          placeholder="(optional)"
          bind-value="{{baseCommit}}"
        >
          <input
            is="iron-input"
            id="baseCommitInput"
            maxlength="40"
            placeholder="(optional)"
            bind-value="{{baseCommit}}"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <span class="title">Enter topic for new change</span>
      <span class="value">
        <iron-input
          maxlength="1024"
          placeholder="(optional)"
          bind-value="{{topic}}"
        >
          <input
            is="iron-input"
            id="tagNameInput"
            maxlength="1024"
            placeholder="(optional)"
            bind-value="{{topic}}"
          />
        </iron-input>
      </span>
    </section>
    <section id="description">
      <span class="title">Description</span>
      <span class="value">
        <iron-autogrow-textarea
          id="messageInput"
          class="message"
          autocomplete="on"
          rows="4"
          max-rows="15"
          bind-value="{{subject}}"
          placeholder="Insert the description of the change."
        >
        </iron-autogrow-textarea>
      </span>
    </section>
    <section class$="[[_computePrivateSectionClass(_privateChangesEnabled)]]">
      <label class="title" for="privateChangeCheckBox">Private change</label>
      <span class="value">
        <input
          type="checkbox"
          id="privateChangeCheckBox"
          checked$="[[_formatBooleanString(privateByDefault)]]"
        />
      </span>
    </section>
  </div>
`;var Jy=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Zy=class extends fi{constructor(){super(),this.canCreate=!1,this.restApiService=i.restApiService,this._query=e=>this._getRepoBranchesSuggestions(e)}static get template(){return Xy}connectedCallback(){if(super.connectedCallback(),!this.repoName)return Promise.resolve();const e=[];return e.push(this.restApiService.getProjectConfig(this.repoName).then(e=>{e&&(this.privateByDefault=e.private_by_default)})),e.push(this.restApiService.getConfig().then(e=>{e&&(this._privateChangesEnabled=e&&e.change&&!e.change.disable_private_changes)})),Promise.all(e)}_computeBranchClass(e){return e?"hide":""}_allowCreate(e,t){this.canCreate=!!e&&!!t}handleCreateChange(){if(!this.repoName||!this.branch||!this.subject)return Promise.resolve();const e=this.$.privateChangeCheckBox.checked;return this.restApiService.createChange(this.repoName,this.branch,this.subject,this.topic,e,!0,this.baseChange,this.baseCommit||void 0).then(e=>{e&&Qm.navigateToChange(e)})}_getRepoBranchesSuggestions(e){return this.repoName?(e.startsWith("refs/heads/")&&(e=e.substring("refs/heads/".length)),this.restApiService.getRepoBranches(e,this.repoName,15).then(e=>{if(!e)return[];const t=[];for(const i of e){let e=i.ref;e.startsWith("refs/heads/")&&(e=e.substring("refs/heads/".length)),t.push({name:e})}return t})):Promise.reject(new Error("missing repo name"))}_formatBooleanString(e){return!(!e||e.configured_value!==hn.TRUE)||(!e||e.configured_value!==hn.FALSE)&&(!(!e||e.configured_value!==hn.INHERITED)&&!(!e||!e.inherited_value))}_computePrivateSectionClass(e){return e?"hide":""}};Jy([Oo({type:String})],Zy.prototype,"repoName",void 0),Jy([Oo({type:String})],Zy.prototype,"branch",void 0),Jy([Oo({type:Object})],Zy.prototype,"_repoConfig",void 0),Jy([Oo({type:String})],Zy.prototype,"subject",void 0),Jy([Oo({type:String})],Zy.prototype,"topic",void 0),Jy([Oo({type:Object})],Zy.prototype,"_query",void 0),Jy([Oo({type:String})],Zy.prototype,"baseChange",void 0),Jy([Oo({type:String})],Zy.prototype,"baseCommit",void 0),Jy([Oo({type:Object})],Zy.prototype,"privateByDefault",void 0),Jy([Oo({type:Boolean,notify:!0})],Zy.prototype,"canCreate",void 0),Jy([Oo({type:Boolean})],Zy.prototype,"_privateChangesEnabled",void 0),Jy([No("branch","subject")],Zy.prototype,"_allowCreate",null),Zy=Jy([Po("gr-create-change-dialog")],Zy);const Qy=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-subpage-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    #form gr-button {
      margin-bottom: var(--spacing-xxl);
    }
  </style>
  <div class="main gr-form-styles read-only">
    <h1 id="Title" class="heading-1">Repository Commands</h1>
    <div id="loading" class$="[[_computeLoadingClass(_loading)]]">
      Loading...
    </div>
    <div id="loadedContent" class$="[[_computeLoadingClass(_loading)]]">
      <h2 id="options" class="heading-2">Command</h2>
      <div id="form">
        <h3>Create change</h3>
        <gr-button loading="[[_creatingChange]]" on-click="_createNewChange">
          Create change
        </gr-button>
        <h3>Edit repo config</h3>
        <gr-button
          id="editRepoConfig"
          loading="[[_editingConfig]]"
          on-click="_handleEditRepoConfig"
        >
          Edit repo config
        </gr-button>
        <h3 hidden="[[!_repoConfig.actions.gc.enabled]]">
          [[_repoConfig.actions.gc.label]]
        </h3>
        <gr-button
          hidden="[[!_repoConfig.actions.gc.enabled]]"
          title="[[_repoConfig.actions.gc.title]]"
          loading="[[_runningGC]]"
          on-click="_handleRunningGC"
        >
          [[_repoConfig.actions.gc.label]]
        </gr-button>
        <gr-endpoint-decorator name="repo-command">
          <gr-endpoint-param name="config" value="[[_repoConfig]]">
          </gr-endpoint-param>
          <gr-endpoint-param name="repoName" value="[[repo]]">
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    </div>
  </div>
  <gr-overlay id="createChangeOverlay" with-backdrop="">
    <gr-dialog
      id="createChangeDialog"
      confirm-label="Create"
      disabled="[[!_canCreate]]"
      on-confirm="_handleCreateChange"
      on-cancel="_handleCloseCreateChange"
    >
      <div class="header" slot="header">Create Change</div>
      <div class="main" slot="main">
        <gr-create-change-dialog
          id="createNewChangeModal"
          can-create="{{_canCreate}}"
          repo-name="[[repo]]"
        ></gr-create-change-dialog>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var eb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let tb=class extends fi{constructor(){super(...arguments),this._loading=!0,this._canCreate=!1,this._creatingChange=!1,this._editingConfig=!1,this._runningGC=!1,this.restApiService=i.restApiService}static get template(){return Qy}connectedCallback(){super.connectedCallback(),this._loadRepo(),xi(this,"Repo Commands")}_loadRepo(){this.restApiService.getProjectConfig(this.repo,e=>{this.isConnected&&Si(e)}).then(e=>{e&&this.isConnected&&(this._repoConfig=e,this._loading=!1)})}_computeLoadingClass(e){return e?"loading":""}_isLoading(){return this._loading}_handleRunningGC(){if(this.repo)return this._runningGC=!0,this.restApiService.runRepoGC(this.repo).then(e=>{200===(null==e?void 0:e.status)&&Ci(this,"Garbage collection completed successfully.")}).finally(()=>{this._runningGC=!1})}_createNewChange(){this.$.createChangeOverlay.open()}_handleCreateChange(){this._creatingChange=!0,this.$.createNewChangeModal.handleCreateChange().finally(()=>{this._creatingChange=!1}),this._handleCloseCreateChange()}_handleCloseCreateChange(){this.$.createChangeOverlay.close()}_handleEditRepoConfig(){return this._editingConfig=!0,this.restApiService.createChange(this.repo,"refs/meta/config","Edit Repo Config",void 0,!1,!0).then(e=>{Ci(this,e?"Navigating to change":"Failed to create change."),e&&Qm.navigateToRelativeUrl(Qm.getEditUrlForDiff(e,"project.config",1))}).finally(()=>{this._editingConfig=!1})}};eb([Oo({type:String})],tb.prototype,"repo",void 0),eb([Oo({type:Boolean})],tb.prototype,"_loading",void 0),eb([Oo({type:Object})],tb.prototype,"_repoConfig",void 0),eb([Oo({type:Boolean})],tb.prototype,"_canCreate",void 0),eb([Oo({type:Boolean})],tb.prototype,"_creatingChange",void 0),eb([Oo({type:Boolean})],tb.prototype,"_editingConfig",void 0),eb([Oo({type:Boolean})],tb.prototype,"_runningGC",void 0),tb=eb([Po("gr-repo-commands")],tb);const ib=mi`
  <style include="shared-styles">
    :host {
      display: block;
      margin-bottom: var(--spacing-xxl);
    }
    .loading #dashboards,
    #loadingContainer {
      display: none;
    }
    .loading #loadingContainer {
      display: block;
    }
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <table id="list" class$="genericList [[_computeLoadingClass(_loading)]]">
    <tbody>
      <tr class="headerRow">
        <th class="topHeader">Dashboard name</th>
        <th class="topHeader">Dashboard title</th>
        <th class="topHeader">Dashboard description</th>
        <th class="topHeader">Inherited from</th>
        <th class="topHeader">Default</th>
      </tr>
      <tr id="loadingContainer">
        <td>Loading...</td>
      </tr>
    </tbody>
    <tbody id="dashboards">
      <template is="dom-repeat" items="[[_dashboards]]">
        <tr class="groupHeader">
          <td colspan="5">[[item.section]]</td>
        </tr>
        <template is="dom-repeat" items="[[item.dashboards]]">
          <tr class="table">
            <td class="name">
              <a href$="[[_getUrl(item.project, item.id)]]">[[item.path]]</a>
            </td>
            <td class="title">[[item.title]]</td>
            <td class="desc">[[item.description]]</td>
            <td class="inherited">
              [[_computeInheritedFrom(item.project, item.defining_project)]]
            </td>
            <td class="default">[[_computeIsDefault(item.is_default)]]</td>
          </tr>
        </template>
      </template>
    </tbody>
  </table>
`;var nb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let ob=class extends fi{constructor(){super(...arguments),this._loading=!0,this.restApiService=i.restApiService}static get template(){return ib}_repoChanged(e){if(this._loading=!0,!e)return Promise.resolve();return this.restApiService.getRepoDashboards(e,e=>{Si(e)}).then(e=>{if(!e)return;const t=e.concat.apply([],e).sort((e,t)=>e.id<t.id?-1:1),i={};t.forEach(e=>{i[e.ref]||(i[e.ref]=[]),i[e.ref].push(e)});const n=[];Object.keys(i).sort().forEach(e=>{n.push({section:e,dashboards:i[e]})}),this._dashboards=n,this._loading=!1,yh()})}_getUrl(e,t){return e&&t?Qm.getUrlForRepoDashboard(e,t):""}_computeLoadingClass(e){return e?"loading":""}_computeInheritedFrom(e,t){return e===t?"":t}_computeIsDefault(e){return e?"":""}};nb([Oo({type:String,observer:"_repoChanged"})],ob.prototype,"repo",void 0),nb([Oo({type:Boolean})],ob.prototype,"_loading",void 0),nb([Oo({type:Array})],ob.prototype,"_dashboards",void 0),ob=nb([Po("gr-repo-dashboards")],ob);const rb=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    :host {
      display: inline-block;
    }
    input {
      width: 20em;
    }
    /* Add css selector with #id to increase priority
      (otherwise ".gr-form-styles section" rule wins) */
    .hideItem,
    #itemAnnotationSection.hideItem {
      display: none;
    }
  </style>
  <div class="gr-form-styles">
    <div id="form">
      <section id="itemNameSection">
        <span class="title">[[detailType]] name</span>
        <iron-input
          placeholder="[[detailType]] Name"
          bind-value="{{_itemName}}"
        >
          <input
            is="iron-input"
            placeholder="[[detailType]] Name"
            bind-value="{{_itemName}}"
          />
        </iron-input>
      </section>
      <section id="itemRevisionSection">
        <span class="title">Initial Revision</span>
        <iron-input
          placeholder="Revision (Branch or SHA-1)"
          bind-value="{{_itemRevision}}"
        >
          <input
            is="iron-input"
            placeholder="Revision (Branch or SHA-1)"
            bind-value="{{_itemRevision}}"
          />
        </iron-input>
      </section>
      <section
        id="itemAnnotationSection"
        class$="[[_computeHideItemClass(itemDetail)]]"
      >
        <span class="title">Annotation</span>
        <iron-input
          placeholder="Annotation (Optional)"
          bind-value="{{_itemAnnotation}}"
        >
          <input
            is="iron-input"
            placeholder="Annotation (Optional)"
            bind-value="{{_itemAnnotation}}"
          />
        </iron-input>
      </section>
    </div>
  </div>
`;var sb,ab=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.branches="branches",e.tags="tags"}(sb||(sb={}));let lb=class extends fi{constructor(){super(...arguments),this.hasNewItemName=!1,this.restApiService=i.restApiService}static get template(){return rb}_updateItemName(e){this.hasNewItemName=!!e}handleCreateItem(){if(!this.repoName)throw new Error("repoName name is not set");if(!this._itemName)throw new Error("itemName name is not set");const e=this._itemRevision?this._itemRevision:"HEAD",t=`${k()}/admin/repos/${O(this.repoName,!0)}`;if(this.itemDetail===sb.branches)return this.restApiService.createRepoBranch(this.repoName,this._itemName,{revision:e}).then(e=>{201===e.status&&$m.show(`${t},branches`)});if(this.itemDetail===sb.tags)return this.restApiService.createRepoTag(this.repoName,this._itemName,{revision:e,message:this._itemAnnotation||void 0}).then(e=>{201===e.status&&$m.show(`${t},tags`)});throw new Error(`Invalid itemDetail: ${this.itemDetail}`)}_computeHideItemClass(e){return e===sb.branches?"hideItem":""}};ab([Oo({type:String})],lb.prototype,"detailType",void 0),ab([Oo({type:String})],lb.prototype,"repoName",void 0),ab([Oo({type:Boolean,notify:!0})],lb.prototype,"hasNewItemName",void 0),ab([Oo({type:String})],lb.prototype,"itemDetail",void 0),ab([Oo({type:String})],lb.prototype,"_itemName",void 0),ab([Oo({type:String})],lb.prototype,"_itemRevision",void 0),ab([Oo({type:String})],lb.prototype,"_itemAnnotation",void 0),ab([No("_itemName")],lb.prototype,"_updateItemName",null),lb=ab([Po("gr-create-pointer-dialog")],lb);const cb=mi`
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    .tags td.name {
      min-width: 25em;
    }
    td.name,
    td.revision,
    td.message {
      word-break: break-word;
    }
    td.revision.tags {
      width: 27em;
    }
    td.message,
    td.tagger {
      max-width: 15em;
    }
    .editing .editItem {
      display: inherit;
    }
    .editItem,
    .editing .editBtn,
    .canEdit .revisionNoEditing,
    .editing .revisionWithEditing,
    .revisionEdit,
    .hideItem {
      display: none;
    }
    .revisionEdit gr-button {
      margin-left: var(--spacing-m);
    }
    .editBtn {
      margin-left: var(--spacing-l);
    }
    .canEdit .revisionEdit {
      align-items: center;
      display: flex;
    }
    .deleteButton:not(.show) {
      display: none;
    }
    .tagger.hide {
      display: none;
    }
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <gr-list-view
    create-new="[[_loggedIn]]"
    filter="[[_filter]]"
    items-per-page="[[_itemsPerPage]]"
    items="[[_items]]"
    loading="[[_loading]]"
    offset="[[_offset]]"
    on-create-clicked="_handleCreateClicked"
    path="[[_getPath(_repo, detailType)]]"
  >
    <table id="list" class="genericList gr-form-styles">
      <tbody>
        <tr class="headerRow">
          <th class="name topHeader">Name</th>
          <th class="revision topHeader">Revision</th>
          <th class$="message topHeader [[_hideIfBranch(detailType)]]">
            Message
          </th>
          <th class$="tagger topHeader [[_hideIfBranch(detailType)]]">
            Tagger
          </th>
          <th class="repositoryBrowser topHeader">Repository Browser</th>
          <th class="delete topHeader"></th>
        </tr>
        <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
          <td>Loading...</td>
        </tr>
      </tbody>
      <tbody class$="[[computeLoadingClass(_loading)]]">
        <template is="dom-repeat" items="[[_shownItems]]">
          <tr class="table">
            <td class$="[[detailType]] name">
              <a href$="[[_computeFirstWebLink(item)]]">
                [[_stripRefs(item.ref, detailType)]]
              </a>
            </td>
            <td
              class$="[[detailType]] revision [[_computeCanEditClass(item.ref, detailType, _isOwner)]]"
            >
              <span class="revisionNoEditing"> [[item.revision]] </span>
              <span class$="revisionEdit [[_computeEditingClass(_isEditing)]]">
                <span class="revisionWithEditing"> [[item.revision]] </span>
                <gr-button
                  link=""
                  on-click="_handleEditRevision"
                  class="editBtn"
                >
                  edit
                </gr-button>
                <iron-input bind-value="{{_revisedRef}}" class="editItem">
                  <input is="iron-input" bind-value="{{_revisedRef}}" />
                </iron-input>
                <gr-button
                  link=""
                  on-click="_handleCancelRevision"
                  class="cancelBtn editItem"
                >
                  Cancel
                </gr-button>
                <gr-button
                  link=""
                  on-click="_handleSaveRevision"
                  class="saveBtn editItem"
                  disabled="[[!_revisedRef]]"
                >
                  Save
                </gr-button>
              </span>
            </td>
            <td class$="message [[_hideIfBranch(detailType)]]">
              [[_computeMessage(item.message)]]
            </td>
            <td class$="tagger [[_hideIfBranch(detailType)]]">
              <div class$="tagger [[_computeHideTagger(item.tagger)]]">
                <gr-account-link account="[[item.tagger]]"> </gr-account-link>
                (<gr-date-formatter
                  has-tooltip=""
                  date-str="[[item.tagger.date]]"
                >
                </gr-date-formatter
                >)
              </div>
            </td>
            <td class="repositoryBrowser">
              <template
                is="dom-repeat"
                items="[[_computeWeblink(item)]]"
                as="link"
              >
                <a
                  href$="[[link.url]]"
                  class="webLink"
                  rel="noopener"
                  target="_blank"
                >
                  ([[link.name]])
                </a>
              </template>
            </td>
            <td class="delete">
              <gr-button
                link=""
                class$="deleteButton [[_computeHideDeleteClass(_isOwner, item.can_delete)]]"
                on-click="_handleDeleteItem"
              >
                Delete
              </gr-button>
            </td>
          </tr>
        </template>
      </tbody>
    </table>
    <gr-overlay id="overlay" with-backdrop="">
      <gr-confirm-delete-item-dialog
        class="confirmDialog"
        on-confirm="_handleDeleteItemConfirm"
        on-cancel="_handleConfirmDialogCancel"
        item="[[_refName]]"
        item-type="[[detailType]]"
      ></gr-confirm-delete-item-dialog>
    </gr-overlay>
  </gr-list-view>
  <gr-overlay id="createOverlay" with-backdrop="">
    <gr-dialog
      id="createDialog"
      disabled="[[!_hasNewItemName]]"
      confirm-label="Create"
      on-confirm="_handleCreateItem"
      on-cancel="_handleCloseCreate"
    >
      <div class="header" slot="header">
        Create [[_computeItemName(detailType)]]
      </div>
      <div class="main" slot="main">
        <gr-create-pointer-dialog
          id="createNewModal"
          detail-type="[[_computeItemName(detailType)]]"
          has-new-item-name="{{_hasNewItemName}}"
          item-detail="[[detailType]]"
          repo-name="[[_repo]]"
        ></gr-create-pointer-dialog>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var db=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let hb=class extends(B_(fi)){constructor(){super(...arguments),this._editing=!1,this._isOwner=!1,this._loggedIn=!1,this._itemsPerPage=25,this._loading=!0,this.restApiService=i.restApiService}static get template(){return cb}_determineIfOwner(e){return this.restApiService.getRepoAccess(e).then(t=>{var i;return this._isOwner=!!(null===(i=null==t?void 0:t[e])||void 0===i?void 0:i.is_owner)})}_paramsChanged(e){return(null==e?void 0:e.repo)?(null==e?void 0:e.detail)===Jm.BRANCHES||(null==e?void 0:e.detail)===Jm.TAGS?(this._repo=e.repo,this._getLoggedIn().then(e=>{this._loggedIn=e,e&&this._repo&&this._determineIfOwner(this._repo)}),this.detailType=e.detail,this._filter=this.getFilterValue(e),this._offset=this.getOffsetValue(e),this.detailType?this._getItems(this._filter,this._repo,this._itemsPerPage,this._offset,this.detailType):Promise.reject(new Error("undefined detailType"))):void 0:Promise.reject(new Error("undefined repo"))}_getItems(e,t,i,n,o){if(void 0===e||!t||void 0===n)return Promise.reject(new Error("filter or repo or offset undefined"));this._loading=!0,this._items=[],yh();const r=e=>{Si(e)};return o===Jm.BRANCHES?this.restApiService.getRepoBranches(e,t,i,n,r).then(e=>{e&&(this._items=e,this._loading=!1)}):o===Jm.TAGS?this.restApiService.getRepoTags(e,t,i,n,r).then(e=>{e&&(this._items=e,this._loading=!1)}):Promise.reject(new Error("unknown detail type"))}_getPath(e){return`/admin/repos/${O(e,!1)},${this.detailType}`}_computeWeblink(e){if(!e.web_links)return"";const t=e.web_links;return t.length?t:null}_computeFirstWebLink(e){const t=this._computeWeblink(e);return t?t[0].url:null}_computeMessage(e){if(e)return e.split("-----BEGIN PGP SIGNATURE-----")[0]}_stripRefs(e,t){if(t===Jm.BRANCHES)return e.replace("refs/heads/","");if(t===Jm.TAGS)return e.replace("refs/tags/","");throw new Error("unknown detailType")}_getLoggedIn(){return this.restApiService.getLoggedIn()}_computeEditingClass(e){return e?"editing":""}_computeCanEditClass(e,t,i){return i&&"HEAD"===this._stripRefs(e,t)?"canEdit":""}_handleEditRevision(e){this._revisedRef=e.model.get("item.revision"),this._isEditing=!0}_handleCancelRevision(){this._isEditing=!1}_handleSaveRevision(e){this._revisedRef&&this._repo&&this._setRepoHead(this._repo,this._revisedRef,e)}_setRepoHead(e,t,i){return this.restApiService.setRepoHead(e,t).then(e=>{e.status<400&&(this._isEditing=!1,i.model.set("item.revision",t),this._getItems(this._filter,this._repo,this._itemsPerPage,this._offset,this.detailType))})}_computeItemName(e){if(e===Jm.BRANCHES)return"Branch";if(e===Jm.TAGS)return"Tag";throw new Error("unknown detailType")}_handleDeleteItemConfirm(){return this.$.overlay.close(),this._repo&&this._refName?this.detailType===Jm.BRANCHES?this.restApiService.deleteRepoBranches(this._repo,this._refName).then(e=>{204===e.status&&this._getItems(this._filter,this._repo,this._itemsPerPage,this._offset,this.detailType)}):this.detailType===Jm.TAGS?this.restApiService.deleteRepoTags(this._repo,this._refName).then(e=>{204===e.status&&this._getItems(this._filter,this._repo,this._itemsPerPage,this._offset,this.detailType)}):Promise.reject(new Error("unknown detail type")):Promise.reject(new Error("undefined repo or refName"))}_handleConfirmDialogCancel(){this.$.overlay.close()}_handleDeleteItem(e){const t=this._stripRefs(e.model.get("item.ref"),this.detailType);t&&(this._refName=t,this.$.overlay.open())}_computeHideDeleteClass(e,t){return t||e?"show":""}_handleCreateItem(){this.$.createNewModal.handleCreateItem(),this._handleCloseCreate()}_handleCloseCreate(){this.$.createOverlay.close()}_handleCreateClicked(){this.$.createOverlay.open()}_hideIfBranch(e){return e===Jm.BRANCHES?"hideItem":""}_computeHideTagger(e){return e?"":"hide"}};db([Oo({type:Object,observer:"_paramsChanged"})],hb.prototype,"params",void 0),db([Oo({type:String})],hb.prototype,"detailType",void 0),db([Oo({type:Boolean})],hb.prototype,"_editing",void 0),db([Oo({type:Boolean})],hb.prototype,"_isOwner",void 0),db([Oo({type:Boolean})],hb.prototype,"_loggedIn",void 0),db([Oo({type:Number})],hb.prototype,"_offset",void 0),db([Oo({type:String})],hb.prototype,"_repo",void 0),db([Oo({type:Array})],hb.prototype,"_items",void 0),db([Oo({type:Array,computed:"computeShownItems(_items)"})],hb.prototype,"_shownItems",void 0),db([Oo({type:Number})],hb.prototype,"_itemsPerPage",void 0),db([Oo({type:Boolean})],hb.prototype,"_loading",void 0),db([Oo({type:String})],hb.prototype,"_filter",void 0),db([Oo({type:String})],hb.prototype,"_refName",void 0),db([Oo({type:Boolean})],hb.prototype,"_hasNewItemName",void 0),db([Oo({type:Boolean})],hb.prototype,"_isEditing",void 0),db([Oo({type:String})],hb.prototype,"_revisedRef",void 0),hb=db([Po("gr-repo-detail-list")],hb);const pb=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    :host {
      display: inline-block;
    }
    input {
      width: 20em;
    }
    gr-autocomplete {
      width: 20em;
    }
  </style>

  <div class="gr-form-styles">
    <div id="form">
      <section>
        <span class="title">Repository name</span>
        <iron-input autocomplete="on" bind-value="{{_repoConfig.name}}">
          <input
            is="iron-input"
            id="repoNameInput"
            autocomplete="on"
            bind-value="{{_repoConfig.name}}"
          />
        </iron-input>
      </section>
      <section>
        <span class="title">Default Branch</span>
        <iron-input autocomplete="off" bind-value="{{_defaultBranch}}">
          <input
            is="iron-input"
            id="defaultBranchNameInput"
            autocomplete="off"
            bind-value="{{_defaultBranch}}"
          />
        </iron-input>
      </section>
      <section>
        <span class="title">Rights inherit from</span>
        <span class="value">
          <gr-autocomplete
            id="rightsInheritFromInput"
            text="{{_repoConfig.parent}}"
            query="[[_query]]"
            placeholder="Optional, defaults to 'All-Projects'"
          >
          </gr-autocomplete>
        </span>
      </section>
      <section>
        <span class="title">Owner</span>
        <span class="value">
          <gr-autocomplete
            id="ownerInput"
            text="{{_repoOwner}}"
            value="{{_repoOwnerId}}"
            query="[[_queryGroups]]"
          >
          </gr-autocomplete>
        </span>
      </section>
      <section>
        <span class="title">Create initial empty commit</span>
        <span class="value">
          <gr-select
            id="initialCommit"
            bind-value="{{_repoConfig.create_empty_commit}}"
          >
            <select>
              <option value="false">False</option>
              <option value="true">True</option>
            </select>
          </gr-select>
        </span>
      </section>
      <section>
        <span class="title">Only serve as parent for other repositories</span>
        <span class="value">
          <gr-select
            id="parentRepo"
            bind-value="{{_repoConfig.permissions_only}}"
          >
            <select>
              <option value="false">False</option>
              <option value="true">True</option>
            </select>
          </gr-select>
        </span>
      </section>
    </div>
  </div>
`;var ub=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let gb=class extends fi{constructor(){super(),this.hasNewRepoName=!1,this._repoConfig={create_empty_commit:!0,permissions_only:!1,name:"",branches:[]},this._repoCreated=!1,this.restApiService=i.restApiService,this._query=e=>this._getRepoSuggestions(e),this._queryGroups=e=>this._getGroupSuggestions(e)}static get template(){return pb}_computeRepoUrl(e){return k()+"/admin/repos/"+O(e,!0)}focus(){var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("input"))||void 0===t||t.focus()}_updateRepoName(e){this.hasNewRepoName=!!e}handleCreateRepo(){return this._defaultBranch&&(this._repoConfig.branches=[this._defaultBranch]),this._repoOwnerId&&(this._repoConfig.owners=[this._repoOwnerId]),this.restApiService.createRepo(this._repoConfig).then(e=>{201===e.status&&(this._repoCreated=!0,$m.show(this._computeRepoUrl(this._repoConfig.name)))})}_getRepoSuggestions(e){return this.restApiService.getSuggestedProjects(e).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:n.id});return t})}_getGroupSuggestions(e){return this.restApiService.getSuggestedGroups(e).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:decodeURIComponent(n.id)});return t})}};ub([Oo({type:Boolean,notify:!0})],gb.prototype,"hasNewRepoName",void 0),ub([Oo({type:Object})],gb.prototype,"_repoConfig",void 0),ub([Oo({type:String})],gb.prototype,"_defaultBranch",void 0),ub([Oo({type:Boolean})],gb.prototype,"_repoCreated",void 0),ub([Oo({type:String})],gb.prototype,"_repoOwner",void 0),ub([Oo({type:String})],gb.prototype,"_repoOwnerId",void 0),ub([Oo({type:Object})],gb.prototype,"_query",void 0),ub([Oo({type:Object})],gb.prototype,"_queryGroups",void 0),ub([No("_repoConfig.name")],gb.prototype,"_updateRepoName",null),gb=ub([Po("gr-create-repo-dialog")],gb);const mb=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style>
    .genericList tr td:last-of-type {
      text-align: left;
    }
    .genericList tr th:last-of-type {
      text-align: left;
    }
    .readOnly {
      text-align: center;
    }
    .changesLink,
    .name,
    .repositoryBrowser,
    .readOnly {
      white-space: nowrap;
    }
  </style>
  <gr-list-view
    create-new="[[_createNewCapability]]"
    filter="[[_filter]]"
    items-per-page="[[_reposPerPage]]"
    items="[[_repos]]"
    loading="[[_loading]]"
    offset="[[_offset]]"
    on-create-clicked="_handleCreateClicked"
    path="[[_path]]"
  >
    <table id="list" class="genericList">
      <tbody>
        <tr class="headerRow">
          <th class="name topHeader">Repository Name</th>
          <th class="repositoryBrowser topHeader">Repository Browser</th>
          <th class="changesLink topHeader">Changes</th>
          <th class="topHeader readOnly">Read only</th>
          <th class="description topHeader">Repository Description</th>
        </tr>
        <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
          <td>Loading...</td>
        </tr>
      </tbody>
      <tbody class$="[[computeLoadingClass(_loading)]]">
        <template is="dom-repeat" items="[[_shownRepos]]">
          <tr class="table">
            <td class="name">
              <a href$="[[_computeRepoUrl(item.name)]]">[[item.name]]</a>
            </td>
            <td class="repositoryBrowser">
              <template
                is="dom-repeat"
                items="[[_computeWeblink(item)]]"
                as="link"
              >
                <a
                  href$="[[link.url]]"
                  class="webLink"
                  rel="noopener"
                  target="_blank"
                >
                  [[link.name]]
                </a>
              </template>
            </td>
            <td class="changesLink">
              <a href$="[[_computeChangesLink(item.name)]]">view all</a>
            </td>
            <td class="readOnly">[[_readOnly(item)]]</td>
            <td class="description">[[item.description]]</td>
          </tr>
        </template>
      </tbody>
    </table>
  </gr-list-view>
  <gr-overlay id="createOverlay" with-backdrop="">
    <gr-dialog
      id="createDialog"
      class="confirmDialog"
      disabled="[[!_hasNewRepoName]]"
      confirm-label="Create"
      on-confirm="_handleCreateRepo"
      on-cancel="_handleCloseCreate"
    >
      <div class="header" slot="header">Create Repository</div>
      <div class="main" slot="main">
        <gr-create-repo-dialog
          has-new-repo-name="{{_hasNewRepoName}}"
          id="createNewModal"
        ></gr-create-repo-dialog>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var fb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let _b=class extends(B_(fi)){constructor(){super(...arguments),this._path="/admin/repos",this._hasNewRepoName=!1,this._createNewCapability=!1,this._repos=[],this._reposPerPage=25,this._loading=!0,this._filter="",this.restApiService=i.restApiService}static get template(){return mb}get _shownRepos(){return this.computeShownItems(this._repos)}connectedCallback(){super.connectedCallback(),this._getCreateRepoCapability(),xi(this,"Repos"),this._maybeOpenCreateOverlay(this.params)}_paramsChanged(e){return this._loading=!0,this._filter=this.getFilterValue(e),this._offset=this.getOffsetValue(e),this._getRepos(this._filter,this._reposPerPage,this._offset)}_maybeOpenCreateOverlay(e){(null==e?void 0:e.openCreateModal)&&this.$.createOverlay.open()}_computeRepoUrl(e){return this.getUrl(this._path+"/",e)}_computeChangesLink(e){return Qm.getUrlForProjectChanges(e)}_getCreateRepoCapability(){return this.restApiService.getAccount().then(e=>{if(e)return this.restApiService.getAccountCapabilities(["createProject"]).then(e=>{(null==e?void 0:e.createProject)&&(this._createNewCapability=!0)})})}_getRepos(e,t,i){return this._repos=[],this.restApiService.getRepos(e,t,i).then(t=>{e===this._filter&&t&&(this._repos=t.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this._loading=!1)})}_refreshReposList(){return this.restApiService.invalidateReposCache(),this._getRepos(this._filter,this._reposPerPage,this._offset)}_handleCreateRepo(){this.$.createNewModal.handleCreateRepo().then(()=>{this._refreshReposList()})}_handleCloseCreate(){this.$.createOverlay.close()}_handleCreateClicked(){this.$.createOverlay.open().then(()=>{this.$.createNewModal.focus()})}_readOnly(e){return e.state===an.READ_ONLY?"Y":""}_computeWeblink(e){if(!e.web_links)return"";const t=e.web_links;return t.length?t:null}};fb([Oo({type:Object})],_b.prototype,"params",void 0),fb([Oo({type:Number})],_b.prototype,"_offset",void 0),fb([Oo({type:String})],_b.prototype,"_path",void 0),fb([Oo({type:Boolean})],_b.prototype,"_hasNewRepoName",void 0),fb([Oo({type:Boolean})],_b.prototype,"_createNewCapability",void 0),fb([Oo({type:Array})],_b.prototype,"_repos",void 0),fb([Oo({type:Number})],_b.prototype,"_reposPerPage",void 0),fb([Oo({type:Boolean})],_b.prototype,"_loading",void 0),fb([Oo({type:String})],_b.prototype,"_filter",void 0),fb([Lo("_repos")],_b.prototype,"_shownRepos",null),fb([No("params")],_b.prototype,"_paramsChanged",null),_b=fb([Po("gr-repo-list")],_b);const vb=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-menu-page-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-page-nav-styles">
    gr-dropdown-list {
      --trigger-style: {
        text-transform: none;
      }
    }
    .breadcrumbText {
      /* Same as dropdown trigger so chevron spacing is consistent. */
      padding: 5px 4px;
    }
    iron-icon {
      margin: 0 var(--spacing-xs);
    }
    .breadcrumb {
      align-items: center;
      display: flex;
    }
    .mainHeader {
      align-items: baseline;
      border-bottom: 1px solid var(--border-color);
      display: flex;
    }
    .selectText {
      display: none;
    }
    .selectText.show {
      display: inline-block;
    }
    .main.breadcrumbs:not(.table) {
      margin-top: var(--spacing-l);
    }
  </style>
  <gr-page-nav class="navStyles">
    <ul class="sectionContent">
      <template id="adminNav" is="dom-repeat" items="[[_filteredLinks]]">
        <li class$="sectionTitle [[_computeSelectedClass(item.view, params)]]">
          <a class="title" href="[[_computeLinkURL(item)]]" rel="noopener"
            >[[item.name]]</a
          >
        </li>
        <template is="dom-repeat" items="[[item.children]]" as="child">
          <li class$="[[_computeSelectedClass(child.view, params)]]">
            <a href$="[[_computeLinkURL(child)]]" rel="noopener"
              >[[child.name]]</a
            >
          </li>
        </template>
        <template is="dom-if" if="[[item.subsection]]">
          <!--If a section has a subsection, render that.-->
          <li class$="[[_computeSelectedClass(item.subsection.view, params)]]">
            <a
              class="title"
              href$="[[_computeLinkURL(item.subsection)]]"
              rel="noopener"
            >
              [[item.subsection.name]]</a
            >
          </li>
          <!--Loop through the links in the sub-section.-->
          <template
            is="dom-repeat"
            items="[[item.subsection.children]]"
            as="child"
          >
            <li
              class$="subsectionItem [[_computeSelectedClass(child.view, params, child.detailType)]]"
            >
              <a href$="[[_computeLinkURL(child)]]">[[child.name]]</a>
            </li>
          </template>
        </template>
      </template>
    </ul>
  </gr-page-nav>
  <template is="dom-if" if="[[_subsectionLinks.length]]">
    <section class="mainHeader">
      <span class="breadcrumb">
        <span class="breadcrumbText">[[_breadcrumbParentName]]</span>
        <iron-icon icon="gr-icons:chevron-right"></iron-icon>
      </span>
      <gr-dropdown-list
        lowercase=""
        id="pageSelect"
        value="[[_computeSelectValue(params)]]"
        items="[[_subsectionLinks]]"
        on-value-change="_handleSubsectionChange"
      >
      </gr-dropdown-list>
    </section>
  </template>
  <template is="dom-if" if="[[_showRepoList]]" restamp="true">
    <div class="main table">
      <gr-repo-list class="table" params="[[params]]"></gr-repo-list>
    </div>
  </template>
  <template is="dom-if" if="[[_showGroupList]]" restamp="true">
    <div class="main table">
      <gr-admin-group-list class="table" params="[[params]]">
      </gr-admin-group-list>
    </div>
  </template>
  <template is="dom-if" if="[[_showPluginList]]" restamp="true">
    <div class="main table">
      <gr-plugin-list class="table" params="[[params]]"></gr-plugin-list>
    </div>
  </template>
  <template is="dom-if" if="[[_showRepoMain]]" restamp="true">
    <div class="main breadcrumbs">
      <gr-repo repo="[[params.repo]]"></gr-repo>
    </div>
  </template>
  <template is="dom-if" if="[[_showGroup]]" restamp="true">
    <div class="main breadcrumbs">
      <gr-group
        group-id="[[params.groupId]]"
        on-name-changed="_updateGroupName"
      ></gr-group>
    </div>
  </template>
  <template is="dom-if" if="[[_showGroupMembers]]" restamp="true">
    <div class="main breadcrumbs">
      <gr-group-members group-id="[[params.groupId]]"></gr-group-members>
    </div>
  </template>
  <template is="dom-if" if="[[_showRepoDetailList]]" restamp="true">
    <div class="main table breadcrumbs">
      <gr-repo-detail-list
        params="[[params]]"
        class="table"
      ></gr-repo-detail-list>
    </div>
  </template>
  <template is="dom-if" if="[[_showGroupAuditLog]]" restamp="true">
    <div class="main table breadcrumbs">
      <gr-group-audit-log
        group-id="[[params.groupId]]"
        class="table"
      ></gr-group-audit-log>
    </div>
  </template>
  <template is="dom-if" if="[[_showRepoCommands]]" restamp="true">
    <div class="main breadcrumbs">
      <gr-repo-commands repo="[[params.repo]]"></gr-repo-commands>
    </div>
  </template>
  <template is="dom-if" if="[[_showRepoAccess]]" restamp="true">
    <div class="main breadcrumbs">
      <gr-repo-access path="[[path]]" repo="[[params.repo]]"></gr-repo-access>
    </div>
  </template>
  <template is="dom-if" if="[[_showRepoDashboards]]" restamp="true">
    <div class="main table breadcrumbs">
      <gr-repo-dashboards repo="[[params.repo]]"></gr-repo-dashboards>
    </div>
  </template>
`,yb=[{name:"Repositories",noBaseUrl:!0,url:"/admin/repos",view:"gr-repo-list",viewableToAll:!0},{name:"Groups",section:"Groups",noBaseUrl:!0,url:"/admin/groups",view:"gr-admin-group-list"},{name:"Plugins",capability:"viewPlugins",section:"Plugins",noBaseUrl:!0,url:"/admin/plugins",view:"gr-plugin-list"}];function bb(e,t,i,n){return e?t().then(e=>wb(t=>!t.capability||o(e,t.capability),i,n)):Promise.resolve(wb(e=>!!e.viewableToAll,i,n))}function wb(e,t,i){let n=yb.slice(0),o=void 0;const r=e=>"/"!==e.url[0];n.push(...t().map(e=>({url:e.url,name:e.text,capability:e.capability||void 0,noBaseUrl:!r(e),view:null,viewableToAll:!e.capability,target:r(e)?"_blank":null}))),n=n.filter(e);const s=[],a=i&&i.repoName,l=i&&i.groupId,c=i&&i.groupName,d=i&&i.groupIsInternal,h=i&&i.isAdmin,p=i&&i.groupOwner;if(!a&&!l)return{links:n,expandedSection:o};for(const e of n){const t={...e};"Repositories"===t.name&&a?(t.subsection=Sb(a),o=t.subsection):"Groups"===t.name&&l&&c&&(t.subsection=Cb(l,c,d,h,p),o=t.subsection),s.push(t)}return{links:s,expandedSection:o}}function Cb(e,t,i,n,o){const r=[],s={name:t,view:Qm.View.GROUP,url:Qm.getUrlForGroup(e),children:r};return i&&r.push({name:"Members",detailType:Qm.GroupDetailView.MEMBERS,view:Qm.View.GROUP,url:Qm.getUrlForGroupMembers(e)}),i&&(n||o)&&r.push({name:"Audit Log",detailType:Qm.GroupDetailView.LOG,view:Qm.View.GROUP,url:Qm.getUrlForGroupLog(e)}),s}function Sb(e){return{name:e,view:Qm.View.REPO,url:Qm.getUrlForRepo(e),children:[{name:"Access",view:Qm.View.REPO,detailType:Qm.RepoDetailView.ACCESS,url:Qm.getUrlForRepoAccess(e)},{name:"Commands",view:Qm.View.REPO,detailType:Qm.RepoDetailView.COMMANDS,url:Qm.getUrlForRepoCommands(e)},{name:"Branches",view:Qm.View.REPO,detailType:Qm.RepoDetailView.BRANCHES,url:Qm.getUrlForRepoBranches(e)},{name:"Tags",view:Qm.View.REPO,detailType:Qm.RepoDetailView.TAGS,url:Qm.getUrlForRepoTags(e)},{name:"Dashboards",view:Qm.View.REPO,detailType:Qm.RepoDetailView.DASHBOARDS,url:Qm.getUrlForRepoDashboards(e)}]}}var Eb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Ab=/^[\da-f]{40}$/;function xb(e){if(e.view!==bs.ADMIN)return e.detail}let Rb=class extends fi{constructor(){super(...arguments),this._groupOwner=!1,this._showDownload=!1,this._isAdmin=!1,this.restApiService=i.restApiService,this.jsAPI=i.jsApiService}static get template(){return vb}connectedCallback(){super.connectedCallback(),this.reload()}reload(){const e=[this.restApiService.getAccount(),Qu().awaitPluginsLoaded()];return Promise.all(e).then(e=>{this.account=e[0];let t=void 0;return this._repoName?t={repoName:this._repoName}:this._groupId&&(t={groupId:this._groupId,groupName:this._groupName,groupIsInternal:this._groupIsInternal,isAdmin:this._isAdmin,groupOwner:this._groupOwner}),bb(this.account,()=>this.restApiService.getAccountCapabilities().then(e=>{if(!e)throw new Error("getAccountCapabilities returns undefined");return e}),()=>this.jsAPI.getAdminMenuLinks(),t).then(e=>{var t;this._filteredLinks=e.links,this._breadcrumbParentName=e.expandedSection?e.expandedSection.name:"",e.expandedSection?this._subsectionLinks=[e.expandedSection].concat(null!==(t=e.expandedSection.children)&&void 0!==t?t:[]).map(e=>{var t,i;return{text:e.detailType?e.name:"Home",value:e.view+(null!==(t=e.detailType)&&void 0!==t?t:""),view:e.view,url:e.url,detailType:e.detailType,parent:null!==(i=this._groupId)&&void 0!==i?i:this._repoName}}):this._subsectionLinks=[]})})}_computeSelectValue(e){var t;if(e&&e.view)return`${e.view}${null!==(t=xb(e))&&void 0!==t?t:""}`}_selectedIsCurrentPage(e){var t;return!!this.params&&(e.parent===(null!==(t=this._repoName)&&void 0!==t?t:this._groupId)&&e.view===this.params.view&&e.detailType===xb(this.params))}_handleSubsectionChange(e){if(!this._subsectionLinks)return;const t=this._subsectionLinks.find(t=>t.value===e.detail.value);this._selectedIsCurrentPage(t)||Qm.navigateToRelativeUrl(t.url)}_paramsChanged(e){this.set("_showGroup",e.view===bs.GROUP&&!e.detail),this.set("_showGroupAuditLog",e.view===bs.GROUP&&e.detail===Xm.LOG),this.set("_showGroupMembers",e.view===bs.GROUP&&e.detail===Xm.MEMBERS),this.set("_showGroupList",e.view===bs.ADMIN&&"gr-admin-group-list"===e.adminView),this.set("_showRepoAccess",e.view===bs.REPO&&e.detail===Jm.ACCESS),this.set("_showRepoCommands",e.view===bs.REPO&&e.detail===Jm.COMMANDS),this.set("_showRepoDetailList",e.view===bs.REPO&&(e.detail===Jm.BRANCHES||e.detail===Jm.TAGS)),this.set("_showRepoDashboards",e.view===bs.REPO&&e.detail===Jm.DASHBOARDS),this.set("_showRepoMain",e.view===bs.REPO&&!e.detail),this.set("_showRepoList",e.view===bs.ADMIN&&"gr-repo-list"===e.adminView),this.set("_showPluginList",e.view===bs.ADMIN&&"gr-plugin-list"===e.adminView);let t=!1;const i=e.view===bs.REPO?e.repo:void 0;i!==this._repoName&&(this._repoName=i,t=!0);const n=e.view===bs.GROUP?e.groupId:void 0;n!==this._groupId&&(this._groupId=n,t=!0),!this._breadcrumbParentName||e.view===bs.GROUP&&e.groupId||e.view===bs.REPO&&e.repo||(t=!0),t&&this.reload()}_computeURLHelper(e,t){return"//"+e+k()+t}_computeRelativeURL(e){const t=window.location.host;return this._computeURLHelper(t,e)}_computeLinkURL(e){return e&&void 0!==e.url?e.target||!e.noBaseUrl?e.url:this._computeRelativeURL(e.url):""}_computeSelectedClass(e,t,i){return t?t.view===bs.GROUP&&e===bs.GROUP?t.detail||i?t.detail===i?"selected":"":"selected":t.view===bs.REPO&&e===bs.REPO?t.detail||i?t.detail===i?"selected":"":"selected":t.detailType&&t.detailType!==i?"":t.view===bs.ADMIN&&e===t.adminView?"selected":"":""}_computeGroupName(e){if(!e)return;const t=[];this.restApiService.getGroupConfig(e).then(e=>{if(e&&e.name)return this._groupName=e.name,this._groupIsInternal=!!e.id.match(Ab),this.reload(),t.push(this.restApiService.getIsAdmin().then(e=>{this._isAdmin=!!e})),t.push(this.restApiService.getIsGroupOwner(e.name).then(e=>{this._groupOwner=e})),Promise.all(t).then(()=>{this.reload()})})}_updateGroupName(e){this._groupName=e.detail.name,this.reload()}};Eb([Oo({type:Object})],Rb.prototype,"params",void 0),Eb([Oo({type:String})],Rb.prototype,"path",void 0),Eb([Oo({type:String})],Rb.prototype,"adminView",void 0),Eb([Oo({type:String})],Rb.prototype,"_breadcrumbParentName",void 0),Eb([Oo({type:String})],Rb.prototype,"_repoName",void 0),Eb([Oo({type:String,observer:"_computeGroupName"})],Rb.prototype,"_groupId",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_groupIsInternal",void 0),Eb([Oo({type:String})],Rb.prototype,"_groupName",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_groupOwner",void 0),Eb([Oo({type:Array})],Rb.prototype,"_subsectionLinks",void 0),Eb([Oo({type:Array})],Rb.prototype,"_filteredLinks",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showDownload",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_isAdmin",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showGroup",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showGroupAuditLog",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showGroupList",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showGroupMembers",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoAccess",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoCommands",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoDashboards",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoDetailList",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoMain",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showRepoList",void 0),Eb([Oo({type:Boolean})],Rb.prototype,"_showPluginList",void 0),Eb([No("params")],Rb.prototype,"_paramsChanged",null),Rb=Eb([Po("gr-admin-view")],Rb);const Tb=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-table-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <gr-list-view
    filter="[[_filter]]"
    items="false"
    offset="0"
    loading="[[_loading]]"
    path="/Documentation"
  >
    <table id="list" class="genericList">
      <tbody>
        <tr class="headerRow">
          <th class="name topHeader">Name</th>
          <th class="name topHeader"></th>
          <th class="name topHeader"></th>
        </tr>
        <tr id="loading" class$="loadingMsg [[computeLoadingClass(_loading)]]">
          <td>Loading...</td>
        </tr>
      </tbody>
      <tbody class$="[[computeLoadingClass(_loading)]]">
        <template is="dom-repeat" items="[[_documentationSearches]]">
          <tr class="table">
            <td class="name">
              <a href$="[[_computeSearchUrl(item.url)]]">[[item.title]]</a>
            </td>
            <td></td>
            <td></td>
          </tr>
        </template>
      </tbody>
    </table>
  </gr-list-view>
`;var kb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Pb=class extends(B_(fi)){constructor(){super(...arguments),this._loading=!0,this._filter="",this.restApiService=i.restApiService}static get template(){return Tb}connectedCallback(){super.connectedCallback(),xi(this,"Documentation Search")}_paramsChanged(e){return this._loading=!0,this._filter=this.getFilterValue(e),this._getDocumentationSearches(this._filter)}_getDocumentationSearches(e){return this._documentationSearches=[],this.restApiService.getDocumentationSearches(e).then(t=>{e===this._filter&&t&&(this._documentationSearches=t,this._loading=!1)})}_computeSearchUrl(e){return e?`${k()}/${e}`:""}};kb([Oo({type:Object,observer:"_paramsChanged"})],Pb.prototype,"params",void 0),kb([Oo({type:Array})],Pb.prototype,"_documentationSearches",void 0),kb([Oo({type:Boolean})],Pb.prototype,"_loading",void 0),kb([Oo({type:String})],Pb.prototype,"_filter",void 0),Pb=kb([Po("gr-documentation-search")],Pb);const Ib=document.createElement("template");Ib.innerHTML='<dom-module id="gr-change-list-styles">\n  <template>\n    <style>\n      gr-change-list-item {\n        border-top: 1px solid var(--border-color);\n      }\n      gr-change-list-item[selected],\n      gr-change-list-item:focus {\n        background-color: var(--selection-background-color);\n      }\n      gr-change-list-item[highlight] {\n        background-color: var(--assignee-highlight-color);\n      }\n      gr-change-list-item[highlight][selected],\n      gr-change-list-item[highlight]:focus {\n        background-color: var(--assignee-highlight-selection-color);\n      }\n      .groupTitle td,\n      .cell {\n        vertical-align: middle;\n      }\n      .groupTitle td:not(.label):not(.endpoint),\n      .cell:not(.label):not(.endpoint) {\n        padding-right: 8px;\n      }\n      .groupTitle td {\n        color: var(--deemphasized-text-color);\n        text-align: left;\n      }\n      .groupHeader {\n        background-color: transparent;\n        font-size: var(--font-size-h3);\n        font-weight: var(--font-weight-h3);\n        line-height: var(--line-height-h3);\n      }\n      .groupContent {\n        background-color: var(--background-color-primary);\n        box-shadow: var(--elevation-level-1);\n      }\n      .groupHeader a {\n        color: var(--primary-text-color);\n        text-decoration: none;\n      }\n      .groupHeader a:hover {\n        text-decoration: underline;\n      }\n      .groupTitle td,\n      .cell {\n        padding: var(--spacing-s) 0;\n      }\n      .groupHeader .cell {\n        padding-top: var(--spacing-l);\n      }\n      .star {\n        padding: 0;\n      }\n      gr-change-star {\n        vertical-align: middle;\n      }\n      .owner {\n        --account-max-length: 100px;\n      }\n      .branch,\n      .star,\n      .label,\n      .number,\n      .owner,\n      .assignee,\n      .updated,\n      .submitted,\n      .waiting,\n      .size,\n      .status,\n      .repo {\n        white-space: nowrap;\n      }\n      .star {\n        vertical-align: middle;\n      }\n      .leftPadding {\n        width: var(--spacing-l);\n      }\n      .star {\n        width: 30px;\n      }\n      .reviewers div {\n        overflow: hidden;\n      }\n      .label, .endpoint {\n        border-left: 1px solid var(--border-color);\n      }\n      .groupTitle td.label,\n      .label {\n        text-align: center;\n        width: 3rem;\n      }\n      .truncatedRepo {\n        display: none;\n      }\n      @media only screen and (max-width: 150em) {\n        .assignee,\n        .branch {\n          overflow: hidden;\n          max-width: 18rem;\n          text-overflow: ellipsis;\n        }\n        .truncatedRepo {\n          display: inline-block;\n        }\n        .fullRepo {\n          display: none;\n        }\n      }\n      @media only screen and (max-width: 100em) {\n        .assignee,\n        .branch {\n          max-width: 10rem;\n        }\n      }\n      @media only screen and (max-width: 50em) {\n        :host {\n          font-family: var(--header-font-family);\n          font-size: var(--font-size-h3);\n          font-weight: var(--font-weight-h3);\n          line-height: var(--line-height-h3);\n        }\n        gr-change-list-item {\n          flex-wrap: wrap;\n          justify-content: space-between;\n          padding: var(--spacing-xs) var(--spacing-m);\n        }\n        gr-change-list-item[selected],\n        gr-change-list-item:focus {\n          background-color: var(--view-background-color);\n          border: none;\n          border-top: 1px solid var(--border-color);\n        }\n        gr-change-list-item:hover {\n          background-color: var(--view-background-color);\n        }\n        .cell {\n          align-items: center;\n          display: flex;\n        }\n        .groupTitle,\n        .leftPadding,\n        .status,\n        .repo,\n        .branch,\n        .updated,\n        .submitted,\n        .waiting,\n        .label,\n        .assignee,\n        .groupHeader .star,\n        .noChanges .star {\n          display: none;\n        }\n        .groupHeader .cell,\n        .noChanges .cell {\n          padding-left: var(--spacing-m);\n        }\n        .subject {\n          margin-bottom: var(--spacing-xs);\n          width: calc(100% - 2em);\n        }\n        .owner,\n        .size {\n          max-width: none;\n        }\n        .noChanges .cell {\n          display: block;\n          height: auto;\n        }\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(Ib.content);const Ob=mi`
  <style include="shared-styles">
    button {
      background-color: transparent;
      cursor: pointer;
    }
    iron-icon.active {
      fill: var(--link-color);
    }
    iron-icon {
      vertical-align: top;
      --iron-icon-height: var(
        --gr-change-star-size,
        var(--line-height-normal, 20px)
      );
      --iron-icon-width: var(
        --gr-change-star-size,
        var(--line-height-normal, 20px)
      );
    }
  </style>
  <button
    role="checkbox"
    title="[[createTitle(Shortcut.TOGGLE_CHANGE_STAR,
      ShortcutSection.ACTIONS)]]"
    aria-label="[[_computeAriaLabel(change.starred)]]"
    on-click="toggleStar"
  >
    <iron-icon
      class$="[[_computeStarClass(change.starred)]]"
      icon$="[[_computeStarIcon(change.starred)]]"
    ></iron-icon>
  </button>
`;var Nb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Lb=class extends(Kf(fi)){static get template(){return Ob}_computeStarClass(e){return e?"active":""}_computeStarIcon(e){return`gr-icons:star${e?"":"-border"}`}_computeAriaLabel(e){return e?"Unstar this change":"Star this change"}toggleStar(){if(!this.change)return;const e=!this.change.starred;this.set("change.starred",e);const t={change:this.change,starred:e};e&&Ci(this,"Starring change..."),this.dispatchEvent(new CustomEvent("toggle-star",{bubbles:!0,composed:!0,detail:t}))}};Nb([Oo({type:Object,notify:!0})],Lb.prototype,"change",void 0),Lb=Nb([Po("gr-change-star")],Lb);const Db=mi`
  <style include="shared-styles">
    .chip {
      border-radius: var(--border-radius);
      background-color: var(--chip-background-color);
      padding: 0 var(--spacing-m);
      white-space: nowrap;
    }
    :host(.merged) .chip {
      background-color: var(--status-merged);
      color: var(--status-merged);
    }
    :host(.abandoned) .chip {
      background-color: var(--status-abandoned);
      color: var(--status-abandoned);
    }
    :host(.wip) .chip {
      background-color: var(--status-wip);
      color: var(--status-wip);
    }
    :host(.private) .chip {
      background-color: var(--status-private);
      color: var(--status-private);
    }
    :host(.merge-conflict) .chip {
      background-color: var(--status-conflict);
      color: var(--status-conflict);
    }
    :host(.active) .chip {
      background-color: var(--status-active);
      color: var(--status-active);
    }
    :host(.ready-to-submit) .chip {
      background-color: var(--status-ready);
      color: var(--status-ready);
    }
    :host(.custom) .chip {
      background-color: var(--status-custom);
      color: var(--status-custom);
    }
    :host([flat]) .chip {
      background-color: transparent;
      padding: 0;
    }
    :host(:not([flat])) .chip {
      color: var(--status-text-color);
    }
  </style>
  <gr-tooltip-content
    has-tooltip=""
    position-below=""
    title="[[tooltipText]]"
    max-width="40em"
  >
    <div class="chip" aria-label$="Label: [[status]]">
      [[_computeStatusString(status)]]
    </div>
  </gr-tooltip-content>
`;var Mb,Fb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.MERGED="Merged",e.ABANDONED="Abandoned",e.MERGE_CONFLICT="Merge Conflict",e.WIP="WIP",e.PRIVATE="Private"}(Mb||(Mb={}));let $b=class extends fi{constructor(){super(...arguments),this.flat=!1,this.tooltipText=""}static get template(){return Db}_computeStatusString(e){return e!==Mb.WIP||this.flat?e:"Work in Progress"}_toClassName(e){return e?e.toLowerCase().replace(/\s/g,"-"):""}_updateChipDetails(e,t){switch(t&&this.classList.remove(this._toClassName(t)),this.classList.add(this._toClassName(e)),e){case Mb.WIP:this.tooltipText="This change isn't ready to be reviewed or submitted. It will not appear on dashboards unless you are CC'ed or assigned, and email notifications will be silenced until the review is started.";break;case Mb.PRIVATE:this.tooltipText='This change is only visible to its owner and current reviewers (or anyone with "View Private Changes" permission).';break;case Mb.MERGE_CONFLICT:this.tooltipText='This change has merge conflicts. Download the patch and run "git rebase". Upload a new patchset after resolving all merge conflicts.';break;default:this.tooltipText=""}}};Fb([Oo({type:Boolean,reflectToAttribute:!0})],$b.prototype,"flat",void 0),Fb([Oo({type:String,observer:"_updateChipDetails"})],$b.prototype,"status",void 0),Fb([Oo({type:String})],$b.prototype,"tooltipText",void 0),$b=Fb([Po("gr-change-status")],$b);const Bb=mi` [[_computeDisplayText(text, limit)]] `;var jb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Hb=class extends(Ff(fi)){constructor(){super(...arguments),this.text="",this.limit=null,this.tooltip="",this.hasTooltip=!1,this.disableTooltip=!1}static get template(){return Bb}_updateTitle(e,t,i){[e,i,t].includes(void 0)||(this.hasTooltip=!!t||!!i&&e.length>i,this.hasTooltip&&!this.disableTooltip?i&&e.length>i?this.title=`${e}${t?` (${t})`:""}`:this.title=t:this.title="")}_computeDisplayText(e,t){return t&&e&&e.length>t?e.substr(0,t-1)+"":e}};jb([Oo({type:String})],Hb.prototype,"text",void 0),jb([Oo({type:Number})],Hb.prototype,"limit",void 0),jb([Oo({type:String})],Hb.prototype,"tooltip",void 0),jb([Oo({type:Boolean})],Hb.prototype,"hasTooltip",void 0),jb([Oo({type:Boolean})],Hb.prototype,"disableTooltip",void 0),jb([No("text","tooltip","limit")],Hb.prototype,"_updateTitle",null),Hb=jb([Po("gr-limited-text")],Hb);const Ub=mi`
  <style include="shared-styles">
    :host {
      display: table-row;
      color: var(--primary-text-color);
    }
    :host(:focus) {
      outline: none;
    }
    :host(:hover) {
      background-color: var(--hover-background-color);
    }
    :host([needs-review]) {
      font-weight: var(--font-weight-bold);
      color: var(--primary-text-color);
    }
    .container {
      position: relative;
    }
    .content {
      overflow: hidden;
      position: absolute;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
    }
    .content a {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
    }
    .comments,
    .reviewers {
      white-space: nowrap;
    }
    .reviewers {
      --account-max-length: 70px;
    }
    .spacer {
      height: 0;
      overflow: hidden;
    }
    .status {
      align-items: center;
      display: inline-flex;
    }
    .status .comma {
      padding-right: var(--spacing-xs);
    }
    /* Used to hide the leading separator comma for statuses. */
    .status .comma:first-of-type {
      display: none;
    }
    .size gr-tooltip-content {
      margin: -0.4rem -0.6rem;
      max-width: 2.5rem;
      padding: var(--spacing-m) var(--spacing-l);
    }
    a {
      color: inherit;
      cursor: pointer;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .subject:hover .content {
      text-decoration: underline;
    }
    .u-monospace {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
    }
    .u-green,
    .u-green iron-icon {
      color: var(--positive-green-text-color);
    }
    .u-red,
    .u-red iron-icon {
      color: var(--negative-red-text-color);
    }
    .u-gray-background {
      background-color: var(--table-header-background-color);
    }
    .comma,
    .placeholder {
      color: var(--deemphasized-text-color);
    }
    .cell.label {
      font-weight: var(--font-weight-normal);
    }
    .cell.label iron-icon {
      vertical-align: top;
    }
    @media only screen and (max-width: 50em) {
      :host {
        display: flex;
      }
    }
  </style>
  <style include="gr-change-list-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <td aria-hidden="true" class="cell leftPadding"></td>
  <td class="cell star" hidden$="[[!showStar]]" hidden="">
    <gr-change-star change="{{change}}"></gr-change-star>
  </td>
  <td class="cell number" hidden$="[[!showNumber]]" hidden="">
    <a href$="[[changeURL]]">[[change._number]]</a>
  </td>
  <td
    class="cell subject"
    hidden$="[[isColumnHidden('Subject', visibleChangeTableColumns)]]"
  >
    <a
      title$="[[change.subject]]"
      href$="[[changeURL]]"
      on-click="_handleChangeClick"
    >
      <div class="container">
        <div class="content">[[change.subject]]</div>
        <div class="spacer">[[change.subject]]</div>
        <span>&nbsp;</span>
      </div>
    </a>
  </td>
  <td
    class="cell status"
    hidden$="[[isColumnHidden('Status', visibleChangeTableColumns)]]"
  >
    <template is="dom-repeat" items="[[statuses]]" as="status">
      <div class="comma">,</div>
      <gr-change-status flat="" status="[[status]]"></gr-change-status>
    </template>
    <template is="dom-if" if="[[!statuses.length]]">
      <span class="placeholder">--</span>
    </template>
  </td>
  <td
    class="cell owner"
    hidden$="[[isColumnHidden('Owner', visibleChangeTableColumns)]]"
  >
    <gr-account-link
      highlight-attention
      change="[[change]]"
      account="[[change.owner]]"
    ></gr-account-link>
  </td>
  <td
    class="cell assignee"
    hidden$="[[isColumnHidden('Assignee', visibleChangeTableColumns)]]"
  >
    <template is="dom-if" if="[[change.assignee]]">
      <gr-account-link
        id="assigneeAccountLink"
        account="[[change.assignee]]"
      ></gr-account-link>
    </template>
    <template is="dom-if" if="[[!change.assignee]]">
      <span class="placeholder">--</span>
    </template>
  </td>
  <td
    class="cell reviewers"
    hidden$="[[isColumnHidden('Reviewers', visibleChangeTableColumns)]]"
  >
    <div>
      <template
        is="dom-repeat"
        items="[[_computePrimaryReviewers(change)]]"
        as="reviewer"
        indexAs="index"
      >
        <gr-account-link
          hide-avatar=""
          hide-status=""
          first-name
          highlight-attention
          change="[[change]]"
          account="[[reviewer]]"
        ></gr-account-link
        ><span
          hidden$="[[_computeCommaHidden(index, change)]]"
          aria-hidden="true"
          >,
        </span>
      </template>
      <template is="dom-if" if="[[_computeAdditionalReviewersCount(change)]]">
        <span title="[[_computeAdditionalReviewersTitle(change, config)]]">
          +[[_computeAdditionalReviewersCount(change, config)]]
        </span>
      </template>
    </div>
  </td>
  <td
    class="cell comments"
    hidden$="[[isColumnHidden('Comments', visibleChangeTableColumns)]]"
  >
    <iron-icon
      hidden$="[[!change.unresolved_comment_count]]"
      icon="gr-icons:comment"
    ></iron-icon>
    <span>[[_computeComments(change.unresolved_comment_count)]]</span>
  </td>
  <td
    class="cell repo"
    hidden$="[[isColumnHidden('Repo', visibleChangeTableColumns)]]"
  >
    <a class="fullRepo" href$="[[_computeRepoUrl(change)]]">
      [[_computeRepoDisplay(change)]]
    </a>
    <a
      class="truncatedRepo"
      href$="[[_computeRepoUrl(change)]]"
      title$="[[_computeRepoDisplay(change)]]"
    >
      [[_computeRepoDisplay(change, 'true')]]
    </a>
  </td>
  <td
    class="cell branch"
    hidden$="[[isColumnHidden('Branch', visibleChangeTableColumns)]]"
  >
    <a href$="[[_computeRepoBranchURL(change)]]"> [[change.branch]] </a>
    <template is="dom-if" if="[[change.topic]]">
      (<a href$="[[_computeTopicURL(change)]]"
        ><!--
       --><gr-limited-text limit="50" text="[[change.topic]]"> </gr-limited-text
        ><!--
     --></a
      >)
    </template>
  </td>
  <td
    class="cell updated"
    hidden$="[[isColumnHidden('Updated', visibleChangeTableColumns)]]"
  >
    <gr-date-formatter
      has-tooltip=""
      date-str="[[change.updated]]"
    ></gr-date-formatter>
  </td>
  <td
    class="cell submitted"
    hidden$="[[isColumnHidden('Submitted', visibleChangeTableColumns)]]"
  >
    <gr-date-formatter
      has-tooltip=""
      date-str="[[change.submitted]]"
    ></gr-date-formatter>
  </td>
  <td
    class="cell waiting"
    hidden$="[[isColumnHidden('Waiting', visibleChangeTableColumns)]]"
  >
    <gr-date-formatter
      has-tooltip=""
      force-relative=""
      relative-option-no-ago=""
      date-str="[[_computeWaiting(account, change)]]"
    ></gr-date-formatter>
  </td>
  <td
    class="cell size"
    hidden$="[[isColumnHidden('Size', visibleChangeTableColumns)]]"
  >
    <gr-tooltip-content has-tooltip="" title="[[_computeSizeTooltip(change)]]">
      <template is="dom-if" if="[[_changeSize]]">
        <span>[[_changeSize]]</span>
      </template>
      <template is="dom-if" if="[[!_changeSize]]">
        <span class="placeholder">--</span>
      </template>
    </gr-tooltip-content>
  </td>
  <template is="dom-repeat" items="[[labelNames]]" as="labelName">
    <td
      title$="[[_computeLabelTitle(change, labelName)]]"
      class$="[[_computeLabelClass(change, labelName)]]"
    >
      <template is="dom-if" if="[[_computeHasLabelIcon(change, labelName)]]">
        <iron-icon icon="[[_computeLabelIcon(change, labelName)]]"></iron-icon>
      </template>
      <template is="dom-if" if="[[!_computeHasLabelIcon(change, labelName)]]">
        <span>[[_computeLabelValue(change, labelName)]]</span>
      </template>
    </td>
  </template>
  <template
    is="dom-repeat"
    items="[[_dynamicCellEndpoints]]"
    as="pluginEndpointName"
  >
    <td class="cell endpoint">
      <gr-endpoint-decorator name$="[[pluginEndpointName]]">
        <gr-endpoint-param name="change" value="[[change]]">
        </gr-endpoint-param>
      </gr-endpoint-decorator>
    </td>
  </template>
`;var Gb=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const zb=ye(e=>{class t extends e{constructor(){super(...arguments),this.columnNames=["Subject","Status","Owner","Assignee","Reviewers","Comments","Repo","Branch","Updated","Size"]}isColumnHidden(e,t){return!(!t||!e)&&!t.includes(e)}isColumnEnabled(e,t,i){return!t||!t.change||("Assignee"===e?!!t.change.enable_assignee:"Comments"===e?i.includes("comments-column"):"Reviewers"!==e||!!t.change.enable_attention_set)}getEnabledColumns(e,t,i){return e.filter(e=>this.isColumnEnabled(e,t,i))}renameProjectToRepoColumn(e){const t=e.indexOf("Project");if(-1===t)return e;const i=[...e];return i[t]="Repo",i}}return Gb([Oo({type:Array})],t.prototype,"columnNames",void 0),t});function Vb(e,t){if(e===Zi.COMMIT_MESSAGE)return-1;if(t===Zi.COMMIT_MESSAGE)return 1;if(e===Zi.MERGE_LIST)return-1;if(t===Zi.MERGE_LIST)return 1;const i=e.lastIndexOf("."),n=e.substr(i+1),o=e.substr(0,i)||e,r=t.lastIndexOf("."),s=t.substr(r+1),a=t.substr(0,r)||t,l=["h","hxx","hpp"];if(o.length>0&&o===a){if(l.includes(n)&&l.includes(s))return e.localeCompare(t);if(l.includes(n))return-1;if(l.includes(s))return 1}return o.localeCompare(a)||e.localeCompare(t)}function Wb(e,t){t&&Object.keys(t).forEach(t=>{o(e,t)||t===Zi.PATCHSET_LEVEL_COMMENTS||(e[t]={status:on.UNMODIFIED})})}function qb(e){return e===Zi.COMMIT_MESSAGE?"Commit message":e===Zi.MERGE_LIST?"Merge list":e}function Kb(e){return!!e&&(e===Zi.COMMIT_MESSAGE||e===Zi.MERGE_LIST)}function Yb(e){return Xb(qb(e))}function Xb(e,t=1){const i=e.split("/");if(i.length<=t)return e;const n=i.length-t;return`/${i.slice(n).join("/")}`}function Jb(e,t){return 0===e?"":`${e} ${t}`+(e>1?"s":"")}function Zb(e,t){return t?`"${e}"`:e}function Qb(e){return e.replace(/[^a-zA-Z]+/g,"")}var ew,tw,iw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e[e.XS=10]="XS",e[e.SMALL=50]="SMALL",e[e.MEDIUM=250]="MEDIUM",e[e.LARGE=1e3]="LARGE"}(ew||(ew={})),function(e){e.NOT_APPLICABLE="NOT_APPLICABLE",e.APPROVED="APPROVED",e.POSITIVE="POSITIVE",e.NEUTRAL="NEUTRAL",e.UNRESOLVED_COMMENTS="UNRESOLVED_COMMENTS",e.NEGATIVE="NEGATIVE",e.REJECTED="REJECTED"}(tw||(tw={}));let nw=class extends(zb(fi)){constructor(){super(...arguments),this.account=null,this.showStar=!1,this.showNumber=!1,this.reporting=i.reportingService}static get template(){return Ub}connectedCallback(){super.connectedCallback(),Qu().awaitPluginsLoaded().then(()=>{this._dynamicCellEndpoints=Gu().getDynamicEndpoints("change-list-item-cell")})}_changeStatuses(e){return e?So(e):[]}_computeChangeURL(e){return e?Qm.getUrlForChange(e):""}_computeLabelTitle(e,t){var i,n;const o=null===(i=null==e?void 0:e.labels)||void 0===i?void 0:i[t],r=this._computeLabelCategory(e,t);if(!o||r===tw.NOT_APPLICABLE)return"Label not applicable";const s=[];if(r===tw.UNRESOLVED_COMMENTS){const t=null!==(n=null==e?void 0:e.unresolved_comment_count)&&void 0!==n?n:0;s.push(Jb(t,"unresolved comment"))}const a=o.rejected||o.approved||o.disliked||o.recommended;return(null==a?void 0:a.name)&&s.push(`${t} by ${a.name}`),s.length>0?s.join(",\n"):t}_computeLabelClass(e,t){const i=["cell","label"];switch(this._computeLabelCategory(e,t)){case tw.NOT_APPLICABLE:i.push("u-gray-background");break;case tw.APPROVED:i.push("u-green");break;case tw.POSITIVE:i.push("u-monospace"),i.push("u-green");break;case tw.NEGATIVE:i.push("u-monospace"),i.push("u-red");break;case tw.REJECTED:i.push("u-red")}return i.sort().join(" ")}_computeHasLabelIcon(e,t){return""!==this._computeLabelIcon(e,t)}_computeLabelIcon(e,t){switch(this._computeLabelCategory(e,t)){case tw.APPROVED:return"gr-icons:check";case tw.UNRESOLVED_COMMENTS:return"gr-icons:comment";case tw.REJECTED:return"gr-icons:close";default:return""}}_computeLabelCategory(e,t){var i;const n=null===(i=null==e?void 0:e.labels)||void 0===i?void 0:i[t];return n?n.rejected?tw.REJECTED:n.value&&n.value<0?tw.NEGATIVE:(null==e?void 0:e.unresolved_comment_count)&&"Code-Review"===t?tw.UNRESOLVED_COMMENTS:n.approved?tw.APPROVED:n.value&&n.value>0?tw.POSITIVE:tw.NEUTRAL:tw.NOT_APPLICABLE}_computeLabelValue(e,t){var i;const n=null===(i=null==e?void 0:e.labels)||void 0===i?void 0:i[t];switch(this._computeLabelCategory(e,t)){case tw.NOT_APPLICABLE:return"";case tw.APPROVED:return"";case tw.POSITIVE:return`+${null==n?void 0:n.value}`;case tw.NEUTRAL:return"";case tw.UNRESOLVED_COMMENTS:return"u";case tw.NEGATIVE:return`${null==n?void 0:n.value}`;case tw.REJECTED:return""}}_computeRepoUrl(e){return e?Qm.getUrlForProjectChanges(e.project,!0,e.internalHost):""}_computeRepoBranchURL(e){return e?Qm.getUrlForBranch(e.branch,e.project,void 0,e.internalHost):""}_computeTopicURL(e){return(null==e?void 0:e.topic)?Qm.getUrlForTopic(e.topic,e.internalHost):""}_computeRepoDisplay(e,t){if(!(null==e?void 0:e.project))return"";let i="";return e.internalHost&&(i+=e.internalHost+"/"),i+=t?Xb(e.project,2):e.project,i}_computeSizeTooltip(e){return!e||e.insertions+e.deletions===0||isNaN(e.insertions+e.deletions)?"Size unknown":`added ${e.insertions}, removed ${e.deletions} lines`}_hasAttention(e){return!!(this.change&&this.change.attention_set&&e._account_id)&&o(this.change.attention_set,e._account_id)}_computeReviewers(e){if(!(null==e?void 0:e.reviewers)||!(null==e?void 0:e.reviewers.REVIEWER))return[];const t=[...e.reviewers.REVIEWER].filter(t=>!(e.owner&&e.owner._account_id===t._account_id||Pn(t)));return t.sort((e,t)=>{if(this.account){if(In(e,this.account))return-1;if(In(t,this.account))return 1}return this._hasAttention(e)&&!this._hasAttention(t)?-1:this._hasAttention(t)&&!this._hasAttention(e)?1:(e.name||"").localeCompare(t.name||"")}),t}_computePrimaryReviewers(e){return this._computeReviewers(e).slice(0,2)}_computeAdditionalReviewers(e){return this._computeReviewers(e).slice(2)}_computeAdditionalReviewersCount(e){return this._computeAdditionalReviewers(e).length}_computeAdditionalReviewersTitle(e,t){return e&&t?this._computeAdditionalReviewers(e).map(e=>yv(t,e,!0)).join(", "):""}_computeComments(e){return!e||e<1?"":`${e} unresolved`}_computeChangeSize(e){if(!e)return null;const t=e.insertions+e.deletions;return isNaN(t)||0===t?null:t<ew.XS?"XS":t<ew.SMALL?"S":t<ew.MEDIUM?"M":t<ew.LARGE?"L":"XL"}_computeWaiting(e,t){var i;if((null==e?void 0:e._account_id)&&(null==t?void 0:t.attention_set))return null===(i=null==t?void 0:t.attention_set[e._account_id])||void 0===i?void 0:i.last_update}toggleReviewed(){var e;if(!this.change)return;const t=!(null===(e=this.change)||void 0===e?void 0:e.reviewed);this.set("change.reviewed",t);const i={change:this.change,reviewed:t};this.dispatchEvent(new CustomEvent("toggle-reviewed",{bubbles:!0,composed:!0,detail:i}))}_handleChangeClick(){const e=this.account&&this.account._account_id||-1,t=this.change&&this.change.owner&&this.change.owner._account_id||-1;this.reporting.reportInteraction("change-row-clicked",{section:this.sectionName,isOwner:e===t})}_computeCommaHidden(e,t){if(void 0===e)return!1;if(void 0===t)return!1;const i=this._computeAdditionalReviewersCount(t);return e===this._computePrimaryReviewers(t).length-1&&0===i}};iw([Oo({type:Object})],nw.prototype,"account",void 0),iw([Oo({type:Array})],nw.prototype,"visibleChangeTableColumns",void 0),iw([Oo({type:Array})],nw.prototype,"labelNames",void 0),iw([Oo({type:Object})],nw.prototype,"change",void 0),iw([Oo({type:Object})],nw.prototype,"config",void 0),iw([Oo({type:String})],nw.prototype,"sectionName",void 0),iw([Oo({type:String,computed:"_computeChangeURL(change)"})],nw.prototype,"changeURL",void 0),iw([Oo({type:Array,computed:"_changeStatuses(change)"})],nw.prototype,"statuses",void 0),iw([Oo({type:Boolean})],nw.prototype,"showStar",void 0),iw([Oo({type:Boolean})],nw.prototype,"showNumber",void 0),iw([Oo({type:String,computed:"_computeChangeSize(change)"})],nw.prototype,"_changeSize",void 0),iw([Oo({type:Array})],nw.prototype,"_dynamicCellEndpoints",void 0),nw=iw([Po("gr-change-list-item")],nw);const ow=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-change-list-styles">
    #changeList {
      border-collapse: collapse;
      width: 100%;
    }
    .section-count-label {
      color: var(--deemphasized-text-color);
      font-family: var(--font-family);
      font-size: var(--font-size-small);
      font-weight: var(--font-weight-normal);
      line-height: var(--line-height-small);
    }
    a.section-title:hover {
      text-decoration: none;
    }
    a.section-title:hover .section-count-label {
      text-decoration: none;
    }
    a.section-title:hover .section-name {
      text-decoration: underline;
    }
  </style>
  <table id="changeList">
    <template
      is="dom-repeat"
      items="[[sections]]"
      as="changeSection"
      index-as="sectionIndex"
    >
      <template is="dom-if" if="[[changeSection.name]]">
        <tbody>
          <tr class="groupHeader">
            <td aria-hidden="true" class="leftPadding"></td>
            <td
              aria-hidden="true"
              class="star"
              hidden$="[[!showStar]]"
              hidden=""
            ></td>
            <td
              class="cell"
              colspan$="[[_computeColspan(changeSection, visibleChangeTableColumns, labelNames)]]"
            >
              <h2>
                <a
                  href$="[[_sectionHref(changeSection.query)]]"
                  class="section-title"
                >
                  <span class="section-name">[[changeSection.name]]</span>
                  <span class="section-count-label"
                    >[[changeSection.countLabel]]</span
                  >
                </a>
              </h2>
            </td>
          </tr>
        </tbody>
      </template>
      <tbody class="groupContent">
        <template is="dom-if" if="[[_isEmpty(changeSection)]]">
          <tr class="noChanges">
            <td aria-hidden="true" class="leftPadding"></td>
            <td
              aria-hidden="[[!showStar]]"
              class="star"
              hidden$="[[!showStar]]"
            ></td>
            <td
              class="cell"
              colspan$="[[_computeColspan(changeSection, visibleChangeTableColumns, labelNames)]]"
            >
              <template
                is="dom-if"
                if="[[_getSpecialEmptySlot(changeSection)]]"
              >
                <slot name="[[_getSpecialEmptySlot(changeSection)]]"></slot>
              </template>
              <template
                is="dom-if"
                if="[[!_getSpecialEmptySlot(changeSection)]]"
              >
                No changes
              </template>
            </td>
          </tr>
        </template>
        <template is="dom-if" if="[[!_isEmpty(changeSection)]]">
          <tr class="groupTitle">
            <td aria-hidden="true" class="leftPadding"></td>
            <td
              aria-label="Star status column"
              class="star"
              hidden$="[[!showStar]]"
              hidden=""
            ></td>
            <td class="number" hidden$="[[!showNumber]]" hidden="">#</td>
            <template
              is="dom-repeat"
              items="[[_computeColumns(changeSection, visibleChangeTableColumns)]]"
              as="item"
            >
              <td class$="[[_lowerCase(item)]]">[[item]]</td>
            </template>
            <template is="dom-repeat" items="[[labelNames]]" as="labelName">
              <td class="label" title$="[[labelName]]">
                [[_computeLabelShortcut(labelName)]]
              </td>
            </template>
            <template
              is="dom-repeat"
              items="[[_dynamicHeaderEndpoints]]"
              as="pluginHeader"
            >
              <td class="endpoint">
                <gr-endpoint-decorator name$="[[pluginHeader]]">
                </gr-endpoint-decorator>
              </td>
            </template>
          </tr>
        </template>
        <template is="dom-repeat" items="[[changeSection.results]]" as="change">
          <gr-change-list-item
            account="[[account]]"
            selected$="[[_computeItemSelected(sectionIndex, index, selectedIndex)]]"
            highlight$="[[_computeItemHighlight(account, change, _config, changeSection.name)]]"
            needs-review$="[[_computeItemNeedsReview(account, change, showReviewedState, _config)]]"
            change="[[change]]"
            config="[[_config]]"
            section-name="[[changeSection.name]]"
            visible-change-table-columns="[[_computeColumns(changeSection, visibleChangeTableColumns)]]"
            show-number="[[showNumber]]"
            show-star="[[showStar]]"
            tabindex$="[[_computeTabIndex(sectionIndex, index, selectedIndex, isCursorMoving)]]"
            label-names="[[labelNames]]"
            aria-label$="[[_computeAriaLabel(change, changeSection.name)]]"
          ></gr-change-list-item>
        </template>
      </tbody>
    </template>
  </table>
`;var rw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const sw=["MERGED","ABANDONED"];let aw=class extends(zb(Kf(fi))){constructor(){super(),this.account=void 0,this.sections=[],this.showStar=!1,this.showReviewedState=!1,this.keyEventTarget=document.body,this.isCursorMoving=!1,this.flagsService=i.flagsService,this.restApiService=i.restApiService,this.cursor=new J_,this.cursor.scrollMode=Xi.KEEP_VISIBLE,this.cursor.focusOnMove=!0,this.addEventListener("keydown",e=>this._scopedKeydownHandler(e))}static get template(){return ow}keyboardShortcuts(){return{[Hf.CURSOR_NEXT_CHANGE]:"_nextChange",[Hf.CURSOR_PREV_CHANGE]:"_prevChange",[Hf.NEXT_PAGE]:"_nextPage",[Hf.PREV_PAGE]:"_prevPage",[Hf.OPEN_CHANGE]:"_openChange",[Hf.TOGGLE_CHANGE_REVIEWED]:"_toggleChangeReviewed",[Hf.TOGGLE_CHANGE_STAR]:"_toggleChangeStar",[Hf.REFRESH_CHANGE_LIST]:"_refreshChangeList"}}ready(){super.ready(),this.restApiService.getConfig().then(e=>{this._config=e})}connectedCallback(){super.connectedCallback(),Qu().awaitPluginsLoaded().then(()=>{this._dynamicHeaderEndpoints=Gu().getDynamicEndpoints("change-list-header")})}disconnectedCallback(){this.cursor.unsetCursor(),super.disconnectedCallback()}_scopedKeydownHandler(e){13===e.keyCode&&this._openChange(e)}_lowerCase(e){return e.toLowerCase()}_computePreferences(e,t,i){if(i&&(this.changeTableColumns=this.columnNames,this.showNumber=!1,this.visibleChangeTableColumns=this.getEnabledColumns(this.columnNames,i,this.flagsService.enabledExperiments),e&&t&&(this.showNumber=!(!t||!t.legacycid_in_change_table),t.change_table&&t.change_table.length>0))){const e=this.renameProjectToRepoColumn(t.change_table);this.visibleChangeTableColumns=this.getEnabledColumns(e,i,this.flagsService.enabledExperiments)}}_computeColumns(e,t){if(!e||!t)return[];const i=[...t],n=i.indexOf("Updated");return e.name===Wm.name&&-1!==n&&(i[n]="Waiting"),e.name===qm.name&&-1!==n&&(i[n]="Submitted"),i}_computeColspan(e,t,i){const n=this._computeColumns(e,t);return n&&i?n.length+i.length+3:1}_computeLabelNames(e){if(!e)return[];let t=[];const i=function(e){return!t.includes(e)};for(const n of e)if(n.results)for(const e of n.results){if(!e.labels)continue;const n=Object.keys(e.labels);t=t.concat(n.filter(i))}return t.sort()}_computeLabelShortcut(e){return e.startsWith("Invalid-Prolog-Rules-Label-Name--")&&(e=e.slice("Invalid-Prolog-Rules-Label-Name--".length)),e.split("-").reduce((e,t)=>t?e+t[0].toUpperCase():e,"").slice(0,5)}_changesChanged(e){this.sections=e?[{results:e}]:[]}_processQuery(e){let t=e.split(" ");const i=["limit:","age:","-age:"];return t=t.filter(e=>!i.some(t=>e.startsWith(t))),t.join(" ")}_sectionHref(e){return Qm.getUrlForSearchQuery(this._processQuery(e))}_computeItemAbsoluteIndex(e,t){let i=0;for(let t=0;t<e;t++)i+=this.sections[t].results.length;return i+t}_computeItemSelected(e,t,i){return this._computeItemAbsoluteIndex(e,t)===i}_computeTabIndex(e,t,i,n){return n?0:this._computeItemSelected(e,t,i)?0:void 0}_computeItemNeedsReview(e,t,i,n){return!Sv(n)&&i&&!t.reviewed&&!t.work_in_progress&&bo(t)&&(!e||e._account_id!==t.owner._account_id)}_computeItemHighlight(e,t,i,n){var o;return!(!t||!e)&&(-1===sw.indexOf(t.status)&&(Sv(i)?Av(i,e,t)&&!Eo(t,e)&&n===Wm.name:e._account_id===(null===(o=t.assignee)||void 0===o?void 0:o._account_id)))}_nextChange(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.isCursorMoving=!0,this.cursor.next(),this.isCursorMoving=!1,this.selectedIndex=this.cursor.index)}_prevChange(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.isCursorMoving=!0,this.cursor.previous(),this.isCursorMoving=!1,this.selectedIndex=this.cursor.index)}_openChange(e){if(this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e))return;e.preventDefault();const t=this._changeForIndex(this.selectedIndex);t&&Qm.navigateToChange(t)}_nextPage(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)&&!this.isModifierPressed(e,Wf.SHIFT_KEY)||(e.preventDefault(),bi(this,"next-page"))}_prevPage(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)&&!this.isModifierPressed(e,Wf.SHIFT_KEY)||(e.preventDefault(),this.dispatchEvent(new CustomEvent("previous-page",{composed:!0,bubbles:!0})))}_toggleChangeReviewed(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._toggleReviewedForIndex(this.selectedIndex))}_toggleReviewedForIndex(e){const t=this._getListItems();void 0===e||e>=t.length||!t[e]||t[e].toggleReviewed()}_refreshChangeList(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this._reloadWindow())}_reloadWindow(){hu()}_toggleChangeStar(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._toggleStarForIndex(this.selectedIndex))}_toggleStarForIndex(e){var t;const i=this._getListItems();if(void 0===e||e>=i.length||!i[e])return;const n=i[e],o=null===(t=null==n?void 0:n.shadowRoot)||void 0===t?void 0:t.querySelector("gr-change-star");o&&o.toggleStar()}_changeForIndex(e){const t=this._getListItems();return void 0!==e&&e<t.length&&t[e]?t[e].change:null}_getListItems(){var e;const t=null===(e=this.root)||void 0===e?void 0:e.querySelectorAll("gr-change-list-item");return t?Array.from(t):[]}_sectionsChanged(){hh(this,()=>{this.cursor.stops=this._getListItems(),this.cursor.moveToStart(),this.selectedIndex&&this.cursor.setCursorAtIndex(this.selectedIndex)})}_getSpecialEmptySlot(e){return e.isOutgoing?"empty-outgoing":e.name===Wm.name?"empty-your-turn":""}_isEmpty(e){var t;return!(null===(t=e.results)||void 0===t?void 0:t.length)}_computeAriaLabel(e,t){return e?e.subject+(t?`, section: ${t}`:""):""}};rw([Oo({type:Object})],aw.prototype,"account",void 0),rw([Oo({type:Array,observer:"_changesChanged"})],aw.prototype,"changes",void 0),rw([Oo({type:Array})],aw.prototype,"sections",void 0),rw([Oo({type:Array,computed:"_computeLabelNames(sections)"})],aw.prototype,"labelNames",void 0),rw([Oo({type:Array})],aw.prototype,"_dynamicHeaderEndpoints",void 0),rw([Oo({type:Number,notify:!0})],aw.prototype,"selectedIndex",void 0),rw([Oo({type:Boolean})],aw.prototype,"showNumber",void 0),rw([Oo({type:Boolean})],aw.prototype,"showStar",void 0),rw([Oo({type:Boolean})],aw.prototype,"showReviewedState",void 0),rw([Oo({type:Object})],aw.prototype,"keyEventTarget",void 0),rw([Oo({type:Array})],aw.prototype,"changeTableColumns",void 0),rw([Oo({type:Array})],aw.prototype,"visibleChangeTableColumns",void 0),rw([Oo({type:Object})],aw.prototype,"preferences",void 0),rw([Oo({type:Boolean})],aw.prototype,"isCursorMoving",void 0),rw([Oo({type:Object})],aw.prototype,"_config",void 0),rw([No("account","preferences","_config")],aw.prototype,"_computePreferences",null),rw([No("sections.*")],aw.prototype,"_sectionsChanged",null),aw=rw([Po("gr-change-list")],aw);const lw=document.createElement("template");lw.innerHTML='<dom-module id="dashboard-header-styles">\n  <template>\n    <style>\n      :host {\n        background-color: var(--view-background-color);\n        display: block;\n        min-height: 9em;\n        width: 100%;\n      }\n      gr-avatar {\n        display: inline-block;\n        height: 7em;\n        left: 1em;\n        margin: 1em;\n        top: 1em;\n        width: 7em;\n      }\n      .info {\n        display: inline-block;\n        padding: var(--spacing-l);\n        vertical-align: top;\n      }\n      .info > div > span {\n        display: inline-block;\n        font-weight: var(--font-weight-bold);\n        text-align: right;\n        width: 4em;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(lw.content);const cw=mi`
  <style include="shared-styles">
    .browse {
      display: inline-block;
      font-weight: var(--font-weight-bold);
      text-align: right;
      width: 4em;
    }
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="dashboard-header-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="info">
    <h1 class="heading-1">[[repo]]</h1>
    <hr />
    <div><span>Detail:</span> <a href$="[[_repoUrl]]">Repo settings</a></div>
    <span is="dom-if" if="[[_webLinks]]">
      <div>
        <span class="browse">Browse:</span>
        <template is="dom-repeat" items="[[_webLinks]]" as="weblink">
          <a target="_blank" href$="[[weblink.url]]">[[weblink.name]]</a>
        </template>
      </div>
    </span>
  </div>
`;var dw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let hw=class extends fi{constructor(){super(...arguments),this._repoUrl=null,this._webLinks=[],this.restApiService=i.restApiService}static get template(){return cw}_repoChanged(e){e?(this._repoUrl=Qm.getUrlForRepo(e),this.restApiService.getRepo(e).then(e=>{(null==e?void 0:e.web_links)&&(this._webLinks=e.web_links)})):this._repoUrl=null}};dw([Oo({type:String,observer:"_repoChanged"})],hw.prototype,"repo",void 0),dw([Oo({type:String})],hw.prototype,"_repoUrl",void 0),dw([Oo({type:Array})],hw.prototype,"_webLinks",void 0),hw=dw([Po("gr-repo-header")],hw);const pw=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="dashboard-header-styles">
    .status.hide,
    .name.hide,
    .dashboardLink.hide {
      display: none;
    }
  </style>
  <gr-avatar
    account="[[_accountDetails]]"
    image-size="100"
    aria-label="Account avatar"
  ></gr-avatar>
  <div class="info">
    <h1 class="heading-1">[[_computeHeading(_accountDetails)]]</h1>
    <hr />
    <div class$="status [[_computeStatusClass(_status)]]">
      <span>Status:</span> [[_status]]
    </div>
    <div>
      <span>Email:</span>
      <a href="mailto:[[_computeDetail(_accountDetails, 'email')]]"
        ><!--
          -->[[_computeDetail(_accountDetails, 'email')]]</a
      >
    </div>
    <div>
      <span>Joined:</span>
      <gr-date-formatter
        date-str="[[_computeDetail(_accountDetails, 'registered_on')]]"
      >
      </gr-date-formatter>
    </div>
    <gr-endpoint-decorator name="user-header">
      <gr-endpoint-param name="accountDetails" value="[[_accountDetails]]">
      </gr-endpoint-param>
      <gr-endpoint-param name="loggedIn" value="[[loggedIn]]">
      </gr-endpoint-param>
    </gr-endpoint-decorator>
  </div>
  <div class="info">
    <div class$="[[_computeDashboardLinkClass(showDashboardLink, loggedIn)]]">
      <a href$="[[_computeDashboardUrl(_accountDetails)]]">View dashboard</a>
    </div>
  </div>
`;var uw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let gw=class extends fi{constructor(){super(...arguments),this.showDashboardLink=!1,this.loggedIn=!1,this._accountDetails=null,this._status="",this.restApiService=i.restApiService}static get template(){return pw}_accountChanged(e){if(!e)return this._accountDetails=null,void(this._status="");this.restApiService.getAccountDetails(e).then(e=>{var t;this._accountDetails=null!=e?e:null,this._status=null!==(t=null==e?void 0:e.status)&&void 0!==t?t:""})}_computeDetail(e,t){return e?e[t]:""}_computeHeading(e){return e?yv(void 0,e):""}_computeStatusClass(e){return e?"":"hide"}_computeDashboardUrl(e){if(!e)return null;const t=e._account_id;if(t)return Qm.getUrlForUserDashboard(String(t));const i=e.email;return i?Qm.getUrlForUserDashboard(i):null}_computeDashboardLinkClass(e,t){return e&&t?"dashboardLink":"dashboardLink hide"}};uw([Oo({type:String,observer:"_accountChanged"})],gw.prototype,"userId",void 0),uw([Oo({type:Boolean})],gw.prototype,"showDashboardLink",void 0),uw([Oo({type:Boolean})],gw.prototype,"loggedIn",void 0),uw([Oo({type:Object})],gw.prototype,"_accountDetails",void 0),uw([Oo({type:String})],gw.prototype,"_status",void 0),gw=uw([Po("gr-user-header")],gw);const mw=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    .loading {
      color: var(--deemphasized-text-color);
      padding: var(--spacing-l);
    }
    gr-change-list {
      width: 100%;
    }
    gr-user-header,
    gr-repo-header {
      border-bottom: 1px solid var(--border-color);
    }
    nav {
      align-items: center;
      display: flex;
      height: 3rem;
      justify-content: flex-end;
      margin-right: 20px;
    }
    nav,
    iron-icon {
      color: var(--deemphasized-text-color);
    }
    iron-icon {
      height: 1.85rem;
      margin-left: 16px;
      width: 1.85rem;
    }
    .hide {
      display: none;
    }
    @media only screen and (max-width: 50em) {
      .loading,
      .error {
        padding: 0 var(--spacing-l);
      }
    }
  </style>
  <div class="loading" hidden$="[[!_loading]]" hidden="">Loading...</div>
  <div hidden$="[[_loading]]" hidden="">
    <gr-repo-header
      repo="[[_repo]]"
      class$="[[_computeHeaderClass(_repo)]]"
    ></gr-repo-header>
    <gr-user-header
      user-id="[[_userId]]"
      show-dashboard-link=""
      logged-in="[[_loggedIn]]"
      class$="[[_computeHeaderClass(_userId)]]"
    ></gr-user-header>
    <gr-change-list
      account="[[account]]"
      changes="{{_changes}}"
      preferences="[[preferences]]"
      selected-index="{{viewState.selectedChangeIndex}}"
      show-star="[[_loggedIn]]"
      on-toggle-star="_handleToggleStar"
      on-toggle-reviewed="_handleToggleReviewed"
    ></gr-change-list>
    <nav class$="[[_computeNavClass(_loading)]]">
      Page [[_computePage(_offset, _changesPerPage)]]
      <a
        id="prevArrow"
        href$="[[_computeNavLink(_query, _offset, -1, _changesPerPage)]]"
        class$="[[_computePrevArrowClass(_offset)]]"
      >
        <iron-icon icon="gr-icons:chevron-left" aria-label="Older"> </iron-icon>
      </a>
      <a
        id="nextArrow"
        href$="[[_computeNavLink(_query, _offset, 1, _changesPerPage)]]"
        class$="[[_computeNextArrowClass(_changes)]]"
      >
        <iron-icon icon="gr-icons:chevron-right" aria-label="Newer">
        </iron-icon>
      </a>
    </nav>
  </div>
`;var fw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const _w=[/^\s*i?[0-9a-f]{7,40}\s*$/i,/^\s*[1-9][0-9]*\s*$/g,/[0-9a-f]{40}/],vw=/^owner:\s?("[^"]+"|[^ ]+)$/,yw=/^project:\s?("[^"]+"|[^ ]+)(\sstatus\s?:(open|"open"))?$/,bw=/\blimit:(\d+)/i;let ww=class extends fi{constructor(){super(),this.account=null,this.viewState={},this._query="",this._loading=!0,this._userId=null,this._repo=null,this.restApiService=i.restApiService,this.addEventListener("next-page",()=>this._handleNextPage()),this.addEventListener("previous-page",()=>this._handlePreviousPage())}static get template(){return mw}connectedCallback(){super.connectedCallback(),this._loadPreferences()}_paramsChanged(e){if(e.view!==bs.SEARCH)return;this._loading=!0,this._query=e.query;const t=Number(e.offset);this._offset=isNaN(t)?0:t,this.viewState.query===this._query&&this.viewState.offset===this._offset||(this.set("viewState.selectedChangeIndex",0),this.set("viewState.query",this._query),this.set("viewState.offset",this._offset)),setTimeout(()=>xi(this,this._query)),this.restApiService.getPreferences().then(e=>{if(!e)throw new Error("getPreferences returned undefined");return this._changesPerPage=e.changes_per_page,this._getChanges()}).then(e=>{if(e=e||[],this._query&&1===e.length)for(const t of _w)if(this._query.match(t))return void Qm.navigateToChange(e[0],void 0,void 0,void 0,!0);this._changes=e,this._loading=!1})}_loadPreferences(){return this.restApiService.getLoggedIn().then(e=>{e?this.restApiService.getPreferences().then(e=>{this.preferences=e}):this.preferences={}})}_getChanges(){return this.restApiService.getChanges(this._changesPerPage,this._query,this._offset)}_limitFor(e,t){const i=e.match(bw);return i?Number(i[1]):t}_computeNavLink(e,t,i,n){t=null!=t?t:0;const o=this._limitFor(e,n),r=Math.max(0,t+o*i);return Qm.getUrlForSearchQuery(e,r)}_computePrevArrowClass(e){return 0===e?"hide":""}_computeNextArrowClass(e){return(null==e?void 0:e.length)&&e[e.length-1]._more_changes?"":"hide"}_computeNavClass(e){return!e&&this._changes&&this._changes.length?"":"hide"}_handleNextPage(){!this.$.nextArrow.hidden&&this._changesPerPage&&$m.show(this._computeNavLink(this._query,this._offset,1,this._changesPerPage))}_handlePreviousPage(){!this.$.prevArrow.hidden&&this._changesPerPage&&$m.show(this._computeNavLink(this._query,this._offset,-1,this._changesPerPage))}_changesChanged(e){if(this._userId=null,this._repo=null,e&&e.length){if(vw.test(this._query)){const t=e[0].owner,i=t._account_id?t._account_id:t.email;if(i)return void(this._userId=i)}yw.test(this._query)&&(this._repo=e[0].project)}}_computeHeaderClass(e){return e?"":"hide"}_computePage(e,t){if(void 0!==e&&void 0!==t)return e/t+1}_computeLoggedIn(e){return!!(e&&Object.keys(e).length>0)}_handleToggleStar(e){this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred)}_handleToggleReviewed(e){this.restApiService.saveChangeReviewed(e.detail.change._number,e.detail.reviewed)}};fw([Oo({type:Object,observer:"_paramsChanged"})],ww.prototype,"params",void 0),fw([Oo({type:Boolean,computed:"_computeLoggedIn(account)"})],ww.prototype,"_loggedIn",void 0),fw([Oo({type:Object})],ww.prototype,"account",void 0),fw([Oo({type:Object,notify:!0})],ww.prototype,"viewState",void 0),fw([Oo({type:Object})],ww.prototype,"preferences",void 0),fw([Oo({type:Number})],ww.prototype,"_changesPerPage",void 0),fw([Oo({type:String})],ww.prototype,"_query",void 0),fw([Oo({type:Number})],ww.prototype,"_offset",void 0),fw([Oo({type:Array,observer:"_changesChanged"})],ww.prototype,"_changes",void 0),fw([Oo({type:Boolean})],ww.prototype,"_loading",void 0),fw([Oo({type:String})],ww.prototype,"_userId",void 0),fw([Oo({type:String})],ww.prototype,"_repo",void 0),ww=fw([Po("gr-change-list-view")],ww);const Cw=mi`
  <style include="shared-styles">
    ol {
      list-style: decimal;
      margin-left: var(--spacing-l);
    }
    p {
      margin-bottom: var(--spacing-m);
    }
    #commandsDialog {
      max-width: 40em;
    }
  </style>
  <gr-overlay id="commandsOverlay" with-backdrop="">
    <gr-dialog
      id="commandsDialog"
      confirm-label="Done"
      cancel-label=""
      confirm-on-enter=""
      on-confirm="_handleClose"
    >
      <div class="header" slot="header">Create change commands</div>
      <div class="main" slot="main">
        <ol>
          <li>
            <p>Make the changes to the files on your machine</p>
          </li>
          <li>
            <p>If you are making a new commit use</p>
            <gr-shell-command
              command="[[_createNewCommitCommand]]"
            ></gr-shell-command>
            <p>Or to amend an existing commit use</p>
            <gr-shell-command
              command="[[_amendExistingCommitCommand]]"
            ></gr-shell-command>
            <p>
              Please make sure you add a commit message as it becomes the
              description for your change.
            </p>
          </li>
          <li>
            <p>Push the change for code review</p>
            <gr-shell-command command="[[_pushCommand]]"></gr-shell-command>
          </li>
          <li>
            <p>
              Close this dialog and you should be able to see your recently
              created change in the 'Outgoing changes' section on the 'Your
              changes' page.
            </p>
          </li>
        </ol>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var Sw,Ew=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.CREATE="git commit",e.AMEND="git commit --amend",e.PUSH_PREFIX="git push origin HEAD:refs/for/"}(Sw||(Sw={}));let Aw=class extends fi{constructor(){super(...arguments),this._createNewCommitCommand=Sw.CREATE,this._amendExistingCommitCommand=Sw.AMEND}static get template(){return Cw}open(){this.$.commandsOverlay.open()}_handleClose(){this.$.commandsOverlay.close()}_computePushCommand(e){return Sw.PUSH_PREFIX+e}};Ew([Oo({type:String})],Aw.prototype,"branch",void 0),Ew([Oo({type:String})],Aw.prototype,"_createNewCommitCommand",void 0),Ew([Oo({type:String})],Aw.prototype,"_amendExistingCommitCommand",void 0),Ew([Oo({type:String,computed:"_computePushCommand(branch)"})],Aw.prototype,"_pushCommand",void 0),Aw=Ew([Po("gr-create-commands-dialog")],Aw);const xw=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    #graphic {
      display: inline-block;
      margin: var(--spacing-m);
      margin-left: 0;
    }
    #graphic #circle {
      align-items: center;
      background-color: var(--chip-background-color);
      border-radius: 50%;
      display: flex;
      height: 10em;
      justify-content: center;
      width: 10em;
    }
    #graphic iron-icon {
      color: var(--gray-foreground);
      height: 5em;
      width: 5em;
    }
    #graphic p {
      color: var(--deemphasized-text-color);
      text-align: center;
    }
    #help {
      display: inline-block;
      margin: var(--spacing-m);
      padding-top: var(--spacing-xl);
      vertical-align: top;
    }
    #help p {
      margin-bottom: var(--spacing-m);
      max-width: 35em;
    }
    @media only screen and (max-width: 50em) {
      #graphic {
        display: none;
      }
    }
  </style>
  <div id="graphic">
    <div id="circle">
      <iron-icon id="icon" icon="gr-icons:zeroState"></iron-icon>
    </div>
    <p>No outgoing changes yet</p>
  </div>
  <div id="help">
    <h2 class="heading-3">Push your first change for code review</h2>
    <p>
      Pushing a change for review is easy, but a little different from other git
      code review tools. Click on the \`Create Change' button and follow the
      step by step instructions.
    </p>
    <gr-button on-click="_handleCreateTap">Create Change</gr-button>
  </div>
`;let Rw=class extends fi{static get template(){return xw}_handleCreateTap(e){e.preventDefault(),bi(this,"create-tap")}};Rw=(window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s})([Po("gr-create-change-help")],Rw);const Tw=mi`
  <style include="shared-styles">
    :host {
      display: block;
      width: 12em;
    }
    #container {
      background: var(--chip-background-color);
      border-radius: 1em;
      padding: var(--spacing-m);
    }
    #header {
      color: var(--deemphasized-text-color);
      font-weight: var(--font-weight-bold);
      font-size: var(--font-size-small);
    }
    #body {
      display: flex;
    }
    #trigger {
      color: var(--deemphasized-text-color);
      cursor: pointer;
      padding-left: var(--spacing-s);
    }
    #trigger:hover {
      color: var(--primary-text-color);
    }
  </style>
  <div id="container">
    <div id="header">[[label]]</div>
    <div id="body">
      <gr-autocomplete
        id="autocomplete"
        threshold="0"
        query="[[query]]"
        disabled="[[disabled]]"
        placeholder="[[placeholder]]"
        borderless=""
      ></gr-autocomplete>
      <div id="trigger" on-click="_handleTriggerClick"></div>
    </div>
  </div>
`;var kw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Pw=class extends fi{constructor(){super(...arguments),this.query=()=>Promise.resolve([]),this.text=""}static get template(){return Tw}_handleTriggerClick(e){e.stopPropagation(),this.$.autocomplete.focus()}setText(e){this.$.autocomplete.setText(e)}clear(){this.setText("")}};kw([Oo({type:Object})],Pw.prototype,"query",void 0),kw([Oo({type:String,notify:!0})],Pw.prototype,"text",void 0),kw([Oo({type:String})],Pw.prototype,"label",void 0),kw([Oo({type:String})],Pw.prototype,"placeholder",void 0),kw([Oo({type:Boolean})],Pw.prototype,"disabled",void 0),Pw=kw([Po("gr-labeled-autocomplete")],Pw);const Iw=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    gr-labeled-autocomplete,
    iron-icon {
      display: inline-block;
    }
    iron-icon {
      margin-bottom: var(--spacing-l);
    }
  </style>
  <div>
    <gr-labeled-autocomplete
      id="repoInput"
      label="Repository"
      placeholder="Select repo"
      on-commit="_repoCommitted"
      query="[[_repoQuery]]"
    >
    </gr-labeled-autocomplete>
    <iron-icon icon="gr-icons:chevron-right"></iron-icon>
    <gr-labeled-autocomplete
      id="branchInput"
      label="Branch"
      placeholder="Select branch"
      disabled="[[_branchDisabled]]"
      on-commit="_branchCommitted"
      query="[[_query]]"
    >
    </gr-labeled-autocomplete>
  </div>
`;var Ow=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Nw=class extends fi{constructor(){super(),this.restApiService=i.restApiService,this._query=e=>this._getRepoBranchesSuggestions(e),this._repoQuery=e=>this._getRepoSuggestions(e)}static get template(){return Iw}connectedCallback(){super.connectedCallback(),this.repo&&this.$.repoInput.setText(this.repo)}ready(){super.ready(),this._branchDisabled=!this.repo}_getRepoBranchesSuggestions(e){return this.repo?(e.startsWith("refs/heads/")&&(e=e.substring("refs/heads/".length)),this.restApiService.getRepoBranches(e,this.repo,15).then(e=>this._branchResponseToSuggestions(e))):Promise.resolve([])}_getRepoSuggestions(e){return this.restApiService.getRepos(e,15).then(e=>this._repoResponseToSuggestions(e))}_repoResponseToSuggestions(e){return e?e.map(e=>({name:e.name,value:N(e.id)})):[]}_branchResponseToSuggestions(e){return e?e.map(e=>{let t;return t=e.ref.startsWith("refs/heads/")?e.ref.substring("refs/heads/".length):e.ref,{name:t,value:t}}):[]}_repoCommitted(e){this.repo=e.detail.value}_branchCommitted(e){this.branch=e.detail.value}_repoChanged(){this.$.branchInput.clear(),this._branchDisabled=!this.repo}};Ow([Oo({type:String,notify:!0,observer:"_repoChanged"})],Nw.prototype,"repo",void 0),Ow([Oo({type:String,notify:!0})],Nw.prototype,"branch",void 0),Ow([Oo({type:Boolean})],Nw.prototype,"_branchDisabled",void 0),Ow([Oo({type:Object})],Nw.prototype,"_query",void 0),Ow([Oo({type:Object})],Nw.prototype,"_repoQuery",void 0),Nw=Ow([Po("gr-repo-branch-picker")],Nw);const Lw=mi`
  <style include="shared-styles"></style>
  <gr-overlay id="createOverlay" with-backdrop="">
    <gr-dialog
      confirm-label="View commands"
      on-confirm="_pickerConfirm"
      on-cancel="_handleClose"
      disabled="[[!_repoAndBranchSelected]]"
    >
      <div class="header" slot="header">Create change</div>
      <div class="main" slot="main">
        <gr-repo-branch-picker
          repo="{{_repo}}"
          branch="{{_branch}}"
        ></gr-repo-branch-picker>
        <p>If you haven't done so, you will need to clone the repository.</p>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var Dw=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Mw=class extends fi{constructor(){super(...arguments),this._repoAndBranchSelected=!1}static get template(){return Lw}open(){this._repo="",this._branch="",this.$.createOverlay.open()}_handleClose(){this.$.createOverlay.close()}_pickerConfirm(e){this.$.createOverlay.close();const t={repo:this._repo,branch:this._branch};e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{detail:t,bubbles:!1}))}_computeRepoAndBranchSelected(e,t){return!(!e||!t)}};Dw([Oo({type:String})],Mw.prototype,"_repo",void 0),Dw([Oo({type:String})],Mw.prototype,"_branch",void 0),Dw([Oo({type:Boolean,computed:"_computeRepoAndBranchSelected(_repo, _branch)"})],Mw.prototype,"_repoAndBranchSelected",void 0),Mw=Dw([Po("gr-create-destination-dialog")],Mw);const Fw=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    .loading {
      color: var(--deemphasized-text-color);
      padding: var(--spacing-l);
    }
    gr-change-list {
      width: 100%;
    }
    gr-user-header {
      border-bottom: 1px solid var(--border-color);
    }
    .banner {
      align-items: center;
      background-color: var(--comment-background-color);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-xs) var(--spacing-l);
    }
    .banner gr-button {
      --gr-button: {
        color: var(--primary-text-color);
      }
    }
    .hide {
      display: none;
    }
    #emptyOutgoing {
      display: block;
    }
    @media only screen and (max-width: 50em) {
      .loading {
        padding: 0 var(--spacing-l);
      }
    }
  </style>
  <div class$="banner [[_computeBannerClass(_showDraftsBanner)]]">
    <div>
      You have draft comments on closed changes.
      <a href$="[[_computeDraftsLink(_showDraftsBanner)]]" target="_blank"
        >(view all)</a
      >
    </div>
    <div>
      <gr-button class="delete" link="" on-click="_handleOpenDeleteDialog"
        >Delete All</gr-button
      >
    </div>
  </div>
  <div class="loading" hidden$="[[!_loading]]">Loading...</div>
  <div hidden$="[[_loading]]" hidden="">
    <gr-user-header
      user-id="[[params.user]]"
      class$="[[_computeUserHeaderClass(params)]]"
    ></gr-user-header>
    <h1 class="assistive-tech-only">Dashboard</h1>
    <gr-change-list
      show-star=""
      show-reviewed-state=""
      account="[[account]]"
      preferences="[[preferences]]"
      selected-index="{{_selectedChangeIndex}}"
      sections="[[_results]]"
      on-toggle-star="_handleToggleStar"
      on-toggle-reviewed="_handleToggleReviewed"
    >
      <div id="emptyOutgoing" slot="empty-outgoing">
        <template is="dom-if" if="[[_showNewUserHelp]]">
          <gr-create-change-help
            on-create-tap="_handleCreateChangeTap"
          ></gr-create-change-help>
        </template>
        <template is="dom-if" if="[[!_showNewUserHelp]]"> No changes </template>
      </div>
      <div id="emptyYourTurn" slot="empty-your-turn">
        <span>No changes need your attention &nbsp;&#x1f389;</span>
      </div>
    </gr-change-list>
  </div>
  <gr-overlay id="confirmDeleteOverlay" with-backdrop="">
    <gr-dialog
      id="confirmDeleteDialog"
      confirm-label="Delete"
      on-confirm="_handleConfirmDelete"
      on-cancel="_closeConfirmDeleteOverlay"
    >
      <div class="header" slot="header">Delete comments</div>
      <div class="main" slot="main">
        Are you sure you want to delete all your draft comments in closed
        changes? This action cannot be undone.
      </div>
    </gr-dialog>
  </gr-overlay>
  <gr-create-destination-dialog
    id="destinationDialog"
    on-confirm="_handleDestinationConfirm"
  ></gr-create-destination-dialog>
  <gr-create-commands-dialog id="commandsDialog"></gr-create-commands-dialog>
`;var $w=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Bw=/\${project}/g;let jw=class extends fi{constructor(){super(),this.account=null,this._loading=!0,this._showDraftsBanner=!1,this._showNewUserHelp=!1,this.reporting=i.reportingService,this.restApiService=i.restApiService,this.lastVisibleTimestampMs=0}static get template(){return Fw}connectedCallback(){super.connectedCallback(),this._loadPreferences(),this.addEventListener("reload",e=>{e.stopPropagation(),this._reload(this.params)}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState?Date.now()-this.lastVisibleTimestampMs>1e4&&this._reload(this.params):this.lastVisibleTimestampMs=Date.now()})}_loadPreferences(){return this.restApiService.getLoggedIn().then(e=>{e?this.restApiService.getPreferences().then(e=>{this.preferences=e}):this.preferences={}})}_getProjectDashboard(e,t){return this.restApiService.getDashboard(e,t,e=>{Si(e)}).then(t=>{if(t)return{title:t.title,sections:t.sections.map(i=>{const n=t.foreach?" "+t.foreach:"";return{name:i.name,query:(i.query+n).replace(Bw,e)}})}})}_computeTitle(e){return e&&"self"!==e?"Dashboard for "+e:"My Reviews"}_isViewActive(e){return e.view===bs.DASHBOARD}_selectedChangeIndexChanged(e){if(this.params&&this._isViewActive(this.params)){if(!this.viewState)throw new Error("view state undefined");if(!this.params.user)throw new Error("user for dashboard is undefined");this.viewState[this.params.user]=e}}_paramsChanged(e){const t=e.base;return t&&this._isViewActive(t)&&t.user&&this.viewState&&(this._selectedChangeIndex=this.viewState[t.user]||0),this._reload(t)}_reload(e){if(!e||!this._isViewActive(e))return Promise.resolve();this._loading=!0;const{project:t,dashboard:i,title:n,user:o,sections:r}=e,s=t?this._getProjectDashboard(t,i):this.restApiService.getConfig().then(e=>Promise.resolve(Qm.getUserDashboard(o,r,n||this._computeTitle(o),e))),a=!t&&!!this.account&&"self"===o;return s.then(e=>(e&&e.title&&xi(this,e.title),this._fetchDashboardChanges(e,a))).then(()=>{this._maybeShowDraftsBanner(e),this.reporting.dashboardDisplayed()}).catch(e=>{xi(this,n||this._computeTitle(o)),console.warn(e)}).then(()=>{this._loading=!1})}_fetchDashboardChanges(e,t){if(!e)return Promise.resolve();let i;return window.PRELOADED_QUERIES&&window.PRELOADED_QUERIES.dashboardQuery?(i=window.PRELOADED_QUERIES.dashboardQuery,window.PRELOADED_QUERIES.dashboardQuery=void 0):(i=e.sections.map(e=>e.suffixForDashboard?e.query+" "+e.suffixForDashboard:e.query),t&&i.push("owner:self limit:1")),this.restApiService.getChanges(void 0,i).then(i=>{if(!i)throw new Error("getChanges returns undefined");if(t){const e=i.pop();this._showNewUserHelp=0===e.length}this._results=i.map((t,i)=>({name:e.sections[i].name,countLabel:this._computeSectionCountLabel(t),query:e.sections[i].query,results:this._maybeSortResults(e.sections[i].name,t),isOutgoing:e.sections[i].isOutgoing})).filter((t,i)=>i<e.sections.length&&(!e.sections[i].hideIfEmpty||t.results.length))})}_maybeSortResults(e,t){const i=this.account&&this.account._account_id,n=[...t];return e===Wm.name&&i&&n.sort((e,t)=>{const n=e.owner._account_id===i;if(n!==(t.owner._account_id===i))return n?1:-1;if(!e.attention_set||!e.attention_set[i])return 0;if(!t.attention_set||!t.attention_set[i])return 0;const o=e.attention_set[i].last_update,r=t.attention_set[i].last_update;return o&&r?Fi(o).valueOf()-Fi(r).valueOf():o?1:-1}),n}_computeSectionCountLabel(e){if(!e||!e.length||0===e.length)return"";const t=e[e.length-1]._more_changes;return`(${e.length}${t?" and more":""})`}_computeUserHeaderClass(e){return e&&e.view===bs.DASHBOARD&&!e.project&&e.user&&"self"!==e.user?"":"hide"}_handleToggleStar(e){var t;this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred),null===(t=this._results)||void 0===t||t.forEach((t,i)=>t.results.forEach((t,n)=>{t.id===e.detail.change.id&&this.set(`_results.${i}.results.${n}.starred`,e.detail.starred)}))}_handleToggleReviewed(e){var t;this.restApiService.saveChangeReviewed(e.detail.change._number,e.detail.reviewed),null===(t=this._results)||void 0===t||t.forEach((t,i)=>t.results.forEach((t,n)=>{t.id===e.detail.change.id&&this.set(`_results.${i}.results.${n}.reviewed`,e.detail.reviewed)}))}_maybeShowDraftsBanner(e){if(this._showDraftsBanner=!1,"self"!==e.user)return;if(!this._results)throw new Error("this._results must be set. restAPI returned undefined");const t=this._results.find(e=>"has:draft"===e.query);t&&t.results.length&&t.results.filter(e=>!bo(e)).length&&(this._showDraftsBanner=!0)}_computeBannerClass(e){return e?"":"hide"}_handleOpenDeleteDialog(){this.$.confirmDeleteOverlay.open()}_handleConfirmDelete(){return this.$.confirmDeleteDialog.disabled=!0,this.restApiService.deleteDraftComments("-is:open").then(()=>{this._closeConfirmDeleteOverlay(),this._reload(this.params)})}_closeConfirmDeleteOverlay(){this.$.confirmDeleteOverlay.close()}_computeDraftsLink(){return Qm.getUrlForSearchQuery("has:draft -is:open")}_handleCreateChangeTap(){this.$.destinationDialog.open()}_handleDestinationConfirm(e){this.$.commandsDialog.branch=e.detail.branch,this.$.commandsDialog.open()}};$w([Oo({type:Object})],jw.prototype,"account",void 0),$w([Oo({type:Object})],jw.prototype,"preferences",void 0),$w([Oo({type:Object})],jw.prototype,"viewState",void 0),$w([Oo({type:Object})],jw.prototype,"params",void 0),$w([Oo({type:Array})],jw.prototype,"_results",void 0),$w([Oo({type:Boolean})],jw.prototype,"_loading",void 0),$w([Oo({type:Boolean})],jw.prototype,"_showDraftsBanner",void 0),$w([Oo({type:Boolean})],jw.prototype,"_showNewUserHelp",void 0),$w([Oo({type:Number})],jw.prototype,"_selectedChangeIndex",void 0),$w([No("_selectedChangeIndex")],jw.prototype,"_selectedChangeIndexChanged",null),$w([No("params.*")],jw.prototype,"_paramsChanged",null),jw=$w([Po("gr-dashboard-view")],jw);const Hw=mi``;function Uw(e){return!!e&&!!e.robot_id}function Gw(e){return!!e&&!!e.__draft}function zw(e){return e.slice(0).sort((e,t)=>{var i,n;const o=!!e.__draft;if(o!==!!t.__draft)return o?1:-1;const r=e.updated&&Fi(e.updated)||e.__date,s=t.updated&&Fi(t.updated)||t.__date,a=r.valueOf()-s.valueOf();if(0!==a)return a;const l=null!==(i=e.id)&&void 0!==i?i:"",c=null!==(n=t.id)&&void 0!==n?n:"";return l.localeCompare(c)})}function Vw(e,t){var i;const n=zw(e),o=[],r={};for(const e of n){if(!e.id)continue;if(e.in_reply_to){const t=r[e.in_reply_to];if(t){t.comments.push(e),r[e.id]=t;continue}}if(!e.path)throw new Error('Comment missing required "path".');const n={comments:[e],patchNum:e.patch_set,commentSide:null!==(i=e.side)&&void 0!==i?i:fn.REVISION,mergeParentNum:e.parent,path:e.path,line:e.line,range:e.range,rootId:e.id};if(t)if(Qw(e,t))n.diffSide=zi.LEFT;else{if(!eC(e,t))throw new Error("comment does not belong in given patchrange");n.diffSide=zi.RIGHT}e.line||e.range||(n.line="FILE"),o.push(n),r[e.id]=n}return o}function Ww(e){const t=null==e?void 0:e.comments.length;return e&&t?e.comments[t-1]:void 0}function qw(e){var t;return null===(t=null==e?void 0:e.comments)||void 0===t?void 0:t[0]}function Kw(e){return!Yw(e)}function Yw(e){var t;return!(null===(t=Ww(e))||void 0===t?void 0:t.unresolved)}function Xw(e){return Gw(Ww(e))}function Jw(e){return Uw(qw(e))}function Zw(e){return function(e){var t,i;return null!==(i=null===(t=null==e?void 0:e.comments)||void 0===t?void 0:t.length)&&void 0!==i?i:0}(e)>1&&!Uw(Ww(e))}function Qw(e,t){return e.parent&&e.side===fn.PARENT?Gn(t.basePatchNum)&&e.parent===to(t.basePatchNum):"PARENT"===t.basePatchNum&&e.side===fn.PARENT&&e.patch_set===t.patchNum||"PARENT"!==t.basePatchNum&&e.side!==fn.PARENT&&e.patch_set===t.basePatchNum}function eC(e,t){return e.side!==fn.PARENT&&e.patch_set===t.patchNum}function tC(e,t){return Qw(e,t)||eC(e,t)}var iC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};class nC{constructor(e,t,i,n,o){this._comments=this._addPath(e),this._robotComments=this._addPath(t),this._drafts=this._addPath(i),this._portedComments=n||{},this._portedDrafts=o||{}}_addPath(e={}){const t={};for(const i of Object.keys(e)){const n=e[i]||[];n.length&&(t[i]=n.map(e=>({...e,path:i})))}return t}get drafts(){return this._drafts}findCommentById(e){if(!e)return;const t=t=>{let i;for(const n of Object.keys(t))i=i||t[n].find(t=>t.id===e);return i};return t(this._comments)||t(this._robotComments)||t(this._drafts)}getPaths(e){const t=[this._comments,this.drafts,this._robotComments],i={};for(const n of t)for(const[t,o]of Object.entries(n))o.some(t=>!e||tC(t,e))&&(i[t]=!0);return i}getAllPublishedComments(e){return this.getAllComments(!1,e)}getCommentsForThread(e){const t=this.getAllThreadsForChange().find(t=>t.rootId===e);return t?t.comments:null}getAllComments(e,t){const i=this.getPaths(),n={};for(const o of Object.keys(i))n[o]=this.getAllCommentsForPath(o,t,e);return n}getAllDrafts(e){const t=this.getPaths(),i={};for(const n of Object.keys(t))i[n]=this.getAllDraftsForPath(n,e);return i}getAllCommentsForPath(e,t,i){const n=this._comments[e]||[],o=this._robotComments[e]||[];let r=n.concat(o);if(i){const t=this.getAllDraftsForPath(e);r=r.concat(t)}return t&&(r=r.filter(e=>e.patch_set===t)),r.map(e=>({...e}))}getAllCommentsForFile(e,t){let i=this.getAllCommentsForPath(e.path,e.patchNum,t);return e.basePath&&(i=i.concat(this.getAllCommentsForPath(e.basePath,e.patchNum,t))),i}cloneWithUpdatedDrafts(e){return new nC(this._comments,this._robotComments,e,this._portedComments,this._portedDrafts)}cloneWithUpdatedPortedComments(e,t){return new nC(this._comments,this._robotComments,this._drafts,e,t)}getAllDraftsForPath(e,t){let i=this._drafts[e]||[];return t&&(i=i.filter(e=>e.patch_set===t)),i.map(e=>({...e,__draft:!0}))}getAllDraftsForFile(e){let t=this.getAllDraftsForPath(e.path,e.patchNum);return e.basePath&&(t=t.concat(this.getAllDraftsForPath(e.basePath,e.patchNum))),t}getCommentsForPath(e,t){let i=[],n=[],o=[];return this._comments&&this._comments[e]&&(i=this._comments[e]),this.drafts&&this.drafts[e]&&(n=this.drafts[e]),this._robotComments&&this._robotComments[e]&&(o=this._robotComments[e]),n.forEach(e=>{e.__draft=!0}),i.concat(n).concat(o).filter(e=>tC(e,t)).map(e=>({...e}))}_getPortedCommentThreads(e,t){const i=this._portedComments[e.path]||[];return i.push(...this._portedDrafts[e.path]||[]),e.basePath&&(i.push(...this._portedComments[e.basePath]||[]),i.push(...this._portedDrafts[e.basePath]||[])),i.length?Vw(this.getAllCommentsForFile(e,!0)).filter(e=>{const n=i.find(t=>e.comments.some(e=>t.id===e.id));if(!n)return!1;const o=e.comments.find(e=>e.id===n.id);if((o.line&&!n.line||o.range&&!n.range)&&(e.rangeInfoLost=!0),Qw(e.comments[0],t)||eC(e.comments[0],t))return!1;if(e.diffSide=zi.RIGHT,e.commentSide===fn.PARENT){if("PARENT"!==t.basePatchNum||e.mergeParentNum)return!1;e.diffSide=zi.LEFT}return!(!Kw(e)&&!Xw(e))&&(e.range=n.range,e.line=n.line,e.ported=!0,!0)}):[]}getThreadsBySideForFile(e,t){const i=Vw(this.getCommentsForFile(e,t),t);return i.push(...this._getPortedCommentThreads(e,t)),i}getCommentsForFile(e,t){const i=this.getCommentsForPath(e.path,t);return e.basePath&&i.push(...this.getCommentsForPath(e.basePath,t)),i}_commentObjToArray(e){return Object.keys(e).reduce((t,i)=>(e[i].forEach(e=>t.push({...e})),t),[])}computeCommentThreadCount(e,t){let i=[];i=ju(e)?this.getAllCommentsForFile(e):this._commentObjToArray(this.getAllPublishedComments(e.patchNum));let n=Vw(i);return t&&(n=n.filter(e=>!function(e){return(null==e?void 0:e.path)===Zi.PATCHSET_LEVEL_COMMENTS}(e))),n.length}computeDraftCount(e){if(e&&ju(e))return this.getAllDraftsForFile(e).length;const t=this.getAllDrafts(e&&e.patchNum);return this._commentObjToArray(t).length}computePortedDraftCount(e,t){return this.getThreadsBySideForFile({path:t},e).filter(e=>Xw(e)&&e.ported).length}computeCommentsString(e,t,i,n){if(!t)return"";if(!e)return"";const o=this.getThreadsBySideForFile({path:t},e),r=o.filter(e=>!Xw(e)).length,s=o.reduce((e,t)=>(Kw(t)&&(e+=1),e),0),a=Jb(r,"comment"),l=0===s?"":`${s} unresolved`,c=n&&"U"===(null==i?void 0:i.status)?"no changes":"";return a+(a&&l?" ":"")+(l?`(${l})`:"")+(c?`(${c})`:"")}computeUnresolvedNum(e){let t=[],i=[];return ju(e)?(t=this.getAllCommentsForFile(e),i=this.getAllDraftsForFile(e)):t=this._commentObjToArray(this.getAllPublishedComments(e.patchNum)),t=t.concat(i),Vw(t).filter(Kw).length}getAllThreadsForChange(){return Vw(this._commentObjToArray(this.getAllComments(!0)))}}nC.prototype.findCommentById,nC.prototype.getCommentsForPath;let oC=class extends fi{constructor(){super(...arguments),this.restApiService=i.restApiService}static get template(){return Hw}loadAll(e,t){const i=t||"current",n=[this.restApiService.getDiffComments(e),this.restApiService.getDiffRobotComments(e),this.restApiService.getDiffDrafts(e),this.restApiService.getPortedComments(e,i),this.restApiService.getPortedDrafts(e,i)];return Promise.all(n).then(([e,t,i,n,o])=>(this._changeComments=new nC(e,t,i,n,o),this._changeComments))}reloadDrafts(e){return this._changeComments?this.restApiService.getDiffDrafts(e).then(e=>(this._changeComments=this._changeComments.cloneWithUpdatedDrafts(e),this._changeComments)):this.loadAll(e)}reloadPortedComments(e,t){return this._changeComments?Promise.all([this.restApiService.getPortedComments(e,t),this.restApiService.getPortedDrafts(e,t)]).then(e=>{this._changeComments&&(this._changeComments=this._changeComments.cloneWithUpdatedPortedComments(e[0],e[1]))}):(this.loadAll(e),Promise.resolve())}};iC([Oo({type:Object})],oC.prototype,"_changeComments",void 0),oC=iC([Po("gr-comment-api")],oC);const rC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) iron-autogrow-textarea {
      opacity: 0.5;
    }
    .viewer {
      background-color: var(--view-background-color);
      border: 1px solid var(--view-background-color);
      border-radius: var(--border-radius);
      box-shadow: var(--elevation-level-1);
      padding: var(--spacing-m);
    }
    :host([collapsed]) .viewer,
    .viewer[collapsed] {
      max-height: var(--collapsed-max-height, 300px);
      overflow: hidden;
    }
    .editor iron-autogrow-textarea,
    .viewer {
      min-height: 100px;
    }
    .editor iron-autogrow-textarea {
      background-color: var(--view-background-color);
      width: 100%;
      display: block;

      /* You have to also repeat everything from shared-styles here, because
           you can only *replace* --iron-autogrow-textarea vars as a whole. */
      --iron-autogrow-textarea: {
        box-sizing: border-box;
        padding: var(--spacing-m);
        overflow-y: hidden;
        white-space: pre;
      }
    }
    .editButtons {
      display: flex;
      justify-content: space-between;
    }
    .show-all-container {
      background-color: var(--view-background-color);
      display: flex;
      justify-content: flex-end;
      border-top-width: 1px;
      border-top-style: solid;
      border-radius: 0 0 4px 4px;
      border-color: var(--border-color);
      box-shadow: var(--elevation-level-1);
      /* slightly up to cover rounded corner of the commit msg */
      margin-top: calc(-1 * var(--spacing-xs));
      /* To make this bar pop over editor, since editor has relative position. 
      */
      position: relative;
    }
    .show-all-container .show-all-button {
      margin-right: auto;
    }
    .show-all-container iron-icon {
      color: inherit;
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
    }
    .cancel-button {
      margin-right: var(--spacing-l);
    }
    .save-button {
      margin-right: var(--spacing-xs);
    }
    gr-button {
      font-family: var(--font-family);
      line-height: var(--line-height-normal);
      padding: var(--spacing-xs);
    }
  </style>
  <div
    class="viewer"
    hidden$="[[editing]]"
    collapsed$="[[_computeCommitMessageCollapsed(_commitCollapsed, commitCollapsible)]]"
  >
    <slot></slot>
  </div>
  <div class="editor" hidden$="[[!editing]]">
    <div>
      <iron-autogrow-textarea
        autocomplete="on"
        bind-value="{{_newContent}}"
        disabled="[[disabled]]"
      ></iron-autogrow-textarea>
    </div>
  </div>
  <div class="show-all-container" hidden$="[[_hideShowAllContainer]]">
    <gr-button
      link=""
      class="show-all-button"
      on-click="_toggleCommitCollapsed"
      hidden$="[[_hideShowAllButton]]"
      ><iron-icon
        icon="gr-icons:expand-more"
        hidden$="[[!_commitCollapsed]]"
      ></iron-icon
      ><iron-icon
        icon="gr-icons:expand-less"
        hidden$="[[_commitCollapsed]]"
      ></iron-icon>
      [[_computeCollapseText(_commitCollapsed)]]
    </gr-button>
    <gr-button
      link=""
      class="edit-commit-message"
      title="Edit commit message"
      on-click="_handleEditCommitMessage"
      hidden$="[[hideEditCommitMessage]]"
      ><iron-icon icon="gr-icons:edit"></iron-icon> Edit</gr-button
    >
    <div class="editButtons" hidden$="[[!editing]]">
      <gr-button
        link=""
        class="cancel-button"
        on-click="_handleCancel"
        disabled="[[disabled]]"
        >Cancel</gr-button
      >
      <gr-button
        class="save-button"
        primary=""
        on-click="_handleSave"
        disabled="[[_saveDisabled]]"
        >Save</gr-button
      >
    </div>
  </div>
`;var sC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let aC=class extends fi{constructor(){super(...arguments),this.disabled=!1,this.editing=!1,this._commitCollapsed=!0,this.commitCollapsible=!0,this._hideShowAllContainer=!1,this._hideShowAllButton=!1,this.storage=i.storageService,this.reporting=i.reportingService}static get template(){return rC}ready(){super.ready()}disconnectedCallback(){var e;null===(e=this.storeTask)||void 0===e||e.cancel(),super.disconnectedCallback()}_contentChanged(){this.editing=!1,this._newContent=""}focusTextarea(){this.shadowRoot.querySelector("iron-autogrow-textarea").textarea.focus()}_newContentChanged(e){if(!this.storageKey)return;const t=this.storageKey;this.storeTask=Cu(this.storeTask,()=>{e.length?this.storage.setEditableContentItem(t,e):this.storage.eraseEditableContentItem(t)},400)}_editingChanged(e){if(!e||this._newContent)return;let t;if(this.storageKey){const e=this.storage.getEditableContentItem(this.storageKey);(null==e?void 0:e.message)&&(t=e.message,Ci(this,"Content restored from a previous edit."))}t||(t=this.content||""),this._newContent=this.removeZeroWidthSpace?t.replace(/^R=\u200B/gm,"R="):t}_computeSaveDisabled(e,t,i){return e||!i||t===i}_handleSave(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("editable-content-save",{detail:{content:this._newContent},composed:!0,bubbles:!0}))}_handleCancel(e){e.preventDefault(),this.editing=!1,bi(this,"editable-content-cancel")}_computeCollapseText(e){return e?"Show all":"Show less"}_toggleCommitCollapsed(){this._commitCollapsed=!this._commitCollapsed,this.reporting.reportInteraction("toggle show all button",{sectionName:"Commit message",toState:this._commitCollapsed?"Show less":"Show all"}),this._commitCollapsed&&window.scrollTo(0,0)}_computeHideShowAllContainer(e,t,i){return!i&&(t&&e)}_computeHideShowAllButton(e,t){return!e||t}_computeCommitMessageCollapsed(e,t){return t&&e}_handleEditCommitMessage(){this.editing=!0,this.focusTextarea()}};sC([Oo({type:String,notify:!0,observer:"_contentChanged"})],aC.prototype,"content",void 0),sC([Oo({type:Boolean,reflectToAttribute:!0})],aC.prototype,"disabled",void 0),sC([Oo({type:Boolean,observer:"_editingChanged",notify:!0})],aC.prototype,"editing",void 0),sC([Oo({type:Boolean})],aC.prototype,"removeZeroWidthSpace",void 0),sC([Oo({type:String})],aC.prototype,"storageKey",void 0),sC([Oo({type:Boolean})],aC.prototype,"_commitCollapsed",void 0),sC([Oo({type:Boolean})],aC.prototype,"commitCollapsible",void 0),sC([Oo({type:Boolean,computed:"_computeHideShowAllContainer(hideEditCommitMessage, _hideShowAllButton, editing)"})],aC.prototype,"_hideShowAllContainer",void 0),sC([Oo({type:Boolean,computed:"_computeHideShowAllButton(commitCollapsible, editing)"})],aC.prototype,"_hideShowAllButton",void 0),sC([Oo({type:Boolean})],aC.prototype,"hideEditCommitMessage",void 0),sC([Oo({type:Boolean,computed:"_computeSaveDisabled(disabled, content, _newContent)"})],aC.prototype,"_saveDisabled",void 0),sC([Oo({type:String,observer:"_newContentChanged"})],aC.prototype,"_newContent",void 0),aC=sC([Po("gr-editable-content")],aC);const lC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([pre]) span {
      white-space: var(--linked-text-white-space, pre-wrap);
      word-wrap: var(--linked-text-word-wrap, break-word);
    }
    :host([disabled]) a {
      color: inherit;
      text-decoration: none;
      pointer-events: none;
    }
  </style>
  <span id="output"></span>
`;var cC,dC,hC,pC;window.linkify=(cC=new RegExp("(?:(?:mailto:)?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w)|\\b[a-z\\d.-]+://[^<>\\s]+|\\b(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:[;/][^#?<>\\s]*)?(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w))","ig"),dC=new RegExp("^[a-z\\d.-]+://","i"),hC={"'":"`",">":"<",")":"(","]":"[","}":"{","":"","":""},pC={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+'">'+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/},function(e,t){t=t||{};var i,n,o,r,s,a,l,c,d,h,p,u,g="",m=[];for(n in pC)void 0===t[n]&&(t[n]=pC[n]);for(;i=cC.exec(e);)if(o=i[0],l=(a=cC.lastIndex)-o.length,!/[\/:]/.test(e.charAt(l-1))){do{c=o,u=o.substr(-1),(p=hC[u])&&(d=o.match(new RegExp("\\"+p+"(?!$)","g")),h=o.match(new RegExp("\\"+u,"g")),(d?d.length:0)<(h?h.length:0)&&(o=o.substr(0,o.length-1),a--)),t.punct_regexp&&(o=o.replace(t.punct_regexp,(function(e){return a-=e.length,""})))}while(o.length&&o!==c);r=o,dC.test(r)||(r=(-1!==r.indexOf("@")?r.indexOf("mailto:")?"mailto:":"":r.indexOf("irc.")?r.indexOf("ftp.")?"http://":"ftp://":"irc://")+r),s!=l&&(m.push([e.slice(s,l)]),s=a),m.push([o,r])}for(m.push([e.substr(s)]),n=0;n<m.length;n++)g+=t.callback.apply(window,m[n]);return g||e});const uC=/^(.*)(https?:\/\/|mailto:)/;class gC{constructor(e,t,i){this.linkConfig=e,this.callback=t,this.removeZeroWidthSpace=i,this.baseUrl=k(),Object.preventExtensions(this)}addText(e,t){e&&this.callback(e,t)}processLinks(e,t){this.sortArrayReverse(t);const i=document.createDocumentFragment();let n=e.length;t.forEach(t=>{t.position+t.length!==n&&i.insertBefore(document.createTextNode(e.slice(t.position+t.length,n)),i.firstChild),i.insertBefore(t.html,i.firstChild),n=t.position}),0!==n&&i.insertBefore(document.createTextNode(e.slice(0,n)),i.firstChild),this.callback(null,null,i)}sortArrayReverse(e){e.sort((e,t)=>t.position-e.position)}addItem(e,t,i,n,o,r){if(t){const i=document.createElement("a");i.setAttribute("href",t),i.textContent=e,i.target="_blank",i.rel="noopener",r.push({html:i,position:n,length:o})}else if(i){const e=document.createDocumentFragment(),t=document.createElement("div");for(t.innerHTML=i;t.firstChild;)e.appendChild(t.firstChild);r.push({html:e,position:n,length:o})}}addLink(e,t,i,n,o){e&&!this.hasOverlap(i,n,o)&&(this.baseUrl&&t.startsWith("/")&&!t.startsWith(this.baseUrl)&&(t=this.baseUrl+t),this.addItem(e,t,null,i,n,o))}addHTML(e,t,i,n){this.hasOverlap(t,i,n)||(this.baseUrl&&e.match(/<a href="\//g)&&!new RegExp(`<a href="${this.baseUrl}`,"g").test(e)&&(e=e.replace(/<a href="\//g,`<a href="${this.baseUrl}/`)),this.addItem(null,null,e,t,i,n))}hasOverlap(e,t,i){const n=e+t;for(let t=0;t<i.length;t++){const o=i[t].position,r=i[t].position+i[t].length;if(e>=o&&e<r||n>o&&n<=r||e===o&&e===r)return!0}return!1}parse(e){e&&window.linkify(e,{callback:(e,t)=>this.parseChunk(e,t)})}parseChunk(e,t){if(this.removeZeroWidthSpace&&(e=e.replace(/^(CC|R)=\u200B/gm,"$1=")),t){const i=uC.exec(t);if(i){const n=i[1];return n.length>0&&(this.parseLinks(n,{}),e=e.substring(n.length),t=t.substring(n.length)),void this.addText(e,t)}}this.parseLinks(e,this.linkConfig)}parseLinks(e,t){const i=[];for(const[n,o]of Object.entries(t)){if(null!=o.enabled&&0==o.enabled)continue;const t=o.html,r=o.link;t?o.html=t.replace(/<a href="#\//g,'<a href="/'):r&&"#"===r[0]&&(o.link=r.substr(1));const s=new RegExp(o.match,"g");let a,l=e,c=0;for(;a=s.exec(l);){l=l.substr(a.index+a[0].length);let e=a[0].replace(s,o.html||o.link);if(o.html){let t;for(t=0;t<e.length&&e[t]===a[0][t];t++);e=e.slice(t),this.addHTML(e,c+a.index+t,a[0].length-t,i)}else{if(!o.link)throw Error("linkconfig entry "+n+" doesnt contain a link or html attribute.");this.addLink(a[0],e,c+a.index,a[0].length,i)}c=c+a.index+a[0].length}}this.processLinks(e,i)}}var mC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let fC=class extends fi{constructor(){super(...arguments),this.content=null,this.pre=!1,this.disabled=!1}static get template(){return lC}_contentChanged(e){this.config&&(this.$.output.textContent=e)}_contentOrConfigChanged(e,t){if(!t)return;if(!Qm.mapCommentlinks)return;t=Qm.mapCommentlinks(t);const i=this.$.output;i.textContent="",new gC(t,(e,t,i)=>this._handleParseResult(e,t,i),this.removeZeroWidthSpace).parse(e),i.querySelectorAll("a").forEach(e=>{e.hostname===window.location.hostname?e.removeAttribute("target"):e.setAttribute("target","_blank"),e.setAttribute("rel","noopener")})}_handleParseResult(e,t,i){const n=this.$.output;if(t){const i=document.createElement("a");i.setAttribute("href",t),i.textContent=e,i.target="_blank",i.setAttribute("rel","noopener"),n.appendChild(i)}else i&&n.appendChild(i)}};mC([Oo({type:Boolean})],fC.prototype,"removeZeroWidthSpace",void 0),mC([Oo({type:String})],fC.prototype,"content",void 0),mC([Oo({type:Boolean,reflectToAttribute:!0})],fC.prototype,"pre",void 0),mC([Oo({type:Boolean,reflectToAttribute:!0})],fC.prototype,"disabled",void 0),mC([Oo({type:Object})],fC.prototype,"config",void 0),mC([No("content")],fC.prototype,"_contentChanged",null),mC([No("content","config")],fC.prototype,"_contentOrConfigChanged",null),fC=mC([Po("gr-linked-text")],fC);const _C=mi`
  <style include="shared-styles">
    :host {
      display: inline-block;
    }
    .dropdown-trigger {
      text-decoration: none;
      width: 100%;
    }
    .dropdown-content {
      background-color: var(--dropdown-background-color);
      box-shadow: var(--elevation-level-2);
      min-width: 112px;
      max-width: 280px;
    }
    gr-button {
      vertical-align: top;
      @apply --gr-button;
    }
    gr-avatar {
      height: 2em;
      width: 2em;
      vertical-align: middle;
    }
    gr-button[link]:focus {
      outline: 5px auto -webkit-focus-ring-color;
    }
    ul {
      list-style: none;
    }
    .topContent,
    li {
      border-bottom: 1px solid var(--border-color);
    }
    li:last-of-type {
      border: none;
    }
    li .itemAction {
      cursor: pointer;
      display: block;
      padding: var(--spacing-m) var(--spacing-l);
    }
    li .itemAction {
      @apply --gr-dropdown-item;
    }
    li .itemAction.disabled {
      color: var(--deemphasized-text-color);
      cursor: default;
    }
    li .itemAction:link,
    li .itemAction:visited {
      text-decoration: none;
    }
    li .itemAction:not(.disabled):hover {
      background-color: var(--hover-background-color);
    }
    li:focus,
    li.selected {
      background-color: var(--selection-background-color);
      outline: none;
    }
    li:focus .itemAction,
    li.selected .itemAction {
      background-color: transparent;
    }
    .topContent {
      display: block;
      padding: var(--spacing-m) var(--spacing-l);
      @apply --gr-dropdown-item;
    }
    .bold-text {
      font-weight: var(--font-weight-bold);
    }
  </style>
  <gr-button
    link="[[link]]"
    class="dropdown-trigger"
    id="trigger"
    down-arrow="[[downArrow]]"
    on-click="_dropdownTriggerTapHandler"
  >
    <slot></slot>
  </gr-button>
  <iron-dropdown
    id="dropdown"
    vertical-align="top"
    vertical-offset="[[verticalOffset]]"
    allow-outside-scroll="true"
    horizontal-align="[[horizontalAlign]]"
    on-click="_handleDropdownClick"
    on-opened-changed="handleOpenedChanged"
  >
    <div class="dropdown-content" slot="dropdown-content">
      <ul>
        <template is="dom-if" if="[[topContent]]">
          <div class="topContent">
            <template
              is="dom-repeat"
              items="[[topContent]]"
              as="item"
              initial-count="75"
            >
              <div
                class$="[[_getClassIfBold(item.bold)]] top-item"
                tabindex="-1"
              >
                [[item.text]]
              </div>
            </template>
          </div>
        </template>
        <template
          is="dom-repeat"
          items="[[items]]"
          as="link"
          initial-count="75"
        >
          <li tabindex="-1">
            <gr-tooltip-content
              has-tooltip="[[_computeHasTooltip(link.tooltip)]]"
              title$="[[link.tooltip]]"
            >
              <span
                class$="itemAction [[_computeDisabledClass(link.id, disabledIds.*)]]"
                data-id$="[[link.id]]"
                on-click="_handleItemTap"
                hidden$="[[link.url]]"
                tabindex="-1"
                >[[link.name]]</span
              >
              <a
                class="itemAction"
                href$="[[_computeLinkURL(link)]]"
                download$="[[_computeIsDownload(link)]]"
                rel$="[[_computeLinkRel(link)]]"
                target$="[[link.target]]"
                hidden$="[[!link.url]]"
                tabindex="-1"
                >[[link.name]]</a
              >
            </gr-tooltip-content>
          </li>
        </template>
      </ul>
    </div>
  </iron-dropdown>
`;var vC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let yC=class extends(Kf(fi)){constructor(){super(),this.horizontalAlign="left",this.link=!1,this.verticalOffset=40,this.opened=!1,this.disabledIds=[],this.cursor=new J_,this.cursor.cursorTargetClass="selected",this.cursor.focusOnMove=!0}static get template(){return _C}get keyBindings(){return{down:"_handleDown","enter space":"_handleEnter",tab:"_handleTab",up:"_handleUp"}}disconnectedCallback(){this.cursor.unsetCursor(),super.disconnectedCallback()}_handleUp(e){this.$.dropdown.opened?(e.preventDefault(),e.stopPropagation(),this.cursor.previous()):this._open()}_handleDown(e){this.$.dropdown.opened?(e.preventDefault(),e.stopPropagation(),this.cursor.next()):this._open()}_handleTab(e){this.$.dropdown.opened&&(e.preventDefault(),e.stopPropagation())}_handleEnter(e){if(e.preventDefault(),e.stopPropagation(),this.$.dropdown.opened){if(null!==this.cursor.target){const e=this.cursor.target.querySelector(":not([hidden]) a");e&&e.click()}}else this._open()}_handleDropdownClick(){this._close()}handleOpenedChanged(e){this.opened=e.detail.value}_dropdownTriggerTapHandler(e){e.preventDefault(),e.stopPropagation(),this.$.dropdown.opened?this._close():this._open()}_open(){this.$.dropdown.open(),this._resetCursorStops(),this.cursor.setCursorAtIndex(0),null!==this.cursor.target&&this.cursor.target.focus()}_close(){setTimeout(()=>{this.$.dropdown.close()},1)}_getClassIfBold(e){return e?"bold-text":""}_computeURLHelper(e,t){return"//"+e+(t.startsWith(k())?"":k())+t}_computeRelativeURL(e){const t=window.location.host;return this._computeURLHelper(t,e)}_computeLinkURL(e){return void 0===e.url?"":e.target||!e.url.startsWith("/")?e.url:this._computeRelativeURL(e.url)}_computeLinkRel(e){return e.target?"noopener":e.external?"external":null}_handleItemTap(e){if(null===e.target||!this.items)return;const t=e.target.getAttribute("data-id"),i=this.items.find(e=>e.id===t);t&&!this.disabledIds.includes(t)&&(i&&this.dispatchEvent(new CustomEvent("tap-item",{detail:i,bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent("tap-item-"+t)))}_computeDisabledClass(e,t){return t.base.includes(e)?"disabled":""}_resetCursorStops(){this.items&&this.items.length>0&&this.$.dropdown.opened&&(yh(),this.cursor.stops=null!==this.root?Array.from(this.root.querySelectorAll("li")):[])}_computeHasTooltip(e){return!!e}_computeIsDownload(e){return!!e.download}};vC([Oo({type:Array})],yC.prototype,"items",void 0),vC([Oo({type:Boolean})],yC.prototype,"downArrow",void 0),vC([Oo({type:Array})],yC.prototype,"topContent",void 0),vC([Oo({type:String})],yC.prototype,"horizontalAlign",void 0),vC([Oo({type:Boolean})],yC.prototype,"link",void 0),vC([Oo({type:Number})],yC.prototype,"verticalOffset",void 0),vC([Oo({type:Boolean,notify:!0})],yC.prototype,"opened",void 0),vC([Oo({type:Array})],yC.prototype,"disabledIds",void 0),vC([No("items")],yC.prototype,"_resetCursorStops",null),yC=vC([Po("gr-dropdown")],yC);const bC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    label {
      cursor: pointer;
      display: block;
      width: 100%;
    }
    iron-autogrow-textarea {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      width: 73ch; /* Add a char to account for the border. */
    }
  </style>
  <gr-dialog
    confirm-label="Abandon"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Abandon Change</div>
    <div class="main" slot="main">
      <label for="messageInput">Abandon Message</label>
      <iron-autogrow-textarea
        id="messageInput"
        class="message"
        autocomplete="on"
        placeholder="<Insert reasoning here>"
        bind-value="{{message}}"
      ></iron-autogrow-textarea>
    </div>
  </gr-dialog>
`;var wC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let CC=class extends(Kf(fi)){static get template(){return bC}get keyBindings(){return{"ctrl+enter meta+enter":"_handleEnterKey"}}resetFocus(){this.$.messageInput.textarea.focus()}_handleEnterKey(){this._confirm()}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this._confirm()}_confirm(){this.dispatchEvent(new CustomEvent("confirm",{detail:{reason:this.message},composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}};wC([Oo({type:String})],CC.prototype,"message",void 0),CC=wC([Po("gr-confirm-abandon-dialog")],CC);const SC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    label {
      cursor: pointer;
    }
    .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    .main label,
    .main input[type='text'] {
      display: block;
      width: 100%;
    }
    iron-autogrow-textarea {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      width: 73ch; /* Add a char to account for the border. */
    }
    .cherryPickTopicLayout {
      display: flex;
      align-items: center;
      margin-bottom: var(--spacing-m);
    }
    .cherryPickSingleChange,
    .cherryPickTopic {
      margin-left: var(--spacing-m);
    }
    .cherry-pick-topic-message {
      margin-bottom: var(--spacing-m);
    }
    label[for='messageInput'],
    label[for='baseInput'] {
      margin-top: var(--spacing-m);
    }
    .title {
      font-weight: var(--font-weight-bold);
    }
    tr > td {
      padding: var(--spacing-m);
    }
    th {
      color: var(--deemphasized-text-color);
    }
    table {
      border-collapse: collapse;
    }
    tr {
      border-bottom: 1px solid var(--border-color);
    }
    .error {
      color: var(--error-text-color);
    }
    .error-message {
      color: var(--error-text-color);
      margin: var(--spacing-m) 0 var(--spacing-m) 0;
    }
  </style>
  <gr-dialog
    confirm-label="Cherry Pick"
    cancel-label="[[_computeCancelLabel(_statuses)]]"
    disabled$="[[_computeDisableCherryPick(_cherryPickType, _duplicateProjectChanges, _statuses, branch)]]"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header title" slot="header">
      Cherry Pick Change to Another Branch
    </div>
    <div class="main" slot="main">
      <template is="dom-if" if="[[_showCherryPickTopic]]">
        <div class="cherryPickTopicLayout">
          <input
            name="cherryPickOptions"
            type="radio"
            id="cherryPickSingleChange"
            on-change="_handlecherryPickSingleChangeClicked"
            checked=""
          />
          <label for="cherryPickSingleChange" class="cherryPickSingleChange">
            Cherry Pick single change
          </label>
        </div>
        <div class="cherryPickTopicLayout">
          <input
            name="cherryPickOptions"
            type="radio"
            id="cherryPickTopic"
            on-change="_handlecherryPickTopicClicked"
          />
          <label for="cherryPickTopic" class="cherryPickTopic">
            Cherry Pick entire topic ([[_changesCount]] Changes)
          </label>
        </div></template
      >

      <label for="branchInput"> Cherry Pick to branch </label>
      <gr-autocomplete
        id="branchInput"
        text="{{branch}}"
        query="[[_query]]"
        placeholder="Destination branch"
      >
      </gr-autocomplete>
      <template is="dom-if" if="[[_invalidBranch]]">
        <span class="error"> Branch name cannot contain space or commas. </span>
      </template>
      <template
        is="dom-if"
        if="[[_computeIfSinglecherryPick(_cherryPickType)]]"
      >
        <label for="baseInput">
          Provide base commit sha1 for cherry-pick
        </label>
        <iron-input
          maxlength="40"
          placeholder="(optional)"
          bind-value="{{baseCommit}}"
        >
          <input
            is="iron-input"
            id="baseCommitInput"
            maxlength="40"
            placeholder="(optional)"
            bind-value="{{baseCommit}}"
          />
        </iron-input>
        <label for="messageInput"> Cherry Pick Commit Message </label>
      </template>
      <template
        is="dom-if"
        if="[[_computeIfSinglecherryPick(_cherryPickType)]]"
      >
        <iron-autogrow-textarea
          id="messageInput"
          class="message"
          autocomplete="on"
          rows="4"
          max-rows="15"
          bind-value="{{message}}"
        ></iron-autogrow-textarea>
      </template>
      <template is="dom-if" if="[[_computeIfCherryPickTopic(_cherryPickType)]]">
        <span class="error-message"
          >[[_computeTopicErrorMessage(_duplicateProjectChanges)]]</span
        >
        <span class="cherry-pick-topic-message">
          Commit Message will be auto generated
        </span>
        <table>
          <thead>
            <tr>
              <th></th>
              <th>Change</th>
              <th>Status</th>
              <th>Subject</th>
              <th>Project</th>
              <th>Progress</th>
              <!-- Error Message -->
              <th></th>
            </tr>
          </thead>
          <tbody>
            <template is="dom-repeat" items="[[changes]]">
              <tr>
                <td>
                  <input
                    type="checkbox"
                    data-item$="[[item.id]]"
                    on-change="_toggleChangeSelected"
                    checked="[[_isChangeSelected(item.id)]]"
                  />
                </td>
                <td><span> [[_getChangeId(item)]] </span></td>
                <td><span> [[item.status]] </span></td>
                <td>
                  <span> [[_getTrimmedChangeSubject(item.subject)]] </span>
                </td>
                <td><span> [[item.project]] </span></td>
                <td>
                  <span class$="[[_computeStatusClass(item, _statuses)]]">
                    [[_computeStatus(item, _statuses)]]
                  </span>
                </td>
                <td>
                  <span class="error">
                    [[_computeError(item, _statuses)]]
                  </span>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </template>
    </div>
  </gr-dialog>
`;var EC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var AC,xC;!function(e){e[e.SINGLE_CHANGE=1]="SINGLE_CHANGE",e[e.TOPIC=2]="TOPIC"}(AC||(AC={})),function(e){e.RUNNING="RUNNING",e.FAILED="FAILED",e.NOT_STARTED="NOT STARTED",e.SUCCESSFUL="SUCCESSFUL"}(xC||(xC={}));let RC=class extends fi{constructor(){super(),this.changes=[],this._showCherryPickTopic=!1,this._cherryPickType=AC.SINGLE_CHANGE,this._duplicateProjectChanges=!1,this._invalidBranch=!1,this.selectedChangeIds=new Set,this.restApiService=i.restApiService,this._statuses={},this.reporting=i.reportingService,this._query=e=>this._getProjectBranchesSuggestions(e)}static get template(){return SC}updateChanges(e){this.changes=e,this._statuses={};const t={};this._duplicateProjectChanges=!1,e.forEach(e=>{this.selectedChangeIds.add(e.id),t[e.project]&&(this._duplicateProjectChanges=!0),t[e.project]=!0}),this._changesCount=e.length,this._showCherryPickTopic=e.length>1}_updateBranch(e){this._invalidBranch=!(!e||![","," "].some(t=>e.includes(t)))}_isChangeSelected(e){return this.selectedChangeIds.has(e)}_toggleChangeSelected(e){const t=Th(e).localTarget.dataset.item;this.selectedChangeIds.has(t)?this.selectedChangeIds.delete(t):this.selectedChangeIds.add(t)}_computeTopicErrorMessage(e){return e?"Two changes cannot be of the same project":""}updateStatus(e,t){this._statuses={...this._statuses,[e.id]:t}}_computeStatus(e,t){return e&&t&&t[e.id]?t[e.id].status:xC.NOT_STARTED}_computeStatusClass(e,t){return e&&t&&t[e.id]&&t[e.id].status===xC.FAILED?"error":""}_computeError(e,t){return e&&t&&t[e.id]&&t[e.id].status===xC.FAILED?t[e.id].msg:""}_getChangeId(e){return e.change_id.substring(0,10)}_getTrimmedChangeSubject(e){return e?e.length<50?e:e.substring(0,50)+"...":""}_computeCancelLabel(e){return Object.values(e).some(e=>e.status===xC.RUNNING)?"Close":"Cancel"}_computeDisableCherryPick(e,t,i,n){if(!n)return!0;return!(e!==AC.TOPIC||!t)||!!i&&Object.values(i).some(e=>e.status===xC.RUNNING)}_computeIfSinglecherryPick(e){return e===AC.SINGLE_CHANGE}_computeIfCherryPickTopic(e){return e===AC.TOPIC}_handlecherryPickSingleChangeClicked(){this._cherryPickType=AC.SINGLE_CHANGE,bi(this,"iron-resize")}_handlecherryPickTopicClicked(){this._cherryPickType=AC.TOPIC,bi(this,"iron-resize")}_computeMessage(e,t,i){if(void 0===e||void 0===t||void 0===i)return;let n=i;"MERGED"===e&&(n+="(cherry picked from commit "+t.toString()+")"),this.message=n}_generateRandomCherryPickTopic(e){const t=Math.random().toString(36).substr(2,10);return`cherrypick-${e.topic}-${t}`}_handleCherryPickFailed(e,t){t&&t.text().then(t=>{this.updateStatus(e,{status:xC.FAILED,msg:t})})}_handleCherryPickTopic(){var e;const t=this.changes.filter(e=>this.selectedChangeIds.has(e.id));if(!t.length){return void((null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".error-message")).innerHTML="No change selected")}const i=this._generateRandomCherryPickTopic(t[0]);t.forEach(e=>{this.updateStatus(e,{status:xC.RUNNING});const t={destination:this.branch,base:null,topic:i,allow_conflicts:!0,allow_empty:!0},n=e.revisions[e.current_revision]._number;this.restApiService.executeChangeAction(e._number,mn.POST,"/cherrypick",n,t,t=>{this._handleCherryPickFailed(e,t)}).then(()=>{this.updateStatus(e,{status:xC.SUCCESSFUL}),Object.values(this._statuses).find(e=>e.status!==xC.SUCCESSFUL)||Qm.navigateToSearchQuery(`topic: "${i}"`)})})}_handleConfirmTap(e){if(e.preventDefault(),e.stopPropagation(),this._cherryPickType===AC.TOPIC)return this.reporting.reportInteraction("cherry-pick-topic-clicked",{}),void this._handleCherryPickTopic();this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}resetFocus(){this.$.branchInput.focus()}_getProjectBranchesSuggestions(e){return this.project?(e.startsWith("refs/heads/")&&(e=e.substring("refs/heads/".length)),this.restApiService.getRepoBranches(e,this.project,15).then(e=>{if(!e)return[];const t=[];for(const i of e){let e;e=i.ref.startsWith("refs/heads/")?i.ref.substring("refs/heads/".length):i.ref,t.push({name:e})}return t})):(this.reporting.error(new Error("no project specified")),Promise.resolve([]))}};EC([Oo({type:String})],RC.prototype,"branch",void 0),EC([Oo({type:String})],RC.prototype,"baseCommit",void 0),EC([Oo({type:String})],RC.prototype,"changeStatus",void 0),EC([Oo({type:String})],RC.prototype,"commitMessage",void 0),EC([Oo({type:String})],RC.prototype,"commitNum",void 0),EC([Oo({type:String})],RC.prototype,"message",void 0),EC([Oo({type:String})],RC.prototype,"project",void 0),EC([Oo({type:Array})],RC.prototype,"changes",void 0),EC([Oo({type:Object})],RC.prototype,"_query",void 0),EC([Oo({type:Boolean})],RC.prototype,"_showCherryPickTopic",void 0),EC([Oo({type:Number})],RC.prototype,"_changesCount",void 0),EC([Oo({type:Number})],RC.prototype,"_cherryPickType",void 0),EC([Oo({type:Boolean})],RC.prototype,"_duplicateProjectChanges",void 0),EC([Oo({type:Object})],RC.prototype,"_statuses",void 0),EC([Oo({type:Boolean})],RC.prototype,"_invalidBranch",void 0),EC([Oo({type:Object})],RC.prototype,"reporting",void 0),EC([No("branch")],RC.prototype,"_updateBranch",null),EC([No("changeStatus","commitNum","commitMessage")],RC.prototype,"_computeMessage",null),RC=EC([Po("gr-confirm-cherrypick-dialog")],RC);const TC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
  </style>
  <gr-dialog
    confirm-label="Continue"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Cherry Pick Conflict!</div>
    <div class="main" slot="main">
      <span>Cherry Pick failed! (merge conflicts)</span>

      <span
        >Please select "Continue" to continue with conflicts or select "cancel"
        to close the dialog.</span
      >
    </div>
  </gr-dialog>
`;let kC=class extends fi{static get template(){return TC}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}};kC=(window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s})([Po("gr-confirm-cherrypick-conflict-dialog")],kC);const PC=mi`
  <style include="shared-styles">
    :host {
      display: block;
      width: 30em;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    label {
      cursor: pointer;
    }
    .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    .main label,
    .main input[type='text'] {
      display: block;
      width: 100%;
    }
    .main .message {
      width: 100%;
    }
    .warning {
      color: var(--error-text-color);
    }
  </style>
  <gr-dialog
    confirm-label="Move Change"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Move Change to Another Branch</div>
    <div class="main" slot="main">
      <p class="warning">
        Warning: moving a change will not change its parents.
      </p>
      <label for="branchInput"> Move change to branch </label>
      <gr-autocomplete
        id="branchInput"
        text="{{branch}}"
        query="[[_query]]"
        placeholder="Destination branch"
      >
      </gr-autocomplete>
      <label for="messageInput"> Move Change Message </label>
      <iron-autogrow-textarea
        id="messageInput"
        class="message"
        autocomplete="on"
        rows="4"
        max-rows="15"
        bind-value="{{message}}"
      ></iron-autogrow-textarea>
    </div>
  </gr-dialog>
`;var IC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let OC=class extends(Kf(fi)){constructor(){super(),this.restApiService=i.restApiService,this._query=e=>this._getProjectBranchesSuggestions(e)}static get template(){return PC}get keyBindings(){return{"ctrl+enter meta+enter":"_handleConfirmTap"}}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}_getProjectBranchesSuggestions(e){return this.project?(e.startsWith("refs/heads/")&&(e=e.substring("refs/heads/".length)),this.restApiService.getRepoBranches(e,this.project,15).then(e=>{const t=[];let i;return e&&e.forEach(e=>{i=e.ref.startsWith("refs/heads/")?e.ref.substring("refs/heads/".length):e.ref,t.push({name:i})}),t})):Promise.reject(new Error("Missing project"))}};IC([Oo({type:String})],OC.prototype,"branch",void 0),IC([Oo({type:String})],OC.prototype,"message",void 0),IC([Oo({type:String})],OC.prototype,"project",void 0),IC([Oo({type:Object})],OC.prototype,"_query",void 0),OC=IC([Po("gr-confirm-move-dialog")],OC);const NC=mi`
  <style include="shared-styles">
    :host {
      display: block;
      width: 30em;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    label {
      cursor: pointer;
    }
    .message {
      font-style: italic;
    }
    .parentRevisionContainer label,
    .parentRevisionContainer input[type='text'] {
      display: block;
      width: 100%;
    }
    .parentRevisionContainer label {
      margin-bottom: var(--spacing-xs);
    }
    .rebaseOption {
      margin: var(--spacing-m) 0;
    }
  </style>
  <gr-dialog
    id="confirmDialog"
    confirm-label="Rebase"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Confirm rebase</div>
    <div class="main" slot="main">
      <div
        id="rebaseOnParent"
        class="rebaseOption"
        hidden$="[[!_displayParentOption(rebaseOnCurrent, hasParent)]]"
      >
        <input
          id="rebaseOnParentInput"
          name="rebaseOptions"
          type="radio"
          on-click="_handleRebaseOnParent"
        />
        <label id="rebaseOnParentLabel" for="rebaseOnParentInput">
          Rebase on parent change
        </label>
      </div>
      <div
        id="parentUpToDateMsg"
        class="message"
        hidden$="[[!_displayParentUpToDateMsg(rebaseOnCurrent, hasParent)]]"
      >
        This change is up to date with its parent.
      </div>
      <div
        id="rebaseOnTip"
        class="rebaseOption"
        hidden$="[[!_displayTipOption(rebaseOnCurrent, hasParent)]]"
      >
        <input
          id="rebaseOnTipInput"
          name="rebaseOptions"
          type="radio"
          disabled$="[[!_displayTipOption(rebaseOnCurrent, hasParent)]]"
          on-click="_handleRebaseOnTip"
        />
        <label id="rebaseOnTipLabel" for="rebaseOnTipInput">
          Rebase on top of the [[branch]] branch<span hidden$="[[!hasParent]]">
            (breaks relation chain)
          </span>
        </label>
      </div>
      <div
        id="tipUpToDateMsg"
        class="message"
        hidden$="[[_displayTipOption(rebaseOnCurrent, hasParent)]]"
      >
        Change is up to date with the target branch already ([[branch]])
      </div>
      <div id="rebaseOnOther" class="rebaseOption">
        <input
          id="rebaseOnOtherInput"
          name="rebaseOptions"
          type="radio"
          on-click="_handleRebaseOnOther"
        />
        <label id="rebaseOnOtherLabel" for="rebaseOnOtherInput">
          Rebase on a specific change, ref, or commit
          <span hidden$="[[!hasParent]]"> (breaks relation chain) </span>
        </label>
      </div>
      <div class="parentRevisionContainer">
        <gr-autocomplete
          id="parentInput"
          query="[[_query]]"
          no-debounce=""
          text="{{_text}}"
          on-click="_handleEnterChangeNumberClick"
          allow-non-suggested-values=""
          placeholder="Change number, ref, or commit hash"
        >
        </gr-autocomplete>
      </div>
    </div>
  </gr-dialog>
`;var LC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let DC=class extends fi{constructor(){super(),this.restApiService=i.restApiService,this._query=e=>this._getChangeSuggestions(e)}static get template(){return NC}fetchRecentChanges(){return this.restApiService.getChanges(void 0,"is:open -age:90d").then(e=>{if(!e)return[];const t=[];for(const i of e)t.push({name:`${i._number}: ${i.subject}`,value:i._number});return this._recentChanges=t,this._recentChanges})}_getRecentChanges(){return this._recentChanges?Promise.resolve(this._recentChanges):this.fetchRecentChanges()}_getChangeSuggestions(e){return this._getRecentChanges().then(t=>this._filterChanges(e,t))}_filterChanges(e,t){return t.filter(t=>t.name.includes(e)&&t.value!==this.changeNumber).map(e=>({name:e.name,value:`${e.value}`}))}_displayParentOption(e,t){return t&&e}_displayParentUpToDateMsg(e,t){return t&&!e}_displayTipOption(e,t){return!(!e&&!t)}_getSelectedBase(){return this.$.rebaseOnParentInput.checked?null:this.$.rebaseOnTipInput.checked?"":this._text?this._text.split(":")[0]:""}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation();const t={base:this._getSelectedBase()};this.dispatchEvent(new CustomEvent("confirm",{detail:t})),this._text=""}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel")),this._text=""}_handleRebaseOnOther(){this.$.parentInput.focus()}_handleEnterChangeNumberClick(){this.$.rebaseOnOtherInput.checked=!0}_updateSelectedOption(e,t){void 0!==e&&void 0!==t&&(this._displayParentOption(e,t)?this.$.rebaseOnParentInput.checked=!0:this._displayTipOption(e,t)?this.$.rebaseOnTipInput.checked=!0:this.$.rebaseOnOtherInput.checked=!0)}};LC([Oo({type:String})],DC.prototype,"branch",void 0),LC([Oo({type:Number})],DC.prototype,"changeNumber",void 0),LC([Oo({type:Boolean})],DC.prototype,"hasParent",void 0),LC([Oo({type:Boolean})],DC.prototype,"rebaseOnCurrent",void 0),LC([Oo({type:String})],DC.prototype,"_text",void 0),LC([Oo({type:Object})],DC.prototype,"_query",void 0),LC([Oo({type:Array})],DC.prototype,"_recentChanges",void 0),LC([No("rebaseOnCurrent","hasParent")],DC.prototype,"_updateSelectedOption",null),DC=LC([Po("gr-confirm-rebase-dialog")],DC);const MC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    label {
      cursor: pointer;
      display: block;
      width: 100%;
    }
    .revertSubmissionLayout {
      display: flex;
    }
    .label {
      margin-left: var(--spacing-m);
      margin-bottom: var(--spacing-m);
    }
    iron-autogrow-textarea {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      width: 73ch; /* Add a char to account for the border. */
    }
    .error {
      color: var(--error-text-color);
      margin-bottom: var(--spacing-m);
    }
  </style>
  <gr-dialog
    confirm-label="Revert"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Revert Merged Change</div>
    <div class="main" slot="main">
      <div class="error" hidden$="[[!_showErrorMessage]]">
        <span> A reason is required </span>
      </div>
      <template is="dom-if" if="[[_showRevertSubmission]]">
        <div class="revertSubmissionLayout">
          <input
            name="revertOptions"
            type="radio"
            id="revertSingleChange"
            on-change="_handleRevertSingleChangeClicked"
            checked="[[_computeIfSingleRevert(_revertType)]]"
          />
          <label for="revertSingleChange" class="label revertSingleChange">
            Revert single change
          </label>
        </div>
        <div class="revertSubmissionLayout">
          <input
            name="revertOptions"
            type="radio"
            id="revertSubmission"
            on-change="_handleRevertSubmissionClicked"
            checked="[[_computeIfRevertSubmission(_revertType)]]"
          />
          <label for="revertSubmission" class="label revertSubmission">
            Revert entire submission ([[_changesCount]] Changes)
          </label>
        </div></template
      >
      <gr-endpoint-decorator name="confirm-revert-change">
        <label for="messageInput"> Revert Commit Message </label>
        <iron-autogrow-textarea
          id="messageInput"
          class="message"
          autocomplete="on"
          max-rows="15"
          bind-value="{{_message}}"
        ></iron-autogrow-textarea>
      </gr-endpoint-decorator>
    </div>
  </gr-dialog>
`;var FC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var $C;!function(e){e[e.REVERT_SINGLE_CHANGE=1]="REVERT_SINGLE_CHANGE",e[e.REVERT_SUBMISSION=2]="REVERT_SUBMISSION"}($C||($C={}));let BC=class extends fi{constructor(){super(...arguments),this._revertType=$C.REVERT_SINGLE_CHANGE,this._showRevertSubmission=!1,this._showErrorMessage=!1,this._originalRevertMessages=[],this._revertMessages=[],this.jsAPI=i.jsApiService}static get template(){return MC}_computeIfSingleRevert(e){return e===$C.REVERT_SINGLE_CHANGE}_computeIfRevertSubmission(e){return e===$C.REVERT_SUBMISSION}_modifyRevertMsg(e,t,i){return this.jsAPI.modifyRevertMsg(e,i,t)}populate(e,t,i){this._changesCount=i.length,this._populateRevertSingleChangeMessage(e,t,e.current_revision),this._populateRevertSubmissionMessage(e,i,t)}_populateRevertSingleChangeMessage(e,t,i){const n=`Revert "${(t||"").split("\n")[0]}"`;if(!i)return void Ci(this,"Unable to find the commit hash of this change.");const o=`${n}\n\n${`This reverts commit ${i}.`}\n\n`+"Reason for revert: <INSERT REASONING HERE>\n";this._message=this._modifyRevertMsg(e,t,o),this._revertType=$C.REVERT_SINGLE_CHANGE,this._showRevertSubmission=!1,this._revertMessages[this._revertType]=this._message,this._originalRevertMessages[this._revertType]=this._message}_getTrimmedChangeSubject(e){return e?e.length<50?e:e.substring(0,50)+"...":""}_modifyRevertSubmissionMsg(e,t,i){return this.jsAPI.modifyRevertSubmissionMsg(e,t,i)}_populateRevertSubmissionMessage(e,t,i){if(!e.current_revision)return void Ci(this,"Unable to find the commit hash of this change.");if(!t||t.length<=1)return;let n=`Revert submission ${e.submission_id}`+"\n\nReason for revert: <INSERT REASONING HERE>\n";n+="Reverted Changes:\n",t.forEach(e=>{n+=`${e.change_id.substring(0,10)}:`+`${this._getTrimmedChangeSubject(e.subject)}\n`}),this._message=this._modifyRevertSubmissionMsg(e,n,i),this._revertType=$C.REVERT_SUBMISSION,this._revertMessages[this._revertType]=this._message,this._originalRevertMessages[this._revertType]=this._message,this._showRevertSubmission=!0}_handleRevertSingleChangeClicked(){this._showErrorMessage=!1,this._message&&(this._revertMessages[$C.REVERT_SUBMISSION]=this._message),this._message=this._revertMessages[$C.REVERT_SINGLE_CHANGE],this._revertType=$C.REVERT_SINGLE_CHANGE}_handleRevertSubmissionClicked(){this._showErrorMessage=!1,this._revertType=$C.REVERT_SUBMISSION,this._message&&(this._revertMessages[$C.REVERT_SINGLE_CHANGE]=this._message),this._message=this._revertMessages[$C.REVERT_SUBMISSION]}_handleConfirmTap(e){if(e.preventDefault(),e.stopPropagation(),this._message===this._originalRevertMessages[this._revertType])return void(this._showErrorMessage=!0);const t={revertType:this._revertType,message:this._message};this.dispatchEvent(new CustomEvent("confirm",{detail:t,composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{detail:{revertType:this._revertType},composed:!0,bubbles:!1}))}};FC([Oo({type:String})],BC.prototype,"_message",void 0),FC([Oo({type:Number})],BC.prototype,"_revertType",void 0),FC([Oo({type:Boolean})],BC.prototype,"_showRevertSubmission",void 0),FC([Oo({type:Number})],BC.prototype,"_changesCount",void 0),FC([Oo({type:Boolean})],BC.prototype,"_showErrorMessage",void 0),FC([Oo({type:Array})],BC.prototype,"_originalRevertMessages",void 0),FC([Oo({type:Array})],BC.prototype,"_revertMessages",void 0),BC=FC([Po("gr-confirm-revert-dialog")],BC);const jC=mi`
  <!-- TODO(taoalpha): move all shared styles to a style module. -->
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    label {
      cursor: pointer;
      display: block;
      width: 100%;
    }
    iron-autogrow-textarea {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      width: 73ch; /* Add a char to account for the border. */
    }
  </style>
  <gr-dialog
    confirm-label="Revert Submission"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Revert Submission</div>
    <div class="main" slot="main">
      <label for="messageInput"> Revert Commit Message </label>
      <iron-autogrow-textarea
        id="messageInput"
        class="message"
        autocomplete="on"
        max-rows="15"
        bind-value="{{message}}"
      ></iron-autogrow-textarea>
    </div>
  </gr-dialog>
`;var HC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let UC=class extends fi{constructor(){super(...arguments),this.jsAPI=i.jsApiService}static get template(){return jC}_getTrimmedChangeSubject(e){return e?e.length<50?e:e.substring(0,50)+"...":""}_modifyRevertSubmissionMsg(e){return e&&this.message&&this.commitMessage?this.jsAPI.modifyRevertSubmissionMsg(e,this.message,this.commitMessage):this.message}_populateRevertSubmissionMessage(e,t){if(void 0===e)return;if(!e.current_revision)return void Ci(this,"Unable to find the commit hash of this change.");const i=`Revert submission ${e.submission_id}`;this.message=i+"\n\nReason for revert: <INSERT REASONING HERE>\n",(t=t||[]).length&&(this.message+="Reverted Changes:\n",t.forEach(e=>{this.message+=`${e.change_id.substring(0,10)}: `+`${this._getTrimmedChangeSubject(e.subject)}\n`})),this.message=this._modifyRevertSubmissionMsg(e)}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}};HC([Oo({type:String})],UC.prototype,"message",void 0),HC([Oo({type:String})],UC.prototype,"commitMessage",void 0),UC=HC([Po("gr-confirm-revert-submission-dialog")],UC);const GC=mi`
  <style>
    :host {
      display: block;
      font-family: var(--font-family);
    }
    p,
    ul,
    code,
    blockquote,
    gr-linked-text.pre {
      margin: 0 0 var(--spacing-m) 0;
    }
    p,
    ul,
    code,
    blockquote {
      max-width: var(--gr-formatted-text-prose-max-width, none);
    }
    :host(.noTrailingMargin) p:last-child,
    :host(.noTrailingMargin) ul:last-child,
    :host(.noTrailingMargin) blockquote:last-child,
    :host(.noTrailingMargin) gr-linked-text.pre:last-child {
      margin: 0;
    }
    code,
    blockquote {
      border-left: 1px solid #aaa;
      padding: 0 var(--spacing-m);
    }
    code {
      display: block;
      white-space: pre-wrap;
      color: var(--deemphasized-text-color);
    }
    li {
      list-style-type: disc;
      margin-left: var(--spacing-xl);
    }
    code,
    gr-linked-text.pre {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-code);
      /* usually 16px = 12px + 4px */
      line-height: calc(var(--font-size-code) + var(--spacing-s));
    }
  </style>
  <div id="container"></div>
`;var zC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const VC=/^(`{1,3})([^`]+?)\1$/;let WC=class extends fi{constructor(){super(...arguments),this.noTrailingMargin=!1}static get template(){return GC}static get observers(){return["_contentOrConfigChanged(content, config)"]}ready(){super.ready(),this.noTrailingMargin&&this.classList.add("noTrailingMargin")}_contentChanged(e){this.config||this._contentOrConfigChanged(e)}_contentOrConfigChanged(e){const t=this.$.container;for(;t.firstChild;)t.removeChild(t.firstChild);for(const i of this._computeNodes(this._computeBlocks(e)))i&&t.appendChild(i)}_computeBlocks(e){if(!e)return[];const t=[],i=e.replace(/[\s\n\r\t]+$/g,"").split("\n");for(let e=0;e<i.length;e++)if(i[e].length){if(this._isCodeMarkLine(i[e])){let n=e+1;for(;!this._isCodeMarkLine(i[n])&&n<i.length;)n++;if(this._isCodeMarkLine(i[n])){t.push({type:"code",text:i.slice(e+1,n).join("\n")}),e=n;continue}}if(this._isSingleLineCode(i[e])){const n=i[e].match(VC)[2];t.push({type:"code",text:n})}else if(this._isList(i[e])){let n=e+1;for(;this._isList(i[n]);)n++;t.push(this._makeList(i.slice(e,n))),e=n-1}else if(this._isQuote(i[e])){let n=e+1;for(;this._isQuote(i[n]);)n++;const o=i.slice(e,n).map(e=>e.replace(/^[ ]?>[ ]?/,""));t.push({type:"quote",blocks:this._computeBlocks(o.join("\n"))}),e=n-1}else if(this._isPreFormat(i[e])){let n=e+1;for(;this._isPreFormat(i[n])||this._isRegularLine(i[n])&&i[n].length;)n++;t.push({type:"pre",text:i.slice(e,n).join("\n")}),e=n-1}else{let n=e+1;for(;this._isRegularLine(i[n]);)n++;t.push({type:"paragraph",text:i.slice(e,n).join("\n")}),e=n-1}}return t}_makeList(e){const t=[];for(let i=0;i<e.length;i++){let n=e[i];n=n.substring(1).trim(),t.push(n)}return{type:"list",items:t}}_isRegularLine(e){return void 0!==e&&!(this._isQuote(e)||this._isCodeMarkLine(e)||this._isSingleLineCode(e)||this._isList(e)||this._isPreFormat(e))}_isQuote(e){return e&&(e.startsWith("> ")||e.startsWith(" > "))}_isCodeMarkLine(e){return e&&"```"===e.trim()}_isSingleLineCode(e){return e&&VC.test(e)}_isPreFormat(e){return e&&/^[ \t]/.test(e)}_isList(e){return e&&/^[-*] /.test(e)}_makeLinkedText(e="",t){const i=document.createElement("gr-linked-text");return i.config=this.config,i.content=e,i.pre=!0,t&&i.classList.add("pre"),i}_computeNodes(e){return e.map(e=>{if("paragraph"===e.type){const t=document.createElement("p");return t.appendChild(this._makeLinkedText(e.text)),t}if("quote"===e.type){const t=document.createElement("blockquote");for(const i of this._computeNodes(e.blocks||[]))i&&t.appendChild(i);return t}if("code"===e.type){const t=document.createElement("code");return t.textContent=e.text||"",t}if("pre"===e.type)return this._makeLinkedText(e.text,!0);if("list"===e.type){const t=document.createElement("ul"),i=e.items||[];for(const e of i){const i=document.createElement("li");i.appendChild(this._makeLinkedText(e)),t.appendChild(i)}return t}return console.warn("Unrecognized type."),document.createElement("span")})}};zC([Oo({type:String,observer:"_contentChanged"})],WC.prototype,"content",void 0),zC([Oo({type:Object})],WC.prototype,"config",void 0),zC([Oo({type:Boolean})],WC.prototype,"noTrailingMargin",void 0),WC=zC([Po("gr-formatted-text")],WC);const qC=mi`
  <style include="shared-styles">
    :host {
      display: flex;
      position: relative;
    }
    :host(.monospace) {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      font-weight: var(--font-weight-normal);
    }
    :host(.code) {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-code);
      /* usually 16px = 12px + 4px */
      line-height: calc(var(--font-size-code) + var(--spacing-s));
      font-weight: var(--font-weight-normal);
    }
    #emojiSuggestions {
      font-family: var(--font-family);
    }
    gr-autocomplete {
      display: inline-block;
    }
    #textarea {
      background-color: var(--view-background-color);
      width: 100%;
    }
    #hiddenText #emojiSuggestions {
      visibility: visible;
      white-space: normal;
    }
    iron-autogrow-textarea {
      position: relative;
    }
    #textarea.noBorder {
      border: none;
    }
    #hiddenText {
      display: block;
      float: left;
      position: absolute;
      visibility: hidden;
      width: 100%;
      white-space: pre-wrap;
    }
  </style>
  <div id="hiddenText"></div>
  <!-- When the autocomplete is open, the span is moved at the end of
      hiddenText in order to correctly position the dropdown. After being moved,
      it is set as the positionTarget for the emojiSuggestions dropdown. -->
  <span id="caratSpan"></span>
  <gr-autocomplete-dropdown
    vertical-align="top"
    horizontal-align="left"
    dynamic-align=""
    id="emojiSuggestions"
    suggestions="[[_suggestions]]"
    index="[[_index]]"
    vertical-offset="[[_verticalOffset]]"
    on-dropdown-closed="_resetEmojiDropdown"
    on-item-selected="_handleEmojiSelect"
  >
  </gr-autocomplete-dropdown>
  <iron-autogrow-textarea
    id="textarea"
    autocomplete="[[autocomplete]]"
    placeholder="[[placeholder]]"
    disabled="[[disabled]]"
    rows="[[rows]]"
    max-rows="[[maxRows]]"
    value="{{text}}"
    on-bind-value-changed="_onValueChanged"
  ></iron-autogrow-textarea>
`;var KC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const YC=[{value:"",match:"smile :)"},{value:"",match:"thumbs up"},{value:"",match:"laugh :D"},{value:"",match:"heart <3"},{value:"",match:"tears :')"},{value:"",match:"party"},{value:"",match:"cool |;)"},{value:"",match:"sad :("},{value:"",match:"neutral :|"},{value:"",match:"shock :O"},{value:"",match:"pray"},{value:"",match:"confused"},{value:"",match:"ok"},{value:"",match:"fire"},{value:"",match:"100"},{value:"",match:"check"},{value:"",match:"tongue"},{value:"",match:"crying :'("},{value:"",match:"glasses"},{value:"",match:"tear"},{value:"",match:"winking tongue ;)"}];let XC=class extends(Kf(fi)){constructor(){super(),this.hideBorder=!1,this.monospace=!1,this.code=!1,this._colonIndex=null,this._hideAutocomplete=!0,this._verticalOffset=20,this.disableEnterKeyForSelectingEmoji=!1,this.reporting=i.reportingService}static get template(){return qC}get keyBindings(){return{esc:"_handleEscKey",tab:"_handleEnterByKey",enter:"_handleEnterByKey",up:"_handleUpKey",down:"_handleDownKey"}}ready(){super.ready(),this.monospace&&this.classList.add("monospace"),this.code&&this.classList.add("code"),this.hideBorder&&this.$.textarea.classList.add("noBorder")}closeDropdown(){return this.$.emojiSuggestions.close()}getNativeTextarea(){return this.$.textarea.textarea}putCursorAtEnd(){const e=this.getNativeTextarea();e.selectionStart=e.value.length,e.selectionEnd=e.selectionStart,setTimeout(()=>{e.focus()})}_handleEscKey(e){this._hideAutocomplete||(e.preventDefault(),e.stopPropagation(),this._resetEmojiDropdown())}_handleUpKey(e){this._hideAutocomplete||(e.preventDefault(),e.stopPropagation(),this.$.emojiSuggestions.cursorUp(),this.$.textarea.textarea.focus(),this.disableEnterKeyForSelectingEmoji=!1)}_handleDownKey(e){this._hideAutocomplete||(e.preventDefault(),e.stopPropagation(),this.$.emojiSuggestions.cursorDown(),this.$.textarea.textarea.focus(),this.disableEnterKeyForSelectingEmoji=!1)}_handleEnterByKey(e){this._hideAutocomplete||this.disableEnterKeyForSelectingEmoji||(e.preventDefault(),e.stopPropagation(),this._setEmoji(this.$.emojiSuggestions.getCurrentText()))}_handleEmojiSelect(e){this._setEmoji(e.detail.selected.dataset.value)}_setEmoji(e){if(null===this._colonIndex)return;const t=this._colonIndex;this.text=this._getText(e),this.$.textarea.selectionStart=t+1,this.$.textarea.selectionEnd=t+1,this.reporting.reportInteraction("select-emoji",{type:e}),this._resetEmojiDropdown()}_getText(e){return this.text?this.text.substr(0,this._colonIndex||0)+e+this.text.substr(this.$.textarea.selectionStart):""}_updateCaratPosition(){this._hideAutocomplete=!1,"string"==typeof this.$.textarea.value&&(this.$.hiddenText.textContent=this.$.textarea.value.substr(0,this.$.textarea.selectionStart));const e=this.$.caratSpan;this.$.hiddenText.appendChild(e),this.$.emojiSuggestions.positionTarget=e,this._openEmojiDropdown()}_getFontSize(){const e=getComputedStyle(this).fontSize||"12px";return Number(e.substr(0,e.length-2))}_getScrollTop(){return document.body.scrollTop}_onValueChanged(e){if(this.dispatchEvent(new CustomEvent("bind-value-changed",{detail:e,composed:!0,bubbles:!0})),null===e.currentTarget||!e.currentTarget.focused)return;const t=e.detail&&e.detail.value?e.detail.value[this.$.textarea.selectionStart-1]:"";":"!==t&&null===this._colonIndex||(":"===t&&(this.$.textarea.selectionStart<2||" "===e.detail.value[this.$.textarea.selectionStart-2])&&(this._colonIndex=this.$.textarea.selectionStart-1),null!==this._colonIndex&&(this._currentSearchString=e.detail.value.substr(this._colonIndex+1,this.$.textarea.selectionStart-this._colonIndex-1),this.$.textarea.selectionStart===this._currentSearchString.length+this._colonIndex+1&&" "!==this._currentSearchString&&"\n"!==this._currentSearchString&&":"===e.detail.value[this._colonIndex]&&this._suggestions&&this._suggestions.length?this.$.emojiSuggestions.isHidden&&this._updateCaratPosition():this._resetEmojiDropdown(),this.$.textarea.textarea.focus()))}_openEmojiDropdown(){this.$.emojiSuggestions.open(),this.reporting.reportInteraction("open-emoji-dropdown")}_formatSuggestions(e){const t=[];for(const i of e)i.dataValue=i.value,i.text=i.value+" "+i.match,t.push(i);this.set("_suggestions",t)}_determineSuggestions(e){if(e.length){const t=YC.filter(t=>t.match.includes(e)).slice(0,10);this._formatSuggestions(t),this.disableEnterKeyForSelectingEmoji=!1}else this._formatSuggestions(YC),this.disableEnterKeyForSelectingEmoji=!0}_resetEmojiDropdown(){yh(),this._currentSearchString="",this._hideAutocomplete=!0,this.closeDropdown(),this._colonIndex=null,this.$.textarea.textarea.focus()}_handleTextChanged(e){this.dispatchEvent(new CustomEvent("value-changed",{detail:{value:e}}))}};KC([Oo({type:Boolean})],XC.prototype,"autocomplete",void 0),KC([Oo({type:Boolean})],XC.prototype,"disabled",void 0),KC([Oo({type:Number})],XC.prototype,"rows",void 0),KC([Oo({type:Number})],XC.prototype,"maxRows",void 0),KC([Oo({type:String})],XC.prototype,"placeholder",void 0),KC([Oo({type:String,notify:!0,observer:"_handleTextChanged"})],XC.prototype,"text",void 0),KC([Oo({type:Boolean})],XC.prototype,"hideBorder",void 0),KC([Oo({type:Boolean})],XC.prototype,"monospace",void 0),KC([Oo({type:Boolean})],XC.prototype,"code",void 0),KC([Oo({type:Number})],XC.prototype,"_colonIndex",void 0),KC([Oo({type:String,observer:"_determineSuggestions"})],XC.prototype,"_currentSearchString",void 0),KC([Oo({type:Boolean})],XC.prototype,"_hideAutocomplete",void 0),KC([Oo({type:Number})],XC.prototype,"_index",void 0),KC([Oo({type:Array})],XC.prototype,"_suggestions",void 0),KC([Oo({type:Number})],XC.prototype,"_verticalOffset",void 0),XC=KC([Po("gr-textarea")],XC);const JC=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.5;
      pointer-events: none;
    }
    .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    p {
      margin-bottom: var(--spacing-l);
    }
    label {
      cursor: pointer;
      display: block;
      width: 100%;
    }
    iron-autogrow-textarea {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      width: 73ch; /* Add a char to account for the border. */
    }
  </style>
  <gr-dialog
    confirm-label="Delete"
    on-confirm="_handleConfirmTap"
    on-cancel="_handleCancelTap"
  >
    <div class="header" slot="header">Delete Comment</div>
    <div class="main" slot="main">
      <p>
        This is an admin function. Please only use in exceptional circumstances.
      </p>
      <label for="messageInput">Enter comment delete reason</label>
      <iron-autogrow-textarea
        id="messageInput"
        class="message"
        autocomplete="on"
        placeholder="<Insert reasoning here>"
        bind-value="{{message}}"
      ></iron-autogrow-textarea>
    </div>
  </gr-dialog>
`;var ZC=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let QC=class extends fi{static get template(){return JC}static get is(){return"gr-confirm-delete-comment-dialog"}resetFocus(){this.$.messageInput.textarea.focus()}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{detail:{reason:this.message},composed:!0,bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1}))}};ZC([Oo({type:String})],QC.prototype,"message",void 0),QC=ZC([Po("gr-confirm-delete-comment-dialog")],QC);const eS=mi`
  <style include="shared-styles">
    :host {
      display: block;
      font-family: var(--font-family);
      padding: var(--spacing-m);
    }
    :host([collapsed]) {
      padding: var(--spacing-s) var(--spacing-m);
    }
    :host([disabled]) {
      pointer-events: none;
    }
    :host([disabled]) .actions,
    :host([disabled]) .robotActions,
    :host([disabled]) .date {
      opacity: 0.5;
    }
    :host([discarding]) {
      display: none;
    }
    .body {
      padding-top: var(--spacing-m);
    }
    .header {
      align-items: center;
      cursor: pointer;
      display: flex;
    }
    .headerLeft > span {
      font-weight: var(--font-weight-bold);
    }
    .headerMiddle {
      color: var(--deemphasized-text-color);
      flex: 1;
      overflow: hidden;
    }
    .draftLabel,
    .draftTooltip {
      color: var(--deemphasized-text-color);
      display: none;
    }
    .date {
      justify-content: flex-end;
      text-align: right;
      white-space: nowrap;
    }
    span.date {
      color: var(--deemphasized-text-color);
    }
    span.date:hover {
      text-decoration: underline;
    }
    .actions,
    .robotActions {
      display: flex;
      justify-content: flex-end;
      padding-top: 0;
    }
    .robotActions {
      /* Better than the negative margin would be to remove the gr-button
       * padding, but then we would also need to fix the buttons that are
       * inserted by plugins. :-/ */
      margin: 4px 0 -4px;
    }
    .action {
      margin-left: var(--spacing-l);
    }
    .rightActions {
      display: flex;
      justify-content: flex-end;
    }
    .rightActions gr-button {
      --gr-button: {
        height: 20px;
        padding: 0 var(--spacing-s);
      }
    }
    .editMessage {
      display: none;
      margin: var(--spacing-m) 0;
      width: 100%;
    }
    .container:not(.draft) .actions .hideOnPublished {
      display: none;
    }
    .draft .reply,
    .draft .quote,
    .draft .ack,
    .draft .done {
      display: none;
    }
    .draft .draftLabel,
    .draft .draftTooltip {
      display: inline;
    }
    .draft:not(.editing):not(.unableToSave) .save,
    .draft:not(.editing) .cancel {
      display: none;
    }
    .editing .message,
    .editing .reply,
    .editing .quote,
    .editing .ack,
    .editing .done,
    .editing .edit,
    .editing .discard,
    .editing .unresolved {
      display: none;
    }
    .editing .editMessage {
      display: block;
    }
    .show-hide {
      margin-left: var(--spacing-s);
    }
    .robotId {
      color: var(--deemphasized-text-color);
      margin-bottom: var(--spacing-m);
    }
    .robotRun {
      margin-left: var(--spacing-m);
    }
    .robotRunLink {
      margin-left: var(--spacing-m);
    }
    input.show-hide {
      display: none;
    }
    label.show-hide {
      cursor: pointer;
      display: block;
    }
    label.show-hide iron-icon {
      vertical-align: top;
    }
    #container .collapsedContent {
      display: none;
    }
    #container.collapsed .body {
      padding-top: 0;
    }
    #container.collapsed .collapsedContent {
      display: block;
      overflow: hidden;
      padding-left: var(--spacing-m);
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    #container.collapsed #deleteBtn,
    #container.collapsed .date,
    #container.collapsed .actions,
    #container.collapsed gr-formatted-text,
    #container.collapsed gr-textarea,
    #container.collapsed .respectfulReviewTip {
      display: none;
    }
    .resolve,
    .unresolved {
      align-items: center;
      display: flex;
      flex: 1;
      margin: 0;
    }
    .resolve label {
      color: var(--comment-text-color);
    }
    gr-dialog .main {
      display: flex;
      flex-direction: column;
      width: 100%;
    }
    #deleteBtn {
      display: none;
      --gr-button: {
        color: var(--deemphasized-text-color);
        padding: 0;
      }
    }
    #deleteBtn.showDeleteButtons {
      display: block;
    }

    /** Disable select for the caret and actions */
    .actions,
    .show-hide {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .respectfulReviewTip {
      justify-content: space-between;
      display: flex;
      padding: var(--spacing-m);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      margin-bottom: var(--spacing-m);
    }
    .respectfulReviewTip div {
      display: flex;
    }
    .respectfulReviewTip div iron-icon {
      margin-right: var(--spacing-s);
    }
    .respectfulReviewTip a {
      white-space: nowrap;
      margin-right: var(--spacing-s);
      padding-left: var(--spacing-m);
      text-decoration: none;
    }
    .pointer {
      cursor: pointer;
    }
    .patchset-text {
      color: var(--deemphasized-text-color);
      margin-left: var(--spacing-s);
    }
    .headerLeft gr-account-label {
      --gr-account-label-text-style: {
        font-weight: var(--font-weight-bold);
      }
      --account-max-length: 130px;
      width: 150px;
    }
    .draft gr-account-label {
      width: unset;
    }
    .portedMessage {
      margin: 0 var(--spacing-m);
    }
  </style>
  <div id="container" class="container">
    <div class="header" id="header" on-click="_handleToggleCollapsed">
      <div class="headerLeft">
        <template is="dom-if" if="[[comment.robot_id]]">
          <span class="robotName"> [[comment.robot_id]] </span>
        </template>
        <template is="dom-if" if="[[!comment.robot_id]]">
          <gr-account-label
            account="[[_getAuthor(comment, _selfAccount)]]"
            class$="[[_computeAccountLabelClass(draft)]]"
            hide-status=""
          >
          </gr-account-label>
        </template>
        <template is="dom-if" if="[[showPortedComment]]">
          <a href="[[_getUrlForComment(comment)]]"
            ><span class="portedMessage" on-click="_handlePortedMessageClick"
              >From patchset [[comment.patch_set]]</span
            ></a
          >
          <a
            href="https://bugs.chromium.org/p/gerrit/issues/entry?template=Porting+Comments"
            target="_blank"
          >
            <iron-icon icon="gr-icons:bug" title="report a problem"></iron-icon>
          </a>
        </template>
        <gr-tooltip-content
          class="draftTooltip"
          has-tooltip=""
          title="[[_computeDraftTooltip(_unableToSave)]]"
          max-width="20em"
          show-icon=""
        >
          <span class="draftLabel">[[_computeDraftText(_unableToSave)]]</span>
        </gr-tooltip-content>
      </div>
      <div class="headerMiddle">
        <span class="collapsedContent">[[comment.message]]</span>
      </div>
      <div
        hidden$="[[_computeHideRunDetails(comment, collapsed)]]"
        class="runIdMessage message"
      >
        <div class="runIdInformation">
          <a class="robotRunLink" href$="[[comment.url]]">
            <span class="robotRun link">Run Details</span>
          </a>
        </div>
      </div>
      <gr-button
        id="deleteBtn"
        title="Delete Comment"
        link=""
        class$="action delete [[_computeDeleteButtonClass(_isAdmin, draft)]]"
        hidden$="[[isRobotComment]]"
        on-click="_handleCommentDelete"
      >
        <iron-icon id="icon" icon="gr-icons:delete"></iron-icon>
      </gr-button>
      <template is="dom-if" if="[[showPatchset]]">
        <span class="patchset-text"> Patchset [[patchNum]]</span>
      </template>
      <span class="separator"></span>
      <template is="dom-if" if="[[comment.updated]]">
        <span class="date" tabindex="0" on-click="_handleAnchorClick">
          <gr-date-formatter
            has-tooltip=""
            date-str="[[comment.updated]]"
          ></gr-date-formatter>
        </span>
      </template>
      <div class="show-hide" tabindex="0">
        <label
          class="show-hide"
          aria-label="[[_computeShowHideAriaLabel(collapsed)]]"
        >
          <input
            type="checkbox"
            class="show-hide"
            checked$="[[collapsed]]"
            on-change="_handleToggleCollapsed"
          />
          <iron-icon id="icon" icon="[[_computeShowHideIcon(collapsed)]]">
          </iron-icon>
        </label>
      </div>
    </div>
    <div class="body">
      <template is="dom-if" if="[[isRobotComment]]">
        <div class="robotId" hidden$="[[collapsed]]">
          [[comment.author.name]]
        </div>
      </template>
      <template is="dom-if" if="[[editing]]">
        <gr-textarea
          id="editTextarea"
          class="editMessage"
          autocomplete="on"
          code=""
          disabled="{{disabled}}"
          rows="4"
          text="{{_messageText}}"
        ></gr-textarea>
        <template
          is="dom-if"
          if="[[_computeVisibilityOfTip(_showRespectfulTip, _respectfulTipDismissed)]]"
        >
          <div class="respectfulReviewTip">
            <div>
              <gr-tooltip-content
                has-tooltip=""
                title="Tips for respectful code reviews."
              >
                <iron-icon
                  class="pointer"
                  icon="gr-icons:lightbulb-outline"
                ></iron-icon>
              </gr-tooltip-content>
              [[_respectfulReviewTip]]
            </div>
            <div>
              <a
                tabindex="-1"
                on-click="_onRespectfulReadMoreClick"
                href="https://testing.googleblog.com/2019/11/code-health-respectful-reviews-useful.html"
                target="_blank"
              >
                Read more
              </a>
              <a
                tabindex="-1"
                class="close pointer"
                on-click="_dismissRespectfulTip"
                >Not helpful</a
              >
            </div>
          </div>
        </template>
      </template>
      <!--The message class is needed to ensure selectability from
        gr-diff-selection.-->
      <gr-formatted-text
        class="message"
        content="[[comment.message]]"
        no-trailing-margin="[[!comment.__draft]]"
        config="[[projectConfig.commentlinks]]"
      ></gr-formatted-text>
      <div class="actions humanActions" hidden$="[[!_showHumanActions]]">
        <div class="action resolve hideOnPublished">
          <label>
            <input
              type="checkbox"
              id="resolvedCheckbox"
              checked="[[resolved]]"
              on-change="_handleToggleResolved"
            />
            Resolved
          </label>
        </div>
        <template is="dom-if" if="[[draft]]">
          <div class="rightActions">
            <gr-button
              link=""
              class="action cancel hideOnPublished"
              on-click="_handleCancel"
              >Cancel</gr-button
            >
            <gr-button
              link=""
              class="action discard hideOnPublished"
              on-click="_handleDiscard"
              >Discard</gr-button
            >
            <gr-button
              link=""
              class="action edit hideOnPublished"
              on-click="_handleEdit"
              >Edit</gr-button
            >
            <gr-button
              link=""
              disabled$="[[_computeSaveDisabled(_messageText, comment, resolved)]]"
              class="action save hideOnPublished"
              on-click="_handleSave"
              >Save</gr-button
            >
          </div>
        </template>
      </div>
      <div class="robotActions" hidden$="[[!_showRobotActions]]">
        <template is="dom-if" if="[[isRobotComment]]">
          <gr-endpoint-decorator name="robot-comment-controls">
            <gr-endpoint-param name="comment" value="[[comment]]">
            </gr-endpoint-param>
          </gr-endpoint-decorator>
          <gr-button
            link=""
            secondary=""
            class="action show-fix"
            hidden$="[[_hasNoFix(comment)]]"
            on-click="_handleShowFix"
          >
            Show Fix
          </gr-button>
          <template is="dom-if" if="[[!_hasHumanReply]]">
            <gr-button
              link=""
              class="action fix"
              on-click="_handleFix"
              disabled="[[robotButtonDisabled]]"
            >
              Please Fix
            </gr-button>
          </template>
        </template>
      </div>
    </div>
  </div>
  <template is="dom-if" if="[[_enableOverlay]]">
    <gr-overlay id="confirmDeleteOverlay" with-backdrop="">
      <gr-confirm-delete-comment-dialog
        id="confirmDeleteComment"
        on-confirm="_handleConfirmDeleteComment"
        on-cancel="_handleCancelDeleteComment"
      >
      </gr-confirm-delete-comment-dialog>
    </gr-overlay>
    <gr-overlay id="confirmDiscardOverlay" with-backdrop="">
      <gr-dialog
        id="confirmDiscardDialog"
        confirm-label="Discard"
        confirm-on-enter=""
        on-confirm="_handleConfirmDiscard"
        on-cancel="_closeConfirmDiscardOverlay"
      >
        <div class="header" slot="header">Discard comment</div>
        <div class="main" slot="main">
          Are you sure you want to discard this draft comment?
        </div>
      </gr-dialog>
    </gr-overlay>
  </template>
`;var tS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const iS=["Assume competence.","Provide rationale or context.","Consider how comments may be interpreted.","Avoid harsh language.","Make your comments specific and actionable.","When disagreeing, explain the advantage of your approach."];let nS=class extends(Kf(fi)){constructor(){super(...arguments),this.isRobotComment=!1,this.disabled=!1,this.draft=!1,this.editing=!1,this.discarding=!1,this.collapsed=!0,this._isAdmin=!1,this._messageText="",this._numPendingDraftRequests={number:0},this._enableOverlay=!1,this._overlays={},this._showRespectfulTip=!1,this.showPatchset=!0,this._respectfulTipDismissed=!1,this._unableToSave=!1,this.showPortedComment=!1,this.restApiService=i.restApiService,this.storage=i.storageService,this.reporting=i.reportingService}static get template(){return eS}get keyBindings(){return{"ctrl+enter meta+enter ctrl+s meta+s":"_handleSaveKey",esc:"_handleEsc"}}connectedCallback(){super.connectedCallback(),this.restApiService.getAccount().then(e=>{this._selfAccount=e}),this.editing?this.collapsed=!1:this.comment&&(this.collapsed=!!this.comment.collapsed),this._getIsAdmin().then(e=>{this._isAdmin=!!e})}disconnectedCallback(){var e,t,i;null===(e=this.fireUpdateTask)||void 0===e||e.cancel(),null===(t=this.storeTask)||void 0===t||t.cancel(),null===(i=this.draftToastTask)||void 0===i||i.cancel(),this.textarea&&this.textarea.closeDropdown(),super.disconnectedCallback()}_getAuthor(e){return e.author||this._selfAccount}_getUrlForComment(e){if(!this.changeNum||!this.projectName)return"";if(!e.id)throw new Error("comment must have an id");return Qm.getUrlForComment(this.changeNum,this.projectName,e.id)}_handlePortedMessageClick(){a(this.comment,"comment"),this.reporting.reportInteraction("navigate-to-original-comment",{line:this.comment.line,range:this.comment.range})}_onEditingChange(e){if(this.dispatchEvent(new CustomEvent("comment-editing-changed",{detail:!!e,bubbles:!0,composed:!0})),!e)return;if(!this.storage.getRespectfulTipVisibility()){if(this.getRandomNum(0,3)>=1)return;this._showRespectfulTip=!0;const e=this.getRandomNum(0,iS.length);this._respectfulReviewTip=iS[e],this.reporting.reportInteraction("respectful-tip-appeared",{tip:this._respectfulReviewTip}),this.storage.setRespectfulTipVisibility()}}getRandomNum(e,t){return Math.floor(Math.random()*(t-e)+e)}_computeVisibilityOfTip(e,t){return e&&!t}_dismissRespectfulTip(){this._respectfulTipDismissed=!0,this.reporting.reportInteraction("respectful-tip-dismissed",{tip:this._respectfulReviewTip}),this.storage.setRespectfulTipVisibility(14)}_onRespectfulReadMoreClick(){this.reporting.reportInteraction("respectful-read-more-clicked")}get textarea(){var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#editTextarea")}get confirmDeleteOverlay(){var e;return this._overlays.confirmDelete||(this._enableOverlay=!0,yh(),this._overlays.confirmDelete=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#confirmDeleteOverlay")),this._overlays.confirmDelete}get confirmDiscardOverlay(){var e;return this._overlays.confirmDiscard||(this._enableOverlay=!0,yh(),this._overlays.confirmDiscard=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#confirmDiscardOverlay")),this._overlays.confirmDiscard}_computeShowHideIcon(e){return e?"gr-icons:expand-more":"gr-icons:expand-less"}_computeShowHideAriaLabel(e){return e?"Expand":"Collapse"}_calculateActionstoShow(e,t){[e,t].includes(void 0)||(this._showHumanActions=e&&!t,this._showRobotActions=e&&t)}_isRobotComment(e){this.isRobotComment=!!e.robot_id}isOnParent(){return"PARENT"===this.side}_getIsAdmin(){return this.restApiService.getIsAdmin()}_computeDraftTooltip(e){return e?"Unable to save draft. Please try to save again.":"This draft is only visible to you. To publish drafts, click the 'Reply'or 'Start review' button at the top of the change or press the 'A' key."}_computeDraftText(e){return"DRAFT"+(e?"(Failed to save)":"")}save(e){let t=e;return t||(t=this.comment),this.set("comment.message",this._messageText),this.editing=!1,this.disabled=!0,this._messageText?(this._xhrPromise=this._saveDraft(t).then(e=>{if(this.disabled=!1,e.ok)return this._eraseDraftComment(),this.restApiService.getResponseObject(e).then(e=>{var t;const i=e;if(!Gw(this.comment))throw new Error("Can only save drafts.");return i.__draft=!0,(null===(t=this.comment)||void 0===t?void 0:t.__draftID)&&(i.__draftID=this.comment.__draftID),this.comment=i,this._fireSave(),e})}).catch(e=>{throw this.disabled=!1,e}),this._xhrPromise):this._discardDraft()}_eraseDraftComment(){var e,t;null===(e=this.storeTask)||void 0===e||e.cancel(),a(null===(t=this.comment)||void 0===t?void 0:t.path,"comment.path"),a(this.changeNum,"changeNum"),this.storage.eraseDraftComment({changeNum:this.changeNum,patchNum:this._getPatchNum(),path:this.comment.path,line:this.comment.line,range:this.comment.range})}_commentChanged(e){this.editing=Gw(e)&&!!e.__editing,this.resolved=!e.unresolved,this.editing&&this._fireUpdate()}_computeHasHumanReply(){const e=this.comment;e&&this.comments&&(this._hasHumanReply=this.comments.some(t=>t.in_reply_to&&t.in_reply_to===e.id&&!t.robot_id))}_getEventPayload(){return{comment:this.comment,patchNum:this.patchNum}}_fireSave(){this.dispatchEvent(new CustomEvent("comment-save",{detail:this._getEventPayload(),composed:!0,bubbles:!0}))}_fireUpdate(){this.fireUpdateTask=Cu(this.fireUpdateTask,()=>{this.dispatchEvent(new CustomEvent("comment-update",{detail:this._getEventPayload(),composed:!0,bubbles:!0}))})}_computeAccountLabelClass(e){return e?"draft":""}_draftChanged(e){this.$.container.classList.toggle("draft",e)}_editingChanged(e,t){var i;if(void 0!==t){if(this.$.container.classList.toggle("editing",e),this.comment&&this.comment.id){const t=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector(".cancel");t&&(t.hidden=!e)}Gw(this.comment)&&(this.comment.__editing=this.editing),!!e!=!!t&&this._fireUpdate(),e&&setTimeout(()=>{yh(),this.textarea&&this.textarea.putCursorAtEnd()},1)}}_computeDeleteButtonClass(e,t){return e&&!t?"showDeleteButtons":""}_computeSaveDisabled(e,t,i){return!(!t||t.unresolved===i&&e)&&(!e||""===e.trim())}_handleSaveKey(e){this._computeSaveDisabled(this._messageText,this.comment,this.resolved)||(e.preventDefault(),this._handleSave(e))}_handleEsc(e){this._messageText.length||(e.preventDefault(),this._handleCancel(e))}_handleToggleCollapsed(){this.collapsed=!this.collapsed}_toggleCollapseClass(e){e?this.$.container.classList.add("collapsed"):this.$.container.classList.remove("collapsed")}_commentMessageChanged(e){this._messageText=e||""}_messageTextChanged(e,t){if(!this.comment||this.comment&&this.comment.id)return;const i=this.comment.patch_set?this.comment.patch_set:this._getPatchNum(),{path:n,line:o,range:r}=this.comment;n&&(this.storeTask=Cu(this.storeTask,()=>{const e=this._messageText;if(void 0===this.changeNum)throw new Error("undefined changeNum");const s={changeNum:this.changeNum,patchNum:i,path:n,line:o,range:r};e&&e.length||!t?this.storage.setDraftComment(s,e):this.storage.eraseDraftComment(s)},400))}_handleAnchorClick(e){e.preventDefault(),this.comment&&this.dispatchEvent(new CustomEvent("comment-anchor-tap",{bubbles:!0,composed:!0,detail:{number:this.comment.line||"FILE",side:this.side}}))}_handleEdit(e){var t;e.preventDefault(),(null===(t=this.comment)||void 0===t?void 0:t.message)&&(this._messageText=this.comment.message),this.editing=!0,this.reporting.recordDraftInteraction()}_handleSave(e){var t;if(e.preventDefault(),this.disabled)return;const i=(null===(t=this.comment)||void 0===t?void 0:t.id)?"UpdateDraftComment":"CreateDraftComment",n=this.reporting.getTimer(i);return this.set("comment.__editing",!1),this.save().then(()=>{n.end()})}_handleCancel(e){var t;e.preventDefault(),(null===(t=this.comment)||void 0===t?void 0:t.message)&&0!==this.comment.message.trim().length&&this.comment.id?(this._messageText=this.comment.message,this.editing=!1):this._fireDiscard()}_fireDiscard(){var e;null===(e=this.fireUpdateTask)||void 0===e||e.cancel(),this.dispatchEvent(new CustomEvent("comment-discard",{detail:this._getEventPayload(),composed:!0,bubbles:!0}))}_handleFix(){this.dispatchEvent(new CustomEvent("create-fix-comment",{bubbles:!0,composed:!0,detail:this._getEventPayload()}))}_handleShowFix(){this.dispatchEvent(new CustomEvent("open-fix-preview",{bubbles:!0,composed:!0,detail:this._getEventPayload()}))}_hasNoFix(e){return!e||!e.fix_suggestions}_handleDiscard(e){e.preventDefault(),this.reporting.recordDraftInteraction(),this._messageText?this._openOverlay(this.confirmDiscardOverlay).then(()=>{var e;const t=null===(e=this.confirmDiscardOverlay)||void 0===e?void 0:e.querySelector("#confirmDiscardDialog");t&&t.resetFocus()}):this._discardDraft()}_handleConfirmDiscard(e){e.preventDefault();const t=this.reporting.getTimer("DiscardDraftComment");return this._closeConfirmDiscardOverlay(),this._discardDraft().then(()=>{t.end()})}_discardDraft(){return this.comment?Gw(this.comment)?(this.discarding=!0,this.editing=!1,this.disabled=!0,this._eraseDraftComment(),this.comment.id?(this._xhrPromise=this._deleteDraft(this.comment).then(e=>(this.disabled=!1,e.ok||(this.discarding=!1),this._fireDiscard(),e)).catch(e=>{throw this.disabled=!1,e}),this._xhrPromise):(this.disabled=!1,this._fireDiscard(),Promise.resolve())):Promise.reject(new Error("Cannot discard a non-draft comment.")):Promise.reject(new Error("undefined comment"))}_closeConfirmDiscardOverlay(){this._closeOverlay(this.confirmDiscardOverlay)}_getSavingMessage(e,t){return t?"Unable to save draft":0===e?"All changes saved":`Saving ${Jb(e,"draft")}...`}_showStartRequest(){const e=++this._numPendingDraftRequests.number;this._updateRequestToast(e)}_showEndRequest(){const e=--this._numPendingDraftRequests.number;this._updateRequestToast(e)}_handleFailedDraftRequest(){var e;this._numPendingDraftRequests.number--,null===(e=this.draftToastTask)||void 0===e||e.cancel(),this._updateRequestToast(this._numPendingDraftRequests.number,!0)}_updateRequestToast(e,t){const i=this._getSavingMessage(e,t);this.draftToastTask=Cu(this.draftToastTask,()=>{Ci(document.body,i)},200)}_handleDraftFailure(){this.$.container.classList.add("unableToSave"),this._unableToSave=!0,this._handleFailedDraftRequest()}_saveDraft(e){if(!e||void 0===this.changeNum||void 0===this.patchNum)throw new Error("undefined draft or changeNum or patchNum");return this._showStartRequest(),this.restApiService.saveDiffDraft(this.changeNum,this.patchNum,e).then(e=>(e.ok?(this._unableToSave=!1,this.$.container.classList.remove("unableToSave"),this._showEndRequest()):this._handleDraftFailure(),e)).catch(e=>{throw this._handleDraftFailure(),e})}_deleteDraft(e){if(void 0===this.changeNum||void 0===this.patchNum)throw new Error("undefined changeNum or patchNum");if(this._showStartRequest(),!e.id)throw new Error("Missing id in comment draft.");return this.restApiService.deleteDiffDraft(this.changeNum,this.patchNum,{id:e.id}).then(e=>(e.ok?this._showEndRequest():this._handleFailedDraftRequest(),e))}_getPatchNum(){const e=this.isOnParent()?"PARENT":this.patchNum;if(void 0===e)throw new Error("patchNum undefined");return e}_loadLocalDraft(e,t,i){if([e,t,i].includes(void 0))return;if(!i||i.id||i.message||!i.path)return;const n=this.storage.getDraftComment({changeNum:e,patchNum:this._getPatchNum(),path:i.path,line:i.line,range:i.range});n&&this.set("comment.message",n.message)}_handleToggleResolved(){this.reporting.recordDraftInteraction(),this.resolved=!this.resolved;const e=this._getEventPayload();if(!e.comment)throw new Error("comment not defined in payload");e.comment.unresolved=!this.$.resolvedCheckbox.checked,this.dispatchEvent(new CustomEvent("comment-update",{detail:e,composed:!0,bubbles:!0})),this.editing||this.save(e.comment)}_handleCommentDelete(){this._openOverlay(this.confirmDeleteOverlay)}_handleCancelDeleteComment(){this._closeOverlay(this.confirmDeleteOverlay)}_openOverlay(e){return e?(yu().appendChild(e),e.open()):Promise.reject(new Error("undefined overlay"))}_computeHideRunDetails(e,t){return!e||!(e.robot_id&&e.url&&!t)}_closeOverlay(e){e&&(yu().removeChild(e),e.close())}_handleConfirmDeleteComment(){var e;const t=null===(e=this.confirmDeleteOverlay)||void 0===e?void 0:e.querySelector("#confirmDeleteComment");if(!t||!t.message)throw new Error("missing confirm delete dialog");if(!this.comment||!this.comment.id||void 0===this.changeNum||void 0===this.patchNum)throw new Error("undefined comment or id or changeNum or patchNum");this.restApiService.deleteComment(this.changeNum,this.patchNum,this.comment.id,t.message).then(e=>{this._handleCancelDeleteComment(),this.comment=e})}};tS([Oo({type:Number})],nS.prototype,"changeNum",void 0),tS([Oo({type:String})],nS.prototype,"projectName",void 0),tS([Oo({type:Object,notify:!0,observer:"_commentChanged"})],nS.prototype,"comment",void 0),tS([Oo({type:Array})],nS.prototype,"comments",void 0),tS([Oo({type:Boolean,reflectToAttribute:!0})],nS.prototype,"isRobotComment",void 0),tS([Oo({type:Boolean,reflectToAttribute:!0})],nS.prototype,"disabled",void 0),tS([Oo({type:Boolean,observer:"_draftChanged"})],nS.prototype,"draft",void 0),tS([Oo({type:Boolean,observer:"_editingChanged"})],nS.prototype,"editing",void 0),tS([Oo({type:Boolean,reflectToAttribute:!0})],nS.prototype,"discarding",void 0),tS([Oo({type:Boolean})],nS.prototype,"hasChildren",void 0),tS([Oo({type:String})],nS.prototype,"patchNum",void 0),tS([Oo({type:Boolean})],nS.prototype,"showActions",void 0),tS([Oo({type:Boolean})],nS.prototype,"_showHumanActions",void 0),tS([Oo({type:Boolean})],nS.prototype,"_showRobotActions",void 0),tS([Oo({type:Boolean,reflectToAttribute:!0,observer:"_toggleCollapseClass"})],nS.prototype,"collapsed",void 0),tS([Oo({type:Object})],nS.prototype,"projectConfig",void 0),tS([Oo({type:Boolean})],nS.prototype,"robotButtonDisabled",void 0),tS([Oo({type:Boolean})],nS.prototype,"_hasHumanReply",void 0),tS([Oo({type:Boolean})],nS.prototype,"_isAdmin",void 0),tS([Oo({type:Object})],nS.prototype,"_xhrPromise",void 0),tS([Oo({type:String,observer:"_messageTextChanged"})],nS.prototype,"_messageText",void 0),tS([Oo({type:String})],nS.prototype,"side",void 0),tS([Oo({type:Boolean})],nS.prototype,"resolved",void 0),tS([Oo({type:Object})],nS.prototype,"_numPendingDraftRequests",void 0),tS([Oo({type:Boolean})],nS.prototype,"_enableOverlay",void 0),tS([Oo({type:Object})],nS.prototype,"_overlays",void 0),tS([Oo({type:Boolean})],nS.prototype,"_showRespectfulTip",void 0),tS([Oo({type:Boolean})],nS.prototype,"showPatchset",void 0),tS([Oo({type:String})],nS.prototype,"_respectfulReviewTip",void 0),tS([Oo({type:Boolean})],nS.prototype,"_respectfulTipDismissed",void 0),tS([Oo({type:Boolean})],nS.prototype,"_unableToSave",void 0),tS([Oo({type:Object})],nS.prototype,"_selfAccount",void 0),tS([Oo({type:Boolean})],nS.prototype,"showPortedComment",void 0),tS([No("editing")],nS.prototype,"_onEditingChange",null),tS([No("showActions","isRobotComment")],nS.prototype,"_calculateActionstoShow",null),tS([No("comment")],nS.prototype,"_isRobotComment",null),tS([No("comment","comments.*")],nS.prototype,"_computeHasHumanReply",null),tS([No("comment.message")],nS.prototype,"_commentMessageChanged",null),tS([No("changeNum","patchNum","comment")],nS.prototype,"_loadLocalDraft",null),nS=tS([Po("gr-comment")],nS);const oS=mi``;var rS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const sS=new Map([[Vi.COVERED,"Covered by tests."],[Vi.NOT_COVERED,"Not covered by tests."],[Vi.PARTIALLY_COVERED,"Partially covered by tests."],[Vi.NOT_INSTRUMENTED,"Not instrumented by any tests."]]);let aS=class extends fi{constructor(){super(...arguments),this.coverageRanges=[],this._lineNumber=0,this._index=0}static get template(){return oS}annotate(e,t){if(!this.side||!t||!t.classList.contains(this.side))return;let i;const n=t.getAttribute("data-value");if(n&&(i=Number(n)),i&&!(i<1))for(i<this._lineNumber&&(this._index=0),this._lineNumber=i;this._index<this.coverageRanges.length;){const e=this.coverageRanges[this._index];if(!(this._lineNumber>e.code_range.end_line)){if(this._lineNumber<e.code_range.start_line)return;return t.classList.add(e.type),void(t.title=sS.get(e.type)||"")}this._index++}}};rS([Oo({type:Array})],aS.prototype,"coverageRanges",void 0),rS([Oo({type:String})],aS.prototype,"side",void 0),rS([Oo({type:Number})],aS.prototype,"_lineNumber",void 0),rS([Oo({type:Number})],aS.prototype,"_index",void 0),aS=rS([Po("gr-coverage-layer")],aS);class lS{constructor(e,t=0,i=0){this.type=e,this.beforeNumber=t,this.afterNumber=i,this.hasIntralineInfo=!1,this.highlights=[],this.text=""}}lS.Type=Wi,lS.File="FILE";const cS=new lS(Wi.BLANK);var dS;function hS(e,t,i){if(0===e.length)return[];t=Math.max(t,0);let n=[],o=e,r=[];if((i=Math.max(i,t))-t>3){if(t&&([n,o]=uS(o,t)),i){let e=0;if(n.length>0){const t=n[0].lineRange.left.start_line;e=n[n.length-1].lineRange.left.end_line-t+1}[o,r]=uS(o,i-e)}}else[o,r]=[[],o];const s=[...n];if(o.length){const e=new gS(dS.CONTEXT_CONTROL,[]);e.contextGroups=o,s.push(e)}return s.push(...r),s}function pS(e,t,i){let n,o;if(e.skip){t-e.lineRange.left.start_line<e.lineRange.right.end_line-t?o=e:n=e}else{const r=[],s=[];for(const n of e.lines)n.beforeNumber&&n.beforeNumber<t||n.afterNumber&&n.afterNumber<i?r.push(n):s.push(n);r.length&&(n=r.length===e.lines.length?e:e.cloneWithLines(r)),s.length&&(o=s.length===e.lines.length?e:e.cloneWithLines(s))}return{beforeSplit:n,afterSplit:o}}function uS(e,t){if(0===e.length)return[[],[]];const i=e[0].lineRange.left.start_line+t,n=e[0].lineRange.right.start_line+t,o=[],r=[];for(const t of e){const e=t.lineRange.left.end_line<i||t.lineRange.right.end_line<n,s=i<=t.lineRange.left.start_line||n<=t.lineRange.right.start_line;if(e)o.push(t);else if(s)r.push(t);else{const{beforeSplit:e,afterSplit:s}=pS(t,i,n);e&&o.push(e),s&&r.push(s)}}return[o,r]}!function(e){e.BOTH="both",e.CONTEXT_CONTROL="contextControl",e.DELTA="delta"}(dS||(dS={}));class gS{constructor(e,t=[]){this.type=e,this.dueToRebase=!1,this.ignoredWhitespaceOnly=!1,this.keyLocation=!1,this.lines=[],this.adds=[],this.removes=[],this.contextGroups=[],this.lineRange={left:{start_line:0,end_line:0},right:{start_line:0,end_line:0}},t.forEach(e=>this.addLine(e))}cloneWithLines(e){const t=new gS(this.type,e);return t.dueToRebase=this.dueToRebase,t.ignoredWhitespaceOnly=this.ignoredWhitespaceOnly,t}addLine(e){if(this.lines.push(e),(this.type===dS.BOTH||this.type===dS.CONTEXT_CONTROL)&&(e.type===Wi.ADD||e.type===Wi.REMOVE))throw Error("Cannot add delta line to a non-delta group.");e.type===Wi.ADD?this.adds.push(e):e.type===Wi.REMOVE&&this.removes.push(e),this._updateRange(e)}getSideBySidePairs(){if(this.type===dS.BOTH||this.type===dS.CONTEXT_CONTROL)return this.lines.map(e=>({left:e,right:e}));const e=[];let t=0,i=0;for(;t<this.removes.length||i<this.adds.length;)e.push({left:this.removes[t]||cS,right:this.adds[i]||cS}),t++,i++;return e}_updateRange(e){"FILE"!==e.beforeNumber&&"FILE"!==e.afterNumber&&"LOST"!==e.beforeNumber&&"LOST"!==e.afterNumber&&(e.type!==Wi.ADD&&e.type!==Wi.BOTH||((0===this.lineRange.right.start_line||e.afterNumber<this.lineRange.right.start_line)&&(this.lineRange.right.start_line=e.afterNumber),e.afterNumber>this.lineRange.right.end_line&&(this.lineRange.right.end_line=e.afterNumber)),e.type!==Wi.REMOVE&&e.type!==Wi.BOTH||((0===this.lineRange.left.start_line||e.beforeNumber<this.lineRange.left.start_line)&&(this.lineRange.left.start_line=e.beforeNumber),e.beforeNumber>this.lineRange.left.end_line&&(this.lineRange.left.end_line=e.beforeNumber)))}}const mS={getCookie(e){const t=e+"=",i=document.cookie.split(";");for(let e=0;e<i.length;e++){let n=i[e];for(;" "===n.charAt(0);)n=n.substring(1);if(n.startsWith(t))return n.substring(t.length,n.length)}return""},makeCancelable(e){let t,i=!1;const n=new Promise((n,o)=>{t=o,e.then(e=>{i||n(e),i=!0},e=>{i||o(e),i=!0})});return n.cancel=()=>{i||(t({isCanceled:!0}),i=!0)},n}};var fS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let _S=class extends fi{constructor(){super(...arguments),this.context=3,this.groups=[],this.keyLocations={left:{},right:{}},this._asyncThreshold=64,this._nextStepHandle=null,this._processPromise=null,this.handleWindowScroll=()=>{this._isScrolling=!0,this.resetIsScrollingTask=Cu(this.resetIsScrollingTask,()=>this._isScrolling=!1,50)}}connectedCallback(){super.connectedCallback(),window.addEventListener("scroll",this.handleWindowScroll)}disconnectedCallback(){var e;null===(e=this.resetIsScrollingTask)||void 0===e||e.cancel(),this.cancel(),window.removeEventListener("scroll",this.handleWindowScroll),super.disconnectedCallback()}process(e,t){return this.cancel(),this.groups=[],this.push("groups",this._makeGroup("LOST")),this.push("groups",this._makeGroup("FILE")),t?Promise.resolve():(this._processPromise=mS.makeCancelable(new Promise(t=>{const i={lineNums:{left:0,right:0},chunkIndex:0};e=this._splitLargeChunks(e),e=this._splitCommonChunksWithKeyLocations(e);let n=0;const o=()=>{if(this._isScrolling)return void(this._nextStepHandle=window.setTimeout(o,100));if(i.chunkIndex>=e.length)return t(),void(this._nextStepHandle=null);const r=this._processNext(i,e);for(const e of r.groups)this.push("groups",e),n+=e.lines.length;i.lineNums.left+=r.lineDelta.left,i.lineNums.right+=r.lineDelta.right,i.chunkIndex=r.newChunkIndex,n>=this._asyncThreshold?(n=0,this._nextStepHandle=window.setTimeout(o,1)):o.call(this)};o.call(this)})),this._processPromise.finally(()=>{this._processPromise=null}))}cancel(){null!==this._nextStepHandle&&(window.clearTimeout(this._nextStepHandle),this._nextStepHandle=null),this._processPromise&&this._processPromise.cancel()}_processNext(e,t){const i=this._firstUncollapsibleChunkIndex(t,e.chunkIndex);if(i===e.chunkIndex){const i=t[e.chunkIndex];return{lineDelta:{left:this._linesLeft(i).length,right:this._linesRight(i).length},groups:[this._chunkToGroup(i,e.lineNums.left+1,e.lineNums.right+1)],newChunkIndex:e.chunkIndex+1}}return this._processCollapsibleChunks(e,t,i)}_linesLeft(e){return e.ab||e.a||[]}_linesRight(e){return e.ab||e.b||[]}_firstUncollapsibleChunkIndex(e,t){let i=t;for(;i<e.length&&this._isCollapsibleChunk(e[i]);)i++;return i}_isCollapsibleChunk(e){return(e.ab||e.common||e.skip)&&!e.keyLocation}_processCollapsibleChunks(e,t,i){const n=t.slice(e.chunkIndex,i),o=n.reduce((e,t)=>e+this._commonChunkLength(t),0);let r=this._chunksToGroups(n,e.lineNums.left+1,e.lineNums.right+1);const s=!!r.find(e=>e.skip);if(-1!==this.context||s){const n=this.context>0?this.context:0;r=hS(r,0===e.chunkIndex?0:n,o-(i===t.length?0:this.context))}return{lineDelta:{left:o,right:o},groups:r,newChunkIndex:i}}_commonChunkLength(e){return e.skip?e.skip:(console.assert(!!e.ab||!!e.common),console.assert(!e.a||!!e.b&&e.a.length===e.b.length,"common chunk needs same number of a and b lines: ",e),this._linesLeft(e).length)}_chunksToGroups(e,t,i){return e.map(e=>{const n=this._chunkToGroup(e,t,i),o=this._commonChunkLength(e);return t+=o,i+=o,n})}_chunkToGroup(e,t,i){const n=e.ab||e.skip?dS.BOTH:dS.DELTA,o=this._linesFromChunk(e,t,i),r=new gS(n,o);return r.keyLocation=!!e.keyLocation,r.dueToRebase=!!e.due_to_rebase,r.moveDetails=e.move_details,r.skip=e.skip,r.ignoredWhitespaceOnly=!!e.common,e.skip&&(r.lineRange={left:{start_line:t,end_line:t+e.skip-1},right:{start_line:i,end_line:i+e.skip-1}}),r}_linesFromChunk(e,t,i){if(e.ab)return e.ab.map((e,n)=>this._lineFromRow(Wi.BOTH,t,i,e,n));let n=[];return e.a&&(n=n.concat(this._linesFromRows(Wi.REMOVE,e.a,t,e.edit_a))),e.b&&(n=n.concat(this._linesFromRows(Wi.ADD,e.b,i,e.edit_b))),n}_linesFromRows(e,t,i,n){const o=n?this._convertIntralineInfos(t,n):void 0;return t.map((t,n)=>this._lineFromRow(e,i,i,t,n,o))}_lineFromRow(e,t,i,n,o,r){const s=new lS(e);return s.text=n,e!==Wi.ADD&&(s.beforeNumber=t+o),e!==Wi.REMOVE&&(s.afterNumber=i+o),r?(s.hasIntralineInfo=!0,s.highlights=r.filter(e=>e.contentIndex===o)):s.hasIntralineInfo=!1,s}_makeGroup(e){const t=new lS(Wi.BOTH);return t.beforeNumber=e,t.afterNumber=e,new gS(dS.BOTH,[t])}_splitLargeChunks(e){const t=[];for(const i of e)if(i.ab)-1===this.context&&i.ab.length>240?(t.push({ab:i.ab.slice(0,120)}),t.push({ab:i.ab.slice(120)})):t.push(i);else for(const e of this._breakdownChunk(i))t.push(e);return t}_splitCommonChunksWithKeyLocations(e){const t=[];let i=1,n=1;for(const o of e){if(!o.ab&&!o.skip&&!o.common){o.a&&(i+=o.a.length),o.b&&(n+=o.b.length),t.push(o);continue}if(o.common&&o.a.length!==o.b.length)throw new Error("DiffContent with common=true must always have equal length");const e=this._commonChunkLength(o),r=this._findChunkEndsAtKeyLocations(e,i,n);if(i+=e,n+=e,o.skip)t.push({...o,skip:o.skip,keyLocation:!1});else if(o.ab)t.push(...this._splitAtChunkEnds(o.ab,r).map(({lines:e,keyLocation:t})=>({...o,ab:e,keyLocation:t})));else if(o.common){const e=this._splitAtChunkEnds(o.a,r),i=this._splitAtChunkEnds(o.b,r);t.push(...e.map(({lines:e,keyLocation:t},n)=>({...o,a:e,b:i[n].lines,keyLocation:t})))}}return t}_findChunkEndsAtKeyLocations(e,t,i){const n=[];let o=0;for(let r=0;r<e;r++)(this.keyLocations[zi.LEFT][t+r]||this.keyLocations[zi.RIGHT][i+r])&&(r>o&&(n.push({offset:r,keyLocation:!1}),o=r),n.push({offset:r+1,keyLocation:!0}));return e>o&&n.push({offset:e,keyLocation:!1}),n}_splitAtChunkEnds(e,t){const i=[];let n=0;for(const{offset:o,keyLocation:r}of t)i.push({lines:e.slice(n,o),keyLocation:r}),n=o;return i}_convertIntralineInfos(e,t){let i=0,n=0;const o=[];for(const[r,s]of t){let t=e[i]+"\n",a=0;for(;a<r;)n!==t.length?(n++,a++):(n=0,t=e[++i]+"\n");let l={contentIndex:i,startIndex:n};for(a=0;t&&a<s;)n!==t.length?(n++,a++):(n=0,t=e[++i]+"\n",o.push(l),l={contentIndex:i,startIndex:n});l.endIndex=n,o.push(l)}return o}_breakdownChunk(e){let t=null;const{a:i,b:n,ab:o,move_details:r}=e;return(null==i?void 0:i.length)&&!(null==n?void 0:n.length)?t="a":(null==n?void 0:n.length)&&!(null==i?void 0:i.length)?t="b":(null==o?void 0:o.length)&&(t="ab"),!t||r?[e]:this._breakdown(e[t],120).map(i=>{const n={};return n[t]=i,e.due_to_rebase&&(n.due_to_rebase=!0),e.move_details&&(n.move_details=e.move_details),n})}_breakdown(e,t){if(!e.length)return[];if(e.length<t)return[e];const i=e.slice(0,e.length-t),n=e.slice(e.length-t);return this._breakdown(i,t).concat([n])}};fS([Oo({type:Number})],_S.prototype,"context",void 0),fS([Oo({type:Array,notify:!0})],_S.prototype,"groups",void 0),fS([Oo({type:Object})],_S.prototype,"keyLocations",void 0),fS([Oo({type:Number})],_S.prototype,"_asyncThreshold",void 0),fS([Oo({type:Number})],_S.prototype,"_nextStepHandle",void 0),fS([Oo({type:Object})],_S.prototype,"_processPromise",void 0),fS([Oo({type:Boolean})],_S.prototype,"_isScrolling",void 0),_S=fS([Po("gr-diff-processor")],_S);const vS=mi`
  <style include="gr-hovercard-shared-style">
    #container {
      padding: var(--spacing-l);
    }
  </style>
  <div id="container" role="tooltip" tabindex="-1">
    <slot></slot>
  </div>
`;let yS=class extends(Au(fi)){static get template(){return vS}};yS=(window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s})([Po("gr-hovercard")],yS);const bS=mi``;function wS(e,t){return!e&&!t||!(!e||!t)&&(e.start_line===t.start_line&&e.start_character===t.start_character&&e.end_line===t.end_line&&e.end_character===t.end_character)}function CS(e){return e.end_line-e.start_line>10}function SS(e){if(!e)return null;const t=e.getAttribute("data-value");if(!t)return null;if("FILE"===t)return"FILE";if("LOST"===t)return"LOST";const i=Number(t);return Number.isInteger(i)?i:null}function ES(e){const t=e.getAttribute("line-num");if("LOST"===t)return t;if(!t||"FILE"===t)return"FILE";const i=Number(t);if(isNaN(i))throw new Error(`cannot parse line number: ${t}`);if(i<1)throw new Error(`line number smaller than 1: ${i}`);return i}function AS(e){const t=e.getAttribute("diff-side")||e.getAttribute("comment-side");if(t){if(t!==zi.LEFT&&t!==zi.RIGHT)throw Error(`unexpected value for side: ${t}`);return t}console.warn("comment thread without side")}function xS(e){const t=e.getAttribute("range");if(!t)return;const i=JSON.parse(t);if(!i.start_line)throw new Error(`invalid range: ${t}`);return i}function RS(e){return e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("comment-thread")}var TS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const kS=/^(commentRanges\.#?\d+)\.hovering$/;let PS=class extends fi{constructor(){super(...arguments),this.commentRanges=[],this._listeners=[],this._rangesMap={left:{},right:{}}}static get template(){return bS}get styleModuleName(){return"gr-ranged-comment-styles"}annotate(e,t,i){let n=[];(i.type===Wi.REMOVE||i.type===Wi.BOTH&&"right"!==e.getAttribute("data-side"))&&(n=n.concat(this._getRangesForLine(i,zi.LEFT))),(i.type===Wi.ADD||i.type===Wi.BOTH&&"left"!==e.getAttribute("data-side"))&&(n=n.concat(this._getRangesForLine(i,zi.RIGHT)));for(const t of n)Dm.annotateElement(e,t.start,t.end-t.start,(t.hovering?"style-scope gr-diff range rangeHoverHighlight":t.longRange?"style-scope gr-diff range":"style-scope gr-diff range rangeHighlight")+` ${gu(t.rootId)}`)}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter(t=>t!==e)}_notifyUpdateRange(e,t,i){for(const n of this._listeners)n(e,t,i)}_handleCommentRangesChange(e){if(!e)return;if("commentRanges"===e.path){const t=e.value;this._rangesMap={left:{},right:{}};for(const{side:e,range:i,rootId:n,hovering:o}of t){const t=CS(i);this._updateRangesMap({side:e,range:i,hovering:o,operation:(e,i,o,r)=>{e.push({start:i,end:o,hovering:r,rootId:n,longRange:t})}})}}const t=e.path.match(kS);if(t){const{side:e,range:i,hovering:n,rootId:o}=this.get(t[1]);this._updateRangesMap({side:e,range:i,hovering:n,skipLayerUpdate:!0,operation:(e,t,i,n)=>{const r=e.findIndex(e=>e.start===t&&e.end===i);e[r].hovering=n,e[r].rootId=o}})}if("commentRanges.splices"===e.path){const t=e.value;for(const e of t.indexSplices){const t=e.removed;for(const{side:e,range:i,hovering:n,rootId:o}of t)this._updateRangesMap({side:e,range:i,hovering:n,operation:(e,t,i)=>{const n=e.findIndex(e=>e.start===t&&e.end===i&&o===e.rootId);e.splice(n,1)}});const i=e.object.slice(e.index,e.index+e.addedCount);for(const{side:e,range:t,hovering:n,rootId:o}of i){const i=CS(t);this._updateRangesMap({side:e,range:t,hovering:n,operation:(e,t,n,r)=>{e.push({start:t,end:n,hovering:r,rootId:o,longRange:i})}})}}}}_updateRangesMap(e){const{side:t,range:i,hovering:n,operation:o,skipLayerUpdate:r}=e,s=this._rangesMap[t]||(this._rangesMap[t]={});for(let e=i.start_line;e<=i.end_line;e++){o(s[e]||(s[e]=[]),e===i.start_line?i.start_character:0,e===i.end_line?i.end_character:-1,n)}r||this._notifyUpdateRange(i.start_line,i.end_line,t)}_getRangesForLine(e,t){const i=t===zi.LEFT?e.beforeNumber:e.afterNumber;return(this.get(["_rangesMap",t,i])||[]).map(n=>((n={...n}).end=-1===n.end?e.text.length:n.end,n.start>=n.end&&n.start<e.text.length&&(n.end=e.text.length,this.dispatchEvent(new CustomEvent("normalize-range",{bubbles:!0,composed:!0,detail:{lineNum:i,side:t}}))),n)).sort((e,t)=>e.hovering&&!t.hovering?1:0)}};TS([Oo({type:Array})],PS.prototype,"commentRanges",void 0),TS([Oo({type:Array})],PS.prototype,"_listeners",void 0),TS([Oo({type:Object})],PS.prototype,"_rangesMap",void 0),TS([No("commentRanges.*")],PS.prototype,"_handleCommentRangesChange",null),PS=TS([Po("gr-ranged-comment-layer")],PS);const IS=/\t|[\uD800-\uDBFF][\uDC00-\uDFFF]/;var OS;!function(e){e.ABOVE="above",e.BELOW="below",e.ALL="all"}(OS||(OS={}));class NS{constructor(e,t,i,n=[],o){if(this.layers=n,this._diff=e,this._numLinesLeft=this._diff.content?this._diff.content.reduce((e,t)=>{const i=t.a||t.ab;return e+((null==i?void 0:i.length)||t.skip||0)},0):0,this._prefs=t,this._renderPrefs=o,this._outputEl=i,this.groups=[],this.blameInfo=null,isNaN(t.tab_size)||t.tab_size<=0)throw Error("Invalid tab size from preferences.");if(isNaN(t.line_length)||t.line_length<=0)throw Error("Invalid line length from preferences.");this._layerUpdateListener=(e,t,i)=>this._handleLayerUpdate(e,t,i);for(const e of this.layers)e.addListener&&e.addListener(this._layerUpdateListener)}clear(){for(const e of this.layers)e.removeListener&&e.removeListener(this._layerUpdateListener)}emitGroup(e,t){const i=this.buildSectionElement(e);this._outputEl.insertBefore(i,t),e.element=i}getGroupsByLineRange(e,t,i){const n=[];for(let o=0;o<this.groups.length;o++){const r=this.groups[o];if(0===r.lines.length)continue;let s=0,a=0;if(i){const e=i===zi.LEFT?r.lineRange.left:r.lineRange.right;s=e.start_line,a=e.end_line}0===s&&(s=a),0===a&&(a=s),e<=a&&t>=s&&n.push(r)}return n}getContentTdByLine(e,t,i=this._outputEl){const n=t?`.${t}`:"";return i.querySelector(`td.lineNum[data-value="${e}"]${n} ~ td.content`)}getContentByLine(e,t,i){const n=this.getContentTdByLine(e,t,i);return n?n.querySelector(".contentText"):null}findLinesByRange(e,t,i,n,o){const r=this.getGroupsByLineRange(e,t,i);for(const s of r){let r=null;for(const a of s.lines){if("left"===i&&a.type===Wi.ADD||"right"===i&&a.type===Wi.REMOVE)continue;const l="left"===i?a.beforeNumber:a.afterNumber;l<e||l>t||(n&&n.push(a),o&&(r=r?this._getNextContentOnSide(r,i):this.getContentByLine(l,i,s.element),r&&o.push(r)))}}}_renderContentByRange(e,t,i){const n=[],o=[];let r,s;this.findLinesByRange(e,t,i,n,o);for(let e=0;e<n.length;e++){if(r=n[e],s=o[e],!s||!s.parentElement)continue;const t=this._getLineNumberEl(s,i);s.parentElement.replaceChild(this._createTextEl(t,r,i).firstChild,s)}}getSectionsByLineRange(e,t,i){return this.getGroupsByLineRange(e,t,i).map(e=>e.element)}_createContextControls(e,t,i){const n=t[0].lineRange.left.start_line,o=t[t.length-1].lineRange.left.end_line,r=o-n+1;0===r&&console.error("context group without lines");const s=!!t[0].skip,a=!!t[t.length-1].skip,l=n>1&&!s,c=o<this._numLinesLeft&&!a;if(l){const t=this._createContextControlPaddingRow(i);t.classList.add("above"),e.appendChild(t)}if(e.appendChild(this._createContextControlRow(e,t,l,c,r,i)),c){const t=this._createContextControlPaddingRow(i);t.classList.add("below"),e.appendChild(t)}}_createContextControlRow(e,t,i,n,o,r){const s=this._createElement("tr","dividerRow");i&&!n?s.classList.add("showAboveOnly"):!i&&n?s.classList.add("showBelowOnly"):s.classList.add("showBoth"),s.appendChild(this._createBlameCell(0)),r===Gi.SIDE_BY_SIDE&&s.appendChild(this._createElement("td"));const a=this._createElement("td","dividerCell");a.setAttribute("colspan","3"),s.appendChild(a);const l=this._createElement("div","verticalFlex");a.appendChild(l);const c=this._createElement("div","horizontalFlex");l.appendChild(c);const d=this._createElement("div","aboveBelowButtons");c.appendChild(d);const h=this._createContextButton(OS.ALL,e,t,o);if(h.classList.add(i&&n?"centeredButton":i?"aboveButton":"belowButton"),d.appendChild(h),o>10){const r=this._createElement("div","aboveBelowButtons");i&&r.appendChild(this._createContextButton(OS.ABOVE,e,t,o)),n&&r.appendChild(this._createContextButton(OS.BELOW,e,t,o)),c.appendChild(r)}return s}_createContextControlPaddingRow(e){const t=this._createElement("tr","contextBackground");return e===Gi.SIDE_BY_SIDE?(t.classList.add("side-by-side"),t.setAttribute("left-type",dS.CONTEXT_CONTROL),t.setAttribute("right-type",dS.CONTEXT_CONTROL)):t.classList.add("unified"),t.appendChild(this._createBlameCell(0)),t.appendChild(this._createElement("td","contextLineNum")),e===Gi.SIDE_BY_SIDE&&t.appendChild(this._createElement("td")),t.appendChild(this._createElement("td","contextLineNum")),t.appendChild(this._createElement("td")),t}_createContextButton(e,t,i,n){const o=this._createElement("gr-button","showContext");o.classList.add("contextControlButton"),o.setAttribute("link","true"),o.setAttribute("no-uppercase","true");let r="",s=[],a=!1;e===NS.ContextButtonType.ALL?(r=`+${Jb(n,"common line")}`,o.setAttribute("aria-label",`Show ${Jb(n,"common line")}`),a=void 0!==i.find(e=>!!e.skip),a&&(r+=" (too large)"),s.push(...i)):e===NS.ContextButtonType.ABOVE?(s=hS(i,10,n),r="+10",o.classList.add("aboveButton"),o.setAttribute("aria-label",`Show ${Jb(10,"line")} above`)):e===NS.ContextButtonType.BELOW&&(s=hS(i,0,n-10),r="+10",o.classList.add("belowButton"),o.setAttribute("aria-label",`Show ${Jb(10,"line")} below`));const l=this._createElement("span","showContext");return l.textContent=r,o.appendChild(l),a?o.addEventListener("click",e=>{e.stopPropagation();const t=s[0].lineRange,i=s[s.length-1].lineRange,n={left:{start_line:t.left.start_line,end_line:i.left.end_line},right:{start_line:t.right.start_line,end_line:i.right.end_line}};wi(o,"content-load-needed",{lineRange:n})}):o.addEventListener("click",e=>{e.stopPropagation(),wi(o,"diff-context-expanded",{groups:s,section:t,numLines:n})}),o}_createLineEl(e,t,i,n){var o;const r=this._createElement("td");if(r.classList.add(n),e.type===Wi.BLANK)return r;if(e.type===Wi.BOTH||e.type===i){if(r.classList.add("lineNum"),r.dataset.value=t.toString(),(!1===this._prefs.show_file_comment_button||!1===(null===(o=this._renderPrefs)||void 0===o?void 0:o.show_file_comment_button))&&"FILE"===t||"LOST"===t)return r;const i=this._createElement("button");r.appendChild(i),i.tabIndex=-1,i.classList.add("lineNumButton"),i.classList.add(n),i.dataset.value=t.toString(),i.textContent="FILE"===t?"File":t.toString(),"FILE"===t&&i.setAttribute("aria-label","Add file comment"),t>0&&(e.type===Wi.REMOVE?i.setAttribute("aria-label",`${t} removed`):e.type===Wi.ADD&&i.setAttribute("aria-label",`${t} added`))}return r}_createTextEl(e,t,i){const n=this._createElement("td");if(t.type!==Wi.BLANK&&n.classList.add("content"),t.hasIntralineInfo||n.classList.add("no-intraline-info"),n.classList.add(t.type),"FILE"!==t.beforeNumber&&"LOST"!==t.beforeNumber){const o=this._prefs.line_wrapping?1/0:this._prefs.line_length,r=this._formatText(t.text,this._prefs.tab_size,o);if(i&&r.setAttribute("data-side",i),e)for(const i of this.layers)"function"==typeof i.annotate&&i.annotate(r,e,t);else console.error("The lineNumberEl is null, skipping layer annotations.");n.appendChild(r)}else"FILE"===t.beforeNumber?n.classList.add("file"):"LOST"===t.beforeNumber&&n.classList.add("lost");return n}_formatText(e,t,i){const n=this._createElement("div","contentText");let o=0,r=0;for(const s of e.split(IS)){if(s){let e=0,t=i-o;for(;t<s.length;)n.appendChild(document.createTextNode(s.substring(e,t))),n.appendChild(this._createElement("span","br")),o=0,e=t,t+=i;n.appendChild(document.createTextNode(s.substring(e))),o+=s.length-e,r+=s.length}if(r<e.length)if(e.startsWith("\t",r)){let e=t-o%t;o+e>i&&(n.appendChild(this._createElement("span","br")),o=0,e=t),n.appendChild(this._getTabWrapper(e)),o+=e,r++}else o>=i&&(n.appendChild(this._createElement("span","br")),o=0),n.appendChild(document.createTextNode(e.substring(r,r+2))),r+=2,o+=1}return n}_getTabWrapper(e){const t=this._createElement("span","tab");return t.setAttribute("style",`tab-size: ${e}; -moz-tab-size: ${e};`),t.innerText="\t",t}_createElement(e,t){const i=document.createElement(e);if(i.classList.add("style-scope","gr-diff"),t)for(const e of t.split(" "))i.classList.add(e);return i}_handleLayerUpdate(e,t,i){this._renderContentByRange(e,t,i)}_isTotal(e){return!(e.type!==dS.DELTA||e.adds.length&&e.removes.length||!e.adds.length&&!e.removes.length)}setBlame(e){if(this.blameInfo=e,e)for(const t of e)for(const e of t.ranges)for(let i=e.start;i<=e.end;i++){const e=this._getBlameByLineNum(i);if(!e)continue;for(;e.hasChildNodes();)e.removeChild(e.lastChild);const n=this._getBlameForBaseLine(i,t);n&&e.appendChild(n)}}_createMovedLineAnchor(e,t){const i=this._createElementWithText("a",`${e}`);return i.setAttribute("href",`#${e}`),i.addEventListener("click",n=>{n.preventDefault(),i.dispatchEvent(new CustomEvent("moved-link-clicked",{detail:{lineNum:e,side:t},composed:!0,bubbles:!0}))}),i}_createElementWithText(e,t){const i=this._createElement(e);return i.textContent=t,i}_createMoveDescriptionDiv(e,t){var i;const n=this._createElement("div");if(null===(i=t.moveDetails)||void 0===i?void 0:i.range){const{changed:i,range:o}=t.moveDetails,r=e?zi.LEFT:zi.RIGHT,s=`Moved ${i?"and changed ":""}${e?"from":"to"} lines `;n.appendChild(this._createElementWithText("span",s)),n.appendChild(this._createMovedLineAnchor(o.start,r)),n.appendChild(this._createElementWithText("span"," - ")),n.appendChild(this._createMovedLineAnchor(o.end,r))}else n.appendChild(this._createElementWithText("span",e?"Moved in":"Moved out"));return n}_buildMoveControls(e){const t=e.adds.length>0,{numberOfCells:i,movedOutIndex:n,movedInIndex:o}=this._getMoveControlsConfig();let r,s;const a=this._createMoveDescriptionDiv(t,e);t?(r="movedIn",s=o):(r="movedOut",s=n);const l=this._createElement("tr",`moveControls ${r}`),c=[...Array(i).keys()].map(()=>this._createElement("td")),d=this._createElement("div","moveDescription"),h=this._createElement("iron-icon");return h.setAttribute("icon","gr-icons:move-item"),d.appendChild(h),d.appendChild(a),c[s].appendChild(d),c[s].classList.add("moveLabel"),c.forEach(e=>{l.appendChild(e)}),l}_getBlameByLineNum(e){return this._outputEl.querySelector(`td.blame[data-line-number="${e}"]`)}_getBlameCommitForBaseLine(e){if(!this.blameInfo)return null;for(const t of this.blameInfo)for(const i of t.ranges)if(i.start<=e&&i.end>=e)return t;return null}_getBlameForBaseLine(e,t=this._getBlameCommitForBaseLine(e)){if(!t)return null;const i=t.ranges.some(t=>t.start===e),n=new Date(1e3*t.time).toLocaleDateString(),o=this._createElement("span",i?"startOfRange":""),r=this._createElement("a","blameDate");r.innerText=`${n}`,r.setAttribute("href",`${k()}/q/${t.id}`),o.appendChild(r);const s=t.author.split(" ")[0],a=this._createElement("span","blameAuthor");a.innerText=` ${s}`,o.appendChild(a);const l=this._createElement("span","blameHoverCard");l.innerText=`Commit ${t.id}\nAuthor: ${t.author}\nDate: ${n}\n\n${t.commit_msg}`;const c=this._createElement("gr-hovercard");return c.appendChild(l),o.appendChild(c),o}_createBlameCell(e){const t=this._createElement("td","blame");if(t.setAttribute("data-line-number",e.toString()),e){const i=this._getBlameForBaseLine(e);i&&t.appendChild(i)}return t}_getLineNumberEl(e,t){let i=e;for(;i&&!i.classList.contains("diff-row");)i=i.parentElement;return i?i.querySelector(".lineNum."+t):null}}NS.GroupType={ADDED:"b",BOTH:"ab",REMOVED:"a"},NS.Highlights={ADDED:"edit_b",REMOVED:"edit_a"},NS.ContextButtonType={ABOVE:"above",BELOW:"below",ALL:"all"};class LS extends NS{constructor(e,t,i,n=[],o){super(e,t,i,n,o),this.layers=n}_getMoveControlsConfig(){return{numberOfCells:4,movedOutIndex:1,movedInIndex:3}}buildSectionElement(e){const t=this._createElement("tbody","section");if(t.classList.add(e.type),this._isTotal(e)&&t.classList.add("total"),e.dueToRebase&&t.classList.add("dueToRebase"),e.moveDetails&&(t.classList.add("dueToMove"),t.appendChild(this._buildMoveControls(e))),e.ignoredWhitespaceOnly&&t.classList.add("ignoredWhitespaceOnly"),e.type===dS.CONTEXT_CONTROL)return this._createContextControls(t,e.contextGroups,Gi.SIDE_BY_SIDE),t;const i=e.getSideBySidePairs();for(let e=0;e<i.length;e++)t.appendChild(this._createRow(i[e].left,i[e].right));return t}addColumns(e,t){const i=4*t,n=document.createElement("colgroup");let o=this._createElement("col","blame");n.appendChild(o),o=this._createElement("col","left"),o.setAttribute("width",i.toString()),n.appendChild(o),n.appendChild(this._createElement("col","left")),o=document.createElement("col"),o.setAttribute("width",i.toString()),n.appendChild(o),n.appendChild(document.createElement("col")),e.appendChild(n)}_createRow(e,t){const i=this._createElement("tr");return i.classList.add("diff-row","side-by-side"),i.setAttribute("left-type",e.type),i.setAttribute("right-type",t.type),i.tabIndex=-1,i.appendChild(this._createBlameCell(e.beforeNumber)),this._appendPair(i,e,e.beforeNumber,zi.LEFT),this._appendPair(i,t,t.afterNumber,zi.RIGHT),i}_appendPair(e,t,i,n){const o=this._createLineEl(t,i,t.type,n);e.appendChild(o),e.appendChild(this._createTextEl(o,t,n))}_getNextContentOnSide(e,t){let i=e.parentElement.parentElement;for(;i=i.nextSibling;){const e=i.querySelector('td.content .contentText[data-side="'+t+'"]');if(e)return e}return null}}const DS=mi`
  <div class="contentWrapper">
    <slot></slot>
  </div>
  <gr-ranged-comment-layer
    id="rangeLayer"
    comment-ranges="[[commentRanges]]"
  ></gr-ranged-comment-layer>
  <gr-coverage-layer
    id="coverageLayerLeft"
    coverage-ranges="[[_leftCoverageRanges]]"
    side="left"
  ></gr-coverage-layer>
  <gr-coverage-layer
    id="coverageLayerRight"
    coverage-ranges="[[_rightCoverageRanges]]"
    side="right"
  ></gr-coverage-layer>
  <gr-diff-processor id="processor" groups="{{_groups}}"></gr-diff-processor>
`;zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        overflow: hidden;
        position: relative;
      }

      #baseURIAnchor {
        display: none;
      }

      #sizedImgDiv {
        position: absolute;
        top: 0px;
        right: 0px;
        bottom: 0px;
        left: 0px;

        display: none;
      }

      #img {
        display: block;
        width: var(--iron-image-width, auto);
        height: var(--iron-image-height, auto);
      }

      :host([sizing]) #sizedImgDiv {
        display: block;
      }

      :host([sizing]) #img {
        display: none;
      }

      #placeholder {
        position: absolute;
        top: 0px;
        right: 0px;
        bottom: 0px;
        left: 0px;

        background-color: inherit;
        opacity: 1;

        @apply --iron-image-placeholder;
      }

      #placeholder.faded-out {
        transition: opacity 0.5s linear;
        opacity: 0;
      }
    </style>

    <a id="baseURIAnchor" href="#"></a>
    <div id="sizedImgDiv" role="img" hidden$="[[_computeImgDivHidden(sizing)]]" aria-hidden$="[[_computeImgDivARIAHidden(alt)]]" aria-label$="[[_computeImgDivARIALabel(alt, src)]]"></div>
    <img id="img" alt$="[[alt]]" hidden$="[[_computeImgHidden(sizing)]]" crossorigin$="[[crossorigin]]" on-load="_imgOnLoad" on-error="_imgOnError">
    <div id="placeholder" hidden$="[[_computePlaceholderHidden(preload, fade, loading, loaded)]]" class$="[[_computePlaceholderClassName(preload, fade, loading, loaded)]]"></div>
`,is:"iron-image",properties:{src:{type:String,value:""},alt:{type:String,value:null},crossorigin:{type:String,value:null},preventLoad:{type:Boolean,value:!1},sizing:{type:String,value:null,reflectToAttribute:!0},position:{type:String,value:"center"},preload:{type:Boolean,value:!1},placeholder:{type:String,value:null,observer:"_placeholderChanged"},fade:{type:Boolean,value:!1},loaded:{notify:!0,readOnly:!0,type:Boolean,value:!1},loading:{notify:!0,readOnly:!0,type:Boolean,value:!1},error:{notify:!0,readOnly:!0,type:Boolean,value:!1},width:{observer:"_widthChanged",type:Number,value:null},height:{observer:"_heightChanged",type:Number,value:null}},observers:["_transformChanged(sizing, position)","_loadStateObserver(src, preventLoad)"],created:function(){this._resolvedSrc=""},_imgOnLoad:function(){this.$.img.src===this._resolveSrc(this.src)&&(this._setLoading(!1),this._setLoaded(!0),this._setError(!1))},_imgOnError:function(){this.$.img.src===this._resolveSrc(this.src)&&(this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage="",this._setLoading(!1),this._setLoaded(!1),this._setError(!0))},_computePlaceholderHidden:function(){return!this.preload||!this.fade&&!this.loading&&this.loaded},_computePlaceholderClassName:function(){return this.preload&&this.fade&&!this.loading&&this.loaded?"faded-out":""},_computeImgDivHidden:function(){return!this.sizing},_computeImgDivARIAHidden:function(){return""===this.alt?"true":void 0},_computeImgDivARIALabel:function(){return null!==this.alt?this.alt:""===this.src?"":this._resolveSrc(this.src).replace(/[?|#].*/g,"").split("/").pop()},_computeImgHidden:function(){return!!this.sizing},_widthChanged:function(){this.style.width=isNaN(this.width)?this.width:this.width+"px"},_heightChanged:function(){this.style.height=isNaN(this.height)?this.height:this.height+"px"},_loadStateObserver:function(e,t){var i=this._resolveSrc(e);i!==this._resolvedSrc&&(this._resolvedSrc="",this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage="",""===e||t?(this._setLoading(!1),this._setLoaded(!1),this._setError(!1)):(this._resolvedSrc=i,this.$.img.src=this._resolvedSrc,this.$.sizedImgDiv.style.backgroundImage='url("'+this._resolvedSrc+'")',this._setLoading(!0),this._setLoaded(!1),this._setError(!1)))},_placeholderChanged:function(){this.$.placeholder.style.backgroundImage=this.placeholder?'url("'+this.placeholder+'")':""},_transformChanged:function(){var e=this.$.sizedImgDiv.style,t=this.$.placeholder.style;e.backgroundSize=t.backgroundSize=this.sizing,e.backgroundPosition=t.backgroundPosition=this.sizing?this.position:"",e.backgroundRepeat=t.backgroundRepeat=this.sizing?"no-repeat":""},_resolveSrc:function(e){var t=H(e,this.$.baseURIAnchor.href);return t.length>=2&&"/"===t[0]&&"/"!==t[1]&&(t=(location.origin||location.protocol+"//"+location.host)+t),t}}),zh({_template:mi`
    <style include="paper-material-styles">
      :host {
        display: inline-block;
        position: relative;
        box-sizing: border-box;
        background-color: var(--paper-card-background-color, var(--primary-background-color));
        border-radius: 2px;

        @apply --paper-font-common-base;
        @apply --paper-card;
      }

      /* IE 10 support for HTML5 hidden attr */
      :host([hidden]), [hidden] {
        display: none !important;
      }

      .header {
        position: relative;
        border-top-left-radius: inherit;
        border-top-right-radius: inherit;
        overflow: hidden;

        @apply --paper-card-header;
      }

      .header iron-image {
        display: block;
        width: 100%;
        --iron-image-width: 100%;
        pointer-events: none;

        @apply --paper-card-header-image;
      }

      .header .title-text {
        padding: 16px;
        font-size: 24px;
        font-weight: 400;
        color: var(--paper-card-header-color, #000);

        @apply --paper-card-header-text;
      }

      .header .title-text.over-image {
        position: absolute;
        bottom: 0px;

        @apply --paper-card-header-image-text;
      }

      :host ::slotted(.card-content) {
        padding: 16px;
        position:relative;

        @apply --paper-card-content;
      }

      :host ::slotted(.card-actions) {
        border-top: 1px solid #e8e8e8;
        padding: 5px 16px;
        position:relative;

        @apply --paper-card-actions;
      }

      :host([elevation="1"]) {
        @apply --paper-material-elevation-1;
      }

      :host([elevation="2"]) {
        @apply --paper-material-elevation-2;
      }

      :host([elevation="3"]) {
        @apply --paper-material-elevation-3;
      }

      :host([elevation="4"]) {
        @apply --paper-material-elevation-4;
      }

      :host([elevation="5"]) {
        @apply --paper-material-elevation-5;
      }
    </style>

    <div class="header">
      <iron-image hidden\$="[[!image]]" aria-hidden\$="[[_isHidden(image)]]" src="[[image]]" alt="[[alt]]" placeholder="[[placeholderImage]]" preload="[[preloadImage]]" fade="[[fadeImage]]"></iron-image>
      <div hidden\$="[[!heading]]" class\$="title-text [[_computeHeadingClass(image)]]">[[heading]]</div>
    </div>

    <slot></slot>
`,is:"paper-card",properties:{heading:{type:String,value:"",observer:"_headingChanged"},image:{type:String,value:""},alt:{type:String},preloadImage:{type:Boolean,value:!1},fadeImage:{type:Boolean,value:!1},placeholderImage:{type:String,value:null},elevation:{type:Number,value:1,reflectToAttribute:!0},animatedShadow:{type:Boolean,value:!1},animated:{type:Boolean,reflectToAttribute:!0,readOnly:!0,computed:"_computeAnimated(animatedShadow)"}},_isHidden:function(e){return e?"false":"true"},_headingChanged:function(e){var t=this.getAttribute("heading"),i=this.getAttribute("aria-label");"string"==typeof i&&i!==t||this.setAttribute("aria-label",e)},_computeHeadingClass:function(e){return e?" over-image":""},_computeAnimated:function(e){return e}});const MS=mi`<style>
  :host {
    display: inline-block;
    white-space: nowrap;
    cursor: pointer;
    --calculated-paper-checkbox-size: var(--paper-checkbox-size, 18px);
    /* -1px is a sentinel for the default and is replaced in \`attached\`. */
    --calculated-paper-checkbox-ink-size: var(--paper-checkbox-ink-size, -1px);
    @apply --paper-font-common-base;
    line-height: 0;
    -webkit-tap-highlight-color: transparent;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host(:focus) {
    outline: none;
  }

  .hidden {
    display: none;
  }

  #checkboxContainer {
    display: inline-block;
    position: relative;
    width: var(--calculated-paper-checkbox-size);
    height: var(--calculated-paper-checkbox-size);
    min-width: var(--calculated-paper-checkbox-size);
    margin: var(--paper-checkbox-margin, initial);
    vertical-align: var(--paper-checkbox-vertical-align, middle);
    background-color: var(--paper-checkbox-unchecked-background-color, transparent);
  }

  #ink {
    position: absolute;

    /* Center the ripple in the checkbox by negative offsetting it by
     * (inkWidth - rippleWidth) / 2 */
    top: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    left: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    width: var(--calculated-paper-checkbox-ink-size);
    height: var(--calculated-paper-checkbox-ink-size);
    color: var(--paper-checkbox-unchecked-ink-color, var(--primary-text-color));
    opacity: 0.6;
    pointer-events: none;
  }

  #ink:dir(rtl) {
    right: calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);
    left: auto;
  }

  #ink[checked] {
    color: var(--paper-checkbox-checked-ink-color, var(--primary-color));
  }

  #checkbox {
    position: relative;
    box-sizing: border-box;
    height: 100%;
    border: solid 2px;
    border-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
    border-radius: 2px;
    pointer-events: none;
    -webkit-transition: background-color 140ms, border-color 140ms;
    transition: background-color 140ms, border-color 140ms;

    -webkit-transition-duration: var(--paper-checkbox-animation-duration, 140ms);
    transition-duration: var(--paper-checkbox-animation-duration, 140ms);
  }

  /* checkbox checked animations */
  #checkbox.checked #checkmark {
    -webkit-animation: checkmark-expand 140ms ease-out forwards;
    animation: checkmark-expand 140ms ease-out forwards;

    -webkit-animation-duration: var(--paper-checkbox-animation-duration, 140ms);
    animation-duration: var(--paper-checkbox-animation-duration, 140ms);
  }

  @-webkit-keyframes checkmark-expand {
    0% {
      -webkit-transform: scale(0, 0) rotate(45deg);
    }
    100% {
      -webkit-transform: scale(1, 1) rotate(45deg);
    }
  }

  @keyframes checkmark-expand {
    0% {
      transform: scale(0, 0) rotate(45deg);
    }
    100% {
      transform: scale(1, 1) rotate(45deg);
    }
  }

  #checkbox.checked {
    background-color: var(--paper-checkbox-checked-color, var(--primary-color));
    border-color: var(--paper-checkbox-checked-color, var(--primary-color));
  }

  #checkmark {
    position: absolute;
    width: 36%;
    height: 70%;
    border-style: solid;
    border-top: none;
    border-left: none;
    border-right-width: calc(2/15 * var(--calculated-paper-checkbox-size));
    border-bottom-width: calc(2/15 * var(--calculated-paper-checkbox-size));
    border-color: var(--paper-checkbox-checkmark-color, white);
    -webkit-transform-origin: 97% 86%;
    transform-origin: 97% 86%;
    box-sizing: content-box; /* protect against page-level box-sizing */
  }

  #checkmark:dir(rtl) {
    -webkit-transform-origin: 50% 14%;
    transform-origin: 50% 14%;
  }

  /* label */
  #checkboxLabel {
    position: relative;
    display: inline-block;
    vertical-align: middle;
    padding-left: var(--paper-checkbox-label-spacing, 8px);
    white-space: normal;
    line-height: normal;
    color: var(--paper-checkbox-label-color, var(--primary-text-color));
    @apply --paper-checkbox-label;
  }

  :host([checked]) #checkboxLabel {
    color: var(--paper-checkbox-label-checked-color, var(--paper-checkbox-label-color, var(--primary-text-color)));
    @apply --paper-checkbox-label-checked;
  }

  #checkboxLabel:dir(rtl) {
    padding-right: var(--paper-checkbox-label-spacing, 8px);
    padding-left: 0;
  }

  #checkboxLabel[hidden] {
    display: none;
  }

  /* disabled state */

  :host([disabled]) #checkbox {
    opacity: 0.5;
    border-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
  }

  :host([disabled][checked]) #checkbox {
    background-color: var(--paper-checkbox-unchecked-color, var(--primary-text-color));
    opacity: 0.5;
  }

  :host([disabled]) #checkboxLabel  {
    opacity: 0.65;
  }

  /* invalid state */
  #checkbox.invalid:not(.checked) {
    border-color: var(--paper-checkbox-error-color, var(--error-color));
  }
</style>

<div id="checkboxContainer">
  <div id="checkbox" class$="[[_computeCheckboxClass(checked, invalid)]]">
    <div id="checkmark" class$="[[_computeCheckmarkClass(checked)]]"></div>
  </div>
</div>

<div id="checkboxLabel"><slot></slot></div>`;MS.setAttribute("strip-whitespace",""),zh({_template:MS,is:"paper-checkbox",behaviors:[cy],hostAttributes:{role:"checkbox","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},attached:function(){hh(this,(function(){if("-1px"===this.getComputedStyleValue("--calculated-paper-checkbox-ink-size").trim()){var e=this.getComputedStyleValue("--calculated-paper-checkbox-size").trim(),t="px",i=e.match(/[A-Za-z]+$/);null!==i&&(t=i[0]);var n=parseFloat(e),o=8/3*n;"px"===t&&(o=Math.floor(o))%2!=n%2&&o++,this.updateStyles({"--paper-checkbox-ink-size":o+t})}}))},_computeCheckboxClass:function(e,t){var i="";return e&&(i+="checked "),t&&(i+="invalid"),i},_computeCheckmarkClass:function(e){return e?"":"hidden"},_createRipple:function(){return this._rippleContainer=this.$.checkboxContainer,Qv._createRipple.call(this)}});const FS={properties:{animationTiming:{type:Object,value:function(){return{duration:500,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"both"}}}},isNeonAnimation:!0,created:function(){document.body.animate||console.warn("No web animations detected. This element will not function without a web animations polyfill.")},timingFromConfig:function(e){if(e.timing)for(var t in e.timing)this.animationTiming[t]=e.timing[t];return this.animationTiming},setPrefixedProperty:function(e,t,i){for(var n,o={transform:["webkitTransform"],transformOrigin:["mozTransformOrigin","webkitTransformOrigin"]}[t],r=0;n=o[r];r++)e.style[n]=i;e.style[t]=i},complete:function(e){}};zh({is:"fade-in-animation",behaviors:[FS],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"0"},{opacity:"1"}],this.timingFromConfig(e)),this._effect}}),zh({is:"fade-out-animation",behaviors:[FS],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"1"},{opacity:"0"}],this.timingFromConfig(e)),this._effect}}),zh({is:"paper-menu-grow-height-animation",_template:null,behaviors:[FS],configure:function(e){var t=e.node,i=t.getBoundingClientRect().height;return this._effect=new KeyframeEffect(t,[{height:i/2+"px"},{height:i+"px"}],this.timingFromConfig(e)),this._effect}}),zh({is:"paper-menu-grow-width-animation",_template:null,behaviors:[FS],configure:function(e){var t=e.node,i=t.getBoundingClientRect().width;return this._effect=new KeyframeEffect(t,[{width:i/2+"px"},{width:i+"px"}],this.timingFromConfig(e)),this._effect}}),zh({is:"paper-menu-shrink-width-animation",_template:null,behaviors:[FS],configure:function(e){var t=e.node,i=t.getBoundingClientRect().width;return this._effect=new KeyframeEffect(t,[{width:i+"px"},{width:i-i/20+"px"}],this.timingFromConfig(e)),this._effect}}),zh({is:"paper-menu-shrink-height-animation",_template:null,behaviors:[FS],configure:function(e){var t=e.node,i=t.getBoundingClientRect().height;return this.setPrefixedProperty(t,"transformOrigin","0 0"),this._effect=new KeyframeEffect(t,[{height:i+"px",transform:"translateY(0)"},{height:i/2+"px",transform:"translateY(-20px)"}],this.timingFromConfig(e)),this._effect}});var $S={ANIMATION_CUBIC_BEZIER:"cubic-bezier(.3,.95,.5,1)",MAX_ANIMATION_TIME_MS:400};const BS=zh({_template:mi`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;

        @apply --paper-menu-button;
      }

      :host([disabled]) {
        cursor: auto;
        color: var(--disabled-text-color);

        @apply --paper-menu-button-disabled;
      }

      iron-dropdown {
        @apply --paper-menu-button-dropdown;
      }

      .dropdown-content {
        @apply --shadow-elevation-2dp;

        position: relative;
        border-radius: 2px;
        background-color: var(--paper-menu-button-dropdown-background, var(--primary-background-color));

        @apply --paper-menu-button-content;
      }

      :host([vertical-align="top"]) .dropdown-content {
        margin-bottom: 20px;
        margin-top: -10px;
        top: 10px;
      }

      :host([vertical-align="bottom"]) .dropdown-content {
        bottom: 10px;
        margin-bottom: -10px;
        margin-top: 20px;
      }

      #trigger {
        cursor: pointer;
      }
    </style>

    <div id="trigger" on-tap="toggle">
      <slot name="dropdown-trigger"></slot>
    </div>

    <iron-dropdown id="dropdown" opened="{{opened}}" horizontal-align="[[horizontalAlign]]" vertical-align="[[verticalAlign]]" dynamic-align="[[dynamicAlign]]" horizontal-offset="[[horizontalOffset]]" vertical-offset="[[verticalOffset]]" no-overlap="[[noOverlap]]" open-animation-config="[[openAnimationConfig]]" close-animation-config="[[closeAnimationConfig]]" no-animations="[[noAnimations]]" focus-target="[[_dropdownContent]]" allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]" on-iron-overlay-canceled="__onIronOverlayCanceled" expand-sizing-target-for-scrollbars="[[expandSizingTargetForScrollbars]]">
      <div slot="dropdown-content" class="dropdown-content">
        <slot id="content" name="dropdown-content"></slot>
      </div>
    </iron-dropdown>
`,is:"paper-menu-button",behaviors:[qp,lf],properties:{opened:{type:Boolean,value:!1,notify:!0,observer:"_openedChanged"},horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},noOverlap:{type:Boolean},noAnimations:{type:Boolean,value:!1},ignoreSelect:{type:Boolean,value:!1},closeOnActivate:{type:Boolean,value:!1},openAnimationConfig:{type:Object,value:function(){return[{name:"fade-in-animation",timing:{delay:100,duration:200}},{name:"paper-menu-grow-width-animation",timing:{delay:100,duration:150,easing:$S.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-grow-height-animation",timing:{delay:100,duration:275,easing:$S.ANIMATION_CUBIC_BEZIER}}]}},closeAnimationConfig:{type:Object,value:function(){return[{name:"fade-out-animation",timing:{duration:150}},{name:"paper-menu-shrink-width-animation",timing:{delay:100,duration:50,easing:$S.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-shrink-height-animation",timing:{duration:200,easing:"ease-in"}}]}},allowOutsideScroll:{type:Boolean,value:!1},restoreFocusOnClose:{type:Boolean,value:!0},expandSizingTargetForScrollbars:{type:Boolean,value:!1},_dropdownContent:{type:Object}},hostAttributes:{role:"group","aria-haspopup":"true"},listeners:{"iron-activate":"_onIronActivate","iron-select":"_onIronSelect"},get contentElement(){for(var e=Th(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},toggle:function(){this.opened?this.close():this.open()},open:function(){this.disabled||this.$.dropdown.open()},close:function(){this.$.dropdown.close()},_onIronSelect:function(e){this.ignoreSelect||this.close()},_onIronActivate:function(e){this.closeOnActivate&&this.close()},_openedChanged:function(e,t){e?(this._dropdownContent=this.contentElement,this.fire("paper-dropdown-open")):null!=t&&this.fire("paper-dropdown-close")},_disabledChanged:function(e){lf._disabledChanged.apply(this,arguments),e&&this.opened&&this.close()},__onIronOverlayCanceled:function(e){var t=e.detail,i=this.$.trigger;Th(t).path.indexOf(i)>-1&&e.preventDefault()}});Object.keys($S).forEach((function(e){BS[e]=$S[e]}));const jS=document.createElement("template");jS.setAttribute("style","display: none;"),jS.innerHTML='<iron-iconset-svg name="paper-dropdown-menu" size="24">\n<svg><defs>\n<g id="arrow-drop-down"><path d="M7 10l5 5 5-5z"></path></g>\n</defs></svg>\n</iron-iconset-svg>',document.head.appendChild(jS.content);const HS=document.createElement("template");HS.setAttribute("style","display: none;"),HS.innerHTML='<dom-module id="paper-dropdown-menu-shared-styles">\n  <template>\n    <style>\n      :host {\n        display: inline-block;\n        position: relative;\n        text-align: left;\n\n        /* NOTE(cdata): Both values are needed, since some phones require the\n         * value to be `transparent`.\n         */\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n        -webkit-tap-highlight-color: transparent;\n\n        --paper-input-container-input: {\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          max-width: 100%;\n          box-sizing: border-box;\n          cursor: pointer;\n        };\n\n        @apply --paper-dropdown-menu;\n      }\n\n      /* paper-dropdown-menu and paper-dropdown-menu-light both delegate focus\n       * to other internal elements which manage focus styling. */\n      :host(:focus) {\n        outline: none;\n      }\n\n      :host(:dir(rtl)) {\n        text-align: right;\n\n        @apply(--paper-dropdown-menu);\n      }\n\n      :host([disabled]) {\n        @apply --paper-dropdown-menu-disabled;\n      }\n\n      :host([noink]) paper-ripple {\n        display: none;\n      }\n\n      :host([no-label-float]) paper-ripple {\n        top: 8px;\n      }\n\n      paper-ripple {\n        top: 12px;\n        left: 0px;\n        bottom: 8px;\n        right: 0px;\n\n        @apply --paper-dropdown-menu-ripple;\n      }\n\n      paper-menu-button {\n        display: block;\n        padding: 0;\n\n        @apply --paper-dropdown-menu-button;\n      }\n\n      paper-input {\n        @apply --paper-dropdown-menu-input;\n      }\n\n      iron-icon {\n        color: var(--disabled-text-color);\n\n        @apply --paper-dropdown-menu-icon;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(HS.content);const US=Lh(HTMLElement);zh({_template:mi`
    <style include="paper-dropdown-menu-shared-styles"></style>

    <paper-menu-button id="menuButton" vertical-align="[[verticalAlign]]" horizontal-align="[[horizontalAlign]]" dynamic-align="[[dynamicAlign]]" vertical-offset="[[_computeMenuVerticalOffset(noLabelFloat, verticalOffset)]]" disabled="[[disabled]]" no-animations="[[noAnimations]]" on-iron-select="_onIronSelect" on-iron-deselect="_onIronDeselect" opened="{{opened}}" close-on-activate allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]" expand-sizing-target-for-scrollbars="[[expandSizingTargetForScrollbars]]">
      <!-- support hybrid mode: user might be using paper-menu-button 1.x which distributes via <content> -->
      <div class="dropdown-trigger" slot="dropdown-trigger">
        <paper-ripple></paper-ripple>
        <!-- paper-input has type="text" for a11y, do not remove -->
        <paper-input id="input" type="text" invalid="[[invalid]]" readonly disabled="[[disabled]]" value="[[value]]" placeholder="[[placeholder]]" error-message="[[errorMessage]]" always-float-label="[[alwaysFloatLabel]]" no-label-float="[[noLabelFloat]]" label="[[label]]" input-role="button" input-aria-haspopup="listbox" autocomplete="off">
          <!-- support hybrid mode: user might be using paper-input 1.x which distributes via <content> -->
          <iron-icon icon="paper-dropdown-menu:arrow-drop-down" suffix slot="suffix"></iron-icon>
        </paper-input>
      </div>
      <slot id="content" name="dropdown-content" slot="dropdown-content"></slot>
    </paper-menu-button>
`,is:"paper-dropdown-menu",behaviors:[ff,lf,V_,P_],properties:{selectedItemLabel:{type:String,notify:!0,readOnly:!0},selectedItem:{type:Object,notify:!0,readOnly:!0},value:{type:String,notify:!0},label:{type:String},placeholder:{type:String},errorMessage:{type:String},opened:{type:Boolean,notify:!0,value:!1,observer:"_openedChanged"},allowOutsideScroll:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1,reflectToAttribute:!0},alwaysFloatLabel:{type:Boolean,value:!1},noAnimations:{type:Boolean,value:!1},horizontalAlign:{type:String,value:"right"},verticalAlign:{type:String,value:"top"},verticalOffset:Number,dynamicAlign:{type:Boolean},restoreFocusOnClose:{type:Boolean,value:!0},expandSizingTargetForScrollbars:{type:Boolean,value:!1}},listeners:{tap:"_onTap"},keyBindings:{"up down":"open",esc:"close"},observers:["_selectedItemChanged(selectedItem)"],_attachDom(e){const t=Me(this);return t.attachShadow({mode:"open",delegatesFocus:!0,shadyUpgradeFragment:e}),t.shadowRoot.appendChild(e),US.prototype._attachDom.call(this,e)},focus(){this.$.input._focusableElement.focus()},attached:function(){var e=this.contentElement;e&&e.selectedItem&&this._setSelectedItem(e.selectedItem)},get contentElement(){for(var e=Th(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},open:function(){this.$.menuButton.open()},close:function(){this.$.menuButton.close()},_onIronSelect:function(e){this._setSelectedItem(e.detail.item)},_onIronDeselect:function(e){this._setSelectedItem(null)},_onTap:function(e){zd(e)===this&&this.open()},_selectedItemChanged:function(e){var t="";t=e?e.label||e.getAttribute("label")||e.textContent.trim():"",this.value=t,this._setSelectedItemLabel(t)},_computeMenuVerticalOffset:function(e,t){return t||(e?-4:8)},_getValidity:function(e){return this.disabled||!this.required||this.required&&!!this.value},_openedChanged:function(){var e=this.opened?"true":"false",t=this.contentElement;t&&t.setAttribute("aria-expanded",e)}});const GS=new WeakMap,zS=al(e=>t=>{if(!(t instanceof vl)||t instanceof Cl||"style"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");const{committer:i}=t,{style:n}=i.element;let o=GS.get(t);void 0===o&&(n.cssText=i.strings.join(" "),GS.set(t,o=new Set)),o.forEach(t=>{t in e||(o.delete(t),-1===t.indexOf("-")?n[t]=null:n.removeProperty(t))});for(const t in e)o.add(t),-1===t.indexOf("-")?n[t]=e[t]:n.setProperty(t,e[t])});function VS(e,t,i){return Math.max(t,Math.min(e,i))}function WS(e,t){let i,n;return e.width/e.height>t.width/t.height?(i=Math.min(t.width,e.width),n=e.height*(i/e.width)):(n=Math.min(t.height,e.height),i=e.width*(n/e.height)),{top:(t.height-n)/2,left:(t.width-i)/2,width:i,height:n,scale:i/e.width}}function qS(e,t){return{origin:{x:e.dimensions.width<=t.width?VS(e.origin.x,0,t.width-e.dimensions.width):(t.width-e.dimensions.width)/2,y:e.dimensions.height<=t.height?VS(e.origin.y,0,t.height-e.dimensions.height):(t.height-e.dimensions.height)/2},dimensions:e.dimensions}}class KS{constructor(){this.center={x:0,y:0},this.frameSize={width:0,height:0},this.bounds={width:0,height:0},this.scale=1,this.unscaledFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.scaledFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}}}getCenter(){return{...this.center}}getUnscaledFrame(){return{origin:{...this.unscaledFrame.origin},dimensions:{...this.unscaledFrame.dimensions}}}getScaledFrame(){return{origin:{...this.scaledFrame.origin},dimensions:{...this.scaledFrame.dimensions}}}requestCenter(e){this.center={...e},this.ensureFrameInBounds()}setFrameSize(e){e.width<=0||e.height<=0||(this.frameSize={...e},this.ensureFrameInBounds())}setBounds(e){e.width<=0||e.height<=0||(this.bounds={...e},this.ensureFrameInBounds())}setScale(e){!e||e<=0||(this.scale=e,this.ensureFrameInBounds())}ensureFrameInBounds(){const e=this.center.x*this.scale,t=this.center.y*this.scale,i={width:this.bounds.width*this.scale,height:this.bounds.height*this.scale},n={width:this.frameSize.width/this.scale,height:this.frameSize.height/this.scale},o={origin:{x:e-this.frameSize.width/2,y:t-this.frameSize.height/2},dimensions:this.frameSize},r={origin:{x:this.center.x-n.width/2,y:this.center.y-n.height/2},dimensions:n};this.unscaledFrame=qS(o,i),this.scaledFrame=qS(r,this.bounds),this.center={x:this.scaledFrame.origin.x+this.scaledFrame.dimensions.width/2,y:this.scaledFrame.origin.y+this.scaledFrame.dimensions.height/2}}}var YS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let XS=class extends ec{constructor(){super(...arguments),this.frameRect={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.contentStyle={},this.contentTransformStyle={},this.frameStyle={},this.overlayStyle={},this.dragging=!1,this.contentBounds={width:0,height:0},this.imageBounds={width:0,height:0},this.scale=1,this.grabOffset={x:0,y:0},this.resizeObserver=new ResizeObserver(e=>{for(const t of e)t.target===this.contentBox&&(this.contentBounds={width:t.contentRect.width,height:t.contentRect.height}),t.target===this.contentTransform&&(this.imageBounds={width:t.contentRect.width,height:t.contentRect.height}),this.updateScale()})}render(){return Pl`
      <div class="content-box">
        <div
          class="content"
          style="${zS({...this.contentStyle})}"
          @mousemove="${this.maybeDragFrame}"
          @mousedown=${this.clickOverview}
          @mouseup="${this.releaseFrame}"
        >
          <div
            class="content-transform"
            style="${zS(this.contentTransformStyle)}"
          >
            <slot></slot>
          </div>
          <div
            class="frame"
            style="${zS({...this.frameStyle,cursor:this.dragging?"grabbing":"grab"})}"
            @mousedown="${this.grabFrame}"
          ></div>
        </div>
        <div
          class="overlay"
          style="${zS({...this.overlayStyle,display:this.dragging?"block":"none"})}"
          @mousemove="${this.overlayMouseMove}"
          @mouseleave="${this.releaseFrame}"
          @mouseup="${this.releaseFrame}"
        ></div>
      </div>
    `}firstUpdated(){this.resizeObserver.observe(this.contentBox),this.resizeObserver.observe(this.contentTransform)}updated(e){e.has("frameRect")&&this.updateFrameStyle()}clickOverview(e){if(1!==e.buttons)return;e.preventDefault(),this.updateOverlaySize(),this.dragging=!0;const t=this.content.getBoundingClientRect();this.notifyNewCenter({x:(e.clientX-t.left)/this.scale,y:(e.clientY-t.top)/this.scale})}grabFrame(e){if(1!==e.buttons)return;e.preventDefault(),e.stopPropagation(),this.updateOverlaySize(),this.dragging=!0;const t=this.frame.getBoundingClientRect(),i=t.x+t.width/2,n=t.y+t.height/2;this.grabOffset={x:e.clientX-i,y:e.clientY-n}}maybeDragFrame(e){if(e.preventDefault(),!this.dragging)return;const t=this.content.getBoundingClientRect(),i={x:(e.clientX-t.left-this.grabOffset.x)/this.scale,y:(e.clientY-t.top-this.grabOffset.y)/this.scale};this.notifyNewCenter(i)}releaseFrame(e){e.preventDefault(),this.dragging=!1,this.grabOffset={x:0,y:0}}overlayMouseMove(e){e.preventDefault(),this.maybeDragFrame(e)}updateScale(){const e=WS(this.imageBounds,this.contentBounds);this.scale=e.scale,this.contentStyle={...this.contentStyle,top:`${e.top}px`,left:`${e.left}px`,width:`${e.width}px`,height:`${e.height}px`},this.contentTransformStyle={transform:`scale(${this.scale})`},this.updateFrameStyle()}updateFrameStyle(){const e=this.frameRect.origin.x*this.scale,t=this.frameRect.origin.y*this.scale,i=this.frameRect.dimensions.width*this.scale,n=this.frameRect.dimensions.height*this.scale;this.frameStyle={...this.frameStyle,transform:`translate(${e}px, ${t}px)`,width:`${i}px`,height:`${n}px`}}updateOverlaySize(){const e=this.contentBox.getBoundingClientRect(),t=window.innerWidth-20,i=window.innerHeight-20;this.overlayStyle={...this.overlayStyle,top:`-${e.top+1}px`,left:`-${e.left+1}px`,width:`${t}px`,height:`${i}px`}}notifyNewCenter(e){this.dispatchEvent(new CustomEvent("center-updated",{detail:{...e},bubbles:!0,composed:!0}))}};XS.styles=Zl`
    :host {
      --background-color: var(--overview-image-background-color, #000);
      --frame-color: var(--overview-image-frame-color, #f00);
      display: flex;
    }
    * {
      box-sizing: border-box;
    }
    ::slotted(*) {
      display: block;
    }
    .content-box {
      border: 1px solid var(--background-color);
      background-color: var(--background-color);
      width: 100%;
      position: relative;
    }
    .content {
      position: absolute;
      cursor: pointer;
    }
    .content-transform {
      position: absolute;
      transform-origin: top left;
      will-change: transform;
    }
    .frame {
      border: 1px solid var(--frame-color);
      position: absolute;
      will-change: transform;
    }
    .overlay {
      position: absolute;
      z-index: 10000;
      cursor: grabbing;
    }
  `,YS([Gl({type:Object})],XS.prototype,"frameRect",void 0),YS([zl()],XS.prototype,"contentStyle",void 0),YS([zl()],XS.prototype,"contentTransformStyle",void 0),YS([zl()],XS.prototype,"frameStyle",void 0),YS([zl()],XS.prototype,"overlayStyle",void 0),YS([zl()],XS.prototype,"dragging",void 0),YS([Vl(".content-box")],XS.prototype,"contentBox",void 0),YS([Vl(".content")],XS.prototype,"content",void 0),YS([Vl(".content-transform")],XS.prototype,"contentTransform",void 0),YS([Vl(".frame")],XS.prototype,"frame",void 0),XS=YS([Hl("gr-overview-image")],XS);var JS=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let ZS=class extends ec{constructor(){super(...arguments),this.scale=1,this.frameRect={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.imageStyles={}}render(){return Pl`
      <div id="clip">
        <div id="transform" style="${zS(this.imageStyles)}">
          <slot></slot>
        </div>
      </div>
    `}updated(e){(e.has("scale")||e.has("frameRect"))&&this.updateImageStyles()}updateImageStyles(){const{x:e,y:t}=this.frameRect.origin;this.imageStyles={"image-rendering":this.scale>=1?"pixelated":"auto",transform:`translate(${-e}px, ${-t}px) scale(${this.scale})`}}};ZS.styles=Zl`
    :host {
      display: block;
    }
    ::slotted(*) {
      display: block;
    }
    #clip {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    #transform {
      position: absolute;
      transform-origin: top left;
      will-change: transform;
    }
  `,JS([Gl({type:Number})],ZS.prototype,"scale",void 0),JS([Gl({type:Object})],ZS.prototype,"frameRect",void 0),JS([zl()],ZS.prototype,"imageStyles",void 0),ZS=JS([Hl("gr-zoomed-image")],ZS);class QS{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;const t=(e.getAttribute("class")||"").split(/\s+/);for(const e of t)this.classes.add(e)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach(t=>e+=t+" "),this.element.setAttribute("class",e)}}}const eE=new WeakMap,tE=al(e=>t=>{if(!(t instanceof vl)||t instanceof Cl||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:i}=t,{element:n}=i;let o=eE.get(t);void 0===o&&(n.setAttribute("class",i.strings.join(" ")),eE.set(t,o=new Set));const r=n.classList||new QS(n);o.forEach(t=>{t in e||(r.remove(t),o.delete(t))});for(const t in e){const i=e[t];i!=o.has(t)&&(i?(r.add(t),o.add(t)):(r.remove(t),o.delete(t)))}"function"==typeof r.commit&&r.commit()});var iE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let nE=class extends ec{constructor(){super(...arguments),this.baseUrl="",this.revisionUrl="",this.baseSelected=!0,this.scaledSelected=!0,this.followMouse=!1,this.scale=1,this.checkerboardSelected=!0,this.zoomedImageStyle={},this.imageSize={width:0,height:0},this.magnifierSize={width:0,height:0},this.magnifierFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.overviewFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.zoomLevels=["fit",1,1.25,1.5,1.75,2],this.grabbing=!1,this.ownsMouseDown=!1,this.centerOnDown={x:0,y:0},this.pointerOnDown={x:0,y:0},this.frameConstrainer=new KS,this.resizeObserver=new ResizeObserver(e=>{for(const t of e)t.target===this.imageArea&&(this.magnifierSize={width:t.contentRect.width,height:t.contentRect.height})})}render(){const e=this.baseSelected?this.baseUrl:this.revisionUrl,t=Pl`
      <img
        id="source-image"
        src="${e}"
        class="${tE({checkerboard:this.checkerboardSelected})}"
        @load="${this.updateSizes}"
      />
    `,i=Pl`
      <div id="version-explanation">
        This file is being ${this.revisionUrl?"added":"deleted"}.
      </div>
    `,n=Pl`
      <div id="version-switcher">
        <paper-button
          class="left"
          ?unelevated=${this.baseSelected}
          ?outlined=${!this.baseSelected}
          @click="${this.selectBase}"
        >
          Base
        </paper-button>
        <paper-button
          class="right"
          ?unelevated=${!this.baseSelected}
          ?outlined=${this.baseSelected}
          @click="${this.selectRevision}"
        >
          Revision
        </paper-button>
      </div>
    `,o=Pl`
      ${this.baseUrl&&this.revisionUrl?n:i}
    `,r=Pl`
      <gr-overview-image
        .frameRect="${this.overviewFrame}"
        @center-updated="${this.onOverviewCenterUpdated}"
      >
        <img src="${e}" class="checkerboard" />
      </gr-overview-image>
    `,s=Pl`
      <paper-dropdown-menu id="zoom-control" label="Zoom">
        <paper-listbox
          slot="dropdown-content"
          selected="fit"
          attr-for-selected="value"
          @selected-changed="${this.zoomControlChanged}"
        >
          ${this.zoomLevels.map(e=>Pl`
              <paper-item value="${e}">
                ${"fit"===e?"Fit":`${100*e}%`}
              </paper-item>
            `)}
        </paper-listbox>
      </paper-dropdown-menu>
    `,a=Pl`
      <paper-checkbox
        id="follow-mouse"
        ?checked="${this.followMouse}"
        @change="${this.followMouseChanged}"
      >
        Magnifier follows mouse
      </paper-checkbox>
    `,l=Math.max(this.scale,1),c=this.imageSize.width*l,d=this.imageSize.height*l,h=Pl`
      <div
        id="spacer"
        style="${zS({width:`${c}px`,height:`${d}px`})}"
      ></div>
    `,p=Pl`
      <custom-style>
        <style>
            paper-button.left {
              --paper-button: {
                border-radius: 4px 0 0 4px;
                border-width: 1px 0 1px 1px;
              }
            }
            paper-button.left[outlined] {
              --paper-button: {
                border-radius: 4px 0 0 4px;
                border-width: 1px 0 1px 1px;
                border-style: solid;
                border-color: var(--primary-button-background-color);
              }
            }
            paper-button.right {
              --paper-button: {
                border-radius: 0 4px 4px 0;
                border-width: 1px 1px 1px 0;
              }
            }
            paper-button.right[outlined] {
              --paper-button: {
                border-radius: 0 4px 4px 0;
                border-width: 1px 1px 1px 0;
                border-style: solid;
                border-color: var(--primary-button-background-color);
              }
            }
            paper-item {
              cursor: pointer;
              --paper-item-min-height: 48;
              --paper-item: {
                min-height: 48px;
                padding: 0 var(--spacing-xl);
              }
              --paper-item-focused-before: {
                background-color: var(--selection-background-color);
              }
              --paper-item-focused: {
                background-color: var(--selection-background-color);
              }
            }
          }
          paper-item:hover {
            background-color: var(--hover-background-color);
          }
        </style>
      </custom-style>
    `;return Pl`
      ${p}
      <div class="imageArea" @mousemove="${this.mousemoveMagnifier}">
        <gr-zoomed-image
          class="${tE({base:this.baseSelected,revision:!this.baseSelected})}"
          style="${zS({...this.zoomedImageStyle,cursor:this.grabbing?"grabbing":"pointer"})}"
          .scale="${this.scale}"
          .frameRect="${this.magnifierFrame}"
          @mousedown="${this.mousedownMagnifier}"
          @mouseup="${this.mouseupMagnifier}"
          @mousemove="${this.mousemoveMagnifier}"
          @mouseleave="${this.mouseleaveMagnifier}"
          @dragstart="${this.dragstartMagnifier}"
        >
          ${t}
        </gr-zoomed-image>
        ${h}
      </div>

      <paper-card class="controls">
        ${o} ${r} ${s}
        ${this.scaledSelected?"":a}
      </paper-card>
    `}firstUpdated(){this.resizeObserver.observe(this.imageArea,{box:"content-box"})}update(e){this.baseUrl||(this.baseSelected=!1),this.revisionUrl||(this.baseSelected=!0),this.updateSizes(),super.update(e)}updated(e){(e.has("baseUrl")&&this.baseSelected||e.has("revisionUrl")&&!this.baseSelected)&&this.frameConstrainer.requestCenter({x:0,y:0})}selectBase(){this.baseUrl&&(this.baseSelected=!0)}selectRevision(){this.revisionUrl&&(this.baseSelected=!1)}toggleImage(){this.baseUrl&&this.revisionUrl&&(this.baseSelected=!this.baseSelected)}zoomControlChanged(e){const t=e.detail.value;t&&("fit"===t&&(this.scaledSelected=!0),t>0&&(this.scaledSelected=!1,this.scale=t),this.updateSizes())}followMouseChanged(){this.followMouse=!this.followMouse}mousedownMagnifier(e){1===e.buttons&&(this.ownsMouseDown=!0,this.centerOnDown=this.frameConstrainer.getCenter(),this.pointerOnDown={x:e.clientX,y:e.clientY})}mouseupMagnifier(e){const t=e.clientX-this.pointerOnDown.x,i=e.clientY-this.pointerOnDown.y,n=Math.max(Math.abs(t),Math.abs(i));this.ownsMouseDown&&n<5&&this.toggleImage(),this.grabbing=!1,this.ownsMouseDown=!1}mousemoveMagnifier(e){1===e.buttons&&this.ownsMouseDown?this.handleMagnifierDrag(e):this.followMouse&&this.handleFollowMouse(e)}handleMagnifierDrag(e){this.grabbing=!0;const t=e.clientX-this.pointerOnDown.x,i=e.clientY-this.pointerOnDown.y;this.frameConstrainer.requestCenter({x:this.centerOnDown.x-t/this.scale,y:this.centerOnDown.y-i/this.scale}),this.updateFrames()}handleFollowMouse(e){const t=this.imageArea.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top,o=i/t.width,r=n/t.height;this.frameConstrainer.requestCenter({x:this.imageSize.width*o,y:this.imageSize.height*r}),this.updateFrames()}mouseleaveMagnifier(){this.grabbing=!1,this.ownsMouseDown=!1}dragstartMagnifier(e){e.preventDefault()}onOverviewCenterUpdated(e){this.frameConstrainer.requestCenter({x:e.detail.x,y:e.detail.y}),this.updateFrames()}updateFrames(){this.magnifierFrame=this.frameConstrainer.getUnscaledFrame(),this.overviewFrame=this.frameConstrainer.getScaledFrame()}updateSizes(){if(!this.sourceImage||!this.sourceImage.complete)return;if(this.imageSize={width:this.sourceImage.naturalWidth||0,height:this.sourceImage.naturalHeight||0},this.frameConstrainer.setBounds(this.imageSize),this.scaledSelected){const e=WS(this.imageSize,this.magnifierSize);this.scale=Math.min(e.scale,1)}this.frameConstrainer.setScale(this.scale);const e={width:this.imageSize.width*this.scale,height:this.imageSize.height*this.scale},t=Math.min(this.magnifierSize.width,e.width),i=Math.min(this.magnifierSize.height,e.height);this.frameConstrainer.setFrameSize({width:t,height:i}),this.updateFrames(),this.zoomedImageStyle={...this.zoomedImageStyle,width:`${t}px`,height:`${i}px`}}};nE.styles=Zl`
    :host {
      display: flex;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      font-size: var(--font-size-normal);
      --image-border-width: 2px;
    }
    .imageArea {
      box-sizing: border-box;
      flex-grow: 1;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: var(--spacing-m);
      padding: var(--image-border-width);
      max-height: 100%;
    }
    #spacer {
      visibility: hidden;
    }
    gr-zoomed-image {
      border: var(--image-border-width) solid;
      margin: calc(-1 * var(--image-border-width));
      box-sizing: content-box;
      position: absolute;
      overflow: hidden;
      cursor: pointer;
    }
    gr-zoomed-image.base {
      border-color: var(--base-image-border-color, rgb(255, 205, 210));
    }
    gr-zoomed-image.revision {
      border-color: var(--revision-image-border-color, rgb(170, 242, 170));
    }
    .checkerboard {
      --square-size: var(--checkerboard-square-size, 10px);
      --square-color: var(--checkerboard-square-color, #808080);
      background-color: var(--checkerboard-background-color, #aaaaaa);
      background-image: linear-gradient(
          45deg,
          var(--square-color) 25%,
          transparent 25%
        ),
        linear-gradient(-45deg, var(--square-color) 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, var(--square-color) 75%),
        linear-gradient(-45deg, transparent 75%, var(--square-color) 75%);
      background-size: calc(var(--square-size) * 2) calc(var(--square-size) * 2);
      background-position: 0 0, 0 var(--square-size),
        var(--square-size) calc(-1 * var(--square-size)),
        calc(-1 * var(--square-size)) 0;
    }
    .controls {
      flex-grow: 0;
      display: flex;
      flex-direction: column;
      align-self: flex-start;
      margin: var(--spacing-m);
      padding-bottom: var(--spacing-xl);
    }
    paper-button {
      padding: var(--spacing-m);
      font: var(--image-diff-button-font);
      text-transform: var(--image-diff-button-text-transform, uppercase);
    }
    paper-button[unelevated] {
      color: var(--primary-button-text-color);
      background-color: var(--primary-button-background-color);
    }
    paper-button[outlined] {
      color: var(--primary-button-background-color);
      border-color: var(--primary-button-background-color);
    }
    #version-switcher {
      display: flex;
      margin: var(--spacing-xl);
    }
    #version-switcher paper-button {
      flex-basis: 0;
      flex-grow: 1;
      margin: 0;
    }
    #version-explanation {
      color: var(--deemphasized-text-color);
      text-align: center;
      margin: var(--spacing-xl);
    }
    gr-overview-image {
      min-width: 200px;
      min-height: 150px;
    }
    #zoom-control {
      margin: 0 var(--spacing-xl);
    }
    #follow-mouse {
      margin: var(--spacing-m) var(--spacing-xl) 0;
    }
  `,iE([Gl({type:String})],nE.prototype,"baseUrl",void 0),iE([Gl({type:String})],nE.prototype,"revisionUrl",void 0),iE([zl()],nE.prototype,"baseSelected",void 0),iE([zl()],nE.prototype,"scaledSelected",void 0),iE([zl()],nE.prototype,"followMouse",void 0),iE([zl()],nE.prototype,"scale",void 0),iE([zl()],nE.prototype,"checkerboardSelected",void 0),iE([zl()],nE.prototype,"zoomedImageStyle",void 0),iE([Vl(".imageArea")],nE.prototype,"imageArea",void 0),iE([Vl("gr-zoomed-image")],nE.prototype,"zoomedImage",void 0),iE([Vl("#source-image")],nE.prototype,"sourceImage",void 0),iE([zl()],nE.prototype,"magnifierSize",void 0),iE([zl()],nE.prototype,"magnifierFrame",void 0),iE([zl()],nE.prototype,"overviewFrame",void 0),iE([zl()],nE.prototype,"grabbing",void 0),nE=iE([Hl("gr-image-viewer")],nE);const oE=/^image\/(bmp|gif|x-icon|jpeg|jpg|png|tiff|webp)$/;class rE extends LS{constructor(e,t,i,n,o,r,s=!1){super(e,t,i,[],r),this._baseImage=n,this._revisionImage=o,this._useNewImageDiffUi=s}renderDiff(){const e=this._createElement("tbody","image-diff");this._useNewImageDiffUi?(this._emitImageViewer(e),this._outputEl.appendChild(e)):(this._emitImagePair(e),this._emitImageLabels(e),this._outputEl.appendChild(e),this._outputEl.appendChild(this._createEndpoint()))}_createEndpoint(){const e=this._createElement("tbody"),t=this._createElement("tr"),i=this._createElement("td");i.setAttribute("colspan","4");const n=this._createElement("gr-endpoint-decorator");return n.setAttribute("name","image-diff"),n.appendChild(this._createEndpointParam("baseImage",this._baseImage)),n.appendChild(this._createEndpointParam("revisionImage",this._revisionImage)),i.appendChild(n),t.appendChild(i),e.appendChild(t),e}_createEndpointParam(e,t){const i=this._createElement("gr-endpoint-param");return i.name=e,i.value=t,i}_emitImageViewer(e){const t=this._createElement("tr"),i=this._createElement("td");i.setAttribute("colspan","4");const n=this._createElement("gr-image-viewer");n.baseUrl=this._getImageSrc(this._baseImage),n.revisionUrl=this._getImageSrc(this._revisionImage),i.appendChild(n),t.appendChild(i),e.appendChild(t)}_getImageSrc(e){return e&&oE.test(e.type)?`data:${e.type};base64,${e.body}`:""}_emitImagePair(e){const t=this._createElement("tr");t.appendChild(this._createElement("td","left lineNum blank")),t.appendChild(this._createImageCell(this._baseImage,"left",e)),t.appendChild(this._createElement("td","right lineNum blank")),t.appendChild(this._createImageCell(this._revisionImage,"right",e)),e.appendChild(t)}_createImageCell(e,t,i){const n=this._createElement("td",t),o=this._getImageSrc(e);if(e&&o){const r=this._createElement("img");r.onload=()=>{e._height=r.naturalHeight,e._width=r.naturalWidth,this._updateImageLabel(i,t,e)},r.addEventListener("error",e=>{r.remove(),n.textContent="[Image failed to load] "+e.type}),r.setAttribute("src",o),n.appendChild(r)}return n}_updateImageLabel(e,t,i){const n=e.querySelector("."+t+" span.label");this._setLabelText(n,i)}_setLabelText(e,t){e.textContent=function(e){var t;if(e){const i=null!==(t=e.type)&&void 0!==t?t:e._expectedType;return e._width&&e._height?`${e._width}${e._height} ${i}`:i}return"No image"}(t)}_emitImageLabels(e){var t,i,n,o;const r=this._createElement("tr");let s=!1;this._baseImage&&this._revisionImage&&this._baseImage._name!==this._revisionImage._name&&(s=!0),r.appendChild(this._createElement("td","left lineNum blank"));let a,l=this._createElement("td","left"),c=this._createElement("label"),d=this._createElement("span","label");s&&(a=this._createElement("span","name"),a.textContent=null!==(i=null===(t=this._baseImage)||void 0===t?void 0:t._name)&&void 0!==i?i:"",c.appendChild(a),c.appendChild(this._createElement("br"))),this._setLabelText(d,this._baseImage),c.appendChild(d),l.appendChild(c),r.appendChild(l),r.appendChild(this._createElement("td","right lineNum blank")),l=this._createElement("td","right"),c=this._createElement("label"),d=this._createElement("span","label"),s&&(a=this._createElement("span","name"),a.textContent=null!==(o=null===(n=this._revisionImage)||void 0===n?void 0:n._name)&&void 0!==o?o:"",c.appendChild(a),c.appendChild(this._createElement("br"))),this._setLabelText(d,this._revisionImage),c.appendChild(d),l.appendChild(c),r.appendChild(l),e.appendChild(r)}}class sE extends NS{constructor(e,t,i,n=[],o){super(e,t,i,n,o),this.layers=n}_getMoveControlsConfig(){return{numberOfCells:3,movedOutIndex:2,movedInIndex:2}}buildSectionElement(e){const t=this._createElement("tbody","section");if(t.classList.add(e.type),this._isTotal(e)&&t.classList.add("total"),e.dueToRebase&&t.classList.add("dueToRebase"),e.moveDetails&&(t.classList.add("dueToMove"),t.appendChild(this._buildMoveControls(e))),e.ignoredWhitespaceOnly&&t.classList.add("ignoredWhitespaceOnly"),e.type===dS.CONTEXT_CONTROL)return this._createContextControls(t,e.contextGroups,Gi.UNIFIED),t;for(let i=0;i<e.lines.length;++i){const n=e.lines[i];e.ignoredWhitespaceOnly&&n.type===Wi.REMOVE||t.appendChild(this._createRow(n))}return t}addColumns(e,t){const i=4*t,n=document.createElement("colgroup");let o=this._createElement("col","blame");n.appendChild(o),o=document.createElement("col"),o.setAttribute("width",i.toString()),n.appendChild(o),o=document.createElement("col"),o.setAttribute("width",i.toString()),n.appendChild(o),n.appendChild(document.createElement("col")),e.appendChild(n)}_createRow(e){const t=this._createElement("tr",e.type);t.classList.add("diff-row","unified"),t.tabIndex=-1,t.appendChild(this._createBlameCell(e.beforeNumber));let i=this._createLineEl(e,e.beforeNumber,Wi.REMOVE,zi.LEFT);return t.appendChild(i),i=this._createLineEl(e,e.afterNumber,Wi.ADD,zi.RIGHT),t.appendChild(i),t.appendChild(this._createTextEl(i,e)),t}_getNextContentOnSide(e,t){let i=e.parentElement.parentElement;for(;i=i.nextSibling;)if(i.classList.contains("both")||"left"===t&&i.classList.contains("remove")||"right"===t&&i.classList.contains("add"))return i.querySelector(".contentText");return null}}class aE extends sE{constructor(e,t,i){super(e,t,i)}buildSectionElement(){const e=this._createElement("tbody","binary-diff"),t=new lS(Wi.BOTH,"FILE","FILE"),i=this._createRow(t);return i.querySelector("td.both.file").textContent=" Difference in binary files",e.appendChild(i),e}}var lE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const cE=/\s+$/;let dE=class extends fi{constructor(){super(...arguments),this.baseImage=null,this.revisionImage=null,this._groups=[],this.layers=[],this._layers=[],this.commentRanges=[],this.coverageRanges=[],this.useNewImageDiffUi=!1,this._cancelableRenderPromise=null}static get template(){return DS}disconnectedCallback(){this._builder&&this._builder.clear(),super.disconnectedCallback()}get diffElement(){return this.querySelector("#diffTable")}_computeLeftCoverageRanges(e){return e.filter(e=>e&&"left"===e.side)}_computeRightCoverageRanges(e){return e.filter(e=>e&&"right"===e.side)}render(e,t,i){if(this._setupAnnotationLayers(),this._showTabs=!!t.show_tabs,this._showTrailingWhitespace=!!t.show_whitespace_errors,this.cancel(),this._builder&&this._builder.clear(),!this.diff)throw Error("Cannot render a diff without DiffInfo.");this._builder=this._getDiffBuilder(this.diff,t,i),this.$.processor.context=t.context,this.$.processor.keyLocations=e,this._clearDiffContent(),this._builder.addColumns(this.diffElement,t.font_size);const n=!(!this.isImageDiff&&!this.diff.binary);return bi(this,"render-start"),this._cancelableRenderPromise=mS.makeCancelable(this.$.processor.process(this.diff.content,n).then(()=>{this.isImageDiff&&this._builder.renderDiff(),bi(this,"render-content")})),this._cancelableRenderPromise.finally(()=>{this._cancelableRenderPromise=null}).catch(e=>{if(!e.isCanceled)return Promise.reject(e)})}_setupAnnotationLayers(){const e=[this._createTrailingWhitespaceLayer(),this._createIntralineLayer(),this._createTabIndicatorLayer(),this._createSpecialCharacterIndicatorLayer(),this.$.rangeLayer,this.$.coverageLayerLeft,this.$.coverageLayerRight];this.layers&&e.push(...this.layers),this._layers=e}getLineElByChild(e){for(var t,i;e;){if(e instanceof Element){if(e.classList.contains("lineNum"))return e;if(e.classList.contains("section"))return null}e=null!==(i=null!==(t=e.previousSibling)&&void 0!==t?t:e.parentElement)&&void 0!==i?i:void 0}return null}getLineNumberByChild(e){return SS(this.getLineElByChild(e))}getContentTdByLine(e,t,i){return this._builder?this._builder.getContentTdByLine(e,t,i):null}_getDiffRowByChild(e){for(;!e.classList.contains("diff-row")&&e.parentElement;)e=e.parentElement;return e}getContentTdByLineEl(e){if(!e)return null;const t=SS(e);if(!t)return null;const i=this.getSideByLineEl(e),n=this._getDiffRowByChild(e);return this.getContentTdByLine(t,i,n)}getLineElByNumber(e,t){const i=t?"."+t:"";return this.diffElement.querySelector(`.lineNum[data-value="${e}"]${i}`)}getSideByLineEl(e){return e.classList.contains(zi.RIGHT)?zi.RIGHT:zi.LEFT}emitGroup(e,t){this._builder&&this._builder.emitGroup(e,t)}showContext(e,t){if(!this._builder)return;const i=this._builder.groups,n=i.findIndex(e=>e.element===t);i.splice(n,1,...e);for(const i of e)this._builder.emitGroup(i,t);t.parentNode&&t.parentNode.removeChild(t),setTimeout(()=>bi(this,"render-content"),1)}cancel(){this.$.processor.cancel(),this._cancelableRenderPromise&&(this._cancelableRenderPromise.cancel(),this._cancelableRenderPromise=null)}_handlePreferenceError(e){throw Ci(this,`The value of the '${e}' user preference is `+"invalid. Fix in diff preferences"),Error(`Invalid preference value: ${e}`)}_getDiffBuilder(e,t,i){(isNaN(t.tab_size)||t.tab_size<=0)&&this._handlePreferenceError("tab size"),(isNaN(t.line_length)||t.line_length<=0)&&this._handlePreferenceError("diff width");const n={...t};"/COMMIT_MSG"===this.path&&(n.line_length=72);let o=null;if(this.isImageDiff)o=new rE(e,n,this.diffElement,this.baseImage,this.revisionImage,i,this.useNewImageDiffUi);else{if(e.binary)return new aE(e,n,this.diffElement);this.viewMode===Gi.SIDE_BY_SIDE?o=new LS(e,n,this.diffElement,this._layers,i):this.viewMode===Gi.UNIFIED&&(o=new sE(e,n,this.diffElement,this._layers,i))}if(!o)throw Error(`Unsupported diff view mode: ${this.viewMode}`);return o}_clearDiffContent(){this.diffElement.innerHTML=""}_groupsChanged(e){if(e&&this._builder)for(const t of e.indexSplices){let e;for(let i=0;i<t.addedCount;i++)e=t.object[t.index+i],this._builder.groups.push(e),this._builder.emitGroup(e,null)}}_createIntralineLayer(){return{annotate(e,t,i){for(const t of i.highlights){if(t.startIndex===t.endIndex)continue;const n=void 0===t.endIndex?i.text.length:t.endIndex;Dm.annotateElement(e,t.startIndex,n-t.startIndex,"style-scope gr-diff intraline")}}}}_createTabIndicatorLayer(){const e=()=>this._showTabs;return{annotate(t,i,n){if(!e())return;const o=n.text.split("\t");if(o)for(let e=0,i=0;e<o.length-1;e++)i+=o[e].length,Dm.annotateElement(t,i,1,"style-scope gr-diff tab-indicator"),i++}}}_createSpecialCharacterIndicatorLayer(){return{annotate(e,t,i){const n=i.text.split("");if(n&&!(n.length<2))for(let t=0,i=0;t<n.length-1;t++)i+=n[t].length,Dm.annotateElement(e,i,1,"style-scope gr-diff special-char-indicator"),i++}}}_createTrailingWhitespaceLayer(){const e=()=>this._showTrailingWhitespace;return{annotate(t,i,n){if(!e())return;const o=n.text.match(cE);if(o){const e=Dm.getStringLength(n.text.substr(0,o.index)),i=Dm.getStringLength(o[0]);Dm.annotateElement(t,e,i,"style-scope gr-diff trailing-whitespace")}}}}setBlame(e){this._builder&&this._builder.setBlame(e)}};lE([Oo({type:Object})],dE.prototype,"diff",void 0),lE([Oo({type:String})],dE.prototype,"changeNum",void 0),lE([Oo({type:String})],dE.prototype,"patchNum",void 0),lE([Oo({type:String})],dE.prototype,"viewMode",void 0),lE([Oo({type:Boolean})],dE.prototype,"isImageDiff",void 0),lE([Oo({type:Object})],dE.prototype,"baseImage",void 0),lE([Oo({type:Object})],dE.prototype,"revisionImage",void 0),lE([Oo({type:Number})],dE.prototype,"parentIndex",void 0),lE([Oo({type:String})],dE.prototype,"path",void 0),lE([Oo({type:Object})],dE.prototype,"_builder",void 0),lE([Oo({type:Array})],dE.prototype,"_groups",void 0),lE([Oo({type:Array})],dE.prototype,"layers",void 0),lE([Oo({type:Array})],dE.prototype,"_layers",void 0),lE([Oo({type:Boolean})],dE.prototype,"_showTabs",void 0),lE([Oo({type:Boolean})],dE.prototype,"_showTrailingWhitespace",void 0),lE([Oo({type:Array})],dE.prototype,"commentRanges",void 0),lE([Oo({type:Array})],dE.prototype,"coverageRanges",void 0),lE([Oo({type:Boolean})],dE.prototype,"useNewImageDiffUi",void 0),lE([Oo({type:Array,computed:"_computeLeftCoverageRanges(coverageRanges)"})],dE.prototype,"_leftCoverageRanges",void 0),lE([Oo({type:Array,computed:"_computeRightCoverageRanges(coverageRanges)"})],dE.prototype,"_rightCoverageRanges",void 0),lE([Oo({type:Object})],dE.prototype,"_cancelableRenderPromise",void 0),lE([No("_groups.splices")],dE.prototype,"_groupsChanged",null),dE=lE([Po("gr-diff-builder")],dE);const hE=mi`
  <style include="shared-styles">
    :host {
      cursor: pointer;
      font-family: var(--font-family);
      position: absolute;
      white-space: nowrap;
    }
  </style>
  <gr-tooltip
    id="tooltip"
    text="Press c to comment"
    position-below="[[positionBelow]]"
  ></gr-tooltip>
`;var pE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let uE=class extends fi{constructor(){super(),this.keyEventTarget=document.body,this.positionBelow=!1,this.addEventListener("mousedown",e=>this._handleMouseDown(e))}static get template(){return hE}placeAbove(e){yh();const t=this._getTargetBoundingRect(e),i=this.$.tooltip.getBoundingClientRect(),n=this._getParentBoundingClientRect();null!==n&&(this.style.top=`${t.top-n.top-i.height-6}px`,this.style.left=`${t.left-n.left+(t.width-i.width)/2}px`)}placeBelow(e){yh();const t=this._getTargetBoundingRect(e),i=this.$.tooltip.getBoundingClientRect(),n=this._getParentBoundingClientRect();null!==n&&(this.style.top=`${t.top-n.top+i.height-6}px`,this.style.left=`${t.left-n.left+(t.width-i.width)/2}px`)}_getParentBoundingClientRect(){return this.parentElement?this.parentElement.getBoundingClientRect():null!==this.parentNode?this.parentNode.host.getBoundingClientRect():null}_getTargetBoundingRect(e){let t;if(e instanceof Text){const i=document.createRange();i.selectNode(e),t=i.getBoundingClientRect(),i.detach()}else t=e.getBoundingClientRect();return t}_handleMouseDown(e){0===e.button&&(e.preventDefault(),e.stopPropagation(),bi(this,"create-comment-requested"))}};pE([Oo({type:Object})],uE.prototype,"keyEventTarget",void 0),pE([Oo({type:Boolean})],uE.prototype,"positionBelow",void 0),uE=pE([Po("gr-selection-action-box")],uE);const gE=mi`
  <style include="shared-styles">
    :host {
      position: relative;
    }
    gr-selection-action-box {
      /**
         * Needs z-index to appear above wrapped content, since it's inserted
         * into DOM before it.
         */
      z-index: 10;
    }
  </style>
  <div class="contentWrapper">
    <slot></slot>
  </div>
`,mE=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;function fE(e){const t=_E(e.startContainer),i=e.startOffset+vE(t,e.startContainer),n=_E(e.endContainer);return{startContainer:t,startOffset:i,endContainer:n,endOffset:e.endOffset+vE(n,e.endContainer)}}function _E(e){if(!e.parentElement)return e;let t;for(t=e instanceof Element?e:e.parentElement;t&&!t.classList.contains("contentText");){if(null===t.parentElement)return e;t=t.parentElement}return t||e}function vE(e,t){let i=0,n=[e];for(;n.length;){const e=n.pop();if(e===t)break;if((null==e?void 0:e.childNodes)&&0!==e.childNodes.length){const t=[];for(const i of e.childNodes)t.push(i);t.reverse(),n=n.concat(t)}else i+=yE(e)}return i}function yE(e){return e&&e.textContent?e.textContent.replace(mE,"_").length:0}var bE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let wE=class extends fi{constructor(){super(),this.commentRanges=[],this.addEventListener("comment-thread-mouseleave",e=>this._handleCommentThreadMouseleave(e)),this.addEventListener("comment-thread-mouseenter",e=>this._handleCommentThreadMouseenter(e)),this.addEventListener("create-comment-requested",e=>this._handleRangeCommentRequest(e))}static get template(){return gE}disconnectedCallback(){var e;null===(e=this.selectionChangeTask)||void 0===e||e.cancel(),super.disconnectedCallback()}get diffBuilder(){return this._cachedDiffBuilder||(this._cachedDiffBuilder=this.querySelector("gr-diff-builder")),this._cachedDiffBuilder}handleSelectionChange(e,t){null!==e&&(this.selectionChangeTask=Cu(this.selectionChangeTask,()=>this._handleSelection(e,t),10))}_getThreadEl(e){const t=Th(e).path||[];for(const e of t)if(e instanceof HTMLElement&&e.classList.contains("comment-thread"))return e;return null}_toggleRangeElHighlight(e,t=!1){var i,n,o,r;let s=e.assignedSlot;for(;s&&"TABLE"!==s.nodeName;)s=s.parentElement;if(null==s?void 0:s.querySelectorAll)if(t){s.querySelectorAll(`.range.${gu(e.rootId)}`).forEach(e=>{e.classList.add("rangeHoverHighlight")});const t=null===(i=e.parentElement)||void 0===i?void 0:i.querySelector(`gr-ranged-comment-hint[threadElRootId="${e.rootId}"]`);t&&(null===(n=t.shadowRoot)||void 0===n||n.querySelectorAll(".rangeHighlight").forEach(e=>e.classList.add("rangeHoverHighlight")))}else{s.querySelectorAll(`.rangeHoverHighlight.${gu(e.rootId)}`).forEach(e=>{e.classList.remove("rangeHoverHighlight")});const t=null===(o=e.parentElement)||void 0===o?void 0:o.querySelector(`gr-ranged-comment-hint[threadElRootId="${e.rootId}"]`);t&&(null===(r=t.shadowRoot)||void 0===r||r.querySelectorAll(".rangeHoverHighlight").forEach(e=>e.classList.remove("rangeHoverHighlight")))}}_handleCommentThreadMouseenter(e){const t=this._getThreadEl(e),i=this._indexForThreadEl(t);void 0!==i&&this.set(["commentRanges",i,"hovering"],!0),this._toggleRangeElHighlight(t,!0)}_handleCommentThreadMouseleave(e){const t=this._getThreadEl(e),i=this._indexForThreadEl(t);void 0!==i&&this.set(["commentRanges",i,"hovering"],!1),this._toggleRangeElHighlight(t,!1)}_indexForThreadEl(e){const t=AS(e),i=xS(e);if(t&&i)return this._indexOfCommentRange(t,i)}_indexOfCommentRange(e,t){return this.commentRanges.findIndex(i=>{return i.side===e&&(n=i.range,o=t,!n&&!o||!(!n||!o)&&n.start_line===o.start_line&&n.start_character===o.start_character&&n.end_line===o.end_line&&n.end_character===o.end_character);var n,o})}_getNormalizedRange(e){if(e instanceof Range)return this._normalizeRange(e);const t=e.rangeCount;if(0===t)return null;if(1===t)return this._normalizeRange(e.getRangeAt(0));{const i=this._normalizeRange(e.getRangeAt(0)),n=this._normalizeRange(e.getRangeAt(t-1));return{start:i.start,end:n.end}}}_normalizeRange(e){const t=fE(e);return this._fixTripleClickSelection({start:this._normalizeSelectionSide(t.startContainer,t.startOffset),end:this._normalizeSelectionSide(t.endContainer,t.endOffset)},e)}_fixTripleClickSelection(e,t){if(!e.start)return e;const i=e.start,n=e.end,o=!n&&0===t.endOffset&&t.endContainer instanceof HTMLElement&&"TD"===t.endContainer.nodeName&&(t.endContainer.classList.contains("left")||t.endContainer.classList.contains("right")),r=n&&0===i.column&&0===n.column&&n.line===i.line+1,s=t.cloneContents().querySelector(".contentText"),a=s&&this._getLength(s)||0;return a&&(r||o)&&(e.end={node:i.node,column:a,side:i.side,line:i.line}),e}_normalizeSelectionSide(e,t){let i;if(!e||!this.contains(e))return null;const n=this.diffBuilder.getLineElByChild(e);if(!n)return null;const o=this.diffBuilder.getSideByLineEl(n);if(!o)return null;const r=this.diffBuilder.getLineNumberByChild(n);if(!r||"FILE"===r||"LOST"===r)return null;const s=this.diffBuilder.getContentTdByLineEl(n);if(!s)return null;const a=s.querySelector(".contentText");if(s.contains(e)){const n=s.querySelector(".comment-thread");(null==n?void 0:n.contains(e))?(i=this._getLength(a),e=a):i=this._convertOffsetToColumn(e,t)}else e=a,i=0;return{node:e,side:o,line:r,column:i}}_positionActionBox(e,t,i){t>1?e.placeAbove(i):(e.positionBelow=!0,e.placeBelow(i))}_isRangeValid(e){if(!(e&&e.start&&e.start.node&&e.end))return!1;const t=e.start,i=e.end;return!(t.side!==i.side||i.line<t.line||t.line===i.line&&t.column===i.column)}_handleSelection(e,t){if(!e)return;const i=this._getNormalizedRange(e);if(!this._isRangeValid(i))return void this._removeActionBox();const n=e instanceof Range?e:e.getRangeAt(0),o=i.start,r=i.end;if(o.line===r.line-1&&0===r.column){const e=n.cloneContents().querySelector(".contentText");return void(t&&0===this._getLength(e)&&this._fireCreateRangeComment(o.side,{start_line:o.line,start_character:0,end_line:o.line,end_character:o.column}))}let s=this.shadowRoot.querySelector("gr-selection-action-box");s||(s=document.createElement("gr-selection-action-box"),this.root.insertBefore(s,this.root.firstElementChild)),this.selectedRange={range:{start_line:o.line,start_character:o.column,end_line:r.line,end_character:r.column},side:o.side},o.line===r.line?this._positionActionBox(s,o.line,n):o.node instanceof Text?(o.column&&this._positionActionBox(s,o.line,o.node.splitText(o.column)),o.node.parentElement.normalize()):o.node instanceof HTMLElement&&o.node.classList.contains("content")&&(o.node.firstChild instanceof Element||o.node.firstChild instanceof Text)?this._positionActionBox(s,o.line,o.node.firstChild):o.node instanceof Element||o.node instanceof Text?this._positionActionBox(s,o.line,o.node):(console.warn("Failed to position comment action box."),this._removeActionBox())}_fireCreateRangeComment(e,t){this.dispatchEvent(new CustomEvent("create-range-comment",{detail:{side:e,range:t},composed:!0,bubbles:!0})),this._removeActionBox()}_handleRangeCommentRequest(e){if(e.stopPropagation(),!this.selectedRange)throw Error("Selected Range is needed for new range comment!");const{side:t,range:i}=this.selectedRange;this._fireCreateRangeComment(t,i)}_removeActionBox(){this.selectedRange=void 0;const e=this.shadowRoot.querySelector("gr-selection-action-box");e&&this.root.removeChild(e)}_convertOffsetToColumn(e,t){var i;if(e instanceof Element&&e.classList.contains("content"))return t;for(;e.previousSibling||!(null===(i=e.parentElement)||void 0===i?void 0:i.classList.contains("content"));)e.previousSibling?(e=e.previousSibling,t+=this._getLength(e)):e=e.parentElement;return t}_getLength(e){return null===e?0:e instanceof Element&&e.classList.contains("content")?this._getLength(e.querySelector(".contentText")):Dm.getLength(e)}};bE([Oo({type:Array,notify:!0})],wE.prototype,"commentRanges",void 0),bE([Oo({type:Boolean})],wE.prototype,"loggedIn",void 0),bE([Oo({type:Object})],wE.prototype,"_cachedDiffBuilder",void 0),bE([Oo({type:Object,notify:!0})],wE.prototype,"selectedRange",void 0),wE=bE([Po("gr-diff-highlight")],wE);const CE=mi`
  <div class="contentWrapper">
    <slot></slot>
  </div>
`;var SE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const EE={COMMENT:"selected-comment",LEFT:"selected-left",RIGHT:"selected-right",BLAME:"selected-blame"};let AE=class extends fi{constructor(){super(),this._linesCache={left:null,right:null},this.addEventListener("copy",e=>this._handleCopy(e)),Ld(this,"down",e=>this._handleDown(e))}static get template(){return CE}connectedCallback(){super.connectedCallback(),this.classList.add(EE.RIGHT)}get diffBuilder(){return this._cachedDiffBuilder||(this._cachedDiffBuilder=this.querySelector("gr-diff-builder")),this._cachedDiffBuilder}_diffChanged(){this._linesCache={left:null,right:null}}_handleDownOnRangeComment(e){return!!RS(e)&&(this._setClasses([EE.COMMENT,AS(e)===zi.LEFT?EE.LEFT:EE.RIGHT]),!0)}_handleDown(e){const t=e.target;if(!(t instanceof Element))return;if(this._handleDownOnRangeComment(t))return;const i=this.diffBuilder.getLineElByChild(t),n=this._elementDescendedFromClass(t,"blame");if(!i&&!n)return;const o=[];if(n)o.push(EE.BLAME);else if(i){const e=this._elementDescendedFromClass(t,"gr-comment"),n=this.diffBuilder.getSideByLineEl(i);o.push("left"===n?EE.LEFT:EE.RIGHT),e&&o.push(EE.COMMENT)}this._setClasses(o)}_setClasses(e){for(const t of Object.values(EE))e.includes(t)||this.classList.remove(t);for(const t of e)this.classList.contains(t)||this.classList.add(t)}_getCopyEventTarget(e){return Th(e).rootTarget}_elementDescendedFromClass(e,t){return uu(e,t,this.diffBuilder.diffElement)}_handleCopy(e){let t=!1;const i=this._getCopyEventTarget(e);if(!(i instanceof Element))return;if(i instanceof HTMLTextAreaElement)return;if(!this._elementDescendedFromClass(i,"diff-row"))return;this.classList.contains(EE.COMMENT)&&(t=!0);const n=this.diffBuilder.getLineElByChild(i);if(!n)return;const o=this.diffBuilder.getSideByLineEl(n),r=this._getSelectedText(o,t);r&&e.clipboardData&&(e.clipboardData.setData("Text",r),e.preventDefault())}_getSelection(){const e=function(e,t){let i=[e];const n=new Set;for(;i.length;){const e=i.pop();if(!e||!e.querySelectorAll)continue;[...e.querySelectorAll(t)].forEach(e=>n.add(e));const o=[...e.querySelectorAll("*")].filter(du).map(e=>e.shadowRoot);i=i.concat(o),du(e)&&i.push(e.shadowRoot)}return[...n]}(document.body,"gr-diff");if(!e.length)return window.getSelection();const t=e.find(e=>{var t;if(!(null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.getSelection))return!1;const i=e.shadowRoot.getSelection();return i&&"None"!==i.type});return t?t.shadowRoot.getSelection():window.getSelection()}_getSelectedText(e,t){const i=this._getSelection();if(!i||1!==i.rangeCount)return"";if(t)return this._getCommentLines(i,e);const n=fE(i.getRangeAt(0)),o=this.diffBuilder.getLineElByChild(n.startContainer);if(!o)return;const r=this.diffBuilder.getLineElByChild(n.endContainer),s=!r&&0===n.endOffset&&"TD"===n.endContainer.nodeName&&n.endContainer instanceof HTMLTableCellElement&&(n.endContainer.classList.contains("left")||n.endContainer.classList.contains("right")),a=o.getAttribute("data-value");if(!a)return;const l=Number(a);let c;if(s)c=l+1;else if(r){const e=r.getAttribute("data-value");e&&(c=Number(e))}return this._getRangeFromDiff(l,n.startOffset,c,n.endOffset,e)}_getRangeFromDiff(e,t,i,n,o){const r=this._getDiffLines(o).slice(e-1,i);return r.length&&(r[r.length-1]=r[r.length-1].substring(0,n),r[0]=r[0].substring(t)),r.join("\n")}_getDiffLines(e){if(this._linesCache[e])return this._linesCache[e];if(!this.diff)return[];let t=[];for(const i of this.diff.content)i.ab?t=t.concat(i.ab):e===zi.LEFT&&i.a?t=t.concat(i.a):e===zi.RIGHT&&i.b&&(t=t.concat(i.b));return this._linesCache[e]=t,t}_getCommentLines(e,t){const i=fE(e.getRangeAt(0)),n=[],o=this.diffBuilder.diffElement.querySelectorAll(`.side-by-side [data-side="${t}"] .message *, .unified .message *`);for(let t=0;t<o.length;t++){const r=o[t];e.containsNode(r,!0)&&("container"!==r.parentElement.id&&"BLOCKQUOTE"!==r.parentElement.nodeName||n.length&&""!==n[n.length-1]&&n.push(""),"output"!==r.id||this._elementDescendedFromClass(r,"collapsed")||n.push(this._getTextContentForRange(r,e,i)))}return n.join("\n")}_getTextContentForRange(e,t,i){if(!t.containsNode(e,!0))return"";let n="";if(e instanceof Text)n=e.textContent||"",e===i.endContainer&&(n=n.substring(0,i.endOffset)),e===i.startContainer&&(n=n.substring(i.startOffset));else for(const o of e.childNodes)n+=this._getTextContentForRange(o,t,i);return n}};SE([Oo({type:Object})],AE.prototype,"diff",void 0),SE([Oo({type:Object})],AE.prototype,"_cachedDiffBuilder",void 0),SE([Oo({type:Object})],AE.prototype,"_linesCache",void 0),SE([No("diff")],AE.prototype,"_diffChanged",null),AE=SE([Po("gr-diff-selection")],AE);const xE=document.createElement("template");xE.innerHTML='<dom-module id="gr-syntax-theme">\n  <template>\n    <style>\n      /**\n       * @overview Highlight.js emits the following classes that do not have\n       * styles here:\n       *    subst, symbol, class, function, doctag, meta-string, section, name,\n       *    builtin-name, bulletm, code, formula, quote, addition, deletion,\n       *    attribute\n       * @see {@link http://highlightjs.readthedocs.io/en/latest/css-classes-reference.html}\n       */\n\n      .contentText {\n        color: var(--syntax-default-color);\n      }\n      .gr-syntax-attribute {\n        color: var(--syntax-attribute-color);\n      }\n      .gr-syntax-function {\n        color: var(--syntax-function-color);\n      }\n      .gr-syntax-meta {\n        color: var(--syntax-meta-color);\n      }\n      .gr-syntax-keyword,\n      .gr-syntax-name {\n        color: var(--syntax-keyword-color);\n      }\n      .gr-syntax-number {\n        color: var(--syntax-number-color);\n      }\n      .gr-syntax-selector-class {\n        color: var(--syntax-selector-class-color);\n      }\n      .gr-syntax-variable {\n        color: var(--syntax-variable-color);\n      }\n      .gr-syntax-template-variable {\n        color: var(--syntax-template-variable-color);\n      }\n      .gr-syntax-comment {\n        color: var(--syntax-comment-color);\n      }\n      .gr-syntax-string {\n        color: var(--syntax-string-color);\n      }\n      .gr-syntax-selector-id {\n        color: var(--syntax-selector-id-color);\n      }\n      .gr-syntax-built_in {\n        color: var(--syntax-built_in-color);\n      }\n      .gr-syntax-tag {\n        color: var(--syntax-tag-color);\n      }\n      .gr-syntax-link {\n        color: var(--syntax-link-color);\n      }\n      .gr-syntax-meta-keyword {\n        color: var(--syntax-meta-keyword-color);\n      }\n      .gr-syntax-type {\n        color: var(--syntax-type-color);\n      }\n      .gr-syntax-title {\n        color: var(--syntax-title-color);\n      }\n      .gr-syntax-attr {\n        color: var(--syntax-attr-color);\n      }\n      .gr-syntax-literal { /* XML/HTML Attribute */\n        color: var(--syntax-literal-color);\n      }\n      .gr-syntax-property {\n        color: var(--syntax-property-color);\n      }\n      .gr-syntax-selector-pseudo {\n        color: var(--syntax-selector-pseudo-color);\n      }\n      .gr-syntax-regexp {\n        color: var(--syntax-regexp-color);\n      }\n      .gr-syntax-selector-attr {\n        color: var(--syntax-selector-attr-color);\n      }\n      .gr-syntax-template-tag {\n        color: var(--syntax-template-tag-color);\n      }\n      .gr-syntax-params {\n        color: var(--syntax-params-color);\n      }\n      .gr-syntax-doctag {\n        font-weight: var(--syntax-doctag-weight);\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(xE.content);const RE=document.createElement("template");RE.innerHTML='<dom-module id="gr-ranged-comment-theme">\n  <template>\n    <style>\n      .rangeHighlight {\n        background-color: var(--diff-highlight-range-color);\n        display: inline;\n      }\n      .rangeHoverHighlight {\n        background-color: var(--diff-highlight-range-hover-color);\n        display: inline;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(RE.content);const TE=mi`
  <style include="gr-ranged-comment-theme">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    .row {
      color: var(--ranged-comment-hint-text-color);
      display: flex;
      font-family: var(--font-family, ''), 'Roboto Mono';
      font-size: var(--font-size-small, 12px);
      font-weight: var(--code-hint-font-weight, 500);
      line-height: var(--line-height-small, 16px);
      justify-content: flex-end;
      margin: var(--spacing-xs) 0;
      padding: var(--spacing-s) var(--spacing-l);
    }
    .icon {
      color: var(--ranged-comment-hint-text-color);
      height: var(--line-height-small, 16px);
      width: var(--line-height-small, 16px);
      margin-right: var(--spacing-s);
    }
  </style>
  <div class="row rangeHighlight">
    <iron-icon class="icon" icon="gr-icons:comment"></iron-icon>
    [[_computeRangeLabel(range)]]
  </div>
`;var kE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let PE=class extends fi{static get template(){return TE}_computeRangeLabel(e){return e?`Long comment range ${e.start_line} - ${e.end_line}`:""}};kE([Oo({type:Object})],PE.prototype,"range",void 0),PE=kE([Po("gr-ranged-comment-hint")],PE);const IE=mi`
  <style include="shared-styles">
    :host(.no-left) .sideBySide .left,
    :host(.no-left) .sideBySide .left + td,
    :host(.no-left) .sideBySide .right:not([data-value]),
    :host(.no-left) .sideBySide .right:not([data-value]) + td {
      display: none;
    }
    :host(.disable-context-control-buttons) {
      --context-control-display: none;
    }
    :host(.disable-context-control-buttons) .section {
      border-right: none;
    }
    :host(.hide-line-length-indicator) .full-width td.content .contentText {
      background-image: none;
    }

    :host {
      font-family: var(--monospace-font-family, ''), 'Roboto Mono';
      font-size: var(--font-size, var(--font-size-code, 12px));
      /* usually 16px = 12px + 4px */
      line-height: calc(
        var(--font-size, var(--font-size-code, 12px)) + var(--spacing-s, 4px)
      );
    }

    .thread-group {
      display: block;
      max-width: var(--content-width, 80ch);
      white-space: normal;
      background-color: var(--diff-blank-background-color);
    }
    .diffContainer {
      display: flex;
      font-family: var(--monospace-font-family);
      @apply --diff-container-styles;
    }
    .diffContainer.hiddenscroll {
      margin-bottom: var(--spacing-m);
    }
    table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    /*
      Context controls break up the table visually, so we set the right border
      on individual sections to leave a gap for the divider.
      */
    .section {
      border-right: 1px solid var(--border-color);
    }
    .section.contextControl {
      /*
       * Divider inside this section must not have border; we set borders on
       * the padding rows below.
       */
      border-right-width: 0;
    }
    /*
     * Padding rows behind context controls. The diff is styled to be cut into
     * two halves by the negative space of the divider on which the context
     * control buttons are anchored.
     */
    .contextBackground {
      border-right: 1px solid var(--border-color);
    }
    .contextBackground.above {
      border-bottom: 1px solid var(--border-color);
    }
    .contextBackground.below {
      border-top: 1px solid var(--border-color);
    }

    .lineNumButton {
      display: block;
      width: 100%;
      height: 100%;
      background-color: var(--diff-blank-background-color);
    }
    td.lineNum {
      vertical-align: top;
    }

    /*
      The only way to focus this (clicking) will apply our own focus styling,
      so this default styling is not needed and distracting.
      */
    .lineNumButton:focus {
      outline: none;
    }
    gr-image-viewer {
      width: 100%;
      height: 100%;
      max-width: var(--image-viewer-max-width, 95vw);
      max-height: var(--image-viewer-max-height, 90vh);
    }
    .image-diff .gr-diff {
      text-align: center;
    }
    .image-diff img {
      box-shadow: var(--elevation-level-1);
      max-width: 50em;
    }
    .image-diff .right.lineNumButton {
      border-left: 1px solid var(--border-color);
    }
    .image-diff label,
    .binary-diff label {
      font-family: var(--font-family);
      font-style: italic;
    }
    .diff-row {
      outline: none;
      user-select: none;
    }
    .diff-row.target-row.target-side-left .lineNumButton.left,
    .diff-row.target-row.target-side-right .lineNumButton.right,
    .diff-row.target-row.unified .lineNumButton {
      background-color: var(--diff-selection-background-color);
      color: var(--primary-text-color);
    }
    .content {
      background-color: var(--diff-blank-background-color);
    }
    /*
      The file line, which has no contentText, add some margin before the first
      comment. We cannot add padding the container because we only want it if
      there is at least one comment thread, and the slotting makes :empty not
      work as expected.
     */
    .content.file slot:first-child::slotted(.comment-thread) {
      display: block;
      margin-top: var(--spacing-xs);
    }
    .contentText {
      background-color: var(--view-background-color);
    }
    .blank {
      background-color: var(--diff-blank-background-color);
    }
    .image-diff .content {
      background-color: var(--diff-blank-background-color);
    }
    .full-width {
      width: 100%;
    }
    .full-width .contentText {
      white-space: break-spaces;
      word-wrap: break-word;
    }
    .lineNumButton,
    .content {
      vertical-align: top;
      white-space: pre;
    }
    .contextLineNum,
    .lineNumButton {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;

      color: var(--deemphasized-text-color);
      padding: 0 var(--spacing-m);
      text-align: right;
    }
    .canComment .lineNumButton {
      cursor: pointer;
    }
    .content {
      /* Set min width since setting width on table cells still
           allows them to shrink. Do not set max width because
           CJK (Chinese-Japanese-Korean) glyphs have variable width */
      min-width: var(--content-width, 80ch);
      width: var(--content-width, 80ch);
    }
    .content.add .contentText .intraline,
      /* If there are no intraline info, consider everything changed */
      .content.add.no-intraline-info .contentText,
      .delta.total .content.add .contentText {
      background-color: var(--dark-add-highlight-color);
    }
    .content.add .contentText {
      background-color: var(--light-add-highlight-color);
    }
    .content.remove .contentText .intraline,
      /* If there are no intraline info, consider everything changed */
      .content.remove.no-intraline-info .contentText,
      .delta.total .content.remove .contentText {
      background-color: var(--dark-remove-highlight-color);
    }
    .content.remove .contentText {
      background-color: var(--light-remove-highlight-color);
    }

    /* dueToRebase */
    .dueToRebase .content.add .contentText .intraline,
    .delta.total.dueToRebase .content.add .contentText {
      background-color: var(--dark-rebased-add-highlight-color);
    }
    .dueToRebase .content.add .contentText {
      background-color: var(--light-rebased-add-highlight-color);
    }
    .dueToRebase .content.remove .contentText .intraline,
    .delta.total.dueToRebase .content.remove .contentText {
      background-color: var(--dark-rebased-remove-highlight-color);
    }
    .dueToRebase .content.remove .contentText {
      background-color: var(--light-remove-add-highlight-color);
    }

    /* dueToMove */
    .dueToMove .content.add .contentText,
    .dueToMove .moveControls.movedIn .moveLabel,
    .delta.total.dueToMove .content.add .contentText {
      background-color: var(--diff-moved-in-background);
    }

    .dueToMove .content.remove .contentText,
    .dueToMove .moveControls.movedOut .moveLabel,
    .delta.total.dueToMove .content.remove .contentText {
      background-color: var(--diff-moved-out-background);
    }

    .delta.dueToMove .movedIn .moveDescription {
      color: var(--diff-moved-in-label-color);
    }
    .delta.dueToMove .movedOut .moveDescription {
      color: var(--diff-moved-out-label-color);
    }
    .moveLabel {
      font-family: var(--font-family, ''), 'Roboto Mono';
      font-size: var(--font-size-small, 12px);
      font-weight: var(--code-hint-font-weight, 500);
      line-height: var(--line-height-small, 16px);
      padding: var(--spacing-s) var(--spacing-m);
      margin: var(--spacing-s);
    }
    .delta.dueToMove .moveDescription {
      display: flex;
      justify-content: flex-end;
    }

    .moveDescription iron-icon {
      color: inherit;
      margin-right: var(--spacing-s);
      height: var(--line-height-small, 16px);
      width: var(--line-height-small, 16px);
    }

    .moveDescription a {
      color: inherit;
    }

    /* ignoredWhitespaceOnly */
    .ignoredWhitespaceOnly .content.add .contentText .intraline,
    .delta.total.ignoredWhitespaceOnly .content.add .contentText,
    .ignoredWhitespaceOnly .content.add .contentText,
    .ignoredWhitespaceOnly .content.remove .contentText .intraline,
    .delta.total.ignoredWhitespaceOnly .content.remove .contentText,
    .ignoredWhitespaceOnly .content.remove .contentText {
      background-color: var(--view-background-color);
    }

    .content .contentText:empty:after {
      /* Newline, to ensure empty lines are one line-height tall. */
      content: '\\A';
    }

    /* Context controls */
    .contextControl {
      display: var(--context-control-display, table-row-group);
      background-color: transparent;
      border: none;
      --divider-height: var(--spacing-s);
      --divider-border: 1px;
    }
    .contextControl gr-button iron-icon {
      /* should match line-height of gr-button */
      width: var(--line-height-mono, 18px);
      height: var(--line-height-mono, 18px);
    }
    .contextControl td:not(.lineNumButton) {
      text-align: center;
    }

    /*
     * Padding rows behind context controls. Styled as a continuation of the
     * line gutters and code area.
     */
    .contextBackground > .contextLineNum {
      background-color: var(--diff-blank-background-color);
    }
    .contextBackground > td:not(.contextLineNum) {
      background-color: var(--view-background-color);
    }
    .contextBackground {
      /*
       * One line of background behind the context expanders which they can
       * render on top of, plus some padding.
       */
      height: calc(var(--line-height-normal) + var(--spacing-s));
    }

    .dividerCell {
      vertical-align: top;
    }
    .dividerRow.showBoth .dividerCell {
      height: var(--divider-height);
    }
    .dividerRow.showAboveOnly .dividerCell,
    .dividerRow.showBelowOnly .dividerCell {
      height: 0;
    }

    .verticalFlex {
      display: flex;
      flex-direction: column;
      position: relative;
    }
    .dividerRow.showBoth .verticalFlex {
      justify-content: center;
      margin-top: calc(0px - var(--line-height-normal) - var(--spacing-s));
      margin-bottom: calc(0px - var(--line-height-normal) - var(--spacing-s));
      height: calc(
        2 * var(--line-height-normal) + 2 * var(--spacing-s) +
          var(--divider-height) - 1px
      );
    }
    .dividerRow.showAboveOnly .verticalFlex {
      justify-content: flex-end;
      /* margin-top has to make room for height+1px. */
      margin-top: calc(-1px - var(--line-height-normal) - var(--spacing-s));
      height: calc(var(--line-height-normal) + var(--spacing-s));
    }
    .dividerRow.showBelowOnly .verticalFlex {
      justify-content: flex-start;
      /* This just pushes the container down 1 pixel as to render below the
         1px border-top of the padding row below. The same could be achieved
         by position:relative; top:1px.*/
      margin-top: 1px;
      margin-bottom: calc(0px - var(--line-height-normal) - var(--spacing-s));
    }

    .horizontalFlex {
      display: flex;
      justify-content: center;
    }
    .dividerRow.showBoth .horizontalFlex {
      align-items: center;
    }
    .dividerRow.showAboveOnly .horizontalFlex {
      align-items: end;
    }
    .dividerRow.showBelowOnly .horizontalFlex {
      align-items: start;
    }
    .contextControlButton {
      background-color: var(--default-button-background-color);
      font: var(--context-control-button-font, inherit);
    }
    .centeredButton {
      --gr-button: {
        color: var(--diff-context-control-color);
        border-style: solid;
        border-color: var(--border-color);
        border-top-width: 1px;
        border-right-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        border-top-left-radius: var(--border-radius);
        border-top-right-radius: var(--border-radius);
        border-bottom-right-radius: var(--border-radius);
        border-bottom-left-radius: var(--border-radius);
        padding: var(--spacing-s) var(--spacing-l);
      }
    }
    .aboveBelowButtons {
      display: flex;
      flex-direction: column;
      justify-content: center;
      margin-left: var(--spacing-m);
    }
    .aboveBelowButtons:first-child {
      margin-left: 0;
    }
    .dividerRow.showBoth .aboveButton {
      /* The size of the gap between the above and below button. */
      margin-bottom: calc(var(--divider-height) + 1px);
    }
    .aboveButton {
      --gr-button: {
        color: var(--diff-context-control-color);
        border-style: solid;
        border-color: var(--border-color);
        border-top-width: 1px;
        border-right-width: 1px;
        border-bottom-width: 0;
        border-left-width: 1px;
        border-top-left-radius: var(--border-radius);
        border-top-right-radius: var(--border-radius);
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 0;
        padding: var(--spacing-xxs) var(--spacing-l);
      }
    }
    .belowButton {
      --gr-button: {
        color: var(--diff-context-control-color);
        border-style: solid;
        border-color: var(--border-color);
        border-top-width: 0;
        border-right-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: var(--border-radius);
        border-bottom-left-radius: var(--border-radius);
        padding: var(--spacing-xxs) var(--spacing-l);
      }
    }
    #diffTable:focus {
      outline: none;
    }

    .displayLine .diff-row.target-row td {
      box-shadow: inset 0 -1px var(--border-color);
    }
    .br:after {
      /* Line feed */
      content: '\\A';
    }
    .tab {
      display: inline-block;
    }
    .tab-indicator:before {
      color: var(--diff-tab-indicator-color);
      /* >> character */
      content: '\\00BB';
      position: absolute;
    }
    .special-char-indicator {
      /* spacing so elements don't collide */
      padding-right: var(--spacing-m);
    }
    .special-char-indicator:before {
      color: var(--diff-tab-indicator-color);
      content: '';
      position: absolute;
    }
    /* Is defined after other background-colors, such that this
         rule wins in case of same specificity. */
    .trailing-whitespace,
    .content .trailing-whitespace,
    .trailing-whitespace .intraline,
    .content .trailing-whitespace .intraline {
      border-radius: var(--border-radius, 4px);
      background-color: var(--diff-trailing-whitespace-indicator);
    }
    #diffHeader {
      background-color: var(--table-header-background-color);
      border-bottom: 1px solid var(--border-color);
      color: var(--link-color);
      padding: var(--spacing-m) 0 var(--spacing-m) 48px;
    }
    #loadingError,
    #sizeWarning {
      display: none;
      margin: var(--spacing-l) auto;
      max-width: 60em;
      text-align: center;
    }
    #loadingError {
      color: var(--error-text-color);
    }
    #sizeWarning gr-button {
      margin: var(--spacing-l);
    }
    #loadingError.showError,
    #sizeWarning.warn {
      display: block;
    }
    .target-row td.blame {
      background: var(--diff-selection-background-color);
    }
    td.lost div {
      background-color: var(--info-background);
      padding: var(--spacing-s) 0 0 0;
    }
    td.lost div:first-of-type {
      font-family: var(--font-family, 'Roboto');
      font-size: var(--font-size-normal, 14px);
      line-height: var(--line-height-normal);
    }
    td.lost iron-icon {
      padding: 0 var(--spacing-s) 0 var(--spacing-m);
      color: var(--blue-700);
    }
    col.blame {
      display: none;
    }
    td.blame {
      display: none;
      padding: 0 var(--spacing-m);
      white-space: pre;
    }
    :host(.showBlame) col.blame {
      display: table-column;
    }
    :host(.showBlame) td.blame {
      display: table-cell;
    }
    td.blame > span {
      opacity: 0.6;
    }
    td.blame > span.startOfRange {
      opacity: 1;
    }
    td.blame .blameDate {
      font-family: var(--monospace-font-family);
      color: var(--link-color);
      text-decoration: none;
    }
    .full-width td.blame {
      overflow: hidden;
      width: 200px;
    }
    /** Support the line length indicator **/
    .full-width td.content .contentText {
      background-image: var(--line-length-indicator);
      background-position: var(--line-limit) 0;
      background-repeat: repeat-y;
    }
    .newlineWarning {
      color: var(--deemphasized-text-color);
      text-align: center;
    }
    .newlineWarning.hidden {
      display: none;
    }
    .lineNum.COVERED .lineNumButton {
      background-color: var(--coverage-covered, #e0f2f1);
    }
    .lineNum.NOT_COVERED .lineNumButton {
      background-color: var(--coverage-not-covered, #ffd1a4);
    }
    .lineNum.PARTIALLY_COVERED .lineNumButton {
      background: linear-gradient(
        to right bottom,
        var(--coverage-not-covered, #ffd1a4) 0%,
        var(--coverage-not-covered, #ffd1a4) 50%,
        var(--coverage-covered, #e0f2f1) 50%,
        var(--coverage-covered, #e0f2f1) 100%
      );
    }

    /** BEGIN: Select and copy for Polymer 2 */
    /** Below was copied and modified from the original css in gr-diff-selection.html */
    .content,
    .contextControl,
    .blame {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .selected-left:not(.selected-comment)
      .side-by-side
      .left
      + .content
      .contentText,
    .selected-right:not(.selected-comment)
      .side-by-side
      .right
      + .content
      .contentText,
    .selected-left:not(.selected-comment)
      .unified
      .left.lineNum
      ~ .content:not(.both)
      .contentText,
    .selected-right:not(.selected-comment)
      .unified
      .right.lineNum
      ~ .content
      .contentText,
    .selected-left.selected-comment .side-by-side .left + .content .message,
    .selected-right.selected-comment
      .side-by-side
      .right
      + .content
      .message
      :not(.collapsedContent),
    .selected-comment .unified .message :not(.collapsedContent),
    .selected-blame .blame {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }

    /** Make comments selectable when selected */
    .selected-left.selected-comment
      ::slotted(gr-comment-thread[diff-side='left']),
    .selected-right.selected-comment
      ::slotted(gr-comment-thread[diff-side='right']) {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    /** END: Select and copy for Polymer 2 */

    .whitespace-change-only-message {
      background-color: var(--diff-context-control-background-color);
      border: 1px solid var(--diff-context-control-border-color);
      text-align: center;
    }
  </style>
  <style include="gr-syntax-theme">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-ranged-comment-theme">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div id="diffHeader" hidden$="[[_computeDiffHeaderHidden(_diffHeaderItems)]]">
    <template is="dom-repeat" items="[[_diffHeaderItems]]">
      <div>[[item]]</div>
    </template>
  </div>
  <div
    class$="[[_computeContainerClass(loggedIn, viewMode, displayLine)]]"
    on-click="_handleTap"
    on-diff-context-expanded="_handleDiffContextExpanded"
  >
    <gr-diff-selection diff="[[diff]]">
      <gr-diff-highlight
        id="highlights"
        logged-in="[[loggedIn]]"
        comment-ranges="{{_commentRanges}}"
      >
        <gr-diff-builder
          id="diffBuilder"
          comment-ranges="[[_commentRanges]]"
          coverage-ranges="[[coverageRanges]]"
          diff="[[diff]]"
          path="[[path]]"
          change-num="[[changeNum]]"
          patch-num="[[patchRange.patchNum]]"
          view-mode="[[viewMode]]"
          is-image-diff="[[isImageDiff]]"
          base-image="[[baseImage]]"
          layers="[[layers]]"
          revision-image="[[revisionImage]]"
          use-new-image-diff-ui="[[useNewImageDiffUi]]"
        >
          <table
            id="diffTable"
            class$="[[_diffTableClass]]"
            role="presentation"
            contenteditable$="[[isContentEditable]]"
          ></table>

          <template
            is="dom-if"
            if="[[showNoChangeMessage(_loading, prefs, _diffLength, diff)]]"
          >
            <div class="whitespace-change-only-message">
              This file only contains whitespace changes. Modify the whitespace
              setting to see the changes.
            </div>
          </template>
        </gr-diff-builder>
      </gr-diff-highlight>
    </gr-diff-selection>
  </div>
  <div class$="[[_computeNewlineWarningClass(_newlineWarning, _loading)]]">
    [[_newlineWarning]]
  </div>
  <div id="loadingError" class$="[[_computeErrorClass(errorMessage)]]">
    [[errorMessage]]
  </div>
  <div id="sizeWarning" class$="[[_computeWarningClass(_showWarning)]]">
    <p>
      Prevented render because "Whole file" is enabled and this diff is very
      large (about [[_diffLength]] lines).
    </p>
    <gr-button on-click="_collapseContext">
      Render with limited context
    </gr-button>
    <gr-button on-click="_handleFullBypass">
      Render anyway (may be slow)
    </gr-button>
  </div>
`;let OE=void 0;window.addEventListener("WebComponentsReady",()=>{const e=document.createElement("div");e.setAttribute("style","width:100px;height:100px;overflow:scroll"),document.body.appendChild(e),OE=e.offsetWidth===e.clientWidth,e.remove()});const NE="function"==typeof window.ShadowRoot.prototype.getSelection,LE="function"==typeof window.InputEvent.prototype.getTargetRanges;let DE=!1,ME=null;fu()&&!NE&&LE&&(window.addEventListener("selectionchange",()=>{if(!DE){DE=!0;const e=mu(document,!0);e&&"diffTable"===e.id&&document.execCommand("indent"),DE=!1}},!0),window.addEventListener("beforeinput",e=>{if(DE){const t=e;if("function"!=typeof t.getTargetRanges)return;const i=t.getTargetRanges()[0],n=new Range;n.setStart(i.startContainer,i.startOffset),n.setEnd(i.endContainer,i.endOffset),ME=n,e.preventDefault(),e.stopImmediatePropagation()}else{const t=mu(document,!0);t&&"diffTable"===t.id&&(e.preventDefault(),e.stopImmediatePropagation())}},!0),window.addEventListener("selectstart",e=>{ME=null},!0));var FE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let $E=class extends fi{constructor(){super(),this.noAutoRender=!1,this.displayLine=!1,this.hidden=!1,this._commentRanges=[],this.coverageRanges=[],this.lineWrapping=!1,this.viewMode=Gi.SIDE_BY_SIDE,this.loggedIn=!1,this._diffHeaderItems=[],this._diffTableClass="",this.isContentEditable=fu(),this._safetyBypass=null,this.errorMessage=null,this.blame=null,this.showNewlineWarningLeft=!1,this.showNewlineWarningRight=!1,this.useNewImageDiffUi=!1,this._newlineWarning=null,this.isAttached=!1,this.handleSelectionChange=()=>{const e=this._getShadowOrDocumentSelection();this.$.highlights.handleSelectionChange(e,!1)},this.handleMouseUp=()=>{const e=this._getShadowOrDocumentSelection();this.$.highlights.handleSelectionChange(e,!0)},this._setLoading(!0),this.addEventListener("create-range-comment",e=>this._handleCreateRangeComment(e)),this.addEventListener("render-content",()=>this._handleRenderContent()),this.addEventListener("moved-link-clicked",e=>this._movedLinkClicked(e))}static get template(){return IE}connectedCallback(){super.connectedCallback(),this._observeNodes(),this.isAttached=!0}disconnectedCallback(){var e;this.isAttached=!1,null===(e=this.renderDiffTableTask)||void 0===e||e.cancel(),this._unobserveIncrementalNodes(),this._unobserveNodes(),super.disconnectedCallback()}showNoChangeMessage(e,t,i,n){return!e&&n&&!n.binary&&t&&"IGNORE_NONE"!==t.ignore_whitespace&&0===i}_enableSelectionObserver(e,t){e&&t?(document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("mouseup",this.handleMouseUp)):(document.removeEventListener("selectionchange",this.handleSelectionChange),document.removeEventListener("mouseup",this.handleMouseUp))}_getShadowOrDocumentSelection(){return this.root instanceof ShadowRoot&&this.root.getSelection?this.root.getSelection():fu()?ME:document.getSelection()}_observeNodes(){this._nodeObserver=Th(this).observeNodes(e=>{const t=e.addedNodes.filter(RS),i=e.removedNodes.filter(RS);this._updateRanges(t,i),t.forEach(e=>this._redispatchHoverEvents(e,e))})}_updateRanges(e,t){function i(e){const t=AS(e);if(!t)return;const i=xS(e);return i?{side:t,range:i,hovering:!1,rootId:e.rootId}:void 0}const n=e.map(i).filter(e=>!!e),o=t.map(i).filter(e=>!!e);for(const e of o){const t=this._commentRanges.findIndex(t=>t.side===e.side&&wS(t.range,e.range));this.splice("_commentRanges",t,1)}n&&n.length&&this.push("_commentRanges",...n),this.highlightRange&&this.push("_commentRanges",{side:zi.RIGHT,range:this.highlightRange,hovering:!0,rootId:""})}_computeKeyLocations(){const e={left:{},right:{}};if(this.lineOfInterest){e[this.lineOfInterest.leftSide?zi.LEFT:zi.RIGHT][this.lineOfInterest.number]=!0}const t=Th(this).getEffectiveChildNodes().filter(RS);for(const i of t){const t=AS(i);if(!t)continue;const n=ES(i),o=xS(i);e[t][n]=!0,(null==o?void 0:o.start_line)&&(e[t][o.start_line]=!0)}return e}_redispatchHoverEvents(e,t){e.addEventListener("mouseenter",()=>{bi(t,"comment-thread-mouseenter")}),e.addEventListener("mouseleave",()=>{bi(t,"comment-thread-mouseleave")})}cancel(){var e;this.$.diffBuilder.cancel(),null===(e=this.renderDiffTableTask)||void 0===e||e.cancel()}getCursorStops(){var e;return this.hidden&&this.noAutoRender?[]:this.loading?[new Y_]:Array.from((null===(e=this.root)||void 0===e?void 0:e.querySelectorAll(":not(.contextControl) > .diff-row"))||[]).filter(e=>e.querySelector("button"))}isRangeSelected(){return!!this.$.highlights.selectedRange}toggleLeftDiff(){vu(this,"no-left")}_blameChanged(e){void 0!==e&&(this.$.diffBuilder.setBlame(e),e?this.classList.add("showBlame"):this.classList.remove("showBlame"))}_computeContainerClass(e,t,i){const n=["diffContainer"];return t===Gi.UNIFIED&&n.push("unified"),t===Gi.SIDE_BY_SIDE&&n.push("sideBySide"),OE&&n.push("hiddenscroll"),e&&n.push("canComment"),i&&n.push("displayLine"),n.join(" ")}_handleDiffContextExpanded(e){this.$.diffBuilder.showContext(e.detail.groups,e.detail.section)}_handleTap(e){const t=Th(e).localTarget;if("LOST"!==t.getAttribute("data-value")&&(t.classList.contains("lineNum")||t.classList.contains("lineNumButton")))this.addDraftAtLine(t);else if("HL"===t.tagName||t.classList.contains("content")||t.classList.contains("contentText")){const e=this.$.diffBuilder.getLineElByChild(t);e&&this._selectLine(e)}}_selectLine(e){const t=Number(e.getAttribute("data-value")),i=e.classList.contains("left")?zi.LEFT:zi.RIGHT;this._dispatchSelectedLine(t,i)}_dispatchSelectedLine(e,t){this.dispatchEvent(new CustomEvent("line-selected",{detail:{number:e,side:t,path:this.path},composed:!0,bubbles:!0}))}_movedLinkClicked(e){this._dispatchSelectedLine(e.detail.lineNum,e.detail.side)}addDraftAtLine(e){this._selectLine(e);const t=SS(e);null!==t?this._createComment(e,t):Ci(this,"Invalid line number")}createRangeComment(){if(!this.isRangeSelected())throw Error("Selection is needed for new range comment");const e=this.$.highlights.selectedRange;if(!e)throw Error("selected range not set");const{side:t,range:i}=e;this._createCommentForSelection(t,i)}_createCommentForSelection(e,t){const i=t.end_line,n=this.$.diffBuilder.getLineElByNumber(i,e);n&&this._createComment(n,i,e,t)}_handleCreateRangeComment(e){const t=e.detail.range,i=e.detail.side;this._createCommentForSelection(i,t)}_createComment(e,t,i,n){const o=this.$.diffBuilder.getContentTdByLineEl(e);if(!o)throw new Error("content el not found for line el");i=null!=i?i:this._getCommentSideByLineAndContent(e,o),a(this.path,"path"),this.dispatchEvent(new CustomEvent("create-comment",{bubbles:!0,composed:!0,detail:{path:this.path,side:i,lineNum:t,range:n}}))}_getThreadGroupForLine(e){return e.querySelector(".thread-group")}_getOrCreateThreadGroup(e,t){let i=this._getThreadGroupForLine(e);return i||(i=document.createElement("div"),i.className="thread-group",i.setAttribute("data-side",t),e.appendChild(i)),i}_getCommentSideByLineAndContent(e,t){return e.classList.contains(zi.LEFT)||t.classList.contains("remove")?zi.LEFT:zi.RIGHT}_prefsObserver(e,t){this._prefsEqual(e,t)||this._prefsChanged(e)}_prefsEqual(e,t){if(e===t)return!0;if(!e||!t)return!1;const i=Object.keys(e),n=Object.keys(t);return i.length===n.length&&i.every(i=>e[i]===t[i])&&n.every(i=>e[i]===t[i])}_pathObserver(){this._prefsChanged(this.prefs)}_viewModeObserver(){this._prefsChanged(this.prefs)}_cleanup(){this.cancel(),this.blame=null,this._safetyBypass=null,this._showWarning=!1,this.clearDiffContent()}_lineWrappingObserver(){this._prefsChanged(this.prefs)}_useNewImageDiffUiObserver(){this._prefsChanged(this.prefs)}_prefsChanged(e){if(!e)return;this.blame=null;const t="/COMMIT_MSG"===this.path?72:e.line_length,i={};e.line_wrapping?(this._diffTableClass="full-width","SIDE_BY_SIDE"===this.viewMode&&(i["--content-width"]="none",i["--line-limit"]=`${t}ch`)):(this._diffTableClass="",i["--content-width"]=`${t}ch`),e.font_size&&(i["--font-size"]=`${e.font_size}px`),this.updateStyles(i),this.diff&&!this.noRenderOnPrefsChange&&this._debounceRenderDiffTable()}_renderPrefsChanged(e){e&&(e.hide_left_side&&this.classList.add("no-left"),e.disable_context_control_buttons&&this.classList.add("disable-context-control-buttons"),e.hide_line_length_indicator&&this.classList.add("hide-line-length-indicator"))}_diffChanged(e){this._setLoading(!0),this._cleanup(),e&&(this._diffLength=this.getDiffLength(e),this._debounceRenderDiffTable())}_debounceRenderDiffTable(){this.renderDiffTableTask=Cu(this.renderDiffTableTask,()=>this._renderDiffTable())}_renderDiffTable(){if(!this.prefs)return void bi(this,"render");if(-1===this.prefs.context&&this._diffLength&&this._diffLength>=1e4&&null===this._safetyBypass)return this._showWarning=!0,void bi(this,"render");this._showWarning=!1;const e=this._computeKeyLocations(),t=this._getBypassPrefs(this.prefs);this.$.diffBuilder.render(e,t,this.renderPrefs).then(()=>{this.dispatchEvent(new CustomEvent("render",{bubbles:!0,composed:!0,detail:{contentRendered:!0}}))})}_handleRenderContent(){this.querySelectorAll("gr-ranged-comment-hint").forEach(e=>e.remove()),this._setLoading(!1),this._unobserveIncrementalNodes(),this._incrementalNodeObserver=Th(this).observeNodes(e=>{var t;const i=e.addedNodes.filter(RS);let n;for(const e of i){const t=ES(e),i=AS(e),o=xS(e);if(!i)continue;const r=this.$.diffBuilder.getLineElByNumber(t,i);if(!r){console.error("thread attached to line ",i,t," which does not exist.");continue}const s=this.$.diffBuilder.getContentTdByLineEl(r);if(!s)continue;"LOST"!==t||s.hasChildNodes()||s.appendChild(this._portedCommentsWithoutRangeMessage());const a=this._getOrCreateThreadGroup(s,i),l=e.getAttribute("slot");if(o&&CS(o)&&l){const t=document.createElement("gr-ranged-comment-hint");t.range=o,t.setAttribute("threadElRootId",e.rootId),t.setAttribute("slot",l),this.insertBefore(t,e),this._redispatchHoverEvents(t,e)}const c=document.createElement("slot");l&&(c.name=l),a.appendChild(c),n=e}n&&n.replaceWith&&n.replaceWith(n);const o=e.removedNodes.filter(RS);for(const e of o)null===(t=this.querySelector(`gr-ranged-comment-hint[threadElRootId="${e.rootId}"]`))||void 0===t||t.remove()})}_portedCommentsWithoutRangeMessage(){const e=document.createElement("div"),t=document.createElement("iron-icon");t.setAttribute("icon","gr-icons:info-outline"),e.appendChild(t);const i=document.createElement("span");return i.innerText="Original comment position not found in this patchset",e.appendChild(i),e}_unobserveIncrementalNodes(){this._incrementalNodeObserver&&Th(this).unobserveNodes(this._incrementalNodeObserver)}_unobserveNodes(){this._nodeObserver&&Th(this).unobserveNodes(this._nodeObserver)}_getBypassPrefs(e){return null!==this._safetyBypass?{...e,context:this._safetyBypass}:e}clearDiffContent(){for(this._unobserveIncrementalNodes();this.$.diffTable.hasChildNodes();)this.$.diffTable.removeChild(this.$.diffTable.lastChild)}_computeDiffHeaderItems(e){const t=e.base;return t&&t.diff_header?t.diff_header.filter(e=>!(e.startsWith("diff --git ")||e.startsWith("index ")||e.startsWith("+++ ")||e.startsWith("--- ")||"Binary files differ"===e)):[]}_computeDiffHeaderHidden(e){return 0===e.length}_handleFullBypass(){this._safetyBypass=-1,this._debounceRenderDiffTable()}_collapseContext(){var e;this._safetyBypass=(null===(e=this.prefs)||void 0===e?void 0:e.context)&&this.prefs.context>=0?null:10,this._debounceRenderDiffTable()}_computeWarningClass(e){return e?"warn":""}_computeErrorClass(e){return e?"showError":""}toggleAllContext(){this.prefs&&(this._getBypassPrefs(this.prefs).context<0?this._collapseContext():this._handleFullBypass())}_computeNewlineWarning(e,t){const i=[];return e&&i.push("No newline at end of base file."),t&&i.push("No newline at end of revision file."),i.length?i.join("  "):null}_computeNewlineWarningClass(e,t){return t||!e?"newlineWarning hidden":"newlineWarning"}getDiffLength(e){return e?e.content.reduce((e,t)=>t.ab?e+t.ab.length:e+Math.max(t.a?t.a.length:0,t.b?t.b.length:0),0):0}};FE([Oo({type:String})],$E.prototype,"changeNum",void 0),FE([Oo({type:Boolean})],$E.prototype,"noAutoRender",void 0),FE([Oo({type:String,observer:"_pathObserver"})],$E.prototype,"path",void 0),FE([Oo({type:Object,observer:"_prefsObserver"})],$E.prototype,"prefs",void 0),FE([Oo({type:Object,observer:"_renderPrefsChanged"})],$E.prototype,"renderPrefs",void 0),FE([Oo({type:Boolean})],$E.prototype,"displayLine",void 0),FE([Oo({type:Boolean})],$E.prototype,"isImageDiff",void 0),FE([Oo({type:Boolean,reflectToAttribute:!0})],$E.prototype,"hidden",void 0),FE([Oo({type:Boolean})],$E.prototype,"noRenderOnPrefsChange",void 0),FE([Oo({type:Array})],$E.prototype,"_commentRanges",void 0),FE([Oo({type:Object})],$E.prototype,"highlightRange",void 0),FE([Oo({type:Array})],$E.prototype,"coverageRanges",void 0),FE([Oo({type:Boolean,observer:"_lineWrappingObserver"})],$E.prototype,"lineWrapping",void 0),FE([Oo({type:String,observer:"_viewModeObserver"})],$E.prototype,"viewMode",void 0),FE([Oo({type:Object})],$E.prototype,"lineOfInterest",void 0),FE([Oo({type:Boolean,notify:!0,readOnly:!0})],$E.prototype,"loading",void 0),FE([Oo({type:Boolean})],$E.prototype,"loggedIn",void 0),FE([Oo({type:Object,observer:"_diffChanged"})],$E.prototype,"diff",void 0),FE([Oo({type:Array,computed:"_computeDiffHeaderItems(diff.*)"})],$E.prototype,"_diffHeaderItems",void 0),FE([Oo({type:String})],$E.prototype,"_diffTableClass",void 0),FE([Oo({type:Object})],$E.prototype,"baseImage",void 0),FE([Oo({type:Object})],$E.prototype,"revisionImage",void 0),FE([Oo({type:Boolean})],$E.prototype,"isContentEditable",void 0),FE([Oo({type:Number})],$E.prototype,"_safetyBypass",void 0),FE([Oo({type:Boolean})],$E.prototype,"_showWarning",void 0),FE([Oo({type:String})],$E.prototype,"errorMessage",void 0),FE([Oo({type:Object,observer:"_blameChanged"})],$E.prototype,"blame",void 0),FE([Oo({type:Number})],$E.prototype,"parentIndex",void 0),FE([Oo({type:Boolean})],$E.prototype,"showNewlineWarningLeft",void 0),FE([Oo({type:Boolean})],$E.prototype,"showNewlineWarningRight",void 0),FE([Oo({type:String,observer:"_useNewImageDiffUiObserver"})],$E.prototype,"useNewImageDiffUi",void 0),FE([Oo({type:String,computed:"_computeNewlineWarning(showNewlineWarningLeft, showNewlineWarningRight)"})],$E.prototype,"_newlineWarning",void 0),FE([Oo({type:Number})],$E.prototype,"_diffLength",void 0),FE([Oo({type:Object})],$E.prototype,"_incrementalNodeObserver",void 0),FE([Oo({type:Object})],$E.prototype,"_nodeObserver",void 0),FE([Oo({type:Array})],$E.prototype,"layers",void 0),FE([Oo({type:Boolean})],$E.prototype,"isAttached",void 0),FE([No("loggedIn","isAttached")],$E.prototype,"_enableSelectionObserver",null),$E=FE([Po("gr-diff")],$E);const BE=mi`
  <style include="shared-styles">
    :host {
      font-family: var(--font-family);
      font-size: var(--font-size-normal);
      font-weight: var(--font-weight-normal);
      line-height: var(--line-height-normal);
      /* Explicitly set the background color of the diff. We
       * cannot use the diff content type ab because of the skip chunk preceding
       * it, diff processor assumes the chunk of type skip/ab can be collapsed
       * and hides our diff behind context control buttons.
       *  */
      --dark-add-highlight-color: var(--background-color-primary);
    }
    gr-button {
      margin-left: var(--spacing-m);
    }
    gr-comment {
      border-bottom: 1px solid var(--comment-separator-color);
    }
    #actions {
      margin-left: auto;
      padding: var(--spacing-s) var(--spacing-m);
    }
    .comment-box {
      width: 80ch;
      max-width: 100%;
      background-color: var(--comment-background-color);
      color: var(--comment-text-color);
      box-shadow: var(--elevation-level-2);
      border-radius: var(--border-radius);
      flex-shrink: 0;
    }
    #container {
      display: var(--gr-comment-thread-display, flex);
      align-items: flex-start;
      margin: 0 var(--spacing-s) var(--spacing-s);
      white-space: normal;
      /** This is required for firefox to continue the inheritance */
      -webkit-user-select: inherit;
      -moz-user-select: inherit;
      -ms-user-select: inherit;
      user-select: inherit;
    }
    .comment-box.unresolved {
      background-color: var(--unresolved-comment-background-color);
    }
    .comment-box.robotComment {
      background-color: var(--robot-comment-background-color);
    }
    #commentInfoContainer {
      display: flex;
    }
    #unresolvedLabel {
      font-family: var(--font-family);
      margin: auto 0;
      padding: var(--spacing-m);
    }
    .pathInfo {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      padding: 0 var(--spacing-s) var(--spacing-s);
    }
    .descriptionText {
      margin-left: var(--spacing-m);
      font-style: italic;
    }
    .fileName {
      padding: var(--spacing-m) var(--spacing-s) var(--spacing-m);
    }
    @media only screen and (max-width: 1200px) {
      .diff-container {
        display: none;
      }
    }
    .diff-container {
      margin-left: var(--spacing-l);
      border: 1px solid var(--border-color);
      flex-grow: 1;
      flex-shrink: 1;
      max-width: 1200px;
    }
    .view-diff-button {
      margin: var(--spacing-s) var(--spacing-m);
    }
    .view-diff-container {
      border-top: 1px solid var(--border-color);
      background-color: var(--background-color-primary);
    }
  </style>

  <template is="dom-if" if="[[showFilePath]]">
    <template is="dom-if" if="[[showFileName]]">
      <div class="fileName">
        <template is="dom-if" if="[[_isPatchsetLevelComment(path)]]">
          <span> [[_computeDisplayPath(path)]] </span>
        </template>
        <template is="dom-if" if="[[!_isPatchsetLevelComment(path)]]">
          <a
            href$="[[_getDiffUrlForPath(projectName, changeNum, path, patchNum)]]"
          >
            [[_computeDisplayPath(path)]]
          </a>
        </template>
      </div>
    </template>
    <div class="pathInfo">
      <template is="dom-if" if="[[!_isPatchsetLevelComment(path)]]">
        <a
          href$="[[_getDiffUrlForComment(projectName, changeNum, path, patchNum)]]"
          >[[_computeDisplayLine()]]</a
        >
      </template>
    </div>
  </template>
  <div id="container">
    <div class$="[[_computeHostClass(unresolved, isRobotComment)]] comment-box">
      <template
        id="commentList"
        is="dom-repeat"
        items="[[_orderedComments]]"
        as="comment"
      >
        <gr-comment
          comment="{{comment}}"
          comments="{{comments}}"
          robot-button-disabled="[[_shouldDisableAction(_showActions, _lastComment)]]"
          change-num="[[changeNum]]"
          project-name="[[projectName]]"
          patch-num="[[patchNum]]"
          draft="[[_isDraft(comment)]]"
          show-actions="[[_showActions]]"
          show-patchset="[[showPatchset]]"
          show-ported-comment="[[_computeShowPortedComment(comment)]]"
          side="[[comment.side]]"
          project-config="[[_projectConfig]]"
          on-create-fix-comment="_handleCommentFix"
          on-comment-discard="_handleCommentDiscard"
          on-comment-save="_handleCommentSavedOrDiscarded"
        ></gr-comment>
      </template>
      <div
        id="commentInfoContainer"
        hidden$="[[_hideActions(_showActions, _lastComment)]]"
      >
        <span id="unresolvedLabel">[[_getUnresolvedLabel(unresolved)]]</span>
        <div id="actions">
          <gr-button
            id="replyBtn"
            link=""
            class="action reply"
            on-click="_handleCommentReply"
            >Reply</gr-button
          >
          <gr-button
            id="quoteBtn"
            link=""
            class="action quote"
            on-click="_handleCommentQuote"
            >Quote</gr-button
          >
          <template is="dom-if" if="[[unresolved]]">
            <gr-button
              id="ackBtn"
              link=""
              class="action ack"
              on-click="_handleCommentAck"
              >Ack</gr-button
            >
            <gr-button
              id="doneBtn"
              link=""
              class="action done"
              on-click="_handleCommentDone"
              >Done</gr-button
            >
          </template>
        </div>
      </div>
    </div>
    <template is="dom-if" if="[[_shouldShowCommentContext(_diff)]]">
      <div class="diff-container">
        <gr-diff
          id="diff"
          change-num="[[changeNum]]"
          diff="[[_diff]]"
          layers="[[_getLayers(_diff)]]"
          path="[[path]]"
          prefs="[[_prefs]]"
          render-prefs="[[_renderPrefs]]"
          highlight-range="[[getHighlightRange(comments)]]"
        >
        </gr-diff>
        <div class="view-diff-container">
          <a href="[[_getUrlForViewDiff(comments)]]">
            <gr-button link class="view-diff-button" on-click="_handleViewDiff">
              View Diff
            </gr-button>
          </a>
        </div>
      </div>
    </template>
  </div>
`;function jE(){window.Gerrit=window.Gerrit||{},function(e){e.css=t=>{if(i.reportingService.trackApi(HE,"global","css"),console.warn("Gerrit.css(rulesStr) is deprecated!","Use plugin.styles().css(rulesStr)"),!e._customStyleSheet){const t=document.createElement("style");document.head.appendChild(t),e._customStyleSheet=t.sheet}const n=`__pg_js_api_class_${e._customStyleSheet.cssRules.length}`;return e._customStyleSheet.insertRule("."+n+"{"+t+"}",0),n},e.install=(e,t,i)=>{Qu().install(e,t,i)},e.getLoggedIn=()=>(i.reportingService.trackApi(HE,"global","getLoggedIn"),console.warn("Gerrit.getLoggedIn() is deprecated! Use plugin.restApi().getLoggedIn()"),i.restApiService.getLoggedIn()),e.get=(e,t)=>{i.reportingService.trackApi(HE,"global","get"),console.warn(".get() is deprecated! Use plugin.restApi().get()"),La(mn.GET,e,t)},e.post=(e,t,n)=>{i.reportingService.trackApi(HE,"global","post"),console.warn(".post() is deprecated! Use plugin.restApi().post()"),La(mn.POST,e,n,t)},e.put=(e,t,n)=>{i.reportingService.trackApi(HE,"global","put"),console.warn(".put() is deprecated! Use plugin.restApi().put()"),La(mn.PUT,e,n,t)},e.delete=(e,t)=>{i.reportingService.trackApi(HE,"global","delete"),function(e,t){console.warn(".delete() is deprecated! Use plugin.restApi().delete()"),i.restApiService.send(mn.DELETE,e).then(e=>204!==e.status?e.text().then(t=>t?Promise.reject(new Error(t)):Promise.reject(new Error(`${e.status}`))):(t&&t(e),e))}(e,t)},e.awaitPluginsLoaded=()=>(i.reportingService.trackApi(HE,"global","awaitPluginsLoaded"),Qu().awaitPluginsLoaded()),e._loadPlugins=e=>{i.reportingService.trackApi(HE,"global","_loadPlugins"),Qu().loadPlugins(e)},e._arePluginsLoaded=()=>(i.reportingService.trackApi(HE,"global","_arePluginsLoaded"),Qu().arePluginsLoaded()),e._isPluginPreloaded=e=>(i.reportingService.trackApi(HE,"global","_isPluginPreloaded"),Qu().isPluginPreloaded(e)),e._isPluginEnabled=e=>(i.reportingService.trackApi(HE,"global","_isPluginEnabled"),Qu().isPluginEnabled(e)),e._isPluginLoaded=e=>(i.reportingService.trackApi(HE,"global","_isPluginLoaded"),Qu().isPluginLoaded(e));const t=i.eventEmitter;e._eventEmitter=t,e.addListener=(e,n)=>(i.reportingService.trackApi(HE,"global","addListener"),t.addListener(e,n)),e.dispatch=(e,n)=>(i.reportingService.trackApi(HE,"global","dispatch"),t.dispatch(e,n)),e.emit=(e,n)=>(i.reportingService.trackApi(HE,"global","emit"),t.emit(e,n)),e.off=(e,n)=>(i.reportingService.trackApi(HE,"global","off"),t.off(e,n)),e.on=(e,n)=>(i.reportingService.trackApi(HE,"global","on"),t.on(e,n)),e.once=(e,n)=>(i.reportingService.trackApi(HE,"global","once"),t.once(e,n)),e.removeAllListeners=e=>(i.reportingService.trackApi(HE,"global","removeAllListeners"),t.removeAllListeners(e)),e.removeListener=(e,n)=>(i.reportingService.trackApi(HE,"global","removeListener"),t.removeListener(e,n))}(window.Gerrit),Qu().installPreloadedPlugins()}const HE={getPluginName:()=>"global"};class UE{constructor(){this.jsAPI=i.jsApiService,this._hljsState={configured:!1,loading:!1,callbacks:[]}}getHLJS(){return new Promise((e,t)=>{this._getHighlightLib()?e(this._getHighlightLib()):(this._hljsState.loading||(this._hljsState.loading=!0,this._loadScript(this._getHLJSUrl()).then(()=>this._onHLJSLibLoaded()).catch(t)),this._hljsState.callbacks.push(e))})}_onHLJSLibLoaded(){const e=this._getHighlightLib();this._hljsState.loading=!1,this.jsAPI.handleEvent(Fa.HIGHLIGHTJS_LOADED,{hljs:e});for(const t of this._hljsState.callbacks)t(e);this._hljsState.callbacks=[]}_getHighlightLib(){const e=window.hljs;return e&&!this._hljsState.configured&&(this._hljsState.configured=!0,e.configure({classPrefix:"gr-diff gr-syntax gr-syntax-"})),e}_getLibRoot(){return window.STATIC_RESOURCE_PATH?window.STATIC_RESOURCE_PATH+"/":"/"}_loadScript(e){return new Promise((t,i)=>{const n=document.createElement("script");e?(n.setAttribute("src",e),n.onload=t,n.onerror=i,document.head.appendChild(n)):i(new Error("Unable to load blank script url."))})}_getHLJSUrl(){const e=this._getLibRoot();return e?e+"bower_components/highlightjs/highlight.min.js":null}}const GE=new Map([["application/dart","dart"],["application/json","json"],["application/x-powershell","powershell"],["application/typescript","typescript"],["application/xml","xml"],["application/xquery","xquery"],["application/x-erb","erb"],["text/css","css"],["text/html","html"],["text/javascript","js"],["text/jsx","jsx"],["text/tsx","jsx"],["text/x-c","cpp"],["text/x-c++src","cpp"],["text/x-clojure","clojure"],["text/x-cmake","cmake"],["text/x-coffeescript","coffeescript"],["text/x-common-lisp","lisp"],["text/x-crystal","crystal"],["text/x-csharp","csharp"],["text/x-csrc","cpp"],["text/x-d","d"],["text/x-diff","diff"],["text/x-django","django"],["text/x-dockerfile","dockerfile"],["text/x-ebnf","ebnf"],["text/x-elm","elm"],["text/x-erlang","erlang"],["text/x-fortran","fortran"],["text/x-fsharp","fsharp"],["text/x-go","go"],["text/x-groovy","groovy"],["text/x-haml","haml"],["text/x-handlebars","handlebars"],["text/x-haskell","haskell"],["text/x-haxe","haxe"],["text/x-ini","ini"],["text/x-java","java"],["text/x-julia","julia"],["text/x-kotlin","kotlin"],["text/x-latex","latex"],["text/x-less","less"],["text/x-lua","lua"],["text/x-mathematica","mathematica"],["text/x-nginx-conf","nginx"],["text/x-nsis","nsis"],["text/x-objectivec","objectivec"],["text/x-ocaml","ocaml"],["text/x-perl","perl"],["text/x-pgsql","pgsql"],["text/x-php","php"],["text/x-properties","properties"],["text/x-protobuf","protobuf"],["text/x-puppet","puppet"],["text/x-python","python"],["text/x-q","q"],["text/x-ruby","ruby"],["text/x-rustsrc","rust"],["text/x-scala","scala"],["text/x-scss","scss"],["text/x-scheme","scheme"],["text/x-shell","shell"],["text/x-soy","soy"],["text/x-spreadsheet","excel"],["text/x-sh","bash"],["text/x-sql","sql"],["text/x-swift","swift"],["text/x-systemverilog","sv"],["text/x-tcl","tcl"],["text/x-torque","torque"],["text/x-twig","twig"],["text/x-vb","vb"],["text/x-verilog","v"],["text/x-vhdl","vhdl"],["text/x-yaml","yaml"],["text/vbscript","vbscript"]]),zE=new Set(["gr-diff gr-syntax gr-syntax-attr","gr-diff gr-syntax gr-syntax-attribute","gr-diff gr-syntax gr-syntax-built_in","gr-diff gr-syntax gr-syntax-comment","gr-diff gr-syntax gr-syntax-doctag","gr-diff gr-syntax gr-syntax-function","gr-diff gr-syntax gr-syntax-keyword","gr-diff gr-syntax gr-syntax-link","gr-diff gr-syntax gr-syntax-literal","gr-diff gr-syntax gr-syntax-meta","gr-diff gr-syntax gr-syntax-meta-keyword","gr-diff gr-syntax gr-syntax-name","gr-diff gr-syntax gr-syntax-number","gr-diff gr-syntax gr-syntax-params","gr-diff gr-syntax gr-syntax-property","gr-diff gr-syntax gr-syntax-regexp","gr-diff gr-syntax gr-syntax-selector-attr","gr-diff gr-syntax gr-syntax-selector-class","gr-diff gr-syntax gr-syntax-selector-id","gr-diff gr-syntax gr-syntax-selector-pseudo","gr-diff gr-syntax gr-syntax-selector-tag","gr-diff gr-syntax gr-syntax-string","gr-diff gr-syntax gr-syntax-tag","gr-diff gr-syntax gr-syntax-template-tag","gr-diff gr-syntax gr-syntax-template-variable","gr-diff gr-syntax gr-syntax-title","gr-diff gr-syntax gr-syntax-type","gr-diff gr-syntax gr-syntax-variable"]),VE=/^\s*#(if|define).*</,WE=/L'(\\)?.'/g,qE=/(@[^\s]+)\(([^)]+)\)/g,KE=/</g;class YE{constructor(){this.enabled=!0,this.baseRanges=[],this.revisionRanges=[],this.listeners=[],this.processHandle=null,this.processPromise=null,this.libLoader=new UE}init(e){this.cancel(),this.baseRanges=[],this.revisionRanges=[],this.diff=e}setEnabled(e){this.enabled=e}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}annotate(e,t,i){if(!this.enabled)return;if("FILE"===i.beforeNumber||"FILE"===i.afterNumber)return;if("LOST"===i.beforeNumber||"LOST"===i.afterNumber)return;let n;i.type===Wi.REMOVE||i.type===Wi.BOTH&&"right"!==e.getAttribute("data-side")?n="left":i.type!==Wi.ADD&&"left"===e.getAttribute("data-side")||(n="right");let o=[];"left"===n&&this.baseRanges.length>=i.beforeNumber?o=this.baseRanges[i.beforeNumber-1]||[]:"right"===n&&this.revisionRanges.length>=i.afterNumber&&(o=this.revisionRanges[i.afterNumber-1]||[]);for(const t of o)Dm.annotateElement(e,t.start,t.length,t.className)}_getLanguage(e){var t;return null!==(t=e.language)&&void 0!==t?t:GE.get(e.content_type)}process(){var e;if(this.cancel(),this.baseRanges=[],this.revisionRanges=[],!this.enabled||!(null===(e=this.diff)||void 0===e?void 0:e.content.length))return Promise.resolve();if(this.diff.meta_a&&(this.baseLanguage=this._getLanguage(this.diff.meta_a)),this.diff.meta_b&&(this.revisionLanguage=this._getLanguage(this.diff.meta_b)),!this.baseLanguage&&!this.revisionLanguage)return Promise.resolve();const t={sectionIndex:0,lineIndex:0,baseContext:void 0,revisionContext:void 0,lineNums:{left:1,right:1},lastNotify:{left:1,right:1}},i=new Map;return this.processPromise=mS.makeCancelable(this._loadHLJS().then(()=>new Promise(e=>{const n=()=>{if(this.processHandle=null,this._processNextLine(t,i),t.lineIndex++,this._isSectionDone(t)&&(t.lineIndex=0,t.sectionIndex++),!this.diff||t.sectionIndex>=this.diff.content.length)return e(),void this._notify(t);t.lineIndex%100==0?(this._notify(t),this.processHandle=window.setTimeout(n,10)):n.call(this)};this.processHandle=window.setTimeout(n,1)}))),this.processPromise.finally(()=>{this.processPromise=null})}cancel(){null!==this.processHandle&&(clearTimeout(this.processHandle),this.processHandle=null),this.processPromise&&this.processPromise.cancel()}_rangesFromString(e,t){const i=t.get(e);if(i)return i;const n=document.createElement("div");n.innerHTML=e;const o=this._rangesFromElement(n,0);return t.set(e,o),o}_rangesFromElement(e,t){let i=[];for(const n of e.childNodes){const e=Dm.getLength(n);n instanceof Element&&"SPAN"===n.tagName&&"undefined"!==n.className&&(zE.has(n.className)&&i.push({start:t,length:e,className:n.className}),n.children.length&&(i=i.concat(this._rangesFromElement(n,t)))),t+=e}return i}_processNextLine(e,t){if(!this.diff)return;if(!this.hljs)return;let i,n;const o=this.diff.content[e.sectionIndex];if(o.ab)i=o.ab[e.lineIndex],n=o.ab[e.lineIndex],e.lineNums.left++,e.lineNums.right++;else if(o.a&&o.a.length>e.lineIndex&&(i=o.a[e.lineIndex],e.lineNums.left++),o.b&&o.b.length>e.lineIndex&&(n=o.b[e.lineIndex],e.lineNums.right++),o.skip){e.lineNums.left+=o.skip,e.lineNums.right+=o.skip;for(let e=0;e<o.skip;e++)this.revisionRanges.push([])}let r;this.baseLanguage&&void 0!==i&&this.hljs.getLanguage(this.baseLanguage)&&(i=this._workaround(this.baseLanguage,i),r=this.hljs.highlight(this.baseLanguage,i,!0,e.baseContext),this.baseRanges.push(this._rangesFromString(r.value,t)),e.baseContext=r.top),this.revisionLanguage&&void 0!==n&&this.hljs.getLanguage(this.revisionLanguage)&&(n=this._workaround(this.revisionLanguage,n),r=this.hljs.highlight(this.revisionLanguage,n,!0,e.revisionContext),this.revisionRanges.push(this._rangesFromString(r.value,t)),e.revisionContext=r.top)}_workaround(e,t){return"cpp"===e?(VE.test(t)&&(t=t.replace(KE,"|")),WE.test(t)&&(t=t.replace(WE,'L"$1."')),t):"java"===e&&qE.test(t)?t.replace(qE,"$1 $2 "):"go"===e&&t.includes("'\\\\'")?t.replace("'\\\\'",'"\\\\"'):t}_isSectionDone(e){if(!this.diff)return!0;const t=this.diff.content[e.sectionIndex];return t.ab?e.lineIndex>=t.ab.length:(!t.a||e.lineIndex>=t.a.length)&&(!t.b||e.lineIndex>=t.b.length)}_notify(e){e.lineNums.left-e.lastNotify.left&&(this._notifyRange(e.lastNotify.left,e.lineNums.left,zi.LEFT),e.lastNotify.left=e.lineNums.left),e.lineNums.right-e.lastNotify.right&&(this._notifyRange(e.lastNotify.right,e.lineNums.right,zi.RIGHT),e.lastNotify.right=e.lineNums.right)}_notifyRange(e,t,i){for(const n of this.listeners)n(e,t,i)}_loadHLJS(){return this.libLoader.getHLJS().then(e=>{this.hljs=e})}}var XE=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const JE=/\n/g;let ZE=class extends(Kf(fi)){constructor(){super(),this.comments=[],this.keyEventTarget=document.body,this.isOnParent=!1,this.parentIndex=null,this.showFilePath=!1,this._orderedComments=[],this._prefs={context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8},this._renderPrefs={hide_left_side:!0,disable_context_control_buttons:!0,show_file_comment_button:!1,hide_line_length_indicator:!0},this.isRobotComment=!1,this.showFileName=!0,this.showPortedComment=!1,this.showPatchset=!0,this.showCommentContext=!1,this.reporting=i.reportingService,this.flagsService=i.flagsService,this.storage=i.storageService,this.syntaxLayer=new YE,this.restApiService=i.restApiService,this.addEventListener("comment-update",e=>this._handleCommentUpdate(e))}static get template(){return BE}get keyBindings(){return{"e shift+e":"_handleEKey"}}connectedCallback(){super.connectedCallback(),this._getLoggedIn().then(e=>{this._showActions=e}),this.restApiService.getDiffPreferences().then(e=>{e&&(this._prefs={...e,line_wrapping:!0},this.syntaxLayer.setEnabled(!!e.syntax_highlighting))}),this._setInitialExpandedState()}get _diff(){var e,t;if(void 0===this.comments||void 0===this.path)return;if(!(null===(t=null===(e=this.comments[0])||void 0===e?void 0:e.context_lines)||void 0===t?void 0:t.length))return;Pi(this,"render").then(()=>{this.syntaxLayer.process()});const i=(n=this.comments[0].context_lines,o=this.path,r=this.comments[0].source_content_type,{meta_a:{name:"",content_type:"",lines:0,web_links:[]},meta_b:{name:o,content_type:r||"",lines:(n=n.slice(0,20)).length+(null==n?void 0:n[0].line_number),web_links:[]},change_type:"MODIFIED",intraline_status:"OK",diff_header:[],content:[{skip:n[0].line_number-1},{b:n.map(e=>e.context_line)}]});var n,o,r;return this.syntaxLayer.init(i),i}_shouldShowCommentContext(e){return this.showCommentContext&&!!e}addOrEditDraft(e,t){const i=this.comments[this.comments.length-1]||{};if(Gw(i)){const e=this._commentElWithDraftID(i.id||i.__draftID);if(!e)throw new Error("Failed to find draft.");e.editing=!0,e.collapsed=!1}else{const n=t||(i?i.range:void 0),o=i?i.unresolved:void 0;this.addDraft(e,n,o)}}addDraft(e,t,i){const n=this._newDraft(e,t);n.__editing=!0,n.unresolved=!1!==i||i,this.push("comments",n)}fireRemoveSelf(){this.dispatchEvent(new CustomEvent("thread-discard",{detail:{rootId:this.rootId},bubbles:!1}))}_getDiffUrlForPath(e,t,i,n){if(!t||!e||!i)return;if(Gw(this.comments[0]))return Qm.getUrlForDiffById(t,e,i,n);const o=this.comments[0].id;if(!o)throw new Error("A published comment is missing the id.");return Qm.getUrlForComment(t,e,o)}getHighlightRange(){var e;const t=null===(e=this.comments)||void 0===e?void 0:e[0];if(t)return t.range?t.range:t.line?{start_line:t.line,start_character:0,end_line:t.line,end_character:0}:void 0}_getLayers(e){return e?[this.syntaxLayer]:[]}_getUrlForViewDiff(e){return a(this.changeNum,"changeNum"),a(this.projectName,"projectName"),s(e.length>0,"comment not found"),Qm.getUrlForComment(this.changeNum,this.projectName,e[0].id)}_getDiffUrlForComment(e,t,i,n){if(!e||!t||!i)return;if(this.comments.length&&"PARENT"===this.comments[0].side||Gw(this.comments[0])){if("LOST"===this.lineNum)throw new Error("invalid lineNum lost");return Qm.getUrlForDiffById(t,e,i,n,void 0,"FILE"===this.lineNum?void 0:this.lineNum)}const o=this.comments[0].id;if(!o)throw new Error("A published comment is missing the id.");return Qm.getUrlForComment(t,e,o)}_isPatchsetLevelComment(e){return e===Zi.PATCHSET_LEVEL_COMMENTS}_computeShowPortedComment(e){return 0!==this._orderedComments.length&&(this.showPortedComment&&e.id===this._orderedComments[0].id)}_computeDisplayPath(e){const t=qb(e);return t===Zi.PATCHSET_LEVEL_COMMENTS?"Patchset":t}_computeDisplayLine(){return"FILE"===this.lineNum?this.path===Zi.PATCHSET_LEVEL_COMMENTS?"":"FILE":this.lineNum?`#${this.lineNum}`:this.range?`#${this.range.end_line}`:""}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getUnresolvedLabel(e){return e?"Unresolved":"Resolved"}_commentsChanged(){this._orderedComments=zw(this.comments),this.updateThreadProperties()}updateThreadProperties(){this._orderedComments.length&&(this._lastComment=this._getLastComment(),this.unresolved=this._lastComment.unresolved,this.hasDraft=Gw(this._lastComment),this.isRobotComment=Uw(this._lastComment))}_shouldDisableAction(e,t){return!e||!t||Gw(t)}_hideActions(e,t){return this._shouldDisableAction(e,t)||Uw(t)}_getLastComment(){return this._orderedComments[this._orderedComments.length-1]||{}}_handleEKey(e){var t;if(!this.shouldSuppressKeyboardShortcut(e))if(null===(t=e.detail.keyboardEvent)||void 0===t?void 0:t.shiftKey)this._expandCollapseComments(!0);else{if(this.modifierPressed(e))return;this._expandCollapseComments(!1)}}_expandCollapseComments(e){var t;const i=null===(t=this.root)||void 0===t?void 0:t.querySelectorAll("gr-comment");if(i)for(const t of i)t.collapsed=e}_setInitialExpandedState(){if(this._orderedComments)for(let e=0;e<this._orderedComments.length;e++){const t=this._orderedComments[e],i=!!t.robot_id,n=!this.unresolved||this._orderedComments.length-e-1>=5;void 0===t.collapsed&&(t.collapsed=!i&&n)}}_createReplyComment(e,t,i){this.reporting.recordDraftInteraction();const n=this._orderedComments[this._orderedComments.length-1].id;if(!n)throw new Error("Cannot reply to comment without id.");const o=this._newReply(n,e,i);t&&(o.__editing=!0),this.push("comments",o),t||setTimeout(()=>{const e=this._commentElWithDraftID(o.__draftID);e&&e.save()},1)}_isDraft(e){return Gw(e)}_processCommentReply(e){const t=this._lastComment;if(!t)throw new Error("Failed to find last comment.");let i=void 0;if(e){const e=t.message;if(!e)throw new Error("Quoting empty comment.");i="> "+e.replace(JE,"\n> ")+"\n\n"}this._createReplyComment(i,!0,t.unresolved)}_handleCommentReply(){this._processCommentReply()}_handleCommentQuote(){this._processCommentReply(!0)}_handleCommentAck(){this._createReplyComment("Ack",!1,!1)}_handleCommentDone(){this._createReplyComment("Done",!1,!1)}_handleCommentFix(e){const t="> "+e.detail.comment.message.replace(JE,"\n> ")+"\n\n"+"Please fix.";this._createReplyComment(t,!1,!0)}_commentElWithDraftID(e){var t;if(!e)return null;const i=null===(t=this.root)||void 0===t?void 0:t.querySelectorAll("gr-comment");if(!i)return null;for(const t of i){const i=t.comment;if(!Uw(i)&&((null==i?void 0:i.id)===e||Gw(i)&&(null==i?void 0:i.__draftID)===e))return t}return null}_newReply(e,t,i){const n=this._newDraft();return n.in_reply_to=e,void 0!==t&&(n.message=t),void 0!==i&&(n.unresolved=i),n}_newDraft(e,t){const i={__draft:!0,__draftID:Math.random().toString(36),__date:new Date};if("LOST"===e)throw new Error("invalid lineNum lost");if(this.comments&&this.comments.length>=1){const e=this.comments[0];void 0!==e.path&&(i.path=e.path),void 0!==e.patch_set&&(i.patch_set=e.patch_set),void 0!==e.side&&(i.side=e.side),void 0!==e.line&&(i.line=e.line),void 0!==e.range&&(i.range=e.range),void 0!==e.parent&&(i.parent=e.parent)}else i.path=this.path,i.patch_set=this.patchNum,i.side=this._getSide(this.isOnParent),e&&"FILE"!==e&&(i.line=e),t&&(i.range=t),this.parentIndex&&(i.parent=this.parentIndex);return i}_getSide(e){return e?fn.PARENT:fn.REVISION}_computeRootId(e){if(!e.base.length)return this.rootId;const t=e.base[0];if(t.id)return t.id;if(Gw(t))return t.__draftID;throw new Error("Missing id in root comment.")}_handleCommentDiscard(e){var t;a(this.changeNum,"changeNum"),a(this.patchNum,"patchNum");const i=Th(e).rootTarget,n=i.comment,o=this._indexOf(n,this.comments);if(-1===o)throw new Error("Cannot find comment "+JSON.stringify(i.comment));this.splice("comments",o,1),0===this.comments.length&&this.fireRemoveSelf(),this._handleCommentSavedOrDiscarded();for(const e of this.comments)if(Gw(e)&&e.__editing){const i={changeNum:this.changeNum,patchNum:this.patchNum,path:e.path,line:e.line};this.storage.setDraftComment(i,null!==(t=e.message)&&void 0!==t?t:"")}}_handleCommentSavedOrDiscarded(){this.dispatchEvent(new CustomEvent("thread-changed",{detail:{rootId:this.rootId,path:this.path},bubbles:!1}))}_handleCommentUpdate(e){const t=e.detail.comment,i=this._indexOf(t,this.comments);-1!==i?(this.set(["comments",i],t),this.updateThreadProperties()):console.warn("Comment update for another comment thread.")}_indexOf(e,t){if(!e)return-1;for(let i=0;i<t.length;i++){const n=t[i];if(Gw(n)&&Gw(e)&&n.__draftID===e.__draftID||n.id&&n.id===e.id)return i}return-1}_computeHostClass(e){return this.isRobotComment?"robotComment":e?"unresolved":""}_projectNameChanged(e){e&&this.restApiService.getProjectConfig(e).then(e=>{this._projectConfig=e})}};XE([Oo({type:Number})],ZE.prototype,"changeNum",void 0),XE([Oo({type:Array})],ZE.prototype,"comments",void 0),XE([Oo({type:Object,reflectToAttribute:!0})],ZE.prototype,"range",void 0),XE([Oo({type:Object})],ZE.prototype,"keyEventTarget",void 0),XE([Oo({type:String,reflectToAttribute:!0})],ZE.prototype,"diffSide",void 0),XE([Oo({type:String})],ZE.prototype,"patchNum",void 0),XE([Oo({type:String})],ZE.prototype,"path",void 0),XE([Oo({type:String,observer:"_projectNameChanged"})],ZE.prototype,"projectName",void 0),XE([Oo({type:Boolean,notify:!0,reflectToAttribute:!0})],ZE.prototype,"hasDraft",void 0),XE([Oo({type:Boolean})],ZE.prototype,"isOnParent",void 0),XE([Oo({type:Number})],ZE.prototype,"parentIndex",void 0),XE([Oo({type:String,notify:!0,computed:"_computeRootId(comments.*)"})],ZE.prototype,"rootId",void 0),XE([Oo({type:Boolean})],ZE.prototype,"showFilePath",void 0),XE([Oo({type:Object,reflectToAttribute:!0})],ZE.prototype,"lineNum",void 0),XE([Oo({type:Boolean,notify:!0,reflectToAttribute:!0})],ZE.prototype,"unresolved",void 0),XE([Oo({type:Boolean})],ZE.prototype,"_showActions",void 0),XE([Oo({type:Object})],ZE.prototype,"_lastComment",void 0),XE([Oo({type:Array})],ZE.prototype,"_orderedComments",void 0),XE([Oo({type:Object})],ZE.prototype,"_projectConfig",void 0),XE([Oo({type:Object})],ZE.prototype,"_prefs",void 0),XE([Oo({type:Object})],ZE.prototype,"_renderPrefs",void 0),XE([Oo({type:Boolean,reflectToAttribute:!0})],ZE.prototype,"isRobotComment",void 0),XE([Oo({type:Boolean})],ZE.prototype,"showFileName",void 0),XE([Oo({type:Boolean})],ZE.prototype,"showPortedComment",void 0),XE([Oo({type:Boolean})],ZE.prototype,"showPatchset",void 0),XE([Oo({type:Boolean})],ZE.prototype,"showCommentContext",void 0),XE([Lo("comments","path")],ZE.prototype,"_diff",null),XE([No("comments.*")],ZE.prototype,"_commentsChanged",null),ZE=XE([Po("gr-comment-thread")],ZE);const QE=mi`
  <style include="shared-styles">
    #threads {
      display: block;
      padding: var(--spacing-l);
    }
    gr-comment-thread {
      display: block;
      margin-bottom: var(--spacing-m);
    }
    .header {
      align-items: center;
      background-color: var(--background-color-primary);
      border-bottom: 1px solid var(--border-color);
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: left;
      padding: var(--spacing-m) var(--spacing-l);
    }
    .draftsOnly:not(.unresolvedOnly) gr-comment-thread[has-draft],
    .unresolvedOnly:not(.draftsOnly) gr-comment-thread[unresolved],
    .draftsOnly.unresolvedOnly gr-comment-thread[has-draft][unresolved] {
      display: block;
    }
    .thread-separator {
      border-top: 1px solid var(--border-color);
      margin-top: var(--spacing-xl);
    }
    .resolved-comments-message {
      color: var(--link-color);
      cursor: pointer;
    }
    .show-resolved-comments {
      box-shadow: none;
      padding-left: var(--spacing-m);
    }
    .header .categoryRadio {
      height: 18px;
      width: 18px;
    }
    .header label {
      padding-left: 8px;
      margin-right: 16px;
    }
    .partypopper{
      margin-right: var(--spacing-s);
    }
  </style>
  <template is="dom-if" if="[[!hideToggleButtons]]">
    <div class="header">
        <input
          class="categoryRadio"
          id="unresolvedRadio"
          name="filterComments"
          type="radio"
          on-click="_handleOnlyUnresolved"
          checked="[[unresolvedOnly]]"
        />
        <label for="unresolvedRadio">
          Unresolved ([[_countUnresolved(threads)]])
        </label>
        <input
          class="categoryRadio"
          id="draftsRadio"
          name="filterComments"
          type="radio"
          on-click="_handleOnlyDrafts"
          checked="[[_draftsOnly]]"
        />
        <label for="draftsRadio">
          Drafts ([[_countDrafts(threads)]])
        </label>
        <input
          class="categoryRadio"
          id="allRadio"
          name="filterComments"
          type="radio"
          on-click="_handleAllComments"
          checked="[[_showAllComments(_draftsOnly, unresolvedOnly)]]"
        />
        <label for="allRadio">
          All ([[_countAllThreads(threads)]])
        </label>
    </div>
  </template>
  <div id="threads">
    <template
      is="dom-if"
      if="[[_showEmptyThreadsMessage(threads, _displayedThreads, unresolvedOnly)]]"
    >
      <div>
        <span>
          <template is="dom-if" if="[[_showPartyPopper(threads)]]">
            <span class="partypopper">\&#x1F389</span>
          </template>
          [[_computeEmptyThreadsMessage(threads, _displayedThreads,
          unresolvedOnly)]]
          <template is="dom-if" if="[[_showResolvedCommentsButton(threads, _displayedThreads, unresolvedOnly)]]">
            <gr-button
              class="show-resolved-comments"
              link
              on-click="_handleResolvedCommentsMessageClick">
                [[_computeResolvedCommentsMessage(threads, _displayedThreads,
                unresolvedOnly, onlyShowRobotCommentsWithHumanReply)]]
            </gr-button>
          </template>
        </span>
      </div>
    </template>
    <template
      is="dom-repeat"
      items="[[_displayedThreads]]"
      as="thread"
      initial-count="10"
      target-framerate="60"
    >
      <template
        is="dom-if"
        if="[[_shouldRenderSeparator(_displayedThreads, thread, unresolvedOnly, _draftsOnly, onlyShowRobotCommentsWithHumanReply)]]"
      >
        <div class="thread-separator"></div>
      </template>
      <gr-comment-thread
        show-file-path=""
        show-ported-comment="[[thread.ported]]"
        show-comment-context="[[showCommentContext]]"
        change-num="[[changeNum]]"
        comments="[[thread.comments]]"
        diff-side="[[thread.diffSide]]"
        show-file-name="[[_isFirstThreadWithFileName(_displayedThreads, thread, unresolvedOnly, _draftsOnly, onlyShowRobotCommentsWithHumanReply)]]"
        project-name="[[change.project]]"
        is-on-parent="[[_isOnParent(thread.commentSide)]]"
        line-num="[[thread.line]]"
        patch-num="[[thread.patchNum]]"
        path="[[thread.path]]"
        root-id="{{thread.rootId}}"
        on-thread-changed="_handleCommentsChanged"
        on-thread-discard="_handleThreadDiscard"
      ></gr-comment-thread>
    </template>
  </div>
`;var eA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let tA=class extends fi{constructor(){super(...arguments),this.threads=[],this._sortedThreads=[],this.showCommentContext=!1,this._displayedThreads=[],this.unresolvedOnly=!1,this._draftsOnly=!1,this.onlyShowRobotCommentsWithHumanReply=!1,this.hideToggleButtons=!1}static get template(){return QE}_showEmptyThreadsMessage(e,t,i){return!(!e||!t)&&(!e.length||i&&!t.length)}_computeEmptyThreadsMessage(e){return e.length?"No unresolved comments":"No comments."}_showPartyPopper(e){return!!e.length}_computeResolvedCommentsMessage(e,t,i,n){var o;return n&&(e=null!==(o=this.filterRobotThreadsWithoutHumanReply(e))&&void 0!==o?o:[]),i&&e.length&&!t.length?`Show ${Jb(e.length,"resolved comment")}`:""}_showResolvedCommentsButton(e,t,i){return i&&e.length&&!t.length}_handleResolvedCommentsMessageClick(){this.unresolvedOnly=!this.unresolvedOnly}_compareThreads(e,t){if(e.thread.path!==t.thread.path)return e.thread.path===Zi.PATCHSET_LEVEL_COMMENTS?-1:t.thread.path===Zi.PATCHSET_LEVEL_COMMENTS?1:e.thread.path.localeCompare(t.thread.path);if(e.thread.line!==t.thread.line)return e.thread.line&&t.thread.line?e.thread.line<t.thread.line?-1:1:e.thread.line?1:-1;if(e.thread.patchNum!==t.thread.patchNum)return e.thread.patchNum?t.thread.patchNum?e.thread.patchNum>t.thread.patchNum?-1:1:-1:1;if(t.unresolved!==e.unresolved){if(!e.unresolved)return 1;if(!t.unresolved)return-1}if(t.hasDraft!==e.hasDraft){if(!e.hasDraft)return 1;if(!t.hasDraft)return-1}return t.updated!==e.updated?e.updated?t.updated?t.updated.getTime()-e.updated.getTime():-1:1:t.thread.rootId!==e.thread.rootId?e.thread.rootId?t.thread.rootId?e.thread.rootId.localeCompare(t.thread.rootId):-1:1:0}_updateSortedThreads(e,t){if(!e||0===e.length)return this._sortedThreads=[],void(this._displayedThreads=[]);if(this._sortedThreads.length===e.length){for(const t of e){const e=this._sortedThreads.findIndex(e=>e.rootId===t.rootId);this.set(`_sortedThreads.${e}`,{...t})}return}const i=e.map(e=>this._getThreadWithStatusInfo(e));this._sortedThreads=i.sort((e,t)=>this._compareThreads(e,t)).map(e=>e.thread)}_computeDisplayedThreads(e,t,i,n){return e&&e.base?e.base.filter(e=>this._shouldShowThread(e,t,i,n)):[]}_isFirstThreadWithFileName(e,t,i,n,o){const r=e.filter(e=>this._shouldShowThread(e,i,n,o)),s=r.findIndex(e=>e.rootId===t.rootId);return-1!==s&&(0===s||r[s-1].path!==r[s].path)}_shouldRenderSeparator(e,t,i,n,o){const r=e.filter(e=>this._shouldShowThread(e,i,n,o)).findIndex(e=>e.rootId===t.rootId);return-1!==r&&(r>0&&this._isFirstThreadWithFileName(e,t,i,n,o))}_shouldShowThread(e,t,i,n){if([e,t,i,n].includes(void 0))return!1;if(!i&&!t&&!n)return!0;const o=this._getThreadWithStatusInfo(e);if(o.isEditing)return!0;if(o.hasRobotComment&&n&&!o.hasHumanReplyToRobotComment)return!1;let r=!0;return i&&t?r=o.hasDraft&&o.unresolved:i?r=o.hasDraft:t&&(r=o.unresolved),r}_getThreadWithStatusInfo(e){const t=e.comments,i=t.length?t[t.length-1]:void 0,n=Jw(e),o=n&&Zw(e);let r=void 0;return i&&(Gw(i)&&(r=i.__date),i.updated&&(r=Fi(i.updated))),{thread:e,hasRobotComment:n,hasHumanReplyToRobotComment:o,unresolved:!!i&&!!i.unresolved,isEditing:Gw(i)&&!!i.__editing,hasDraft:!!i&&Gw(i),updated:r}}removeThread(e){for(let t=0;t<this.threads.length;t++)if(this.threads[t].rootId===e)return this.splice("threads",t,1),void yh()}_handleThreadDiscard(e){this.removeThread(e.detail.rootId)}_handleCommentsChanged(e){var t,i,n;t=this,i=e.detail.rootId,n=e.detail.path,wi(t,vi.THREAD_LIST_MODIFIED,{rootId:i,path:n})}_isOnParent(e){return!!e}_handleOnlyUnresolved(){this.unresolvedOnly=!0,this._draftsOnly=!1}_handleOnlyDrafts(){this._draftsOnly=!0,this.unresolvedOnly=!1}_handleAllComments(){this._draftsOnly=!1,this.unresolvedOnly=!1}_showAllComments(e,t){return!e&&!t}_countUnresolved(e){var t,i;return null!==(i=null===(t=this.filterRobotThreadsWithoutHumanReply(e))||void 0===t?void 0:t.filter(Kw).length)&&void 0!==i?i:0}_countAllThreads(e){var t,i;return null!==(i=null===(t=this.filterRobotThreadsWithoutHumanReply(e))||void 0===t?void 0:t.length)&&void 0!==i?i:0}_countDrafts(e){var t,i;return null!==(i=null===(t=this.filterRobotThreadsWithoutHumanReply(e))||void 0===t?void 0:t.filter(Xw).length)&&void 0!==i?i:0}filterRobotThreadsWithoutHumanReply(e){return null==e?void 0:e.filter(e=>!Jw(e)||Zw(e))}_commentTabStateChange(e,t){if(!e||e===t)return;let i;switch(e){case yi.UNRESOLVED:this._handleOnlyUnresolved(),i="#unresolvedRadio";break;case yi.DRAFTS:this._handleOnlyDrafts(),i="#draftsRadio";break;case yi.SHOW_ALL:this._handleAllComments(),i="#allRadio";break;default:r(e,"Unsupported preferred state")}const n=i;window.setTimeout(()=>{var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(n);null==t||t.focus()},0)}};eA([Oo({type:Object})],tA.prototype,"change",void 0),eA([Oo({type:Array})],tA.prototype,"threads",void 0),eA([Oo({type:String})],tA.prototype,"changeNum",void 0),eA([Oo({type:Boolean})],tA.prototype,"loggedIn",void 0),eA([Oo({type:Array})],tA.prototype,"_sortedThreads",void 0),eA([Oo({type:Boolean})],tA.prototype,"showCommentContext",void 0),eA([Oo({computed:"_computeDisplayedThreads(_sortedThreads.*, unresolvedOnly, _draftsOnly, onlyShowRobotCommentsWithHumanReply)",type:Array})],tA.prototype,"_displayedThreads",void 0),eA([Oo({type:Boolean})],tA.prototype,"unresolvedOnly",void 0),eA([Oo({type:Boolean})],tA.prototype,"_draftsOnly",void 0),eA([Oo({type:Boolean})],tA.prototype,"onlyShowRobotCommentsWithHumanReply",void 0),eA([Oo({type:Boolean})],tA.prototype,"hideToggleButtons",void 0),eA([Oo({type:Object,observer:"_commentTabStateChange"})],tA.prototype,"commentTabState",void 0),eA([No("threads","threads.splices")],tA.prototype,"_updateSortedThreads",null),tA=eA([Po("gr-thread-list")],tA);const iA=mi`
  <style include="shared-styles">
    #dialog {
      min-width: 40em;
    }
    p {
      margin-bottom: var(--spacing-l);
    }
    .warningBeforeSubmit {
      color: var(--warning-foreground);
      vertical-align: top;
      margin-right: var(--spacing-s);
    }
    @media screen and (max-width: 50em) {
      #dialog {
        min-width: inherit;
        width: 100%;
      }
    }
  </style>
  <gr-dialog
    id="dialog"
    confirm-label="Continue"
    confirm-on-enter=""
    on-cancel="_handleCancelTap"
    on-confirm="_handleConfirmTap"
  >
    <template is="dom-if" if="[[_initialised]]">
      <div class="header" slot="header">[[action.label]]</div>
      <div class="main" slot="main">
        <gr-endpoint-decorator name="confirm-submit-change">
          <p>Ready to submit <strong>[[change.subject]]</strong>?</p>
          <template is="dom-if" if="[[change.is_private]]">
            <p>
              <iron-icon
                icon="gr-icons:warning"
                class="warningBeforeSubmit"
              ></iron-icon>
              <strong>Heads Up!</strong>
              Submitting this private change will also make it public.
            </p>
          </template>
          <template is="dom-if" if="[[change.unresolved_comment_count]]">
            <p>
              <iron-icon
                icon="gr-icons:warning"
                class="warningBeforeSubmit"
              ></iron-icon>
              [[_computeUnresolvedCommentsWarning(change)]]
            </p>
            <gr-thread-list
              id="commentList"
              threads="[[_computeUnresolvedThreads(commentThreads)]]"
              change="[[change]]"
              change-num="[[change._number]]"
              logged-in="true"
              hide-toggle-buttons
            >
            </gr-thread-list>
          </template>
          <template is="dom-if" if="[[_computeHasChangeEdit(change)]]">
            <iron-icon
              icon="gr-icons:warning"
              class="warningBeforeSubmit"
            ></iron-icon>
            Your unpublished edit will not be submitted. Did you forget to click
            <b>PUBLISH</b>?
          </template>
          <gr-endpoint-param
            name="change"
            value="[[change]]"
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="action"
            value="[[action]]"
          ></gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    </template>
  </gr-dialog>
`;var nA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let oA=class extends fi{constructor(){super(...arguments),this.commentThreads=[],this._initialised=!1}static get template(){return iA}init(){this._initialised=!0}resetFocus(){this.$.dialog.resetFocus()}_computeHasChangeEdit(e){return!!e&&!!e.revisions&&Object.values(e.revisions).some(e=>"edit"===e._number)}_computeUnresolvedThreads(e){return e?e.filter(e=>Kw(e)):[]}_computeUnresolvedCommentsWarning(e){const t=e.unresolved_comment_count;if(!t)throw new Error("unresolved comments undefined or 0");return`Heads Up! ${Jb(t,"unresolved comment")}.`}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("confirm",{bubbles:!1}))}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("cancel",{bubbles:!1}))}};nA([Oo({type:Object})],oA.prototype,"change",void 0),nA([Oo({type:Object})],oA.prototype,"action",void 0),nA([Oo({type:Array})],oA.prototype,"commentThreads",void 0),nA([Oo({type:Boolean})],oA.prototype,"_initialised",void 0),oA=nA([Po("gr-confirm-submit-dialog")],oA);const rA=mi`
  <style include="shared-styles">
    :host {
      display: flex;
      font-family: var(--font-family);
    }
    #actionLoadingMessage,
    #mainContent,
    section {
      display: flex;
    }
    #actionLoadingMessage,
    gr-button,
    gr-dropdown {
      /* px because don't have the same font size */
      margin-left: 8px;
    }
    #actionLoadingMessage {
      align-items: center;
      color: var(--deemphasized-text-color);
    }
    #confirmSubmitDialog .changeSubject {
      margin: var(--spacing-l);
      text-align: center;
    }
    iron-icon {
      color: inherit;
      margin-right: var(--spacing-xs);
    }
    #moreActions iron-icon {
      margin: 0;
    }
    #moreMessage,
    .hidden {
      display: none;
    }
    @media screen and (max-width: 50em) {
      #mainContent {
        flex-wrap: wrap;
      }
      gr-button {
        --gr-button: {
          padding: var(--spacing-m);
          white-space: nowrap;
        }
      }
      gr-button,
      gr-dropdown {
        margin: 0;
      }
      #actionLoadingMessage {
        margin: var(--spacing-m);
        text-align: center;
      }
      #moreMessage {
        display: inline;
      }
    }
  </style>
  <div id="mainContent">
    <span id="actionLoadingMessage" hidden$="[[!_actionLoadingMessage]]">
      [[_actionLoadingMessage]]</span
    >
    <section
      id="primaryActions"
      hidden$="[[_shouldHideActions(_topLevelActions.*, _loading)]]"
    >
      <template is="dom-repeat" items="[[_topLevelPrimaryActions]]" as="action">
        <gr-button
          link=""
          title$="[[action.title]]"
          has-tooltip="[[_computeHasTooltip(action.title)]]"
          position-below="true"
          data-action-key$="[[action.__key]]"
          data-action-type$="[[action.__type]]"
          data-label$="[[action.label]]"
          disabled$="[[_calculateDisabled(action, _hasKnownChainState)]]"
          on-click="_handleActionTap"
        >
          <iron-icon
            class$="[[_computeHasIcon(action)]]"
            icon$="gr-icons:[[action.icon]]"
          ></iron-icon>
          [[action.label]]
        </gr-button>
      </template>
    </section>
    <section
      id="secondaryActions"
      hidden$="[[_shouldHideActions(_topLevelActions.*, _loading)]]"
    >
      <template
        is="dom-repeat"
        items="[[_topLevelSecondaryActions]]"
        as="action"
      >
        <gr-button
          link=""
          title$="[[action.title]]"
          has-tooltip="[[_computeHasTooltip(action.title)]]"
          position-below="true"
          data-action-key$="[[action.__key]]"
          data-action-type$="[[action.__type]]"
          data-label$="[[action.label]]"
          disabled$="[[_calculateDisabled(action, _hasKnownChainState)]]"
          on-click="_handleActionTap"
        >
          <iron-icon
            class$="[[_computeHasIcon(action)]]"
            icon$="gr-icons:[[action.icon]]"
          ></iron-icon>
          [[action.label]]
        </gr-button>
      </template>
    </section>
    <gr-button hidden$="[[!_loading]]" disabled=""
      >Loading actions...</gr-button
    >
    <gr-dropdown
      id="moreActions"
      link=""
      vertical-offset="32"
      horizontal-align="right"
      on-tap-item="_handleOverflowItemTap"
      hidden$="[[_shouldHideActions(_menuActions.*, _loading)]]"
      disabled-ids="[[_disabledMenuActions]]"
      items="[[_menuActions]]"
    >
      <iron-icon icon="gr-icons:more-vert" aria-labelledby="moreMessage">
      </iron-icon>
      <span id="moreMessage">More</span>
    </gr-dropdown>
  </div>
  <gr-overlay id="overlay" with-backdrop="">
    <gr-confirm-rebase-dialog
      id="confirmRebase"
      class="confirmDialog"
      change-number="[[change._number]]"
      on-confirm="_handleRebaseConfirm"
      on-cancel="_handleConfirmDialogCancel"
      branch="[[change.branch]]"
      has-parent="[[hasParent]]"
      rebase-on-current="[[_computeRebaseOnCurrent(_revisionRebaseAction)]]"
      hidden=""
    ></gr-confirm-rebase-dialog>
    <gr-confirm-cherrypick-dialog
      id="confirmCherrypick"
      class="confirmDialog"
      change-status="[[changeStatus]]"
      commit-message="[[commitMessage]]"
      commit-num="[[commitNum]]"
      on-confirm="_handleCherrypickConfirm"
      on-cancel="_handleConfirmDialogCancel"
      project="[[change.project]]"
      hidden=""
    ></gr-confirm-cherrypick-dialog>
    <gr-confirm-cherrypick-conflict-dialog
      id="confirmCherrypickConflict"
      class="confirmDialog"
      on-confirm="_handleCherrypickConflictConfirm"
      on-cancel="_handleConfirmDialogCancel"
      hidden=""
    ></gr-confirm-cherrypick-conflict-dialog>
    <gr-confirm-move-dialog
      id="confirmMove"
      class="confirmDialog"
      on-confirm="_handleMoveConfirm"
      on-cancel="_handleConfirmDialogCancel"
      project="[[change.project]]"
      hidden=""
    ></gr-confirm-move-dialog>
    <gr-confirm-revert-dialog
      id="confirmRevertDialog"
      class="confirmDialog"
      on-confirm="_handleRevertDialogConfirm"
      on-cancel="_handleConfirmDialogCancel"
      hidden=""
    ></gr-confirm-revert-dialog>
    <gr-confirm-revert-submission-dialog
      id="confirmRevertSubmissionDialog"
      class="confirmDialog"
      commit-message="[[commitMessage]]"
      on-confirm="_handleRevertSubmissionDialogConfirm"
      on-cancel="_handleConfirmDialogCancel"
      hidden=""
    ></gr-confirm-revert-submission-dialog>
    <gr-confirm-abandon-dialog
      id="confirmAbandonDialog"
      class="confirmDialog"
      on-confirm="_handleAbandonDialogConfirm"
      on-cancel="_handleConfirmDialogCancel"
      hidden=""
    ></gr-confirm-abandon-dialog>
    <gr-confirm-submit-dialog
      id="confirmSubmitDialog"
      class="confirmDialog"
      change="[[change]]"
      action="[[_revisionSubmitAction]]"
      on-cancel="_handleConfirmDialogCancel"
      on-confirm="_handleSubmitConfirm"
      comment-threads="[[commentThreads]]"
      hidden=""
    ></gr-confirm-submit-dialog>
    <gr-dialog
      id="createFollowUpDialog"
      class="confirmDialog"
      confirm-label="Create"
      on-confirm="_handleCreateFollowUpChange"
      on-cancel="_handleCloseCreateFollowUpChange"
    >
      <div class="header" slot="header">Create Follow-Up Change</div>
      <div class="main" slot="main">
        <gr-create-change-dialog
          id="createFollowUpChange"
          branch="[[change.branch]]"
          base-change="[[change.id]]"
          repo-name="[[change.project]]"
          private-by-default="[[privateByDefault]]"
        ></gr-create-change-dialog>
      </div>
    </gr-dialog>
    <gr-dialog
      id="confirmDeleteDialog"
      class="confirmDialog"
      confirm-label="Delete"
      confirm-on-enter=""
      on-cancel="_handleConfirmDialogCancel"
      on-confirm="_handleDeleteConfirm"
    >
      <div class="header" slot="header">Delete Change</div>
      <div class="main" slot="main">
        Do you really want to delete the change?
      </div>
    </gr-dialog>
    <gr-dialog
      id="confirmDeleteEditDialog"
      class="confirmDialog"
      confirm-label="Delete"
      confirm-on-enter=""
      on-cancel="_handleConfirmDialogCancel"
      on-confirm="_handleDeleteEditConfirm"
    >
      <div class="header" slot="header">Delete Change Edit</div>
      <div class="main" slot="main">Do you really want to delete the edit?</div>
    </gr-dialog>
  </gr-overlay>
`;function sA(e){if(!e||!Fn(e)||!e.values)return;const t=Object.keys(e.values).map(e=>Number(e));return t.sort((e,t)=>e-t),t.length?{min:t[0],max:t[t.length-1]}:void 0}function aA(e){const t=sA(e);return t||{min:0,max:0}}function lA(e,t){var i;return null===(i=e.all)||void 0===i?void 0:i.filter(e=>e._account_id===t._account_id)[0]}function cA(e,t){return"Code-Review"===e&&"Code-Review"===t?0:"Code-Review"===e?-1:"Code-Review"===t?1:e.localeCompare(t)}var dA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var hA;!function(e){e.OK="OK",e.REJECT="REJECT",e.MAY="MAY",e.NEED="NEED",e.IMPOSSIBLE="IMPOSSIBLE",e.OPTIONAL="OPTIONAL"}(hA||(hA={}));const pA={abandon:"Abandoning...",cherrypick:"Cherry-picking...",delete:"Deleting...",move:"Moving..",rebase:"Rebasing...",restore:"Restoring...",revert:"Reverting...",revert_submission:"Reverting Submission...",submit:"Submitting..."},uA={__key:"review",__type:$a.CHANGE,enabled:!0,key:"review",label:"Quick approve",method:mn.POST};function gA(e){return e.key===uA.key}const mA={enabled:!0,label:"Download patch",title:"Open download dialog",__key:"download",__primary:!1,__type:$a.REVISION},fA={enabled:!0,label:"Rebase edit",title:"Rebase change edit",__key:"rebaseEdit",__primary:!1,__type:$a.CHANGE,method:mn.POST},_A={enabled:!0,label:"Publish edit",title:"Publish change edit",__key:"publishEdit",__primary:!1,__type:$a.CHANGE,method:mn.POST},vA={enabled:!0,label:"Delete edit",title:"Delete change edit",__key:"deleteEdit",__primary:!1,__type:$a.CHANGE,method:mn.DELETE},yA={enabled:!0,label:"Edit",title:"Edit this change",__key:"edit",__primary:!1,__type:$a.CHANGE},bA={enabled:!0,label:"Stop editing",title:"Stop editing this change",__key:"stopEdit",__primary:!1,__type:$a.CHANGE},wA=new Set([ja.ABANDON,ja.DELETE_EDIT,ja.EDIT,ja.PUBLISH_EDIT,ja.READY,ja.REBASE_EDIT,ja.RESTORE,ja.REVERT,ja.REVERT_SUBMISSION,ja.STOP_EDIT,uA.key,Ha.REBASE,Ha.SUBMIT]),CA=new Set([ja.DELETE_EDIT,ja.EDIT,ja.PUBLISH_EDIT,ja.REBASE_EDIT,ja.STOP_EDIT]),SA=[ja.REVERT_SUBMISSION],EA=[ja.REVIEWED,ja.UNREVIEWED];function AA(e){if(!e)throw new Error("action is undefined");const t=e;if(void 0===t.__key||void 0===t.__type)throw new Error("action is not an UIActionInfo");return t}let xA=class extends fi{constructor(){super(),this.ActionType=$a,this.ChangeActions=ja,this.RevisionActions=Ha,this.reporting=i.reportingService,this.jsAPI=i.jsApiService,this.actions={},this.primaryActionKeys=[ja.READY,Ha.SUBMIT],this.disableEdit=!1,this._hasKnownChainState=!1,this._hideQuickApproveAction=!1,this.commitMessage="",this.revisionActions={},this._loading=!0,this._actionLoadingMessage="",this.commentThreads=[],this._allActionValues=[],this._overflowActions=[{type:$a.CHANGE,key:ja.WIP},{type:$a.CHANGE,key:ja.DELETE},{type:$a.REVISION,key:Ha.CHERRYPICK},{type:$a.CHANGE,key:ja.MOVE},{type:$a.REVISION,key:Ha.DOWNLOAD},{type:$a.CHANGE,key:ja.IGNORE},{type:$a.CHANGE,key:ja.UNIGNORE},{type:$a.CHANGE,key:ja.REVIEWED},{type:$a.CHANGE,key:ja.UNREVIEWED},{type:$a.CHANGE,key:ja.PRIVATE},{type:$a.CHANGE,key:ja.PRIVATE_DELETE},{type:$a.CHANGE,key:ja.FOLLOW_UP}],this._actionPriorityOverrides=[],this._additionalActions=[],this._hiddenActions=[],this._disabledMenuActions=[],this.editPatchsetLoaded=!1,this.editMode=!1,this.editBasedOnCurrentPatchSet=!0,this.restApiService=i.restApiService,this.addEventListener("fullscreen-overlay-opened",()=>this._handleHideBackgroundContent()),this.addEventListener("fullscreen-overlay-closed",()=>this._handleShowBackgroundContent())}static get template(){return rA}ready(){super.ready(),this.jsAPI.addElement(Ma.CHANGE_ACTIONS,this),this.restApiService.getConfig().then(e=>{this._config=e}),this._handleLoadingComplete()}_getSubmitAction(e){return this._getRevisionAction(e,"submit")}_getRebaseAction(e){return this._getRevisionAction(e,"rebase")}_getRevisionAction(e,t){if(e)return void 0===e[t]?null:e[t]}reload(){if(!this.changeNum||!this.latestPatchNum||!this.change)return Promise.resolve();const e=this.change;return this._loading=!0,this.restApiService.getChangeRevisionActions(this.changeNum,this.latestPatchNum).then(t=>{t&&(this.revisionActions=t,this._sendShowRevisionActions({change:e,revisionActions:t}),this._handleLoadingComplete())}).catch(e=>{throw Ci(this,"Couldnt load revision actions."),this._loading=!1,e})}_handleLoadingComplete(){Qu().awaitPluginsLoaded().then(()=>this._loading=!1)}_sendShowRevisionActions(e){this.jsAPI.handleEvent(Fa.SHOW_REVISION_ACTIONS,e)}_changeChanged(){this.reload()}addActionButton(e,t){if(e!==$a.CHANGE&&e!==$a.REVISION)throw Error(`Invalid action type: ${e}`);const i={enabled:!0,label:t,__type:e,__key:"__additionalAction_"+Math.random().toString(36).substr(2)};return this.push("_additionalActions",i),i.__key}removeActionButton(e){const t=this._indexOfActionButtonWithKey(e);-1!==t&&this.splice("_additionalActions",t,1)}setActionButtonProp(e,t,i){this.set(["_additionalActions",this._indexOfActionButtonWithKey(e),t],i)}setActionOverflow(e,t,i){if(e!==$a.CHANGE&&e!==$a.REVISION)throw Error(`Invalid action type given: ${e}`);const n=this._getActionOverflowIndex(e,t),o={type:e,key:t,overflow:i};i||-1===n?i&&this.push("_overflowActions",o):this.splice("_overflowActions",n,1)}setActionPriority(e,t,i){if(e!==$a.CHANGE&&e!==$a.REVISION)throw Error(`Invalid action type given: ${e}`);const n=this._actionPriorityOverrides.findIndex(i=>i.type===e&&i.key===t),o={type:e,key:t,priority:i};-1!==n?this.set("_actionPriorityOverrides",n,o):this.push("_actionPriorityOverrides",o)}setActionHidden(e,t,i){if(e!==$a.CHANGE&&e!==$a.REVISION)throw Error(`Invalid action type given: ${e}`);const n=this._hiddenActions.indexOf(t);i&&-1===n?this.push("_hiddenActions",t):i||-1===n||this.splice("_hiddenActions",n,1)}getActionDetails(e){return this.revisionActions[e]?this.revisionActions[e]:this.actions[e]?this.actions[e]:void 0}_indexOfActionButtonWithKey(e){for(let t=0;t<this._additionalActions.length;t++)if(this._additionalActions[t].__key===e)return t;return-1}_shouldHideActions(e,t){return t||!e||!e.base||!e.base.length}_keyCount(e){return Object.keys((null==e?void 0:e.base)||{}).length}_actionsChanged(e,t,i){if(void 0===e||void 0===t||void 0===i)return;const n=i&&i.base||[];this.hidden=0===this._keyCount(e)&&0===this._keyCount(t)&&0===n.length,this._actionLoadingMessage="",this._actionLoadingMessage="",this._disabledMenuActions=[];const o=t.base||{};0!==Object.keys(o).length&&(o.download||this.set("revisionActions.download",mA))}_deleteAndNotify(e){this.actions&&this.actions[e]&&(delete this.actions[e],this.notifyPath("actions."+e,!1))}_editStatusChanged(e,t,i,n,o,r){if(void 0===o||void 0===r)return;if(n)return this._deleteAndNotify("publishEdit"),this._deleteAndNotify("rebaseEdit"),this._deleteAndNotify("deleteEdit"),this._deleteAndNotify("stopEdit"),void this._deleteAndNotify("edit");const s=o.base,a=r.base;s&&t?(bo(a)&&(i?(s.publishEdit||this.set("actions.publishEdit",_A),this._deleteAndNotify("rebaseEdit")):(s.rebaseEdit||this.set("actions.rebaseEdit",fA),this._deleteAndNotify("publishEdit"))),s.deleteEdit||this.set("actions.deleteEdit",vA)):(this._deleteAndNotify("publishEdit"),this._deleteAndNotify("rebaseEdit"),this._deleteAndNotify("deleteEdit")),s&&bo(a)?(t||e?this._deleteAndNotify("edit"):s.edit||this.set("actions.edit",yA),e&&!t?s.stopEdit||(this.set("actions.stopEdit",bA),Ci(this,"Change is in edit mode")):this._deleteAndNotify("stopEdit")):this._deleteAndNotify("edit")}_getValuesFor(e){return Object.keys(e).map(t=>e[t])}_getLabelStatus(e){if(Mn(e)){if(e.approved)return hA.OK;if(e.rejected)return hA.REJECT}return e.optional?hA.OPTIONAL:hA.NEED}_getTopMissingApproval(){var e,t,i,n;if(!this.change||!this.change.labels||!this.change.permitted_labels)return null;if(this.change&&this.change.status===Ji.MERGED)return null;let o;for(const[e,t]of Object.entries(this.change.labels)){if(!(e in this.change.permitted_labels))continue;if(0===this.change.permitted_labels[e].length)continue;const i=this._getLabelStatus(t);if(i===hA.NEED){if(o){o=null;break}o=e}else if(i===hA.REJECT||i===hA.IMPOSSIBLE)return null}const r=this.change.labels["Code-Review"],s=this.change.permitted_labels["Code-Review"];if(!o&&r&&s&&(null===(e=this.account)||void 0===e?void 0:e._account_id)&&Fn(r)&&this._getLabelStatus(r)===hA.OK&&!Eo(this.change,this.account)&&(null===(t=lA(r,this.account))||void 0===t?void 0:t.value)!==(null===(i=sA(r))||void 0===i?void 0:i.max)&&(o="Code-Review"),o){const e=this.change.labels[o];if(!Fn(e))return null;const t=this.change.permitted_labels[o],i=t[t.length-1],r=null===(n=sA(e))||void 0===n?void 0:n.max;if(Number(i)===r)return{label:o,score:i}}return null}hideQuickApproveAction(){if(!this._topLevelSecondaryActions)throw new Error("_topLevelSecondaryActions must be set");this._topLevelSecondaryActions=this._topLevelSecondaryActions.filter(e=>!gA(e)),this._hideQuickApproveAction=!0}_getQuickApproveAction(){if(this._hideQuickApproveAction)return null;const e=this._getTopMissingApproval();if(!e)return null;const t={...uA};t.label=e.label+e.score;const i=Number(e.score);if(isNaN(i))return null;const n={drafts:Sn.PUBLISH_ALL_REVISIONS,labels:{[e.label]:i}};return t.payload=n,t}_getActionValues(e,t,i,n){if(!e||!t)return[];const o=e.base||{},r=t.base||[],s=[],a=n===$a.CHANGE?this._getValuesFor(ja):this._getValuesFor(Ha),l=[];Object.keys(o).forEach(e=>{const t=o[e];if(t.__key=e,t.__type=n,t.__primary=r.includes(e),-1!==e.indexOf("~"))return this._populateActionUrl(t),l.push(t),void this._overflowActions.push({type:n,key:e});a.includes(e)&&(t.label=this._getActionLabel(t),s.push({...t}))});let c=i&&i.base||[];return c=c.filter(e=>e.__type===n).map(e=>(e.__primary=r.includes(e.__key),{...e})),s.concat(c).concat(l)}_populateActionUrl(e){const t=e.__type===$a.REVISION?this.latestPatchNum:void 0;this.changeNum&&this.restApiService.getChangeActionURL(this.changeNum,t,"/"+e.__key).then(t=>e.__url=t)}_getActionLabel(e){return"Delete"===e.label?"Delete change":"WIP"===e.label?"Mark as work in progress":this._toSentenceCase(e.label)}_toSentenceCase(e){return e.length?e[0].toUpperCase()+e.slice(1).toLowerCase():""}_computeLoadingLabel(e){return pA[e]||"Working..."}_canSubmitChange(){return!!this.change&&this.jsAPI.canSubmitChange(this.change,this._getRevision(this.change,this.latestPatchNum))}_getRevision(e,t){for(const i of Object.values(e.revisions))if(i._number===t)return i;return null}showRevertDialog(){const e=this.change;if(!e)return;const t=`submissionid: "${e.submission_id}"`;this.restApiService.getChanges(0,t).then(t=>{t?(this.$.confirmRevertDialog.populate(e,this.commitMessage,t),this._showActionDialog(this.$.confirmRevertDialog)):this.reporting.error(new Error("changes is undefined"))})}showRevertSubmissionDialog(){const e=this.change;if(!e)return;const t=`submissionid:${e.submission_id}`;this.restApiService.getChanges(0,t).then(t=>{t?(this.$.confirmRevertSubmissionDialog._populateRevertSubmissionMessage(e,t),this._showActionDialog(this.$.confirmRevertSubmissionDialog)):this.reporting.error(new Error("changes is undefined"))})}_handleActionTap(e){e.preventDefault();let t=Th(e).localTarget;for(;"gr-button"!==t.tagName.toLowerCase();){if(!t.parentElement)return;t=t.parentElement}const i=t.getAttribute("data-action-key");if(!i)throw new Error("Button doesn't have data-action-key attribute");if(i.startsWith("__additionalAction_")||-1!==i.indexOf("~"))return void this.dispatchEvent(new CustomEvent(`${i}-tap`,{detail:{node:t},composed:!0,bubbles:!0}));const n=t.getAttribute("data-action-type");this._handleAction(n,i)}_handleOverflowItemTap(e){e.preventDefault();const t=Th(e).localTarget,i=e.detail.action.__key;i.startsWith("__additionalAction_")||-1!==i.indexOf("~")?this.dispatchEvent(new CustomEvent(`${i}-tap`,{detail:{node:t},composed:!0,bubbles:!0})):this._handleAction(e.detail.action.__type,e.detail.action.__key)}_handleAction(e,t){switch(this.reporting.reportInteraction(`${e}-${t}`),e){case $a.REVISION:this._handleRevisionAction(t);break;case $a.CHANGE:this._handleChangeAction(t);break;default:this._fireAction(this._prependSlash(t),AA(this.actions[t]),!1)}}_handleChangeAction(e){switch(e){case ja.REVERT:this.showRevertDialog();break;case ja.REVERT_SUBMISSION:this.showRevertSubmissionDialog();break;case ja.ABANDON:this._showActionDialog(this.$.confirmAbandonDialog);break;case uA.key:{const t=this._allActionValues.find(gA);if(!t)return;this._fireAction(this._prependSlash(e),t,!0,t.payload);break}case ja.EDIT:this._handleEditTap();break;case ja.STOP_EDIT:this._handleStopEditTap();break;case ja.DELETE:this._handleDeleteTap();break;case ja.DELETE_EDIT:this._handleDeleteEditTap();break;case ja.FOLLOW_UP:this._handleFollowUpTap();break;case ja.WIP:this._handleWipTap();break;case ja.MOVE:this._handleMoveTap();break;case ja.PUBLISH_EDIT:this._handlePublishEditTap();break;case ja.REBASE_EDIT:this._handleRebaseEditTap();break;default:this._fireAction(this._prependSlash(e),AA(this.actions[e]),!1)}}_handleRevisionAction(e){switch(e){case Ha.REBASE:this._showActionDialog(this.$.confirmRebase),this.$.confirmRebase.fetchRecentChanges();break;case Ha.CHERRYPICK:this._handleCherrypickTap();break;case Ha.DOWNLOAD:this._handleDownloadTap();break;case Ha.SUBMIT:if(!this._canSubmitChange())return;this._showActionDialog(this.$.confirmSubmitDialog);break;default:this._fireAction(this._prependSlash(e),AA(this.revisionActions[e]),!0)}}_prependSlash(e){return"/"===e?e:`/${e}`}_computeChainState(){this._hasKnownChainState=!0}_calculateDisabled(e,t){return"rebase"===e.__key?!1===t:!e.enabled}_handleConfirmDialogCancel(){this._hideAllDialogs()}_hideAllDialogs(){const e=this.root.querySelectorAll(".confirmDialog");for(const t of e)t.hidden=!0;this.$.overlay.close()}_handleRebaseConfirm(e){const t=this.$.confirmRebase,i={base:e.detail.base};this.$.overlay.close(),t.hidden=!0,this._fireAction("/rebase",AA(this.revisionActions.rebase),!0,i)}_handleCherrypickConfirm(){this._handleCherryPickRestApi(!1)}_handleCherrypickConflictConfirm(){this._handleCherryPickRestApi(!0)}_handleCherryPickRestApi(e){const t=this.$.confirmCherrypick;t.branch?t.message?(this.$.overlay.close(),t.hidden=!0,this._fireAction("/cherrypick",AA(this.revisionActions.cherrypick),!0,{destination:t.branch,base:t.baseCommit?t.baseCommit:null,message:t.message,allow_conflicts:e})):Ci(this,"The commit message cant be empty."):Ci(this,"The destination branch cant be empty.")}_handleMoveConfirm(){const e=this.$.confirmMove;e.branch?(this.$.overlay.close(),e.hidden=!0,this._fireAction("/move",AA(this.actions.move),!1,{destination_branch:e.branch,message:e.message})):Ci(this,"The destination branch cant be empty.")}_handleRevertDialogConfirm(e){const t=e.detail.revertType,i=e.detail.message,n=this.$.confirmRevertDialog;switch(this.$.overlay.close(),n.hidden=!0,t){case $C.REVERT_SINGLE_CHANGE:this._fireAction("/revert",AA(this.actions.revert),!1,{message:i});break;case $C.REVERT_SUBMISSION:this._fireAction("/revert_submission",AA(this.actions.revert_submission),!1,{message:i});break;default:this.reporting.error(new Error("invalid revert type"))}}_handleRevertSubmissionDialogConfirm(){const e=this.$.confirmRevertSubmissionDialog;this.$.overlay.close(),e.hidden=!0,this._fireAction("/revert_submission",AA(this.actions.revert_submission),!1,{message:e.message})}_handleAbandonDialogConfirm(){const e=this.$.confirmAbandonDialog;this.$.overlay.close(),e.hidden=!0,this._fireAction("/abandon",AA(this.actions.abandon),!1,{message:e.message})}_handleCreateFollowUpChange(){this.$.createFollowUpChange.handleCreateChange(),this._handleCloseCreateFollowUpChange()}_handleCloseCreateFollowUpChange(){this.$.overlay.close()}_handleDeleteConfirm(){this._fireAction("/",AA(this.actions[ja.DELETE]),!1)}_handleDeleteEditConfirm(){this._hideAllDialogs(),this._fireAction("/edit",AA(this.actions.deleteEdit),!1)}_handleSubmitConfirm(){this._canSubmitChange()&&(this._hideAllDialogs(),this._fireAction("/submit",AA(this.revisionActions.submit),!0))}_getActionOverflowIndex(e,t){return this._overflowActions.findIndex(i=>i.type===e&&i.key===t)}_setLoadingOnButtonWithKey(e,t){this._actionLoadingMessage=this._computeLoadingLabel(t);let i=t;if(i===ja.REVERT_SUBMISSION&&(i=ja.REVERT),-1!==this._getActionOverflowIndex(e,i))return this.push("_disabledMenuActions","/"===i?"delete":i),()=>{this._actionLoadingMessage="",this._disabledMenuActions=[]};const n=this.shadowRoot.querySelector(`[data-action-key="${i}"]`);if(!n)throw new Error(`Can't find button by data-action-key '${i}'`);return n.setAttribute("loading","true"),n.disabled=!0,()=>{this._actionLoadingMessage="",n.removeAttribute("loading"),n.disabled=!1}}_fireAction(e,t,i,n){const o=this._setLoadingOnButtonWithKey(t.__type,t.__key);this._send(t.method,n,e,i,o,t).then(e=>this._handleResponse(t,e))}_showActionDialog(e){this._hideAllDialogs(),e.init&&e.init(),e.hidden=!1,this.$.overlay.open().then(()=>{e.resetFocus&&e.resetFocus()})}_setReviewOnRevert(e){const t=this.jsAPI.getReviewPostRevert(this.change);return t?this.restApiService.saveChangeReview(e,"current",t):Promise.resolve(void 0)}_handleResponse(e,t){if(t)return this.restApiService.getResponseObject(t).then(t=>{switch(e.__key){case ja.REVERT:{const e=t;this._waitForChangeReachable(e._number).then(()=>this._setReviewOnRevert(e._number)).then(()=>{Qm.navigateToChange(e)});break}case Ha.CHERRYPICK:{const e=t;this._waitForChangeReachable(e._number).then(()=>{Qm.navigateToChange(e)});break}case ja.DELETE:e.__type===$a.CHANGE&&Qm.navigateToRelativeUrl(Qm.getUrlForRoot());break;case ja.WIP:case ja.DELETE_EDIT:case ja.PUBLISH_EDIT:case ja.REBASE_EDIT:case ja.REBASE:case ja.SUBMIT:this.dispatchEvent(new CustomEvent("reload",{detail:{clearPatchset:!0},bubbles:!1,composed:!0}));break;case ja.REVERT_SUBMISSION:{const e=t;if(!e.revert_changes||!e.revert_changes.length)return;Qm.navigateToSearchQuery(`topic: ${e.revert_changes[0].topic}`);break}default:this.dispatchEvent(new CustomEvent("reload",{detail:{action:e.__key,clearPatchset:!0},bubbles:!1,composed:!0}))}})}_handleShowRevertSubmissionChangesConfirm(){this._hideAllDialogs()}_handleResponseError(e,t,i){return t?e&&e.__key===Ha.CHERRYPICK&&409===t.status&&i&&!i.allow_conflicts?this._showActionDialog(this.$.confirmCherrypickConflict):t.text().then(e=>{if(this.dispatchEvent(new CustomEvent("show-error",{detail:{message:`Could not perform action: ${e}`},composed:!0,bubbles:!0})),!e.startsWith("Change is already up to date"))throw Error(e)}):Promise.resolve(()=>{this.dispatchEvent(new CustomEvent("show-error",{detail:{message:`Could not perform action '${e.__key}'`},composed:!0,bubbles:!0}))})}_send(e,t,i,n,o,r){const s=e=>{o.call(this),this._handleResponseError(r,e,t)},a=this.change,l=this.changeNum;return a&&l?Qn(a,this.restApiService).then(r=>{if(!r.isLatest)return this.dispatchEvent(new CustomEvent("show-alert",{detail:{message:"Cannot set label: a newer patch has been uploaded to this change.",action:"Reload",callback:()=>{this.dispatchEvent(new CustomEvent("reload",{detail:{clearPatchset:!0},bubbles:!1,composed:!0}))}},composed:!0,bubbles:!0})),o(),Promise.resolve(void 0);const a=n?this.latestPatchNum:void 0;return this.restApiService.executeChangeAction(l,e,i,a,t,s).then(e=>(o.call(this),e))}):Promise.reject(new Error("Properties change and changeNum must be set."))}_handleAbandonTap(){this._showActionDialog(this.$.confirmAbandonDialog)}_handleCherrypickTap(){if(!this.change)throw new Error("The change property must be set");this.$.confirmCherrypick.branch="";const e=`topic: "${this.change.topic}"`,t=vo(co,ro);this.restApiService.getChanges(0,e,void 0,t).then(e=>{e?(this.$.confirmCherrypick.updateChanges(e),this._showActionDialog(this.$.confirmCherrypick)):this.reporting.error(new Error("getChanges returns undefined"))})}_handleMoveTap(){this.$.confirmMove.branch="",this.$.confirmMove.message="",this._showActionDialog(this.$.confirmMove)}_handleDownloadTap(){this.dispatchEvent(new CustomEvent("download-tap",{composed:!0,bubbles:!1}))}_handleDeleteTap(){this._showActionDialog(this.$.confirmDeleteDialog)}_handleDeleteEditTap(){this._showActionDialog(this.$.confirmDeleteEditDialog)}_handleFollowUpTap(){this._showActionDialog(this.$.createFollowUpDialog)}_handleWipTap(){this.actions.wip&&this._fireAction("/wip",AA(this.actions.wip),!1)}_handlePublishEditTap(){this.actions.publishEdit&&this._fireAction("/edit:publish",AA(this.actions.publishEdit),!1,{notify:En.NONE})}_handleRebaseEditTap(){this.actions.rebaseEdit&&this._fireAction("/edit:rebase",AA(this.actions.rebaseEdit),!1)}_handleHideBackgroundContent(){this.$.mainContent.classList.add("overlayOpen")}_handleShowBackgroundContent(){this.$.mainContent.classList.remove("overlayOpen")}_computeAllActions(e,t,i,n,o,r){if([e,t,i,n,o].includes(void 0))return[];const s=this._getActionValues(t,i,n,$a.REVISION),a=this._getActionValues(e,i,n,$a.CHANGE),l=this._getQuickApproveAction();return l&&a.unshift(l),s.concat(a).sort((e,t)=>this._actionComparator(e,t)).map(e=>(wA.has(e.__key)&&(e.icon=e.__key),e.__key===ja.READY&&(e.label="Mark as Active"),e)).filter(e=>!this._shouldSkipAction(e,r))}_getActionPriority(e){if(e.__type&&e.__key){const t=this._actionPriorityOverrides.find(t=>t.type===e.__type&&t.key===e.__key);if(void 0!==t)return t.priority}return"review"===e.__key?Ba.REVIEW:e.__primary?Ba.PRIMARY:e.__type===$a.CHANGE?Ba.CHANGE:e.__type===$a.REVISION?Ba.REVISION:Ba.DEFAULT}_actionComparator(e,t){const i=this._getActionPriority(e)-this._getActionPriority(t);return 0===i?e.label>t.label?1:-1:i}_shouldSkipAction(e,t){const i=[...SA];return!!t&&!!t.change&&t.change.enable_attention_set&&i.push(...EA),i.includes(e.__key)}_computeTopLevelActions(e,t,i){const n=t.base||[];return e.base.filter(e=>!n.includes(e.__key)&&(i?CA.has(e.__key):-1===this._getActionOverflowIndex(e.__type,e.__key)))}_filterPrimaryActions(e){this._topLevelPrimaryActions=e.filter(e=>e.__primary),this._topLevelSecondaryActions=e.filter(e=>!e.__primary)}_computeMenuActions(e,t){const i=t.base||[];return e.base.filter(e=>-1!==this._getActionOverflowIndex(e.__type,e.__key)&&!i.includes(e.__key)).map(e=>{let t=e.__key;return"/"===t&&(t="delete"),{name:e.label,id:`${t}-${e.__type}`,action:e,tooltip:e.title}})}_computeRebaseOnCurrent(e){return e?!!e.enabled:null}_waitForChangeReachable(e){let t=5;return new Promise(i=>{const n=()=>{t--,this.restApiService.getChange(e,()=>{}).then(e=>{e?i(!0):t?setTimeout(n,1e3):i(!1)})};n()})}_handleEditTap(){this.dispatchEvent(new CustomEvent("edit-tap",{bubbles:!1}))}_handleStopEditTap(){this.dispatchEvent(new CustomEvent("stop-edit-tap",{bubbles:!1}))}_computeHasTooltip(e){return!!e}_computeHasIcon(e){return e.icon?"":"hidden"}};dA([Oo({type:Object})],xA.prototype,"change",void 0),dA([Oo({type:Object})],xA.prototype,"actions",void 0),dA([Oo({type:Array})],xA.prototype,"primaryActionKeys",void 0),dA([Oo({type:Boolean})],xA.prototype,"disableEdit",void 0),dA([Oo({type:Boolean})],xA.prototype,"_hasKnownChainState",void 0),dA([Oo({type:Boolean})],xA.prototype,"_hideQuickApproveAction",void 0),dA([Oo({type:Object})],xA.prototype,"account",void 0),dA([Oo({type:String})],xA.prototype,"changeNum",void 0),dA([Oo({type:String})],xA.prototype,"changeStatus",void 0),dA([Oo({type:String})],xA.prototype,"commitNum",void 0),dA([Oo({type:Boolean,observer:"_computeChainState"})],xA.prototype,"hasParent",void 0),dA([Oo({type:String})],xA.prototype,"latestPatchNum",void 0),dA([Oo({type:String})],xA.prototype,"commitMessage",void 0),dA([Oo({type:Object,notify:!0})],xA.prototype,"revisionActions",void 0),dA([Oo({type:Object,computed:"_getSubmitAction(revisionActions)"})],xA.prototype,"_revisionSubmitAction",void 0),dA([Oo({type:Object,computed:"_getRebaseAction(revisionActions)"})],xA.prototype,"_revisionRebaseAction",void 0),dA([Oo({type:String})],xA.prototype,"privateByDefault",void 0),dA([Oo({type:Boolean})],xA.prototype,"_loading",void 0),dA([Oo({type:String})],xA.prototype,"_actionLoadingMessage",void 0),dA([Oo({type:Array})],xA.prototype,"commentThreads",void 0),dA([Oo({type:Array,computed:"_computeAllActions(actions.*, revisionActions.*,primaryActionKeys.*, _additionalActions.*, change, _config, _actionPriorityOverrides.*)"})],xA.prototype,"_allActionValues",void 0),dA([Oo({type:Array,computed:"_computeTopLevelActions(_allActionValues.*, _hiddenActions.*, editMode, _overflowActions.*)",observer:"_filterPrimaryActions"})],xA.prototype,"_topLevelActions",void 0),dA([Oo({type:Array})],xA.prototype,"_topLevelPrimaryActions",void 0),dA([Oo({type:Array})],xA.prototype,"_topLevelSecondaryActions",void 0),dA([Oo({type:Array,computed:"_computeMenuActions(_allActionValues.*, _hiddenActions.*, _overflowActions.*)"})],xA.prototype,"_menuActions",void 0),dA([Oo({type:Array})],xA.prototype,"_overflowActions",void 0),dA([Oo({type:Array})],xA.prototype,"_actionPriorityOverrides",void 0),dA([Oo({type:Array})],xA.prototype,"_additionalActions",void 0),dA([Oo({type:Array})],xA.prototype,"_hiddenActions",void 0),dA([Oo({type:Array})],xA.prototype,"_disabledMenuActions",void 0),dA([Oo({type:Boolean})],xA.prototype,"editPatchsetLoaded",void 0),dA([Oo({type:Boolean})],xA.prototype,"editMode",void 0),dA([Oo({type:Boolean})],xA.prototype,"editBasedOnCurrentPatchSet",void 0),dA([Oo({type:Object})],xA.prototype,"_config",void 0),dA([No("change")],xA.prototype,"_changeChanged",null),dA([No("actions.*","revisionActions.*","_additionalActions.*")],xA.prototype,"_actionsChanged",null),dA([No("editMode","editPatchsetLoaded","editBasedOnCurrentPatchSet","disableEdit","actions.*","change.*")],xA.prototype,"_editStatusChanged",null),xA=dA([Po("gr-change-actions")],xA);class RA extends ec{constructor(){super(...arguments),this.disconnected$=new fr}subscribe(e,t){t.pipe(cs(this.disconnected$)).subscribe(t=>{const i=this[e];this[e]=t,this.requestUpdate(e,i)})}disconnectedCallback(){this.disconnected$.next(),super.disconnectedCallback()}}var TA,kA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.INFO="info",e.WARNING="warning",e.CHECK="check",e.UNDEFINED=""}(TA||(TA={}));let PA=class extends RA{constructor(){super(...arguments),this.icon="",this.styleType=TA.UNDEFINED,this.reporting=i.reportingService}static get styles(){return[ic,Zl`
        .summaryChip {
          color: var(--chip-color);
          cursor: pointer;
          display: inline-block;
          padding: var(--spacing-xxs) var(--spacing-m) var(--spacing-xxs)
            var(--spacing-s);
          margin-right: var(--spacing-s);
          border-radius: 12px;
          border: 1px solid gray;
          vertical-align: top;
        }
        iron-icon {
          width: var(--line-height-small);
          height: var(--line-height-small);
          vertical-align: top;
        }
        .summaryChip.warning {
          border-color: var(--warning-foreground);
          background: var(--warning-background);
        }
        .summaryChip.warning:hover {
          background: var(--warning-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .summaryChip.warning iron-icon {
          color: var(--warning-foreground);
        }
        .summaryChip.check {
          border-color: var(--gray-foreground);
          background: var(--gray-background);
        }
        .summaryChip.check:hover {
          background: var(--gray-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .summaryChip.check iron-icon {
          color: var(--gray-foreground);
        }
      `]}render(){const e=`summaryChip font-small ${this.styleType}`,t=this.icon?`gr-icons:${this.icon}`:"";return Pl`<button class="${e}" @click="${this.handleClick}">
      ${this.icon&&Pl`<iron-icon icon="${t}"></iron-icon>`}
      <slot></slot>
    </button>`}handleClick(e){e.stopPropagation(),e.preventDefault(),this.reporting.reportInteraction("comment chip click",{category:this.category}),ki(this,qi.COMMENT_THREADS,!0,{commentTab:this.category})}};kA([Gl()],PA.prototype,"icon",void 0),kA([Gl()],PA.prototype,"styleType",void 0),kA([Gl()],PA.prototype,"category",void 0),PA=kA([Hl("gr-summary-chip")],PA);let IA=class extends RA{constructor(){super(...arguments),this.icon="",this.text=""}static get styles(){return[ic,Zl`
        :host {
          display: inline-block;
        }
        .checksChip {
          color: var(--chip-color);
          cursor: pointer;
          display: inline-block;
          margin-right: var(--spacing-s);
          padding: var(--spacing-xxs) var(--spacing-m) var(--spacing-xxs)
            var(--spacing-s);
          border-radius: 12px;
          border: 1px solid gray;
          vertical-align: top;
        }
        .checksChip .text {
          display: inline-block;
          max-width: 120px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          vertical-align: top;
        }
        iron-icon {
          width: var(--line-height-small);
          height: var(--line-height-small);
          vertical-align: top;
        }
        .checksChip.error {
          color: var(--error-foreground);
          border-color: var(--error-foreground);
          background: var(--error-background);
        }
        .checksChip.error:hover {
          background: var(--error-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.error iron-icon {
          color: var(--error-foreground);
        }
        .checksChip.warning {
          border-color: var(--warning-foreground);
          background: var(--warning-background);
        }
        .checksChip.warning:hover {
          background: var(--warning-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.warning iron-icon {
          color: var(--warning-foreground);
        }
        .checksChip.info-outline {
          border-color: var(--info-foreground);
          background: var(--info-background);
        }
        .checksChip.info-outline:hover {
          background: var(--info-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.info-outline iron-icon {
          color: var(--info-foreground);
        }
        .checksChip.check-circle-outline {
          border-color: var(--success-foreground);
          background: var(--success-background);
        }
        .checksChip.check-circle-outline:hover {
          background: var(--success-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.check-circle-outline iron-icon {
          color: var(--success-foreground);
        }
        .checksChip.timelapse {
        }
        .checksChip.timelapse {
          border-color: var(--gray-foreground);
          background: var(--gray-background);
        }
        .checksChip.timelapse:hover {
          background: var(--gray-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.timelapse iron-icon {
          color: var(--gray-foreground);
        }
      `]}render(){if(!this.text)return;const e=`checksChip font-small ${this.icon}`,t=`gr-icons:${this.icon}`;return Pl`
      <div class="${e}" role="button">
        <iron-icon icon="${t}"></iron-icon>
        <div class="text">${this.text}</div>
        <slot></slot>
      </div>
    `}};kA([Gl()],IA.prototype,"icon",void 0),kA([Gl()],IA.prototype,"text",void 0),IA=kA([Hl("gr-checks-chip")],IA);let OA=class extends RA{constructor(){super(),this.runs=[],this.showChecksSummary=!1,this.someProvidersAreLoading=!1,this.detailsQuota=3,this.subscribe("runs",_a),this.subscribe("showChecksSummary",da),this.subscribe("someProvidersAreLoading",ha),this.subscribe("errorMessage",pa),this.subscribe("loginCallback",ua)}static get styles(){return[ic,Zl`
        :host {
          display: block;
          color: var(--deemphasized-text-color);
          max-width: 650px;
          margin-bottom: var(--spacing-m);
        }
        .zeroState {
          color: var(--primary-text-color);
        }
        div.error {
          background-color: var(--error-background);
          display: flex;
          padding: var(--spacing-s);
        }
        div.error iron-icon {
          color: var(--error-foreground);
          width: 16px;
          height: 16px;
          position: relative;
          top: 2px;
          margin-right: var(--spacing-s);
        }
        .login gr-button {
          margin: -4px var(--spacing-s);
        }
        td.key {
          padding-right: var(--spacing-l);
          padding-bottom: var(--spacing-m);
        }
        td.value {
          padding-right: var(--spacing-l);
          padding-bottom: var(--spacing-m);
        }
        iron-icon.launch {
          color: var(--gray-foreground);
          width: var(--line-height-small);
          height: var(--line-height-small);
          vertical-align: top;
        }
        gr-avatar {
          height: var(--line-height-small, 16px);
          width: var(--line-height-small, 16px);
          vertical-align: top;
          margin-right: var(--spacing-xs);
        }
      `]}renderChecksError(){if(this.errorMessage)return Pl`
      <div class="error zeroState">
        <div class="left">
          <iron-icon icon="gr-icons:error"></iron-icon>
        </div>
        <div class="right">
          <div>Error while fetching check results</div>
          <div>${this.errorMessage}</div>
        </div>
      </div>
    `}renderChecksLogin(){if(!this.errorMessage&&this.loginCallback)return Pl`
      <div class="login zeroState">
        Not logged in
        <gr-button @click="${this.loginCallback}" link>Sign in</gr-button>
      </div>
    `}renderChecksZeroState(){if(this.errorMessage||this.loginCallback)return;if(this.runs.some(Js))return;const e=this.someProvidersAreLoading?"Loading...":"No results";return Pl`<div class="loading zeroState">${e}</div>`}renderChecksChipForCategory(e){if(this.errorMessage||this.loginCallback)return;const t=Vs(e),i=this.runs.filter(t=>Qs(t,e));return this.renderChecksChip(t,i,e,t=>ea(t,e))}renderChecksChipForStatus(e,t){if(this.errorMessage||this.loginCallback)return;const i=Ys(e),n=this.runs.filter(t);return this.renderChecksChip(i,n,e,()=>[])}renderChecksChip(e,t,i,n){if(0===t.length)return Pl``;if(t.length<=this.detailsQuota)return this.detailsQuota-=t.length,t.map(t=>{const i=n(t).reduce((e,t)=>{var i;return e.concat(null!==(i=t.links)&&void 0!==i?i:[])},[]).filter(e=>e.primary),o=1===i.length?i:[],r=`${t.checkName}`;return Pl`<gr-checks-chip
          class="${e}"
          .icon="${e}"
          .text="${r}"
          @click="${()=>this.onChipClick({checkName:t.checkName})}"
          >${o.map(e=>Pl`
              <a href="${e.url}" target="_blank" @click="${this.onLinkClick}"
                ><iron-icon class="launch" icon="gr-icons:launch"></iron-icon
              ></a>
            `)}
        </gr-checks-chip>`});this.detailsQuota=0;const o=t.reduce((e,t)=>e+(n(t).length||1),0);return 0!==o?Pl`<gr-checks-chip
      class="${e}"
      .icon="${e}"
      .text="${o}"
      @click="${()=>this.onChipClick({statusOrCategory:i})}"
    ></gr-checks-chip>`:void 0}onChipClick(e){ki(this,qi.CHECKS,!1,{checksTab:e})}onLinkClick(e){e.stopPropagation()}render(){var e,t,i,n;this.detailsQuota=3;const o=null!==(t=null===(e=this.commentThreads)||void 0===e?void 0:e.filter(e=>!Jw(e)||Zw(e)))&&void 0!==t?t:[],r=o.filter(Yw).length,s=o.filter(Kw),a=s.length,l=this.getAccounts(s),c=null!==(n=null===(i=this.changeComments)||void 0===i?void 0:i.computeDraftCount())&&void 0!==n?n:0;return Pl`
      <div>
        <table>
          <tr ?hidden=${!this.showChecksSummary}>
            <td class="key">Checks</td>
            <td class="value">
              ${this.renderChecksError()}${this.renderChecksLogin()}
              ${this.renderChecksZeroState()}${this.renderChecksChipForCategory($s.ERROR)}${this.renderChecksChipForCategory($s.WARNING)}${this.renderChecksChipForCategory($s.INFO)}${this.renderChecksChipForStatus(Fs.COMPLETED,Zs)}${this.renderChecksChipForStatus(Fs.RUNNING,Xs)}
            </td>
          </tr>
          <tr>
            <td class="key">Comments</td>
            <td class="value">
              <span
                class="zeroState"
                ?hidden=${!!r||!!c||!!a}
              >
                No comments</span
              ><gr-summary-chip
                styleType=${TA.WARNING}
                category=${yi.DRAFTS}
                icon="edit"
                ?hidden=${!c}
              >
                ${Jb(c,"draft")}</gr-summary-chip
              ><gr-summary-chip
                styleType=${TA.WARNING}
                category=${yi.UNRESOLVED}
                ?hidden=${!a}
              >
                ${l.map(e=>Pl`<gr-avatar
                      .account="${e}"
                      image-size="32"
                    ></gr-avatar>`)}
                ${a} unresolved</gr-summary-chip
              ><gr-summary-chip
                styleType=${TA.CHECK}
                category=${yi.SHOW_ALL}
                icon="markChatRead"
                ?hidden=${!r}
                >${r} resolved</gr-summary-chip
              >
            </td>
          </tr>
          <tr hidden>
            <td class="key">Findings</td>
            <td class="value"></td>
          </tr>
        </table>
      </div>
    `}getAccounts(e){return e.map(qw).map(e=>{var t;return null!==(t=null==e?void 0:e.author)&&void 0!==t?t:this.selfAccount}).filter($u).filter(e=>{var t,i;return!!(null===(i=null===(t=null==e?void 0:e.avatars)||void 0===t?void 0:t[0])||void 0===i?void 0:i.url)}).filter(Nn).slice(0,3)}};kA([Gl({type:Object})],OA.prototype,"changeComments",void 0),kA([Gl({type:Array})],OA.prototype,"commentThreads",void 0),kA([Gl({type:Object})],OA.prototype,"selfAccount",void 0),kA([Gl()],OA.prototype,"runs",void 0),kA([Gl()],OA.prototype,"showChecksSummary",void 0),kA([Gl()],OA.prototype,"someProvidersAreLoading",void 0),kA([Gl()],OA.prototype,"errorMessage",void 0),kA([Gl()],OA.prototype,"loginCallback",void 0),OA=kA([Hl("gr-change-summary")],OA);const NA=document.createElement("template");NA.innerHTML='<dom-module id="gr-change-metadata-shared-styles">\n  <template>\n    <style include="shared-styles">\n      /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */\n    </style>\n    <style>\n      section {\n        display: table-row;\n      }\n\n      section:not(:first-of-type) .title,\n      section:not(:first-of-type) .value {\n        padding-top: var(--spacing-s);\n      }\n\n      .title,\n      .value {\n        display: table-cell;\n        vertical-align: top;\n      }\n\n      .title {\n        color: var(--deemphasized-text-color);\n        max-width: 20em;\n        padding-left: var(--metadata-horizontal-padding);\n        padding-right: var(--metadata-horizontal-padding);\n        word-break: break-word;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(NA.content);const LA=document.createElement("template");LA.innerHTML='<dom-module id="gr-change-view-integration-shared-styles">\n  <template>\n    <style include="shared-styles">\n      /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */\n    </style>\n    <style>\n      :host {\n        border-top: 1px solid var(--border-color);\n        display: block;\n      }\n      .header {\n        color: var(--primary-text-color);\n        background-color: var(--table-header-background-color);\n        justify-content: space-between;\n        padding: var(--spacing-m) var(--spacing-l);\n        border-bottom: 1px solid var(--border-color);\n      }\n      .header .label {\n        font-family: var(--header-font-family);\n        font-size: var(--font-size-h3);\n        font-weight: var(--font-weight-h3);\n        line-height: var(--line-height-h3);\n        margin: 0 var(--spacing-l) 0 0;\n      }\n      .header .note {\n        color: var(--deemphasized-text-color);\n      }\n      .content {\n        background-color: var(--view-background-color);\n      }\n      .header a,\n      .content a {\n        color: var(--link-color);\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(LA.content);const DA=document.createElement("template");DA.innerHTML='<dom-module id="gr-voting-styles">\n  <template>\n    <style>\n      :host {\n        --vote-chip-styles: {\n          border-style: solid;\n          border-color: var(--border-color);\n          border-top-left-radius: 1em;\n          border-top-right-radius: 1em;\n          border-bottom-right-radius: 1em;\n          border-bottom-left-radius: 1em;\n          border-top-width: 1px;\n          border-right-width: 1px;\n          border-bottom-width: 1px;\n          border-left-width: 1px;\n          box-shadow: none;\n          box-sizing: border-box;\n          min-width: 3em;\n          color: var(--vote-text-color);\n        }\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(DA.content);const MA=mi` <slot></slot> `;var FA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let $A=class extends fi{constructor(){super(...arguments),this._stylesApplied=[]}static get template(){return MA}_applyStyle(e){if(this._stylesApplied.includes(e))return;this._stylesApplied.push(e);const t=document.createElement("style");t.setAttribute("include",e);const i=document.createElement("custom-style");i.appendChild(t);const n=document.getElementsByTagName("body")[0];n.insertBefore(i,n.firstChild),pi()}_importAndApply(){const e=Gu().getModules(this.name);for(const t of e)this._applyStyle(t)}connectedCallback(){super.connectedCallback(),this._importAndApply()}ready(){super.ready(),Qu().awaitPluginsLoaded().then(()=>this._importAndApply())}};FA([Oo({type:String})],$A.prototype,"name",void 0),FA([Oo({type:Array})],$A.prototype,"_stylesApplied",void 0),$A=FA([Po("gr-external-style")],$A);const BA=mi`
  <style>
    :host {
      display: block;
      overflow: hidden;
    }
    .container {
      align-items: center;
      background-color: var(--background-color-primary);
      /** round */
      border-radius: var(--account-chip-border-radius, 20px);
      border: 1px solid var(--border-color);
      display: inline-flex;
      padding: 0 1px;

      --account-label-padding-horizontal: 6px;
      --gr-account-label-text-style: {
        color: var(--deemphasized-text-color);
      }
    }
    :host([show-avatar]) .container {
    }
    :host([removable]) .container {
    }
    gr-button.remove {
      --gr-remove-button-style: {
        border-top-width: 0;
        border-right-width: 0;
        border-bottom-width: 0;
        border-left-width: 0;
        color: var(--deemphasized-text-color);
        font-weight: var(--font-weight-normal);
        height: 0.6em;
        line-height: 10px;
        /* This cancels most of the --account-label-padding-horizontal. */
        margin-left: -4px;
        padding: 0 2px 0 0;
        text-decoration: none;
      }
    }

    gr-button.remove:hover,
    gr-button.remove:focus {
      --gr-button: {
        @apply --gr-remove-button-style;
      }
    }
    gr-button.remove {
      --gr-button: {
        @apply --gr-remove-button-style;
      }
    }
    :host:focus {
      border-color: transparent;
      box-shadow: none;
      outline: none;
    }
    :host:focus .container,
    :host:focus gr-button {
      background: #ccc;
    }
    .transparentBackground,
    gr-button.transparentBackground {
      background-color: transparent;
    }
    :host([disabled]) {
      opacity: 0.6;
      pointer-events: none;
    }
    iron-icon {
      height: 1.2rem;
      width: 1.2rem;
    }
  </style>
  <div class$="container [[_getBackgroundClass(transparentBackground)]]">
    <gr-account-link
      account="[[account]]"
      change="[[change]]"
      force-attention="[[forceAttention]]"
      highlight-attention="[[highlightAttention]]"
      voteable-text="[[voteableText]]"
    >
    </gr-account-link>
    <gr-button
      id="remove"
      link=""
      hidden$="[[!removable]]"
      hidden=""
      aria-label="Remove"
      class$="remove [[_getBackgroundClass(transparentBackground)]]"
      on-click="_handleRemoveTap"
    >
      <iron-icon icon="gr-icons:close"></iron-icon>
    </gr-button>
  </div>
`;var jA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let HA=class extends fi{constructor(){super(...arguments),this.forceAttention=!1,this.disabled=!1,this.removable=!1,this.highlightAttention=!1,this.transparentBackground=!1,this.restApiService=i.restApiService}static get template(){return BA}ready(){super.ready(),this._getHasAvatars().then(e=>{this.showAvatar=e})}_getBackgroundClass(e){return e?"transparentBackground":""}_handleRemoveTap(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("remove",{detail:{account:this.account},composed:!0,bubbles:!0}))}_getHasAvatars(){return this.restApiService.getConfig().then(e=>Promise.resolve(!!(e&&e.plugin&&e.plugin.has_avatars)))}};jA([Oo({type:Object})],HA.prototype,"account",void 0),jA([Oo({type:Object})],HA.prototype,"change",void 0),jA([Oo({type:Boolean})],HA.prototype,"forceAttention",void 0),jA([Oo({type:String})],HA.prototype,"voteableText",void 0),jA([Oo({type:Boolean,reflectToAttribute:!0})],HA.prototype,"disabled",void 0),jA([Oo({type:Boolean,reflectToAttribute:!0})],HA.prototype,"removable",void 0),jA([Oo({type:Boolean})],HA.prototype,"highlightAttention",void 0),jA([Oo({type:Boolean,reflectToAttribute:!0})],HA.prototype,"showAvatar",void 0),jA([Oo({type:Boolean})],HA.prototype,"transparentBackground",void 0),HA=jA([Po("gr-account-chip")],HA);const UA=mi`
  <style include="shared-styles">
    :host {
      align-items: center;
      display: inline-flex;
    }
    :host([uppercase]) label {
      text-transform: uppercase;
    }
    input,
    label {
      width: 100%;
    }
    label {
      color: var(--deemphasized-text-color);
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      @apply --label-style;
    }
    label.editable {
      color: var(--link-color);
      cursor: pointer;
    }
    #dropdown {
      box-shadow: var(--elevation-level-2);
    }
    .inputContainer {
      background-color: var(--dialog-background-color);
      padding: var(--spacing-m);
      @apply --input-style;
    }
    .buttons {
      display: flex;
      justify-content: flex-end;
      padding-top: var(--spacing-l);
      width: 100%;
    }
    .buttons gr-button {
      margin-left: var(--spacing-m);
    }
    paper-input {
      --paper-input-container: {
        padding: 0;
        min-width: 15em;
      }
      --paper-input-container-input: {
        font-size: inherit;
      }
      --paper-input-container-focus-color: var(--link-color);
    }
    gr-button iron-icon {
      color: inherit;
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
    }
    gr-button.pencil {
      --padding: 0px 0px;
    }
  </style>
  <template is="dom-if" if="[[!showAsEditPencil]]">
    <label
      class$="[[_computeLabelClass(readOnly, value, placeholder)]]"
      title$="[[_computeLabel(value, placeholder)]]"
      aria-label$="[[_computeLabel(value, placeholder)]]"
      on-click="_showDropdown"
      >[[_computeLabel(value, placeholder)]]</label
    >
  </template>
  <template is="dom-if" if="[[showAsEditPencil]]">
    <gr-button
      link=""
      class$="pencil [[_computeLabelClass(readOnly, value, placeholder)]]"
      on-click="_showDropdown"
      title="[[_computeLabel(value, placeholder)]]"
      ><iron-icon icon="gr-icons:edit"></iron-icon
    ></gr-button>
  </template>
  <iron-dropdown
    id="dropdown"
    vertical-align="auto"
    horizontal-align="auto"
    vertical-offset="[[_verticalOffset]]"
    allow-outside-scroll="true"
    on-iron-overlay-canceled="_cancel"
  >
    <div class="dropdown-content" slot="dropdown-content">
      <div class="inputContainer">
        <template is="dom-if" if="[[!autocomplete]]">
          <paper-input
            id="input"
            label="[[labelText]]"
            maxlength="[[maxLength]]"
            value="{{_inputText}}"
          ></paper-input>
        </template>
        <template is="dom-if" if="[[autocomplete]]">
          <gr-autocomplete
            label="[[labelText]]"
            id="autocomplete"
            text="{{_inputText}}"
            query="[[query]]"
            on-commit="_handleCommit"
          >
          </gr-autocomplete>
        </template>
        <div class="buttons">
          <gr-button link="" id="cancelBtn" on-click="_cancel"
            >cancel</gr-button
          >
          <gr-button link="" id="saveBtn" on-click="_save">save</gr-button>
        </div>
      </div>
    </div>
  </iron-dropdown>
`;var GA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let zA=class extends(Kf(fi)){constructor(){super(...arguments),this.editing=!1,this.value="",this.placeholder="",this.readOnly=!1,this.uppercase=!1,this._verticalOffset=-30,this.showAsEditPencil=!1,this.autocomplete=!1}static get template(){return UA}ready(){super.ready(),this._ensureAttribute("tabindex","0")}get keyBindings(){return{enter:"_handleEnter",esc:"_handleEsc"}}_usePlaceholder(e,t){return(!e||!e.length)&&t}_computeLabel(e,t){return this._usePlaceholder(e,t)?t:e||""}_showDropdown(){if(!this.readOnly&&!this.editing)return this._open().then(()=>{this._nativeInput.focus();const e=this.getInput();(null==e?void 0:e.value)&&this._nativeInput.setSelectionRange(0,e.value.length)})}open(){return this._open().then(()=>{this._nativeInput.focus()})}_open(){return this.$.dropdown.open(),this._inputText=this.value||"",this.editing=!0,new Promise(e=>{this._awaitOpen(e)})}_awaitOpen(e){let t=0;const i=()=>{setTimeout(()=>{"none"!==this.$.dropdown.style.display?e.call(this):t++<10&&i.call(this)},5)};i.call(this)}_id(){return this.getAttribute("id")||"global"}_save(){this.editing&&(this.$.dropdown.close(),this.value=this._inputText||"",this.editing=!1,this.dispatchEvent(new CustomEvent("changed",{detail:this.value,composed:!0,bubbles:!0})))}_cancel(){this.editing&&(this.$.dropdown.close(),this.editing=!1,this._inputText=this.value)}get _nativeInput(){var e,t;return(null===(e=this.getInput())||void 0===e?void 0:e.$.nativeInput)||(null===(t=this.getInput())||void 0===t?void 0:t.inputElement)||this.getGrAutocomplete()}_handleEnter(e){e=this.getKeyboardEvent(e),Th(e).rootTarget===this._nativeInput&&(e.preventDefault(),this._save())}_handleEsc(e){e=this.getKeyboardEvent(e),Th(e).rootTarget===this._nativeInput&&(e.preventDefault(),this._cancel())}_handleCommit(){this._save()}_computeLabelClass(e,t,i){const n=[];return e||n.push("editable"),this._usePlaceholder(t,i)&&n.push("placeholder"),n.join(" ")}_updateTitle(e){this.setAttribute("title",this._computeLabel(e,this.placeholder))}getInput(){return this.shadowRoot.querySelector("#input")}getGrAutocomplete(){return this.shadowRoot.querySelector("#autocomplete")}};GA([Oo({type:String})],zA.prototype,"labelText",void 0),GA([Oo({type:Boolean})],zA.prototype,"editing",void 0),GA([Oo({type:String,notify:!0,observer:"_updateTitle"})],zA.prototype,"value",void 0),GA([Oo({type:String})],zA.prototype,"placeholder",void 0),GA([Oo({type:Boolean})],zA.prototype,"readOnly",void 0),GA([Oo({type:Boolean,reflectToAttribute:!0})],zA.prototype,"uppercase",void 0),GA([Oo({type:Number})],zA.prototype,"maxLength",void 0),GA([Oo({type:String})],zA.prototype,"_inputText",void 0),GA([Oo({type:Number})],zA.prototype,"_verticalOffset",void 0),GA([Oo({type:Boolean})],zA.prototype,"showAsEditPencil",void 0),GA([Oo({type:Boolean})],zA.prototype,"autocomplete",void 0),GA([Oo({type:Object})],zA.prototype,"query",void 0),zA=GA([Po("gr-editable-label")],zA);const VA=mi`
  <style include="shared-styles">
    :host {
      display: block;
      overflow: hidden;
    }
    .container {
      align-items: center;
      background: var(--chip-background-color);
      border-radius: 0.75em;
      display: inline-flex;
      padding: 0 var(--spacing-m);
    }
    gr-button.remove {
      --gr-remove-button-style: {
        border-top-width: 0;
        border-right-width: 0;
        border-bottom-width: 0;
        border-left-width: 0;
        color: var(--deemphasized-text-color);
        font-weight: var(--font-weight-normal);
        height: 0.6em;
        line-height: 10px;
        margin-left: var(--spacing-xs);
        padding: 0;
        text-decoration: none;
      }
    }

    gr-button.remove:hover,
    gr-button.remove:focus {
      --gr-button: {
        @apply --gr-remove-button-style;
      }
    }
    gr-button.remove {
      --gr-button: {
        @apply --gr-remove-button-style;
      }
    }
    .transparentBackground,
    gr-button.transparentBackground {
      background-color: transparent;
    }
    :host([disabled]) {
      opacity: 0.6;
      pointer-events: none;
    }
    a {
      color: var(--linked-chip-text-color);
    }
    iron-icon {
      height: 1.2rem;
      width: 1.2rem;
    }
  </style>
  <div class$="container [[_getBackgroundClass(transparentBackground)]]">
    <a href$="[[href]]">
      <gr-limited-text limit="[[limit]]" text="[[text]]"></gr-limited-text>
    </a>
    <gr-button
      id="remove"
      link=""
      hidden$="[[!removable]]"
      hidden=""
      class$="remove [[_getBackgroundClass(transparentBackground)]]"
      on-click="_handleRemoveTap"
    >
      <iron-icon icon="gr-icons:close"></iron-icon>
    </gr-button>
  </div>
`;var WA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let qA=class extends fi{constructor(){super(...arguments),this.disabled=!1,this.removable=!1,this.transparentBackground=!1}static get template(){return VA}_getBackgroundClass(e){return e?"transparentBackground":""}_handleRemoveTap(e){e.preventDefault(),bi(this,"remove")}};WA([Oo({type:String})],qA.prototype,"href",void 0),WA([Oo({type:Boolean,reflectToAttribute:!0})],qA.prototype,"disabled",void 0),WA([Oo({type:Boolean})],qA.prototype,"removable",void 0),WA([Oo({type:String})],qA.prototype,"text",void 0),WA([Oo({type:Boolean})],qA.prototype,"transparentBackground",void 0),WA([Oo({type:Number})],qA.prototype,"limit",void 0),qA=WA([Po("gr-linked-chip")],qA);const KA=mi` <slot></slot> `;let YA=class extends(Ff(fi)){static get template(){return KA}};YA=(window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s})([Po("gr-label")],YA);const XA=mi`
  <style include="gr-voting-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    .placeholder {
      color: var(--deemphasized-text-color);
    }
    .hidden {
      display: none;
    }
    .voteChip {
      display: flex;
      justify-content: center;
      margin-right: var(--spacing-s);
      padding: 1px;
      @apply --vote-chip-styles;
      border: 1px solid var(--border-color);
    }
    .max {
      background-color: var(--vote-color-approved);
    }
    .min {
      background-color: var(--vote-color-rejected);
    }
    .positive {
      background-color: var(--vote-color-recommended);
      border-radius: 12px;
      border: 1px solid var(--vote-outline-recommended);
      color: var(--chip-color);
    }
    .negative {
      background-color: var(--vote-color-disliked);
      border-radius: 12px;
      border: 1px solid var(--vote-outline-disliked);
      color: var(--chip-color);
    }
    .hidden {
      display: none;
    }
    td {
      vertical-align: top;
    }
    tr {
      min-height: var(--line-height-normal);
    }
    gr-button {
      vertical-align: top;
      --gr-button: {
        height: var(--line-height-normal);
        width: var(--line-height-normal);
        padding: 0;
      }
    }
    gr-button[disabled] iron-icon {
      color: var(--border-color);
    }
    gr-account-link {
      --account-max-length: 100px;
      margin-right: var(--spacing-xs);
    }
    iron-icon {
      height: calc(var(--line-height-normal) - 2px);
      width: calc(var(--line-height-normal) - 2px);
    }
    .labelValueContainer:not(:first-of-type) td {
      padding-top: var(--spacing-s);
    }
  </style>
  <p
    class$="placeholder [[_computeShowPlaceholder(labelInfo, change.labels.*)]]"
  >
    No votes.
  </p>
  <table>
    <template
      is="dom-repeat"
      items="[[_mapLabelInfo(labelInfo, account, change.labels.*)]]"
      as="mappedLabel"
    >
      <tr class="labelValueContainer">
        <td>
          <gr-label
            has-tooltip=""
            title="[[_computeValueTooltip(labelInfo, mappedLabel.value)]]"
            class$="[[mappedLabel.className]] voteChip font-small"
          >
            [[mappedLabel.value]]
          </gr-label>
        </td>
        <td>
          <gr-account-link
            account="[[mappedLabel.account]]"
            change="[[change]]"
          ></gr-account-link>
        </td>
        <td>
          <gr-button
            link=""
            aria-label="Remove vote"
            on-click="_onDeleteVote"
            tooltip="Remove vote"
            data-account-id$="[[mappedLabel.account._account_id]]"
            class$="deleteBtn [[_computeDeleteClass(mappedLabel.account, mutable, change)]]"
          >
            <iron-icon icon="gr-icons:delete"></iron-icon>
          </gr-button>
        </td>
      </tr>
    </template>
  </table>
`;var JA,ZA=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};!function(e){e.NEGATIVE="negative",e.POSITIVE="positive",e.MIN="min",e.MAX="max"}(JA||(JA={}));let QA=class extends fi{constructor(){super(...arguments),this.label="",this.mutable=!1,this.restApiService=i.restApiService}static get template(){return XA}_mapLabelInfo(e,t){const i=[];if(!e)return i;if(!Fn(e)){if(Mn(e)&&(e.rejected||e.approved)){const t=e.approved||!e.rejected;return[{value:t?"":"",className:t?JA.POSITIVE:JA.NEGATIVE,account:t?e.approved:e.rejected}]}return i}const n=(e.all||[]).sort((e,t)=>(e.value||0)-(t.value||0)),o=aA(e);for(const r of n)if(r.value&&(!Mn(e)||r.value!==e.default_value)){let e,n="";r.value>0?(n="+",e=r.value===o.max?JA.MAX:JA.POSITIVE):r.value<0&&(e=r.value===o.min?JA.MIN:JA.NEGATIVE);const s={value:`${n}${r.value}`,className:e,account:r};r._account_id===(null==t?void 0:t._account_id)?i.unshift(s):i.push(s)}return i}_computeDeleteClass(e,t,i){if(!t||!i||!i.removable_reviewers)return"hidden";return i.removable_reviewers.find(t=>t._account_id===e._account_id)?"":"hidden"}_onDeleteVote(e){if(!this.change)return;e.preventDefault();let t=Th(e).rootTarget;for(;!t.classList.contains("deleteBtn");){if(!t.parentElement)return;t=t.parentElement}t.disabled=!0;const i=Number(`${t.getAttribute("data-account-id")}`);this._xhrPromise=this.restApiService.deleteVote(this.change._number,i,this.label).then(e=>{t.disabled=!1,e.ok&&this.change&&Qm.navigateToChange(this.change)}).catch(e=>{console.warn(e),t.disabled=!1})}_computeValueTooltip(e,t){var i;return e&&Fn(e)&&(null===(i=e.values)||void 0===i?void 0:i[t])?e.values[t]:""}_computeShowPlaceholder(e){if(!e)return"";if(!Fn(e)&&Mn(e)&&(e.rejected||e.approved))return"hidden";if(Fn(e)&&e.all)for(const t of e.all)if(t.value&&(!Mn(e)||t.value!==e.default_value))return"hidden";return""}};ZA([Oo({type:Object})],QA.prototype,"labelInfo",void 0),ZA([Oo({type:String})],QA.prototype,"label",void 0),ZA([Oo({type:Object})],QA.prototype,"change",void 0),ZA([Oo({type:Object})],QA.prototype,"account",void 0),ZA([Oo({type:Boolean})],QA.prototype,"mutable",void 0),QA=ZA([Po("gr-label-info")],QA);const ex=mi`
  <style include="shared-styles">
    :host {
      display: table;
      width: 100%;
    }
    .status {
      color: var(--warning-foreground);
      display: inline-block;
      text-align: center;
      vertical-align: top;
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
    }
    .approved.status {
      color: var(--positive-green-text-color);
    }
    .rejected.status {
      color: var(--negative-red-text-color);
    }
    iron-icon {
      color: inherit;
    }
    .status iron-icon {
      vertical-align: top;
    }
    gr-endpoint-decorator.submit-requirement-endpoints,
    section {
      display: table-row;
    }
    .show-hide {
      float: right;
    }
    .title {
      min-width: 10em;
      padding: var(--spacing-s) var(--spacing-m) 0
        var(--requirements-horizontal-padding);
    }
    .value {
      padding: var(--spacing-s) 0 0 0;
    }
    .title,
    .value {
      display: table-cell;
      vertical-align: top;
    }
    .hidden {
      display: none;
    }
    .showHide {
      cursor: pointer;
    }
    .showHide .title {
      padding-bottom: var(--spacing-m);
      padding-top: var(--spacing-l);
    }
    .showHide .value {
      padding-top: 0;
      vertical-align: middle;
    }
    .showHide iron-icon {
      color: var(--deemphasized-text-color);
      float: right;
    }
    .show-all-button {
      float: right;
    }
    .show-all-button iron-icon {
      color: inherit;
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
    }
    .spacer {
      height: var(--spacing-m);
    }
    gr-endpoint-param {
      display: none;
    }
    .metadata-title {
      font-weight: var(--font-weight-bold);
      color: var(--deemphasized-text-color);
      padding-left: var(--metadata-horizontal-padding);
    }
    .title .metadata-title {
      padding-left: 0;
    }
  </style>
  <h3 class="metadata-title">Submit requirements</h3>
  <template is="dom-repeat" items="[[_requirements]]">
    <gr-endpoint-decorator
      class="submit-requirement-endpoints"
      name$="[[_computeSubmitRequirementEndpoint(item)]]"
    >
      <gr-endpoint-param name="change" value="[[change]]"></gr-endpoint-param>
      <gr-endpoint-param name="requirement" value="[[item]]">
      </gr-endpoint-param>
      <div class="title requirement">
        <span class$="status [[item.style]]">
          <iron-icon
            class="icon"
            icon="[[_computeRequirementIcon(item.satisfied)]]"
          ></iron-icon>
        </span>
        <gr-limited-text
          class="name"
          limit="25"
          tooltip="[[item.tooltip]]"
          text="[[item.fallback_text]]"
        ></gr-limited-text>
      </div>
      <div class="value">
        <gr-endpoint-slot name="value"></gr-endpoint-slot>
      </div>
    </gr-endpoint-decorator>
  </template>
  <template is="dom-repeat" items="[[_requiredLabels]]">
    <section>
      <div class="title">
        <span class$="status [[item.style]]">
          <iron-icon class="icon" icon="[[item.icon]]"></iron-icon>
        </span>
        <gr-limited-text
          class="name"
          limit="25"
          text="[[item.labelName]]"
        ></gr-limited-text>
      </div>
      <div class="value">
        <gr-label-info
          change="{{change}}"
          account="[[account]]"
          mutable="[[mutable]]"
          label="[[item.labelName]]"
          label-info="[[item.labelInfo]]"
        ></gr-label-info>
      </div>
    </section>
  </template>
  <section class="spacer"></section>
  <section
    class$="spacer [[_computeShowOptional(_optionalLabels.*)]]"
  ></section>
  <section class$="showHide [[_computeShowOptional(_optionalLabels.*)]]">
    <div class="title">
      <h3 class="metadata-title">Other labels</h3>
    </div>
    <div class="value">
      <gr-button link="" class="show-all-button" on-click="_handleShowHide"
        >[[_computeShowAllLabelText(_showOptionalLabels)]]
        <iron-icon
          icon="gr-icons:expand-more"
          hidden$="[[_showOptionalLabels]]"
        ></iron-icon
        ><iron-icon
          icon="gr-icons:expand-less"
          hidden$="[[!_showOptionalLabels]]"
        ></iron-icon>
      </gr-button>
    </div>
  </section>
  <template is="dom-repeat" items="[[_optionalLabels]]">
    <section class$="optional [[_computeSectionClass(_showOptionalLabels)]]">
      <div class="title">
        <span class$="status [[item.style]]">
          <template is="dom-if" if="[[item.icon]]">
            <iron-icon class="icon" icon="[[item.icon]]"></iron-icon>
          </template>
          <template is="dom-if" if="[[!item.icon]]">
            <span>[[_computeLabelValue(item.labelInfo.value)]]</span>
          </template>
        </span>
        <gr-limited-text
          class="name"
          limit="25"
          text="[[item.labelName]]"
        ></gr-limited-text>
      </div>
      <div class="value">
        <gr-label-info
          change="{{change}}"
          account="[[account]]"
          mutable="[[mutable]]"
          label="[[item.labelName]]"
          label-info="[[item.labelInfo]]"
        ></gr-label-info>
      </div>
    </section>
  </template>
  <section
    class$="spacer [[_computeShowOptional(_optionalLabels.*)]] [[_computeSectionClass(_showOptionalLabels)]]"
  ></section>
`;var tx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let ix=class extends fi{constructor(){super(...arguments),this._requiredLabels=[],this._optionalLabels=[],this._showOptionalLabels=!0,this.reporting=i.reportingService}static get template(){return ex}_computeShowWip(e){return e.work_in_progress}_computeRequirements(e){const t=[];if(e.requirements)for(const i of e.requirements){const e="OK"===i.status,n=this._computeRequirementClass(e);t.push({...i,satisfied:e,style:n})}return e.work_in_progress&&t.push({type:"wip",fallback_text:"Work-in-progress",tooltip:"Change must not be in 'Work in Progress' state."}),t}_computeRequirementClass(e){return e?"approved":""}_computeRequirementIcon(e){return e?"gr-icons:check":"gr-icons:schedule"}_computeLabels(e){const t=e.base||{},i=[];for(const e of Object.keys(t).sort(cA))i.push({labelName:e,icon:this._computeLabelIcon(t[e]),style:this._computeLabelClass(t[e]),labelInfo:t[e]});this._optionalLabels=i.filter(e=>e.labelInfo.optional),this._requiredLabels=i.filter(e=>!e.labelInfo.optional)}_computeLabelIcon(e){return e.approved?"gr-icons:check":e.rejected?"gr-icons:close":"gr-icons:schedule"}_computeLabelClass(e){return e.approved?"approved":e.rejected?"rejected":""}_computeShowOptional(e){return e.base.length?"":"hidden"}_computeLabelValue(e){return`${e>0?"+":""}${e}`}_computeSectionClass(e){return e?"":"hidden"}_handleShowHide(){this._showOptionalLabels=!this._showOptionalLabels,this.reporting.reportInteraction("toggle show all button",{sectionName:"optional labels",toState:this._showOptionalLabels?"Show all":"Show less"})}_computeSubmitRequirementEndpoint(e){return`submit-requirement-item-${e.type}`}_computeShowAllLabelText(e){return e?"Show less":"Show all"}};tx([Oo({type:Object})],ix.prototype,"change",void 0),tx([Oo({type:Object})],ix.prototype,"account",void 0),tx([Oo({type:Boolean})],ix.prototype,"mutable",void 0),tx([Oo({type:Array,computed:"_computeRequirements(change)"})],ix.prototype,"_requirements",void 0),tx([Oo({type:Array})],ix.prototype,"_requiredLabels",void 0),tx([Oo({type:Array})],ix.prototype,"_optionalLabels",void 0),tx([Oo({type:Boolean,computed:"_computeShowWip(change)"})],ix.prototype,"_showWip",void 0),tx([Oo({type:Boolean})],ix.prototype,"_showOptionalLabels",void 0),tx([No("change.labels.*")],ix.prototype,"_computeLabels",null),ix=tx([Po("gr-change-requirements")],ix);const nx=mi`
  <style include="shared-styles">
    .container {
      align-items: center;
      display: flex;
    }
  </style>
  <div class="container">
    <template is="dom-if" if="[[_showWebLink]]">
      <a target="_blank" rel="noopener" href$="[[_webLink]]"
        >[[_computeShortHash(change, commitInfo, serverConfig)]]</a
      >
    </template>
    <template is="dom-if" if="[[!_showWebLink]]">
      [[_computeShortHash(change, commitInfo, serverConfig)]]
    </template>
    <gr-copy-clipboard
      has-tooltip=""
      button-title="Copy full SHA to clipboard"
      hide-input=""
      text="[[commitInfo.commit]]"
    >
    </gr-copy-clipboard>
  </div>
`;var ox=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let rx=class extends fi{static get template(){return nx}get _showWebLink(){if(!this.change||!this.commitInfo||!this.serverConfig)return!1;const e=this._getWeblink(this.change,this.commitInfo,this.serverConfig);return!!e&&!!e.url}get _webLink(){if(!this.change||!this.commitInfo||!this.serverConfig)return"";const{url:e}=this._getWeblink(this.change,this.commitInfo,this.serverConfig)||{};return e}_getWeblink(e,t,i){return Qm.getPatchSetWeblink(e.project,t.commit,{weblinks:t.web_links,config:i})}_computeShortHash(e,t,i){if(!e||!t||!i)return"";const{name:n}=this._getWeblink(e,t,i)||{};return n}};ox([Oo({type:Object})],rx.prototype,"change",void 0),ox([Oo({type:Object})],rx.prototype,"commitInfo",void 0),ox([Oo({type:Object})],rx.prototype,"serverConfig",void 0),ox([Lo("change","commitInfo","serverConfig")],rx.prototype,"_showWebLink",null),ox([Lo("change","commitInfo","serverConfig")],rx.prototype,"_webLink",null),rx=ox([Po("gr-commit-info")],rx);const sx=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    :host([disabled]) {
      opacity: 0.8;
      pointer-events: none;
    }
    .container {
      display: block;
      /* line-height-normal for the chips, 2px for the chip border, spacing-s
         for the gap between lines, negative bottom margin for eliminating the
         gap after the last line */
      line-height: calc(var(--line-height-normal) + 2px + var(--spacing-s));
      margin-bottom: calc(0px - var(--spacing-s));
    }
    .addReviewer iron-icon {
      color: inherit;
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
    }
    .controlsContainer {
      display: inline-block;
    }
    gr-button.addReviewer {
      --padding: 1px 4px;
      vertical-align: top;
      top: 1px;
    }
    gr-button {
      line-height: var(--line-height-normal);
      --gr-button: {
        padding: 0px 0px;
      }
    }
    gr-account-chip {
      line-height: var(--line-height-normal);
      vertical-align: top;
      display: inline-block;
    }
  </style>
  <div class="container">
    <div>
      <template is="dom-repeat" items="[[_displayedReviewers]]" as="reviewer">
        <gr-account-chip
          class="reviewer"
          account="[[reviewer]]"
          change="[[change]]"
          on-remove="_handleRemove"
          highlight-attention
          voteable-text="[[_computeVoteableText(reviewer, change)]]"
          removable="[[_computeCanRemoveReviewer(reviewer, mutable)]]"
        >
        </gr-account-chip>
      </template>
      <div class="controlsContainer" hidden$="[[!mutable]]">
        <gr-button
          link=""
          id="addReviewer"
          class="addReviewer"
          on-click="_handleAddTap"
          title="[[_addLabel]]"
          ><iron-icon icon="gr-icons:edit"></iron-icon
        ></gr-button>
      </div>
    </div>
    <gr-button
      class="hiddenReviewers"
      link=""
      hidden$="[[!_hiddenReviewerCount]]"
      on-click="_handleViewAll"
      >and [[_hiddenReviewerCount]] more</gr-button
    >
  </div>
`;var ax=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let lx=class extends fi{constructor(){super(...arguments),this.disabled=!1,this.mutable=!1,this.reviewersOnly=!1,this.ccsOnly=!1,this._displayedReviewers=[],this._reviewers=[],this._showInput=!1,this.restApiService=i.restApiService}static get template(){return sx}get _addLabel(){return this.ccsOnly?"Add CC":"Add reviewer"}get _hiddenReviewerCount(){if(void 0!==this._reviewers&&void 0!==this._displayedReviewers)return this._reviewers.length-this._displayedReviewers.length}_permittedLabelsToNumericScores(e){return e?Object.keys(e).map(t=>({label:t,scores:e[t].map(e=>Number(e))})):[]}_getMaxPermittedScores(e){return this._permittedLabelsToNumericScores(e.permitted_labels).map(({label:e,scores:t})=>({[e]:t.reduce((e,t)=>Math.max(e,t))})).reduce((e,t)=>Object.assign(e,t),{})}_getReviewerPermittedScore(e,t,i){if(!t.labels)return NaN;const n=t.labels[i];if(!n.all)return NaN;const r=n.all.filter(t=>e._account_id===t._account_id).pop();return r?o(r,"permitted_voting_range")?r.permitted_voting_range?r.permitted_voting_range.max:NaN:o(r,"value")?0:NaN:NaN}_computeVoteableText(e,t){if(!t||!t.labels)return"";const i=[],n=this._getMaxPermittedScores(t);for(const o of Object.keys(t.labels)){const r=this._getReviewerPermittedScore(e,t,o);isNaN(r)||r<0||(r>0&&r===n[o]?i.push(`${o}: +${r}`):i.push(`${o}`))}return i.join(", ")}_reviewersChanged(e,t,i){if(void 0===e||void 0===t||void 0===i||void 0===this.change)return;let n=[];const o=e.base;for(const e of Object.keys(o))this.reviewersOnly&&"REVIEWER"!==e||this.ccsOnly&&"CC"!==e||"REVIEWER"!==e&&"CC"!==e||(n=n.concat(o[e]));this._reviewers=n.filter(e=>e._account_id!==t._account_id).sort((e,t)=>{if(this.account){if(In(e,this.account))return-1;if(In(t,this.account))return 1}const n=Av(i,e,this.change)?1:0,o=Av(i,t,this.change)?1:0,r=Pn(e)?-2:0;return o-n+(Pn(t)?-2:0)-r}),this._reviewers.length>8?this._displayedReviewers=this._reviewers.slice(0,6):this._displayedReviewers=this._reviewers}_computeCanRemoveReviewer(e,t){return t&&To(this.change,e)}_handleRemove(e){e.preventDefault();const t=Th(e).rootTarget;if(!t.account||!this.change)return;const i=t.account._account_id||t.account.email;this.disabled=!0,i&&(this._xhrPromise=this._removeReviewer(i).then(e=>{if(this.disabled=!1,!e||!e.ok)return e;if(!this.change||!this.change.reviewers)return;const t=this.change.reviewers;for(const e of[en.REVIEWER,en.CC]){const n=t[e]||[];t[e]=n;for(let t=0;t<n.length;t++)if(n[t]._account_id===i||n[t].email===i){this.splice("change.reviewers."+e,t,1);break}}}).catch(e=>{throw this.disabled=!1,e}))}_handleAddTap(e){e.preventDefault();const t={reviewersOnly:!1,ccsOnly:!1};this.reviewersOnly&&(t.reviewersOnly=!0),this.ccsOnly&&(t.ccsOnly=!0),this.dispatchEvent(new CustomEvent("show-reply-dialog",{detail:{value:t},composed:!0,bubbles:!0}))}_handleViewAll(){this._displayedReviewers=this._reviewers}_removeReviewer(e){return this.change?this.restApiService.removeChangeReviewer(this.change._number,e):Promise.resolve(void 0)}};ax([Oo({type:Object})],lx.prototype,"change",void 0),ax([Oo({type:Object})],lx.prototype,"account",void 0),ax([Oo({type:Object})],lx.prototype,"serverConfig",void 0),ax([Oo({type:Boolean,reflectToAttribute:!0})],lx.prototype,"disabled",void 0),ax([Oo({type:Boolean})],lx.prototype,"mutable",void 0),ax([Oo({type:Boolean})],lx.prototype,"reviewersOnly",void 0),ax([Oo({type:Boolean})],lx.prototype,"ccsOnly",void 0),ax([Oo({type:Array})],lx.prototype,"_displayedReviewers",void 0),ax([Oo({type:Array})],lx.prototype,"_reviewers",void 0),ax([Oo({type:Boolean})],lx.prototype,"_showInput",void 0),ax([Oo({type:Object})],lx.prototype,"_xhrPromise",void 0),ax([Lo("ccsOnly")],lx.prototype,"_addLabel",null),ax([Lo("_reviewers","_displayedReviewers")],lx.prototype,"_hiddenReviewerCount",null),ax([No("change.reviewers.*","change.owner","serverConfig")],lx.prototype,"_reviewersChanged",null),lx=ax([Po("gr-reviewer-list")],lx);const cx=mi`
  <style include="shared-styles">
    gr-autocomplete {
      display: inline-block;
      flex: 1;
      overflow: hidden;
    }
  </style>
  <gr-autocomplete
    id="input"
    borderless="[[borderless]]"
    placeholder="[[placeholder]]"
    threshold="[[suggestFrom]]"
    query="[[querySuggestions]]"
    allow-non-suggested-values="[[allowAnyInput]]"
    on-commit="_handleInputCommit"
    clear-on-commit=""
    warn-uncommitted=""
    text="{{_inputText}}"
    vertical-offset="24"
  >
  </gr-autocomplete>
`;var dx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let hx=class extends fi{constructor(){super(...arguments),this.suggestFrom=0,this.querySuggestions=()=>Promise.resolve([])}static get template(){return cx}get focusStart(){return this.$.input.focusStart}focus(){this.$.input.focus()}clear(){this.$.input.clear()}setText(e){this.$.input.setText(e)}getText(){return this.$.input.text}_handleInputCommit(e){this.dispatchEvent(new CustomEvent("add",{detail:{value:e.detail.value},composed:!0,bubbles:!0})),this.$.input.focus()}_inputTextChanged(e){e.length&&this.allowAnyInput&&this.dispatchEvent(new CustomEvent("account-text-changed",{bubbles:!0,composed:!0}))}};dx([Oo({type:Boolean})],hx.prototype,"allowAnyInput",void 0),dx([Oo({type:Boolean})],hx.prototype,"borderless",void 0),dx([Oo({type:String})],hx.prototype,"placeholder",void 0),dx([Oo({type:Number})],hx.prototype,"suggestFrom",void 0),dx([Oo({type:Object,notify:!0})],hx.prototype,"querySuggestions",void 0),dx([Oo({type:String,observer:"_inputTextChanged"})],hx.prototype,"_inputText",void 0),hx=dx([Po("gr-account-entry")],hx);const px=mi`
  <style include="shared-styles">
    gr-account-chip {
      display: inline-block;
      margin: var(--spacing-xs) var(--spacing-xs) var(--spacing-xs) 0;
    }
    gr-account-entry {
      display: flex;
      flex: 1;
      min-width: 10em;
      margin: var(--spacing-xs) var(--spacing-xs) var(--spacing-xs) 0;
    }
    .group {
      --account-label-suffix: ' (group)';
    }
    .pending-add {
      font-style: italic;
    }
    .list {
      align-items: center;
      display: flex;
      flex-wrap: wrap;
      @apply --account-list-style;
    }
  </style>
  <!--
      NOTE(Issue 6419): Nest the inner dom-repeat template in a div rather than
      as a direct child of the dom-module's template.
    -->
  <div class="list">
    <template id="chips" is="dom-repeat" items="[[accounts]]" as="account">
      <gr-account-chip
        account="[[account]]"
        class$="[[_computeChipClass(account)]]"
        data-account-id$="[[account._account_id]]"
        removable="[[_computeRemovable(account, readonly)]]"
        on-keydown="_handleChipKeydown"
        tabindex="-1"
      >
      </gr-account-chip>
    </template>
  </div>
  <gr-account-entry
    borderless=""
    hidden$="[[_computeEntryHidden(maxCount, accounts.*, readonly)]]"
    id="entry"
    placeholder="[[placeholder]]"
    on-add="_handleAdd"
    on-input-keydown="_handleInputKeydown"
    allow-any-input="[[allowAnyInput]]"
    query-suggestions="[[_querySuggestions]]"
  >
  </gr-account-entry>
  <slot></slot>
`;var ux=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let gx=class extends fi{constructor(){super(),this.accounts=[],this.placeholder="",this.disabled=!1,this.pendingConfirmation=null,this.readonly=!1,this.allowAnyInput=!1,this.maxCount=0,this.skipSuggestOnEmpty=!1,this.reporting=i.reportingService,this._querySuggestions=e=>this._getSuggestions(e),this.addEventListener("remove",e=>this._handleRemove(e))}static get template(){return px}get accountChips(){var e;return Array.from((null===(e=this.root)||void 0===e?void 0:e.querySelectorAll("gr-account-chip"))||[])}get focusStart(){return this.$.entry.focusStart}_getSuggestions(e){if(this.skipSuggestOnEmpty&&!e)return Promise.resolve([]);const t=this.suggestionsProvider;return t?t.getSuggestions(e).then(e=>e?(this.filter&&(e=e.filter(this.filter)),e.map(e=>t.makeSuggestionItem(e))):[]):Promise.resolve([])}_handleAdd(e){this.addAccountItem(e.detail.value)}addAccountItem(e){let t="unknown";if(e.account){const i={...e.account,_pendingAdd:!0};this.push("accounts",i),t="account"}else if(function(e){return!!e.group}(e)){if(e.confirm)return void(this.pendingConfirmation=e);const i={...e.group,_pendingAdd:!0,_group:!0};this.push("accounts",i),t="group"}else if(this.allowAnyInput){if(!e.includes("@"))return this.$.entry.setText(e),Ci(this,"Please input a valid email."),!1;{const i={email:e,_pendingAdd:!0};this.push("accounts",i),t="email"}}return this.reporting.reportInteraction(`Add to ${this.id}`,{itemTypeAdded:t}),this.pendingConfirmation=null,!0}confirmGroup(e){this.push("accounts",{...e,confirmed:!0,_pendingAdd:!0,_group:!0}),this.pendingConfirmation=null}_computeChipClass(e){const t=[];return e._group&&t.push("group"),e._pendingAdd&&t.push("pendingAdd"),t.join(" ")}_accountMatches(e,t){if(e&&t){if(e._account_id)return e._account_id===t._account_id;if(e.email)return e.email===t.email}return e===t}_computeRemovable(e,t){if(t)return!1;if(this.removableValues){for(let t=0;t<this.removableValues.length;t++)if(this._accountMatches(this.removableValues[t],e))return!0;return!!e._pendingAdd}return!0}_handleRemove(e){const t=e.detail.account;this.removeAccount(t),this.$.entry.focus()}removeAccount(e){if(e&&this._computeRemovable(e,this.readonly)){for(let t=0;t<this.accounts.length;t++){let i;const n=this.accounts[t];if(i=e._group?e.id===n.id:this._accountMatches(e,n),i)return this.splice("accounts",t,1),void this.reporting.reportInteraction(`Remove from ${this.id}`)}console.warn("received remove event for missing account",e)}}_getNativeInput(e){return e.$.nativeInput||e.inputElement}_handleInputKeydown(e){const t=this._getNativeInput(e.detail.input);if(t.selectionStart===t.selectionEnd&&0===t.selectionStart)switch(e.detail.keyCode){case 8:this.removeAccount(this.accounts[this.accounts.length-1]);break;case 37:this.accountChips[this.accountChips.length-1]&&this.accountChips[this.accountChips.length-1].focus()}}_handleChipKeydown(e){const t=e.target,i=this.accountChips,n=i.indexOf(t);switch(e.keyCode){case 8:case 13:case 32:case 46:this.removeAccount(t.account),i.splice(n,1),n<i.length?i[n].focus():n>0?i[n-1].focus():this.$.entry.focus();break;case 37:n>0&&(t.blur(),i[n-1].focus());break;case 39:t.blur(),n<i.length-1?i[n+1].focus():this.$.entry.focus()}}submitEntryText(){const e=this.$.entry.getText();if(!e.length)return!0;const t=this.addAccountItem(e);return t&&this.$.entry.clear(),t}additions(){return this.accounts.filter(e=>e._pendingAdd).map(e=>{if(function(e){const t=e;return!!t._group||!!t.id}(e))return{group:e};if(function(e){const t=e;return!!t._account||!!t._account_id||!!t.email}(e))return{account:e};throw new Error("AccountInput must be either Account or Group.")})}_computeEntryHidden(e,t,i){return e&&e<=t.base.length||i}};ux([Oo({type:Array,notify:!0})],gx.prototype,"accounts",void 0),ux([Oo({type:Object})],gx.prototype,"change",void 0),ux([Oo({type:Object})],gx.prototype,"filter",void 0),ux([Oo({type:String})],gx.prototype,"placeholder",void 0),ux([Oo({type:Boolean})],gx.prototype,"disabled",void 0),ux([Oo({type:Object})],gx.prototype,"suggestionsProvider",void 0),ux([Oo({type:Object,notify:!0})],gx.prototype,"pendingConfirmation",void 0),ux([Oo({type:Boolean})],gx.prototype,"readonly",void 0),ux([Oo({type:Boolean})],gx.prototype,"allowAnyInput",void 0),ux([Oo({type:Array})],gx.prototype,"removableValues",void 0),ux([Oo({type:Number})],gx.prototype,"maxCount",void 0),ux([Oo({type:Object})],gx.prototype,"_querySuggestions",void 0),ux([Oo({type:Boolean})],gx.prototype,"skipSuggestOnEmpty",void 0),gx=ux([Po("gr-account-list")],gx);const mx=mi`
  <style include="gr-change-metadata-shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    :host {
      display: table;
    }
    gr-change-requirements {
      --requirements-horizontal-padding: var(--metadata-horizontal-padding);
    }
    gr-editable-label {
      max-width: 9em;
    }
    .webLink {
      display: block;
    }
    /* CSS Mixins should be applied last. */
    section.assignee {
      @apply --change-metadata-assignee;
    }
    section.strategy {
      @apply --change-metadata-strategy;
    }
    section.topic {
      @apply --change-metadata-topic;
    }
    gr-account-chip[disabled],
    gr-linked-chip[disabled] {
      opacity: 0;
      pointer-events: none;
    }
    .hashtagChip {
      padding-bottom: var(--spacing-s);
    }
    /* consistent with section .title, .value */
    .hashtagChip:not(last-of-type) {
      padding-bottom: var(--spacing-s);
    }
    .hashtagChip:last-of-type {
      display: inline;
      vertical-align: top;
    }
    #externalStyle {
      display: block;
    }
    .parentList.merge {
      list-style-type: decimal;
      padding-left: var(--spacing-l);
    }
    .parentList gr-commit-info {
      display: inline-block;
    }
    .hideDisplay,
    #parentNotCurrentMessage {
      display: none;
    }
    .icon {
      margin: -3px 0;
    }
    .icon.help,
    .icon.notTrusted {
      color: var(--warning-foreground);
    }
    .icon.invalid {
      color: var(--negative-red-text-color);
    }
    .icon.trusted {
      color: var(--positive-green-text-color);
    }
    .parentList.notCurrent.nonMerge #parentNotCurrentMessage {
      --arrow-color: var(--warning-foreground);
      display: inline-block;
    }
    .separatedSection {
      margin-top: var(--spacing-l);
      padding: var(--spacing-m) 0;
    }
    .hashtag gr-linked-chip,
    .topic gr-linked-chip {
      --linked-chip-text-color: var(--link-color);
    }
    gr-reviewer-list {
      --account-max-length: 100px;
      max-width: 285px;
    }
    .metadata-title {
      font-weight: var(--font-weight-bold);
      color: var(--deemphasized-text-color);
      padding-left: var(--metadata-horizontal-padding);
    }
    .metadata-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      /* The goal is to achieve alignment of the owner account chip and the
         commit message box. Their top border should be on the same line. */
      margin-bottom: var(--spacing-s);
    }
    .show-all-button iron-icon {
      color: inherit;
      --iron-icon-height: 18px;
      --iron-icon-width: 18px;
    }
  </style>
  <gr-external-style id="externalStyle" name="change-metadata">
    <div class="metadata-header">
      <h3 class="metadata-title">Change Info</h3>
      <gr-button link="" class="show-all-button" on-click="_onShowAllClick"
        >[[_computeShowAllLabelText(_showAllSections)]]
        <iron-icon
          icon="gr-icons:expand-more"
          hidden$="[[_showAllSections]]"
        ></iron-icon
        ><iron-icon
          icon="gr-icons:expand-less"
          hidden$="[[!_showAllSections]]"
        ></iron-icon>
      </gr-button>
    </div>
    <template is="dom-if" if="[[change.submitted]]">
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.SUBMITTED)]]"
      >
        <span class="title">Submitted</span>
        <span class="value">
          <gr-date-formatter
            has-tooltip=""
            date-str="[[change.submitted]]"
            show-yesterday=""
          ></gr-date-formatter>
        </span>
      </section>
    </template>
    <section
      class$="[[_computeDisplayState(_showAllSections, change, _SECTION.UPDATED)]]"
    >
      <span class="title">
        <gr-tooltip-content
          has-tooltip=""
          title="Last update of (meta)data for this change."
        >
          Updated
        </gr-tooltip-content>
      </span>
      <span class="value">
        <gr-date-formatter
          has-tooltip=""
          date-str="[[change.updated]]"
          show-yesterday=""
        ></gr-date-formatter>
      </span>
    </section>
    <section
      class$="[[_computeDisplayState(_showAllSections, change, _SECTION.OWNER)]]"
    >
      <span class="title">Owner</span>
      <span class="value">
        <gr-account-chip
          account="[[change.owner]]"
          change="[[change]]"
          highlight-attention
        ></gr-account-chip>
        <template is="dom-if" if="[[_pushCertificateValidation]]">
          <gr-tooltip-content
            has-tooltip=""
            title$="[[_pushCertificateValidation.message]]"
          >
            <iron-icon
              class$="icon [[_pushCertificateValidation.class]]"
              icon="[[_pushCertificateValidation.icon]]"
            >
            </iron-icon>
          </gr-tooltip-content>
        </template>
      </span>
    </section>
    <section class$="[[_computeShowRoleClass(change, _CHANGE_ROLE.UPLOADER)]]">
      <span class="title">Uploader</span>
      <span class="value">
        <gr-account-chip
          account="[[_getNonOwnerRole(change, _CHANGE_ROLE.UPLOADER)]]"
          change="[[change]]"
          highlight-attention
        ></gr-account-chip>
      </span>
    </section>
    <section class$="[[_computeShowRoleClass(change, _CHANGE_ROLE.AUTHOR)]]">
      <span class="title">Author</span>
      <span class="value">
        <gr-account-chip
          account="[[_getNonOwnerRole(change, _CHANGE_ROLE.AUTHOR)]]"
          change="[[change]]"
        ></gr-account-chip>
      </span>
    </section>
    <section class$="[[_computeShowRoleClass(change, _CHANGE_ROLE.COMMITTER)]]">
      <span class="title">Committer</span>
      <span class="value">
        <gr-account-chip
          account="[[_getNonOwnerRole(change, _CHANGE_ROLE.COMMITTER)]]"
          change="[[change]]"
        ></gr-account-chip>
      </span>
    </section>
    <template is="dom-if" if="[[_isAssigneeEnabled(serverConfig)]]">
      <section
        class$="assignee [[_computeDisplayState(_showAllSections, change, _SECTION.ASSIGNEE)]]"
      >
        <span class="title">Assignee</span>
        <span class="value">
          <gr-account-list
            id="assigneeValue"
            placeholder="Set assignee..."
            max-count="1"
            skip-suggest-on-empty=""
            accounts="{{_assignee}}"
            readonly="[[_computeAssigneeReadOnly(_mutable, change)]]"
            suggestions-provider="[[_getReviewerSuggestionsProvider(change)]]"
          >
          </gr-account-list>
        </span>
      </section>
    </template>
    <section
      class$="[[_computeDisplayState(_showAllSections, change, _SECTION.REVIEWERS)]]"
    >
      <span class="title">Reviewers</span>
      <span class="value">
        <gr-reviewer-list
          change="{{change}}"
          mutable="[[_mutable]]"
          reviewers-only=""
          account="[[account]]"
          server-config="[[serverConfig]]"
        ></gr-reviewer-list>
      </span>
    </section>
    <section
      class$="[[_computeDisplayState(_showAllSections, change, _SECTION.CC)]]"
    >
      <span class="title">CC</span>
      <span class="value">
        <gr-reviewer-list
          change="{{change}}"
          mutable="[[_mutable]]"
          ccs-only=""
          account="[[account]]"
          server-config="[[serverConfig]]"
        ></gr-reviewer-list>
      </span>
    </section>
    <template
      is="dom-if"
      if="[[_computeShowRepoBranchTogether(change.project, change.branch)]]"
    >
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.REPO_BRANCH)]]"
      >
        <span class="title">Repo | Branch</span>
        <span class="value">
          <a href$="[[_computeProjectUrl(change.project)]]"
            >[[change.project]]</a
          >
          |
          <a href$="[[_computeBranchUrl(change.project, change.branch)]]"
            >[[change.branch]]</a
          >
        </span>
      </section>
    </template>
    <template
      is="dom-if"
      if="[[!_computeShowRepoBranchTogether(change.project, change.branch)]]"
    >
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.REPO_BRANCH)]]"
      >
        <span class="title">Repo</span>
        <span class="value">
          <a href$="[[_computeProjectUrl(change.project)]]">
            <gr-limited-text
              limit="40"
              text="[[change.project]]"
            ></gr-limited-text>
          </a>
        </span>
      </section>
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.REPO_BRANCH)]]"
      >
        <span class="title">Branch</span>
        <span class="value">
          <a href$="[[_computeBranchUrl(change.project, change.branch)]]">
            <gr-limited-text
              limit="40"
              text="[[change.branch]]"
            ></gr-limited-text>
          </a>
        </span>
      </section>
    </template>
    <section
      class$="[[_computeDisplayState(_showAllSections, change, _SECTION.PARENT)]]"
    >
      <span class="title">[[_computeParentsLabel(_currentParents)]]</span>
      <span class="value">
        <ol
          class$="[[_computeParentListClass(_currentParents, parentIsCurrent)]]"
        >
          <template is="dom-repeat" items="[[_currentParents]]" as="parent">
            <li>
              <gr-commit-info
                change="[[change]]"
                commit-info="[[parent]]"
                server-config="[[serverConfig]]"
              ></gr-commit-info>
              <gr-tooltip-content
                id="parentNotCurrentMessage"
                has-tooltip=""
                show-icon=""
                title$="[[_notCurrentMessage]]"
              ></gr-tooltip-content>
            </li>
          </template>
        </ol>
      </span>
    </section>
    <template is="dom-if" if="[[_isChangeMerged(change)]]">
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.MERGED_AS)]]"
      >
        <span class="title">Merged As</span>
        <span class="value">
          <gr-commit-info
            change="[[change]]"
            commit-info="[[_computeMergedCommitInfo(change.current_revision, change.revisions)]]"
            server-config="[[serverConfig]]"
          ></gr-commit-info>
        </span>
      </section>
    </template>
    <section
      class$="topic [[_computeDisplayState(_showAllSections, change, _SECTION.TOPIC)]]"
    >
      <span class="title">Topic</span>
      <span class="value">
        <template is="dom-if" if="[[_showTopicChip(change.*, _settingTopic)]]">
          <gr-linked-chip
            text="[[change.topic]]"
            limit="40"
            href="[[_computeTopicUrl(change.topic)]]"
            removable="[[!_topicReadOnly]]"
            on-remove="_handleTopicRemoved"
          ></gr-linked-chip>
        </template>
        <template is="dom-if" if="[[_showAddTopic(change.*, _settingTopic)]]">
          <gr-editable-label
            class="topicEditableLabel"
            label-text="Add a topic"
            value="[[change.topic]]"
            max-length="1024"
            placeholder="[[_computeTopicPlaceholder(_topicReadOnly)]]"
            read-only="[[_topicReadOnly]]"
            on-changed="_handleTopicChanged"
            show-as-edit-pencil="true"
            autocomplete="true"
            query="[[queryTopic]]"
          ></gr-editable-label>
        </template>
      </span>
    </section>
    <template is="dom-if" if="[[_showCherryPickOf(change.*)]]">
      <section
        class$="[[_computeDisplayState(_showAllSections, change, _SECTION.CHERRY_PICK_OF)]]"
      >
        <span class="title">Cherry pick of</span>
        <span class="value">
          <a
            href$="[[_computeCherryPickOfUrl(change.cherry_pick_of_change, change.cherry_pick_of_patch_set, change.project)]]"
          >
            <gr-limited-text
              text="[[change.cherry_pick_of_change]],[[change.cherry_pick_of_patch_set]]"
              limit="40"
            >
            </gr-limited-text>
          </a>
        </span>
      </section>
    </template>
    <section
      class$="strategy [[_computeDisplayState(_showAllSections, change, _SECTION.STRATEGY)]]"
      hidden$="[[_computeHideStrategy(change)]]"
      hidden=""
    >
      <span class="title">Strategy</span>
      <span class="value">[[_computeStrategy(change)]]</span>
    </section>
    <section
      class$="hashtag [[_computeDisplayState(_showAllSections, change, _SECTION.HASHTAGS)]]"
    >
      <span class="title">Hashtags</span>
      <span class="value">
        <template is="dom-repeat" items="[[change.hashtags]]">
          <gr-linked-chip
            class="hashtagChip"
            text="[[item]]"
            href="[[_computeHashtagUrl(item)]]"
            removable="[[!_hashtagReadOnly]]"
            on-remove="_handleHashtagRemoved"
            limit="40"
          >
          </gr-linked-chip>
        </template>
        <template is="dom-if" if="[[!_hashtagReadOnly]]">
          <gr-editable-label
            uppercase=""
            label-text="Add a hashtag"
            value="{{_newHashtag}}"
            placeholder="[[_computeHashtagPlaceholder(_hashtagReadOnly)]]"
            read-only="[[_hashtagReadOnly]]"
            on-changed="_handleHashtagChanged"
            show-as-edit-pencil="true"
          ></gr-editable-label>
        </template>
      </span>
    </section>
    <div class="separatedSection">
      <gr-change-requirements
        change="{{change}}"
        account="[[account]]"
        mutable="[[_mutable]]"
      ></gr-change-requirements>
    </div>
    <section
      id="webLinks"
      hidden$="[[!_computeWebLinks(commitInfo, serverConfig)]]"
    >
      <span class="title">Links</span>
      <span class="value">
        <template
          is="dom-repeat"
          items="[[_computeWebLinks(commitInfo, serverConfig)]]"
          as="link"
        >
          <a href="[[link.url]]" class="webLink" rel="noopener" target="_blank">
            [[link.name]]
          </a>
        </template>
      </span>
    </section>
    <gr-endpoint-decorator name="change-metadata-item">
      <gr-endpoint-param name="labels" value="[[labels]]"></gr-endpoint-param>
      <gr-endpoint-param name="change" value="[[change]]"></gr-endpoint-param>
      <gr-endpoint-param
        name="revision"
        value="[[revision]]"
      ></gr-endpoint-param>
    </gr-endpoint-decorator>
  </gr-external-style>
`;var fx,_x;!function(e){e.REVIEWER="reviewers",e.CC="ccs",e.ANY="any"}(fx||(fx={}));class vx{constructor(e,t){this._restAPI=e,this._apiCall=t,this.loggedIn=!1,this.initialized=!1}static create(e,t,i){switch(i){case fx.REVIEWER:return new vx(e,i=>e.getChangeSuggestedReviewers(t,i));case fx.CC:return new vx(e,i=>e.getChangeSuggestedCCs(t,i));case fx.ANY:return new vx(e,i=>e.getSuggestedAccounts(`cansee:${t} ${i}`));default:throw new Error(`Unknown users type: ${i}`)}}init(){if(this.initPromise)return this.initPromise;const e=this._restAPI.getConfig().then(e=>{this.config=e}),t=this._restAPI.getLoggedIn().then(e=>{this.loggedIn=e});return this.initPromise=Promise.all([e,t]).then(()=>{this.initialized=!0}),this.initPromise}getSuggestions(e){return this.initialized&&this.loggedIn?this._apiCall(e).then(e=>e||[]):Promise.resolve([])}makeSuggestionItem(e){return Bn(e)?{name:bv(this.config,e.account),value:e}:jn(e)?{name:(t=e.group,`${t.name||""} (group)`),value:e}:void 0!==e._account_id?{name:bv(this.config,e),value:{account:e,count:1}}:void r(e,"Received an incorrect suggestion");var t}}!function(e){e.OWNER="Owner",e.REVIEWERS="Reviewers",e.REPO_BRANCH="Repo | Branch",e.SUBMITTED="Submitted",e.PARENT="Parent",e.MERGED_AS="Merged as",e.STRATEGY="Strategy",e.UPDATED="Updated",e.CC="CC",e.HASHTAGS="Hashtags",e.TOPIC="Topic",e.UPLOADER="Uploader",e.AUTHOR="Author",e.COMMITTER="Committer",e.ASSIGNEE="Assignee",e.CHERRY_PICK_OF="Cherry pick of"}(_x||(_x={}));const yx={ALWAYS_SHOW:[_x.OWNER,_x.REVIEWERS,_x.REPO_BRANCH,_x.SUBMITTED,_x.TOPIC],SHOW_IF_SET:[_x.CC,_x.HASHTAGS,_x.UPLOADER,_x.AUTHOR,_x.COMMITTER,_x.ASSIGNEE,_x.CHERRY_PICK_OF],ALWAYS_HIDE:[_x.PARENT,_x.MERGED_AS,_x.STRATEGY,_x.UPDATED]};var bx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var wx;!function(e){e.OWNER="owner",e.UPLOADER="uploader",e.AUTHOR="author",e.COMMITTER="committer"}(wx||(wx={}));const Cx=new Map([[cn.FAST_FORWARD_ONLY,"Fast Forward Only"],[cn.MERGE_IF_NECESSARY,"Merge if Necessary"],[cn.REBASE_IF_NECESSARY,"Rebase if Necessary"],[cn.MERGE_ALWAYS,"Always Merge"],[cn.REBASE_ALWAYS,"Rebase Always"],[cn.CHERRY_PICK,"Cherry Pick"]]);let Sx=class extends fi{constructor(){super(...arguments),this._mutable=!1,this._notCurrentMessage="Not current - rebase possible",this._topicReadOnly=!0,this._hashtagReadOnly=!0,this._showRequirements=!1,this._isWip=!1,this._settingTopic=!1,this._currentParents=[],this._CHANGE_ROLE=wx,this._SECTION=_x,this._showAllSections=!1,this.restApiService=i.restApiService,this.reporting=i.reportingService}static get template(){return mx}ready(){super.ready(),this.queryTopic=e=>this._getTopicSuggestions(e)}_labelsChanged(e){this.labels={...e}}_changeChanged(e){this._assignee=(null==e?void 0:e.assignee)?[e.assignee]:[],this._settingTopic=!1}_assigneeChanged(e){if(!this.change||!this._isAssigneeEnabled(this.serverConfig))return;const t=e.base;if(null==t?void 0:t.length){const e=t[0];if(!e._account_id||this.change.assignee&&e._account_id===this.change.assignee._account_id)return;this.set(["change","assignee"],e),this.restApiService.setAssignee(this.change._number,e._account_id)}else{if(!this.change.assignee)return;this.set(["change","assignee"],void 0),this.restApiService.deleteAssignee(this.change._number)}}_computeHideStrategy(e){return!bo(e)}_computeWebLinks(e,t){if(!e)return;const i=Qm.getChangeWeblinks(this.change?this.change.project:"",e.commit,{weblinks:e.web_links,config:t});return i.length?i:void 0}_isChangeMerged(e){return(null==e?void 0:e.status)===Ji.MERGED}_isAssigneeEnabled(e){var t;return!!(null===(t=null==e?void 0:e.change)||void 0===t?void 0:t.enable_assignee)}_computeStrategy(e){return(null==e?void 0:e.submit_type)?Cx.get(e.submit_type):""}_computeLabelNames(e){return e?Object.keys(e).sort():[]}_handleTopicChanged(e){if(!this.change)throw new Error("change must be set");const t=this.change.topic,i=e.detail.length?e.detail:void 0;this._settingTopic=!0;const n=this.change._number;this.restApiService.setChangeTopic(n,i).then(e=>{var i;(null===(i=this.change)||void 0===i?void 0:i._number)===n&&(this._settingTopic=!1,this.set(["change","topic"],e),e!==t&&bi(this,"topic-changed"))})}_showAddTopic(e,t){var i;return!!!(null===(i=null==e?void 0:e.base)||void 0===i?void 0:i.topic)&&!t}_showTopicChip(e,t){var i;return!!(null===(i=null==e?void 0:e.base)||void 0===i?void 0:i.topic)&&!t}_showCherryPickOf(e){var t,i;return!!(null===(t=null==e?void 0:e.base)||void 0===t?void 0:t.cherry_pick_of_change)&&!!(null===(i=null==e?void 0:e.base)||void 0===i?void 0:i.cherry_pick_of_patch_set)}_handleHashtagChanged(){var e;if(!this.change)throw new Error("change must be set");if(!(null===(e=this._newHashtag)||void 0===e?void 0:e.length))return;const t=this._newHashtag;this._newHashtag="",this.restApiService.setChangeHashtag(this.change._number,{add:[t]}).then(e=>{this.set(["change","hashtags"],e),bi(this,"hashtag-changed")})}_computeTopicReadOnly(e,t){var i,n;return!e||!(null===(n=null===(i=null==t?void 0:t.actions)||void 0===i?void 0:i.topic)||void 0===n?void 0:n.enabled)}_computeHashtagReadOnly(e,t){var i,n;return!e||!(null===(n=null===(i=null==t?void 0:t.actions)||void 0===i?void 0:i.hashtags)||void 0===n?void 0:n.enabled)}_computeAssigneeReadOnly(e,t){var i,n;return!e||!(null===(n=null===(i=null==t?void 0:t.actions)||void 0===i?void 0:i.assignee)||void 0===n?void 0:n.enabled)}_computeTopicPlaceholder(e){return e?"No topic":"ADD TOPIC"}_computeHashtagPlaceholder(e){return e?"":"Add Hashtag"}_computeShowRequirements(e){if(!e)return!1;if(e.status!==Ji.NEW)return!1;const t=!!e.requirements&&Object.keys(e.requirements).length>0,i=!!e.labels&&Object.keys(e.labels).length>0;return t||i||!!e.work_in_progress}_computePushCertificateValidation(e,t){var i,n;if(!t||!(null===(i=null==e?void 0:e.receive)||void 0===i?void 0:i.enable_signed_push))return;const o=t.revisions[t.current_revision];if(!(null===(n=o.push_certificate)||void 0===n?void 0:n.key))return{class:"help",icon:"gr-icons:help",message:"This patch set was created without a push certificate"};const s=o.push_certificate.key;switch(s.status){case rn.BAD:return{class:"invalid",icon:"gr-icons:close",message:this._problems("Push certificate is invalid",s)};case rn.OK:return{class:"notTrusted",icon:"gr-icons:info",message:this._problems("Push certificate is valid, but key is not trusted",s)};case rn.TRUSTED:return{class:"trusted",icon:"gr-icons:check",message:this._problems("Push certificate is valid and key is trusted",s)};case void 0:throw new Error("deleted certificate");default:r(s.status,`unknown certificate status: ${s.status}`)}}_problems(e,t){return(null==t?void 0:t.problems)&&0!==t.problems.length?[e+":"].concat(t.problems).join("\n"):e}_computeShowRepoBranchTogether(e,t){return!!e&&!!t&&e.length+t.length<40}_computeProjectUrl(e){return e?Qm.getUrlForProjectChanges(e):""}_computeBranchUrl(e,t){return e&&t&&this.change&&this.change.status?Qm.getUrlForBranch(t,e,this.change.status===Ji.NEW?"open":this.change.status.toLowerCase()):""}_computeCherryPickOfUrl(e,t,i){return e&&i?Qm.getUrlForChangeById(e,i,t):""}_computeTopicUrl(e){return Qm.getUrlForTopic(e)}_computeHashtagUrl(e){return Qm.getUrlForHashtag(e)}_handleTopicRemoved(e){if(!this.change)throw new Error("change must be set");const t=Th(e).rootTarget;t.disabled=!0,this.restApiService.setChangeTopic(this.change._number).then(()=>{t.disabled=!1,this.set(["change","topic"],""),bi(this,"topic-changed")}).catch(()=>{t.disabled=!1})}_handleHashtagRemoved(e){if(e.preventDefault(),!this.change)throw new Error("change must be set");const t=Th(e).rootTarget;t.disabled=!0,this.restApiService.setChangeHashtag(this.change._number,{remove:[t.text]}).then(e=>{t.disabled=!1,this.set(["change","hashtags"],e)}).catch(()=>{t.disabled=!1})}_computeIsWip(e){return!!(null==e?void 0:e.work_in_progress)}_computeShowRoleClass(e,t){return this._getNonOwnerRole(e,t)?"":"hideDisplay"}_computeDisplayState(e,t,i){return e||yx.ALWAYS_SHOW.includes(i)||yx.SHOW_IF_SET.includes(i)&&function(e,t){var i,n,o;switch(e){case _x.CC:return!!(null===(n=null===(i=null==t?void 0:t.reviewers)||void 0===i?void 0:i.CC)||void 0===n?void 0:n.length);case _x.HASHTAGS:return!!(null===(o=null==t?void 0:t.hashtags)||void 0===o?void 0:o.length);case _x.TOPIC:return!!(null==t?void 0:t.topic);case _x.UPLOADER:case _x.AUTHOR:case _x.COMMITTER:case _x.ASSIGNEE:return!1;case _x.CHERRY_PICK_OF:return!!(null==t?void 0:t.cherry_pick_of_change)}return!0}(i,t)?"":"hideDisplay"}_computeMergedCommitInfo(e,t){const i=t[e];return i&&i.commit?(i.commit.commit||(i.commit.commit=e),i.commit):{}}_computeShowAllLabelText(e){return e?"Show less":"Show all"}_onShowAllClick(){this._showAllSections=!this._showAllSections,this.reporting.reportInteraction("toggle show all button",{sectionName:"metadata",toState:this._showAllSections?"Show all":"Show less"})}_getNonOwnerRole(e,t){var i,n,o,r;if(!(null===(i=null==e?void 0:e.revisions)||void 0===i?void 0:i[e.current_revision]))return;const s=e.revisions[e.current_revision];return s?t===wx.UPLOADER&&s.uploader&&e.owner._account_id!==s.uploader._account_id?s.uploader:t===wx.AUTHOR&&(null===(n=s.commit)||void 0===n?void 0:n.author)&&e.owner.email!==s.commit.author.email?s.commit.author:t!==wx.COMMITTER||null===(o=s.commit)||void 0===o||!o.committer||e.owner.email===s.commit.committer.email||null!==(r=s.uploader)&&void 0!==r&&r.email&&s.uploader.email===s.commit.committer.email?void 0:s.commit.committer:void 0}_computeParents(e,t){if(!t||!t.commit){if(!e||!e.current_revision)return[];if(!(t=e.revisions[e.current_revision])||!t.commit)return[]}return t.commit.parents}_computeParentsLabel(e){return e&&e.length>1?"Parents":"Parent"}_computeParentListClass(e,t){return void 0===e||void 0===t?"":["parentList",e&&e.length>1?"merge":"nonMerge",t?"current":"notCurrent"].join(" ")}_computeIsMutable(e){return e&&!!Object.keys(e).length}editTopic(){this._topicReadOnly||!this.change||this.change.topic||this.shadowRoot.querySelector(".topicEditableLabel").open()}_getReviewerSuggestionsProvider(e){if(!e)return;const t=vx.create(this.restApiService,e._number,fx.ANY);return t.init(),t}_getTopicSuggestions(e){return this.restApiService.getChangesWithSimilarTopic(e).then(e=>(null!=e?e:[]).map(e=>e.topic).filter($u).filter(c).map(e=>({name:e,value:e})))}};bx([Oo({type:Object})],Sx.prototype,"change",void 0),bx([Oo({type:Object,notify:!0})],Sx.prototype,"labels",void 0),bx([Oo({type:Object})],Sx.prototype,"account",void 0),bx([Oo({type:Object})],Sx.prototype,"revision",void 0),bx([Oo({type:Object})],Sx.prototype,"commitInfo",void 0),bx([Oo({type:Boolean,computed:"_computeIsMutable(account)"})],Sx.prototype,"_mutable",void 0),bx([Oo({type:Object})],Sx.prototype,"serverConfig",void 0),bx([Oo({type:Boolean})],Sx.prototype,"parentIsCurrent",void 0),bx([Oo({type:String})],Sx.prototype,"_notCurrentMessage",void 0),bx([Oo({type:Boolean,computed:"_computeTopicReadOnly(_mutable, change)"})],Sx.prototype,"_topicReadOnly",void 0),bx([Oo({type:Boolean,computed:"_computeHashtagReadOnly(_mutable, change)"})],Sx.prototype,"_hashtagReadOnly",void 0),bx([Oo({type:Object,computed:"_computePushCertificateValidation(serverConfig, change)"})],Sx.prototype,"_pushCertificateValidation",void 0),bx([Oo({type:Boolean,computed:"_computeShowRequirements(change)"})],Sx.prototype,"_showRequirements",void 0),bx([Oo({type:Array})],Sx.prototype,"_assignee",void 0),bx([Oo({type:Boolean,computed:"_computeIsWip(change)"})],Sx.prototype,"_isWip",void 0),bx([Oo({type:String})],Sx.prototype,"_newHashtag",void 0),bx([Oo({type:Boolean})],Sx.prototype,"_settingTopic",void 0),bx([Oo({type:Array,computed:"_computeParents(change, revision)"})],Sx.prototype,"_currentParents",void 0),bx([Oo({type:Object})],Sx.prototype,"_CHANGE_ROLE",void 0),bx([Oo({type:Object})],Sx.prototype,"_SECTION",void 0),bx([Oo({type:Boolean})],Sx.prototype,"_showAllSections",void 0),bx([Oo({type:Object})],Sx.prototype,"queryTopic",void 0),bx([No("change.labels")],Sx.prototype,"_labelsChanged",null),bx([No("change")],Sx.prototype,"_changeChanged",null),bx([No("_assignee.*")],Sx.prototype,"_assigneeChanged",null),Sx=bx([Po("gr-change-metadata")],Sx);const Ex=mi`
  <style include="shared-styles">
    :host {
      display: block;
      padding: var(--spacing-m) 0;
    }
    section {
      display: flex;
      padding: var(--spacing-m) var(--spacing-xl);
    }
    .flexContainer {
      display: flex;
      justify-content: space-between;
      padding-top: var(--spacing-m);
    }
    .footer {
      justify-content: flex-end;
    }
    .closeButtonContainer {
      align-items: flex-end;
      display: flex;
      flex: 0;
      justify-content: flex-end;
    }
    .patchFiles,
    .archivesContainer {
      padding-bottom: var(--spacing-m);
    }
    .patchFiles {
      margin-right: var(--spacing-xxl);
    }
    .patchFiles a,
    .archives a {
      display: inline-block;
      margin-right: var(--spacing-l);
    }
    .patchFiles a:last-of-type,
    .archives a:last-of-type {
      margin-right: 0;
    }
    .hidden {
      display: none;
    }
    gr-download-commands {
      width: min(80vw, 1200px);
    }
  </style>
  <section>
    <h3 class="heading-3">
      Patch set [[patchNum]] of [[_computePatchSetQuantity(change.revisions)]]
    </h3>
  </section>
  <section class$="[[_computeShowDownloadCommands(_schemes)]]">
    <gr-download-commands
      id="downloadCommands"
      commands="[[_computeDownloadCommands(change, patchNum, _selectedScheme)]]"
      schemes="[[_schemes]]"
      selected-scheme="{{_selectedScheme}}"
    ></gr-download-commands>
  </section>
  <section class="flexContainer">
    <div
      class="patchFiles"
      hidden="[[_computeHidePatchFile(change, patchNum)]]"
    >
      <label>Patch file</label>
      <div>
        <a
          id="download"
          href$="[[_computeDownloadLink(change, patchNum)]]"
          download=""
        >
          [[_computeDownloadFilename(change, patchNum)]]
        </a>
        <a href$="[[_computeZipDownloadLink(change, patchNum)]]" download="">
          [[_computeZipDownloadFilename(change, patchNum)]]
        </a>
      </div>
    </div>
    <div
      class="archivesContainer"
      hidden$="[[!config.archives.length]]"
      hidden=""
    >
      <label>Archive</label>
      <div id="archives" class="archives">
        <template is="dom-repeat" items="[[config.archives]]" as="format">
          <a
            href$="[[_computeArchiveDownloadLink(change, patchNum, format)]]"
            download=""
          >
            [[format]]
          </a>
        </template>
      </div>
    </div>
  </section>
  <section class="footer">
    <span class="closeButtonContainer">
      <gr-button id="closeButton" link="" on-click="_handleCloseTap"
        >Close</gr-button
      >
    </span>
  </section>
`;var Ax=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let xx=class extends fi{static get template(){return Ex}get _schemes(){if(void 0===this.change||void 0===this.patchNum)return[];for(const e of Object.values(this.change.revisions||{}))if(e._number===this.patchNum){const t=e.fetch;if(t)return Object.keys(t).sort();break}return[]}ready(){super.ready(),this._ensureAttribute("role","dialog")}focus(){this._schemes.length?this.$.downloadCommands.focusOnCopy():this.$.download.focus()}getFocusStops(){return{start:this.$.downloadCommands.$.downloadTabs,end:this.$.closeButton}}_computeDownloadCommands(e,t,i){let n;if(!e||!i)return[];for(const r of Object.values(e.revisions||{}))if(r._number===t&&r&&r.fetch&&o(r.fetch,i)){n=r.fetch[i].commands;break}const r=[];for(const[e,t]of Object.entries(null!=n?n:{}))r.push({title:e,command:t});return r}_computeZipDownloadLink(e,t){return this._computeDownloadLink(e,t,!0)}_computeZipDownloadFilename(e,t){return this._computeDownloadFilename(e,t,!0)}_computeDownloadLink(e,t,i){return void 0===e||void 0===t?"":yo(e.project,e._number,t)+"/patch?"+(i?"zip":"download")}_computeDownloadFilename(e,t,i){var n;if(void 0===e||void 0===t)return"";return(null!==(n=Ro(e,t))&&void 0!==n?n:"").substr(0,7)+".diff."+(i?"zip":"base64")}_computeHidePatchFile(e,t){if(void 0===e||void 0===t)return!1;for(const i of Object.values(e.revisions||{}))if(i._number===t){const e=i.commit&&i.commit.parents?i.commit.parents.length:0;return 0===e||e>1}return!1}_computeArchiveDownloadLink(e,t,i){return void 0===e||void 0===t||void 0===i?"":yo(e.project,e._number,t)+"/archive?format="+i}_computePatchSetQuantity(e){return e?Object.keys(e).length:0}_handleCloseTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("close",{composed:!0,bubbles:!1}))}_schemesChanged(e){0!==e.length&&(this._selectedScheme&&e.includes(this._selectedScheme)||(this._selectedScheme=e.sort()[0]))}_computeShowDownloadCommands(e){return e.length?"":"hidden"}};Ax([Oo({type:Object})],xx.prototype,"change",void 0),Ax([Oo({type:Object})],xx.prototype,"config",void 0),Ax([Oo({type:String})],xx.prototype,"patchNum",void 0),Ax([Oo({type:String})],xx.prototype,"_selectedScheme",void 0),Ax([Lo("change","patchNum")],xx.prototype,"_schemes",null),Ax([No("_schemes")],xx.prototype,"_schemesChanged",null),xx=Ax([Po("gr-download-dialog")],xx);const Rx=mi`
  <style include="shared-styles">
    :host {
      /* Used to remove horizontal whitespace between the icons. */
      display: flex;
    }
    gr-button.selected iron-icon {
      color: var(--link-color);
    }
    iron-icon {
      height: 1.3rem;
      width: 1.3rem;
    }
  </style>
  <gr-button
    id="sideBySideBtn"
    link=""
    has-tooltip=""
    class$="[[_computeSideBySideSelected(mode)]]"
    title="Side-by-side diff"
    aria-pressed="[[isSideBySideSelected(mode)]]"
    on-click="_handleSideBySideTap"
  >
    <iron-icon icon="gr-icons:side-by-side"></iron-icon>
  </gr-button>
  <gr-button
    id="unifiedBtn"
    link=""
    has-tooltip=""
    title="Unified diff"
    class$="[[_computeUnifiedSelected(mode)]]"
    aria-pressed="[[isUnifiedSelected(mode)]]"
    on-click="_handleUnifiedTap"
  >
    <iron-icon icon="gr-icons:unified"></iron-icon>
  </gr-button>
`;var Tx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let kx=class extends fi{constructor(){super(...arguments),this.saveOnChange=!1,this.restApiService=i.restApiService}static get template(){return Rx}connectedCallback(){super.connectedCallback(),T_.requestAvailability()}setMode(e){let t;this.saveOnChange&&this.mode&&this.mode!==e&&this.restApiService.savePreferences({diff_view:e}),this.mode=e,this.isUnifiedSelected(e)?t="Changed diff view to unified":this.isSideBySideSelected(e)&&(t="Changed diff view to side by side"),t&&Ti(this,t)}_computeSideBySideSelected(e){return e===Gi.SIDE_BY_SIDE?"selected":""}_computeUnifiedSelected(e){return e===Gi.UNIFIED?"selected":""}isSideBySideSelected(e){return e===Gi.SIDE_BY_SIDE}isUnifiedSelected(e){return e===Gi.UNIFIED}_handleSideBySideTap(){this.setMode(Gi.SIDE_BY_SIDE)}_handleUnifiedTap(){this.setMode(Gi.UNIFIED)}};Tx([Oo({type:String,notify:!0})],kx.prototype,"mode",void 0),Tx([Oo({type:Boolean})],kx.prototype,"saveOnChange",void 0),kx=Tx([Po("gr-diff-mode-selector")],kx);const Px=mi`
  <style include="shared-styles">
    :host {
      align-items: center;
      display: flex;
    }
    select {
      max-width: 15em;
    }
    .arrow {
      color: var(--deemphasized-text-color);
      margin: 0 var(--spacing-m);
    }
    gr-dropdown-list {
      --trigger-style: {
        color: var(--deemphasized-text-color);
        text-transform: none;
        font-family: var(--font-family);
      }
    }
    @media screen and (max-width: 50em) {
      .filesWeblinks {
        display: none;
      }
      gr-dropdown-list {
        --native-select-style: {
          max-width: 5.25em;
        }
      }
    }
  </style>
  <h3 class="assistive-tech-only">Patchset Range Selection</h3>
  <span class="patchRange" aria-label="patch range starts with">
    <gr-dropdown-list
      id="basePatchDropdown"
      value="[[basePatchNum]]"
      on-value-change="_handlePatchChange"
      items="[[_baseDropdownContent]]"
    >
    </gr-dropdown-list>
  </span>
  <span is="dom-if" if="[[filesWeblinks.meta_a]]" class="filesWeblinks">
    <template is="dom-repeat" items="[[filesWeblinks.meta_a]]" as="weblink">
      <a target="_blank" rel="noopener" href$="[[weblink.url]]"
        >[[weblink.name]]</a
      >
    </template>
  </span>
  <span aria-hidden="true" class="arrow"></span>
  <span class="patchRange" aria-label="patch range ends with">
    <gr-dropdown-list
      id="patchNumDropdown"
      value="[[patchNum]]"
      on-value-change="_handlePatchChange"
      items="[[_patchDropdownContent]]"
    >
    </gr-dropdown-list>
    <span is="dom-if" if="[[filesWeblinks.meta_b]]" class="filesWeblinks">
      <template is="dom-repeat" items="[[filesWeblinks.meta_b]]" as="weblink">
        <a target="_blank" href$="[[weblink.url]]">[[weblink.name]]</a>
      </template>
    </span>
  </span>
`;var Ix=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Ox=class extends fi{constructor(){super(),this.reporting=i.reportingService,this.reporting=i.reportingService}static get template(){return Px}_getShaForPatch(e){return e.sha.substring(0,10)}_computeBaseDropdownContent(e,t,i,n,r){if(void 0===e||void 0===t||void 0===i||void 0===n||void 0===r)return;const s=r.getParentCountMap(),a=o(s,t)?s[t]:1,l=r.getMaxParents(),c=a>1,d=[];for(const o of e){const e=o.num,r=this._createDropdownEntry(e,"Patchset ",i,n,this._getShaForPatch(o));d.push({...r,disabled:this._computeLeftDisabled(o.num,t,i)})}d.push({text:c?"Auto Merge":"Base",value:"PARENT"});for(let e=0;c&&e<l;e++)d.push({disabled:e>=a,triggerText:`Parent ${e+1}`,text:`Parent ${e+1}`,mobileText:`Parent ${e+1}`,value:-(e+1)});return d}_computeMobileText(e,t,i){return`${e}`+`${this._computePatchSetCommentsString(t,e)}`+`${this._computePatchSetDescription(i,e,!0)}`}_computePatchDropdownContent(e,t,i,n){if(void 0===e||void 0===t||void 0===i||void 0===n)return;const o=[];for(const r of e){const e=r.num,s=this._createDropdownEntry(e,"edit"===e?"":"Patchset ",i,n,this._getShaForPatch(r));o.push({...s,disabled:this._computeRightDisabled(t,e,i)})}return o}_computeText(e,t,i,n){return`${t}${e}`+`${this._computePatchSetCommentsString(i,e)}`+` | ${n}`}_createDropdownEntry(e,t,i,n,o){const r={triggerText:`${t}${e}`,text:this._computeText(e,t,n,o),mobileText:this._computeMobileText(e,n,i),bottomText:`${this._computePatchSetDescription(i,e)}`,value:e},s=this._computePatchSetDate(i,e);return s&&(r.date=s),r}_updateSortedRevisions(e){const t=e.base;t&&(this._sortedRevisions=Kn(Object.values(t)))}_computeLeftDisabled(e,t,i){return eo(e,i)<=eo(t,i)}_computeRightDisabled(e,t,i){return"PARENT"!==e&&(Gn(e)?!this.revisionInfo||this.revisionInfo.getParentCount(t)<to(e):eo(e,i)<=eo(t,i))}_computePatchSetCommentsString(e,t){if(!e)return;const i=Jb(e.computeCommentThreadCount({patchNum:t},!0),"comment"),n=e.computeUnresolvedNum({patchNum:t}),o=0===n?"":`${n} unresolved`;return i.length||o.length?` (${i}`+(i&&o?", ":"")+`${o})`:""}_computePatchSetDescription(e,t,i){const n=qn(e,t);return(null==n?void 0:n.description)?(i?" ":"")+n.description.substring(0,500):""}_computePatchSetDate(e,t){const i=qn(e,t);return i?i.created:void 0}_handlePatchChange(e){var t,i;const n={patchNum:this.patchNum,basePatchNum:this.basePatchNum},o=Th(e).localTarget,r=Vn(e.detail.value),s=Jn(this.availablePatches);if(o===this.$.patchNumDropdown){if(n.patchNum===e.detail.value)return;this.reporting.reportInteraction("right-patchset-changed",{previous:n.patchNum,current:e.detail.value,latest:s,commentCount:null===(t=this.changeComments)||void 0===t?void 0:t.computeCommentThreadCount({patchNum:e.detail.value})}),n.patchNum=r}else{if(n.basePatchNum===r)return;this.reporting.reportInteraction("left-patchset-changed",{previous:n.basePatchNum,current:e.detail.value,commentCount:null===(i=this.changeComments)||void 0===i?void 0:i.computeCommentThreadCount({patchNum:r})}),n.basePatchNum=r}this.dispatchEvent(new CustomEvent("patch-range-change",{detail:n,bubbles:!1}))}};Ix([Oo({type:Array})],Ox.prototype,"availablePatches",void 0),Ix([Oo({type:Object,computed:"_computeBaseDropdownContent(availablePatches, patchNum,_sortedRevisions, changeComments, revisionInfo)"})],Ox.prototype,"_baseDropdownContent",void 0),Ix([Oo({type:Object,computed:"_computePatchDropdownContent(availablePatches,basePatchNum, _sortedRevisions, changeComments)"})],Ox.prototype,"_patchDropdownContent",void 0),Ix([Oo({type:String})],Ox.prototype,"changeNum",void 0),Ix([Oo({type:Object})],Ox.prototype,"changeComments",void 0),Ix([Oo({type:Object})],Ox.prototype,"filesWeblinks",void 0),Ix([Oo({type:String})],Ox.prototype,"patchNum",void 0),Ix([Oo({type:String})],Ox.prototype,"basePatchNum",void 0),Ix([Oo({type:Object})],Ox.prototype,"revisions",void 0),Ix([Oo({type:Object})],Ox.prototype,"revisionInfo",void 0),Ix([Oo({type:Array})],Ox.prototype,"_sortedRevisions",void 0),Ix([No("revisions.*")],Ox.prototype,"_updateSortedRevisions",null),Ox=Ix([Po("gr-patch-range-select")],Ox);const Nx=mi`
  <style include="shared-styles">
    :host {
      align-items: center;
      display: flex;
      justify-content: flex-end;
    }
    .invisible {
      display: none;
    }
    gr-button {
      margin-left: var(--spacing-l);
      text-decoration: none;
    }
    gr-dialog {
      width: 50em;
    }
    gr-dialog .main {
      width: 100%;
    }
    gr-dialog .main > iron-input {
      width: 100%;
    }
    input {
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      margin: var(--spacing-m) 0;
      padding: var(--spacing-s);
      width: 100%;
      box-sizing: content-box;
    }
    #fileUploadBrowse {
      margin-left: 0;
    }
    #dragDropArea {
      border: 2px dashed var(--border-color);
      border-radius: var(--border-radius);
      margin-top: var(--spacing-l);
      padding: var(--spacing-xxl) var(--spacing-xxl);
      text-align: center;
    }
    #dragDropArea > p {
      font-weight: var(--font-weight-bold);
      padding: var(--spacing-s);
    }
    @media screen and (max-width: 50em) {
      gr-dialog {
        width: 100vw;
      }
    }
  </style>
  <template is="dom-repeat" items="[[_actions]]" as="action">
    <gr-button
      id$="[[action.id]]"
      class$="[[_computeIsInvisible(action.id, hiddenActions)]]"
      link=""
      on-click="_handleTap"
      >[[action.label]]</gr-button
    >
  </template>
  <gr-overlay id="overlay" with-backdrop="">
    <gr-dialog
      id="openDialog"
      class="invisible dialog"
      disabled$="[[!_isValidPath(_path)]]"
      confirm-label="Confirm"
      confirm-on-enter=""
      on-confirm="_handleOpenConfirm"
      on-cancel="_handleDialogCancel"
    >
      <div class="header" slot="header">
        Add a new file or open an existing file
      </div>
      <div class="main" slot="main">
        <gr-autocomplete
          placeholder="Enter an existing or new full file path."
          query="[[_query]]"
          text="{{_path}}"
        ></gr-autocomplete>
        <div
          id="dragDropArea"
          contenteditable="true"
          on-drop="_handleDragAndDropUpload"
          on-keypress="_handleKeyPress"
        >
          <p>Drag and drop a file here</p>
          <p>or</p>
          <p>
            <iron-input>
              <input
                is="iron-input"
                id="fileUploadInput"
                type="file"
                on-change="_handleFileUploadChanged"
                multiple
                hidden
              />
            </iron-input>
            <label for="fileUploadInput">
              <gr-button id="fileUploadBrowse">Browse</gr-button>
            </label>
          </p>
        </div>
      </div>
    </gr-dialog>
    <gr-dialog
      id="deleteDialog"
      class="invisible dialog"
      disabled$="[[!_isValidPath(_path)]]"
      confirm-label="Delete"
      confirm-on-enter=""
      on-confirm="_handleDeleteConfirm"
      on-cancel="_handleDialogCancel"
    >
      <div class="header" slot="header">Delete a file from the repo</div>
      <div class="main" slot="main">
        <gr-autocomplete
          placeholder="Enter an existing full file path."
          query="[[_query]]"
          text="{{_path}}"
        ></gr-autocomplete>
      </div>
    </gr-dialog>
    <gr-dialog
      id="renameDialog"
      class="invisible dialog"
      disabled$="[[!_computeRenameDisabled(_path, _newPath)]]"
      confirm-label="Rename"
      confirm-on-enter=""
      on-confirm="_handleRenameConfirm"
      on-cancel="_handleDialogCancel"
    >
      <div class="header" slot="header">Rename a file in the repo</div>
      <div class="main" slot="main">
        <gr-autocomplete
          placeholder="Enter an existing full file path."
          query="[[_query]]"
          text="{{_path}}"
        ></gr-autocomplete>
        <iron-input
          class="newPathIronInput"
          bind-value="{{_newPath}}"
          placeholder="Enter the new path."
        >
          <input
            class="newPathInput"
            is="iron-input"
            bind-value="{{_newPath}}"
            placeholder="Enter the new path."
          />
        </iron-input>
      </div>
    </gr-dialog>
    <gr-dialog
      id="restoreDialog"
      class="invisible dialog"
      confirm-label="Restore"
      confirm-on-enter=""
      on-confirm="_handleRestoreConfirm"
      on-cancel="_handleDialogCancel"
    >
      <div class="header" slot="header">Restore this file?</div>
      <div class="main" slot="main">
        <iron-input disabled="" bind-value="{{_path}}">
          <input is="iron-input" disabled="" bind-value="{{_path}}" />
        </iron-input>
      </div>
    </gr-dialog>
  </gr-overlay>
`,Lx={OPEN:{label:"Add/Open/Upload",id:"open"},DELETE:{label:"Delete",id:"delete"},RENAME:{label:"Rename",id:"rename"},RESTORE:{label:"Restore",id:"restore"}};var Dx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Mx=class extends fi{constructor(){super(),this.hiddenActions=[Lx.RESTORE.id],this._actions=Object.values(Lx),this._path="",this._newPath="",this.restApiService=i.restApiService,this._query=e=>this._queryFiles(e)}static get template(){return Nx}_handleTap(e){switch(e.preventDefault(),Th(e).localTarget.id){case Lx.OPEN.id:return void this.openOpenDialog();case Lx.DELETE.id:return void this.openDeleteDialog();case Lx.RENAME.id:return void this.openRenameDialog();case Lx.RESTORE.id:return void this.openRestoreDialog()}}openOpenDialog(e){return e&&(this._path=e),this._showDialog(this.$.openDialog)}openDeleteDialog(e){return e&&(this._path=e),this._showDialog(this.$.deleteDialog)}openRenameDialog(e){return e&&(this._path=e),this._showDialog(this.$.renameDialog)}openRestoreDialog(e){return e&&(this._path=e),this._showDialog(this.$.restoreDialog)}_isValidPath(e){return!!e.length&&!e.endsWith("/")}_computeRenameDisabled(e,t){return this._isValidPath(e)&&this._isValidPath(t)}_getDialogFromEvent(e){return Th(e).path.find(e=>e instanceof Element&&(!!e.classList&&e.classList.contains("dialog")))}_showDialog(e){return this._hideAllDialogs(),this.$.overlay.open().then(()=>{e.classList.toggle("invisible",!1);const t=e.querySelector("gr-autocomplete");t&&t.focus(),setTimeout(()=>{this.$.overlay.center()},1)})}_hideAllDialogs(){const e=this.root.querySelectorAll(".dialog");for(const t of e)this._closeDialog(t)}_closeDialog(e,t=!1){if(e)return t&&(e.querySelectorAll("gr-autocomplete").forEach(e=>{e.text=""}),e.querySelectorAll("iron-input").forEach(e=>{e.bindValue=""})),e.classList.toggle("invisible",!0),this.$.overlay.close()}_handleDialogCancel(e){this._closeDialog(this._getDialogFromEvent(e))}_handleOpenConfirm(e){const t=Qm.getEditUrlForDiff(this.change,this._path,this.patchNum);Qm.navigateToRelativeUrl(t),this._closeDialog(this._getDialogFromEvent(e),!0)}_handleUploadConfirm(e,t){if(this.change&&e&&t)return this.restApiService.saveFileUploadChangeEdit(this.change._number,e,t).then(e=>{e&&e.ok&&(this._closeDialog(this.$.openDialog,!0),Qm.navigateToChange(this.change))});this._closeDialog(this.$.openDialog,!0)}_handleDeleteConfirm(e){const t=this._getDialogFromEvent(e);this.restApiService.deleteFileInChangeEdit(this.change._number,this._path).then(e=>{e&&e.ok&&(this._closeDialog(t,!0),Qm.navigateToChange(this.change))})}_handleRestoreConfirm(e){const t=this._getDialogFromEvent(e);this.restApiService.restoreFileInChangeEdit(this.change._number,this._path).then(e=>{e&&e.ok&&(this._closeDialog(t,!0),Qm.navigateToChange(this.change))})}_handleRenameConfirm(e){const t=this._getDialogFromEvent(e);return this.restApiService.renameFileInChangeEdit(this.change._number,this._path,this._newPath).then(e=>{e&&e.ok&&(this._closeDialog(t,!0),Qm.navigateToChange(this.change))})}_queryFiles(e){return this.restApiService.queryChangeFiles(this.change._number,this.patchNum,e).then(e=>{if(!e)throw new Error("Failed to retrieve files. Response not set.");return e.map(e=>({name:e}))})}_computeIsInvisible(e,t){return t.includes(e)?"invisible":""}_handleDragAndDropUpload(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer&&this._fileUpload(e.dataTransfer.files)}_handleFileUploadChanged(e){if(!e.target)return;if(!(e.target instanceof HTMLInputElement))return;const t=e.target;t.files&&this._fileUpload(t.files)}_fileUpload(e){for(const t of e){if(!t)continue;let e=this._path;e||(e=t.name);const i=new FileReader;i.onload=t=>{if(!t)return;const i=t.target.result;"string"==typeof i&&this._handleUploadConfirm(e,i)},i.readAsDataURL(t)}}_handleKeyPress(e){e.preventDefault(),e.stopImmediatePropagation()}};Dx([Oo({type:Object})],Mx.prototype,"change",void 0),Dx([Oo({type:String})],Mx.prototype,"patchNum",void 0),Dx([Oo({type:Array})],Mx.prototype,"hiddenActions",void 0),Dx([Oo({type:Array})],Mx.prototype,"_actions",void 0),Dx([Oo({type:String})],Mx.prototype,"_path",void 0),Dx([Oo({type:String})],Mx.prototype,"_newPath",void 0),Dx([Oo({type:Object})],Mx.prototype,"_query",void 0),Mx=Dx([Po("gr-edit-controls")],Mx);const Fx=mi`
  <style include="shared-styles">
    .prefsButton {
      float: right;
    }
    .collapseToggleButton {
      text-decoration: none;
    }
    .patchInfoOldPatchSet.patchInfo-header {
      background-color: var(--emphasis-color);
    }
    .patchInfo-header {
      align-items: center;
      display: flex;
      padding: var(--spacing-s) var(--spacing-l);
    }
    .patchInfo-left {
      align-items: baseline;
      display: flex;
    }
    .patchInfoContent {
      align-items: center;
      display: flex;
      flex-wrap: wrap;
    }
    .patchInfo-header .container.latestPatchContainer {
      display: none;
    }
    .patchInfoOldPatchSet .container.latestPatchContainer {
      display: initial;
    }
    .editMode.patchInfoOldPatchSet .container.latestPatchContainer {
      display: none;
    }
    .latestPatchContainer a {
      text-decoration: none;
    }
    .mobile {
      display: none;
    }
    .patchInfo-header .container {
      align-items: center;
      display: flex;
    }
    .downloadContainer,
    .uploadContainer,
    .includedInContainer {
      margin-right: 16px;
    }
    .includedInContainer.hide,
    .uploadContainer.hide {
      display: none;
    }
    .rightControls {
      align-self: flex-end;
      margin: auto 0 auto auto;
      align-items: center;
      display: flex;
      flex-wrap: wrap;
      font-weight: var(--font-weight-normal);
      justify-content: flex-end;
    }
    #collapseBtn,
    .allExpanded #expandBtn,
    .fileViewActions {
      display: none;
    }
    .someExpanded #expandBtn {
      margin-right: 8px;
    }
    .someExpanded #collapseBtn,
    .allExpanded #collapseBtn,
    .openFile .fileViewActions {
      align-items: center;
      display: flex;
    }
    .rightControls gr-button,
    gr-patch-range-select {
      margin: 0 -4px;
    }
    .fileViewActions gr-button {
      margin: 0;
      --gr-button: {
        padding: 2px 4px;
      }
    }
    .editMode .hideOnEdit {
      display: none;
    }
    .showOnEdit {
      display: none;
    }
    .editMode .showOnEdit {
      display: initial;
    }
    .editMode .showOnEdit.flexContainer {
      align-items: center;
      display: flex;
    }
    .label {
      font-weight: var(--font-weight-bold);
      margin-right: 24px;
    }
    gr-commit-info,
    gr-edit-controls {
      margin-right: -5px;
    }
    .fileViewActionsLabel {
      margin-right: var(--spacing-xs);
    }
    @media screen and (max-width: 50em) {
      .patchInfo-header .desktop {
        display: none;
      }
    }
  </style>
  <div
    class$="patchInfo-header [[_computeEditModeClass(editMode)]] [[_computePatchInfoClass(patchNum, allPatchSets)]]"
  >
    <div class="patchInfo-left">
      <div class="patchInfoContent">
        <gr-patch-range-select
          id="rangeSelect"
          change-comments="[[changeComments]]"
          change-num="[[changeNum]]"
          patch-num="[[patchNum]]"
          base-patch-num="[[basePatchNum]]"
          available-patches="[[allPatchSets]]"
          revisions="[[change.revisions]]"
          revision-info="[[revisionInfo]]"
          on-patch-range-change="_handlePatchChange"
        >
        </gr-patch-range-select>
        <span class="separator"></span>
        <gr-commit-info
          change="[[change]]"
          server-config="[[serverConfig]]"
          commit-info="[[commitInfo]]"
        ></gr-commit-info>
        <span class="container latestPatchContainer">
          <span class="separator"></span>
          <a href$="[[changeUrl]]">Go to latest patch set</a>
        </span>
      </div>
    </div>
    <div class$="rightControls [[_computeExpandedClass(filesExpanded)]]">
      <template is="dom-if" if="[[editMode]]">
        <span class="showOnEdit flexContainer">
          <gr-edit-controls
            id="editControls"
            patch-num="[[patchNum]]"
            change="[[change]]"
          ></gr-edit-controls>
          <span class="separator"></span>
        </span>
      </template>
      <span class="downloadContainer desktop">
        <gr-button
          link=""
          class="download"
          title="[[createTitle(Shortcut.OPEN_DOWNLOAD_DIALOG,
                ShortcutSection.ACTIONS)]]"
          on-click="_handleDownloadTap"
          >Download</gr-button
        >
      </span>
      <span class$="includedInContainer [[_hideIncludedIn(change)]] desktop">
        <gr-button link="" class="includedIn" on-click="_handleIncludedInTap"
          >Included In</gr-button
        >
      </span>
      <template
        is="dom-if"
        if="[[_fileListActionsVisible(shownFileCount, _maxFilesForBulkActions)]]"
      >
        <gr-button
          id="expandBtn"
          link=""
          title="[[createTitle(Shortcut.TOGGLE_ALL_INLINE_DIFFS,
                ShortcutSection.FILE_LIST)]]"
          on-click="_expandAllDiffs"
          >Expand All</gr-button
        >
        <gr-button
          id="collapseBtn"
          link=""
          on-click="_collapseAllDiffs"
          title="[[createTitle(Shortcut.TOGGLE_ALL_INLINE_DIFFS,
          ShortcutSection.FILE_LIST)]]"
          >Collapse All</gr-button
        >
      </template>
      <template
        is="dom-if"
        if="[[!_fileListActionsVisible(shownFileCount, _maxFilesForBulkActions)]]"
      >
        <div class="warning">
          Bulk actions disabled because there are too many files.
        </div>
      </template>
      <div class="fileViewActions">
        <span class="separator"></span>
        <span class="fileViewActionsLabel">Diff view:</span>
        <gr-diff-mode-selector
          id="modeSelect"
          mode="{{diffViewMode}}"
          save-on-change="[[!diffPrefsDisabled]]"
        ></gr-diff-mode-selector>
        <span
          id="diffPrefsContainer"
          class="hideOnEdit"
          hidden$="[[_computePrefsButtonHidden(diffPrefs, diffPrefsDisabled)]]"
          hidden=""
        >
          <gr-button
            link=""
            has-tooltip=""
            title="Diff preferences"
            class="prefsButton desktop"
            on-click="_handlePrefsTap"
            ><iron-icon icon="gr-icons:settings"></iron-icon
          ></gr-button>
        </span>
      </div>
    </div>
  </div>
`;var $x;!function(e){e.ALL="all",e.NONE="none",e.SOME="some"}($x||($x={}));var Bx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let jx=class extends(Kf(fi)){constructor(){super(...arguments),this._maxFilesForBulkActions=225}static get template(){return Fx}setDiffViewMode(e){this.$.modeSelect.setMode(e)}_expandAllDiffs(){bi(this,"expand-diffs")}_collapseAllDiffs(){bi(this,"collapse-diffs")}_computeExpandedClass(e){const t=[];return e===$x.ALL?(t.push("openFile"),t.push("allExpanded")):e===$x.SOME&&(t.push("openFile"),t.push("someExpanded")),t.join(" ")}_computePrefsButtonHidden(e,t){return t||!e}_fileListActionsVisible(e,t){return e<=t}_showAddPatchsetDescription(e,t){return!e&&(null==t?void 0:t.status)===Ji.NEW}_handlePatchChange(e){const{basePatchNum:t,patchNum:i}=e.detail;t===this.basePatchNum&&i===this.patchNum||!this.change||Qm.navigateToChange(this.change,i,t)}_handlePrefsTap(e){e.preventDefault(),bi(this,"open-diff-prefs")}_handleIncludedInTap(e){e.preventDefault(),bi(this,"open-included-in-dialog")}_handleDownloadTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("open-download-dialog",{bubbles:!1}))}_computeEditModeClass(e){return e?"editMode":""}_computePatchInfoClass(e,t){return e===Jn(t)?"":"patchInfoOldPatchSet"}_hideIncludedIn(e){return"MERGED"===(null==e?void 0:e.status)?"":"hide"}};Bx([Oo({type:Object})],jx.prototype,"account",void 0),Bx([Oo({type:Array})],jx.prototype,"allPatchSets",void 0),Bx([Oo({type:Object})],jx.prototype,"change",void 0),Bx([Oo({type:String})],jx.prototype,"changeNum",void 0),Bx([Oo({type:String})],jx.prototype,"changeUrl",void 0),Bx([Oo({type:Object})],jx.prototype,"changeComments",void 0),Bx([Oo({type:Object})],jx.prototype,"commitInfo",void 0),Bx([Oo({type:Boolean})],jx.prototype,"editMode",void 0),Bx([Oo({type:Boolean})],jx.prototype,"loggedIn",void 0),Bx([Oo({type:Object})],jx.prototype,"serverConfig",void 0),Bx([Oo({type:Number})],jx.prototype,"shownFileCount",void 0),Bx([Oo({type:Object})],jx.prototype,"diffPrefs",void 0),Bx([Oo({type:Boolean})],jx.prototype,"diffPrefsDisabled",void 0),Bx([Oo({type:String,notify:!0})],jx.prototype,"diffViewMode",void 0),Bx([Oo({type:String})],jx.prototype,"patchNum",void 0),Bx([Oo({type:String})],jx.prototype,"basePatchNum",void 0),Bx([Oo({type:String})],jx.prototype,"filesExpanded",void 0),Bx([Oo({type:Number})],jx.prototype,"_maxFilesForBulkActions",void 0),Bx([Oo({type:Object})],jx.prototype,"revisionInfo",void 0),jx=Bx([Po("gr-file-list-header")],jx);const Hx=mi`
  <style include="shared-styles">
    :host {
      background-color: var(--dialog-background-color);
      display: block;
      max-height: 80vh;
      overflow-y: auto;
      padding: 4.5em var(--spacing-l) var(--spacing-l) var(--spacing-l);
    }
    header {
      background-color: var(--dialog-background-color);
      border-bottom: 1px solid var(--border-color);
      left: 0;
      padding: var(--spacing-l);
      position: absolute;
      right: 0;
      top: 0;
    }
    #title {
      display: inline-block;
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
      margin-top: var(--spacing-xs);
    }
    #filterInput {
      display: inline-block;
      float: right;
      margin: 0 var(--spacing-l);
      padding: var(--spacing-xs);
    }
    .closeButtonContainer {
      float: right;
    }
    ul {
      margin-bottom: var(--spacing-l);
    }
    ul li {
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      background: var(--chip-background-color);
      display: inline-block;
      margin: 0 var(--spacing-xs) var(--spacing-s) var(--spacing-xs);
      padding: var(--spacing-xs) var(--spacing-s);
    }
    .loading.loaded {
      display: none;
    }
  </style>
  <header>
    <h1 id="title" class="heading-1">Included In:</h1>
    <span class="closeButtonContainer">
      <gr-button id="closeButton" link="" on-click="_handleCloseTap"
        >Close</gr-button
      >
    </span>
    <iron-input
      id="filterInput"
      placeholder="Filter"
      bind-value="{{_filterText}}"
    >
      <input
        is="iron-input"
        placeholder="Filter"
        bind-value="{{_filterText}}"
      />
    </iron-input>
  </header>
  <div class$="[[_computeLoadingClass(_loaded)]]">Loading...</div>
  <template
    is="dom-repeat"
    items="[[_computeGroups(_includedIn, _filterText)]]"
    as="group"
  >
    <div>
      <span>[[group.title]]:</span>
      <ul>
        <template is="dom-repeat" items="[[group.items]]">
          <li>[[item]]</li>
        </template>
      </ul>
    </div>
  </template>
`;var Ux=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Gx=class extends fi{constructor(){super(...arguments),this._loaded=!1,this._filterText="",this.restApiService=i.restApiService}static get template(){return Hx}loadData(){return this.changeNum?(this._filterText="",this.restApiService.getChangeIncludedIn(this.changeNum).then(e=>{e&&(this._includedIn=e,this._loaded=!0)})):Promise.reject(new Error("missing required property changeNum"))}_resetData(){this._includedIn=void 0,this._loaded=!1}_computeGroups(e,t){if(!e||void 0===t)return[];const i=e=>!t.length||-1!==e.toLowerCase().indexOf(t.toLowerCase()),n=[{title:"Branches",items:e.branches.filter(i)},{title:"Tags",items:e.tags.filter(i)}];if(e.external)for(const t of Object.keys(e.external))n.push({title:t,items:e.external[t].filter(i)});return n.filter(e=>e.items.length)}_handleCloseTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("close",{composed:!0,bubbles:!1}))}_computeLoadingClass(e){return e?"loading loaded":"loading"}};Ux([Oo({type:Object,observer:"_resetData"})],Gx.prototype,"changeNum",void 0),Ux([Oo({type:Object})],Gx.prototype,"_includedIn",void 0),Ux([Oo({type:Boolean})],Gx.prototype,"_loaded",void 0),Ux([Oo({type:String})],Gx.prototype,"_filterText",void 0),Gx=Ux([Po("gr-included-in-dialog")],Gx);const zx=mi`
  <style include="gr-voting-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    :host {
      display: block;
      position: relative;
      cursor: pointer;
      overflow-y: hidden;
    }
    :host(.expanded) {
      cursor: auto;
    }
    .collapsed .contentContainer {
      align-items: center;
      color: var(--deemphasized-text-color);
      display: flex;
      white-space: nowrap;
    }
    .contentContainer {
      padding: var(--spacing-m) var(--spacing-l);
    }
    .expanded .contentContainer {
      background-color: var(--background-color-secondary);
    }
    .collapsed .contentContainer {
      background-color: var(--background-color-primary);
    }
    div.serviceUser.expanded div.contentContainer {
      background-color: var(
        --background-color-service-user,
        var(--background-color-secondary)
      );
    }
    div.serviceUser.collapsed div.contentContainer {
      background-color: var(
        --background-color-service-user,
        var(--background-color-primary)
      );
    }
    .name {
      font-weight: var(--font-weight-bold);
    }
    .message {
      --gr-formatted-text-prose-max-width: 120ch;
    }
    .collapsed .message {
      max-width: none;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .collapsed .author,
    .collapsed .content,
    .collapsed .message,
    .collapsed .updateCategory,
    gr-account-chip {
      display: inline;
    }
    gr-button {
      margin: 0 -4px;
    }
    .collapsed gr-thread-list,
    .collapsed .replyBtn,
    .collapsed .deleteBtn,
    .collapsed .hideOnCollapsed,
    .hideOnOpen {
      display: none;
    }
    .replyBtn {
      margin-right: var(--spacing-m);
    }
    .collapsed .hideOnOpen {
      display: block;
    }
    .collapsed .content {
      flex: 1;
      margin-right: var(--spacing-m);
      min-width: 0;
      overflow: hidden;
    }
    .collapsed .content.messageContent {
      text-overflow: ellipsis;
    }
    .collapsed .dateContainer {
      position: static;
    }
    .collapsed .author {
      overflow: hidden;
      color: var(--primary-text-color);
      margin-right: var(--spacing-s);
    }
    .authorLabel {
      min-width: 130px;
      --account-max-length: 120px;
      margin-right: var(--spacing-s);
    }
    .expanded .author {
      cursor: pointer;
      margin-bottom: var(--spacing-m);
    }
    .expanded .content {
      padding-left: 40px;
    }
    .dateContainer {
      position: absolute;
      /* right and top values should match .contentContainer padding */
      right: var(--spacing-l);
      top: var(--spacing-m);
    }
    .dateContainer gr-button {
      margin-right: var(--spacing-m);
      color: var(--deemphasized-text-color);
    }
    .dateContainer .patchset:before {
      content: 'Patchset ';
    }
    .dateContainer .patchsetDiffButton {
      margin-right: var(--spacing-m);
      --padding: 0 var(--spacing-m);
    }
    span.date {
      color: var(--deemphasized-text-color);
    }
    span.date:hover {
      text-decoration: underline;
    }
    .dateContainer iron-icon {
      cursor: pointer;
      vertical-align: top;
    }
    .score {
      border-radius: var(--border-radius);
      color: var(--vote-text-color);
      display: inline-block;
      padding: 0 var(--spacing-s);
      text-align: center;
    }
    .score,
    .commentsSummary {
      margin-right: var(--spacing-s);
      min-width: 115px;
    }
    .expanded .commentsSummary {
      display: none;
    }
    .commentsIcon {
      vertical-align: top;
    }
    .score.removed {
      background-color: var(--vote-color-neutral);
    }
    .score.negative {
      background-color: var(--vote-color-disliked);
      border: 1px solid var(--vote-outline-disliked);
      line-height: calc(var(--line-height-normal) - 2px);
      color: var(--chip-color);
    }
    .score.negative.min {
      background-color: var(--vote-color-rejected);
      border: none;
      padding-top: 1px;
      padding-bottom: 1px;
      color: var(--vote-text-color);
    }
    .score.positive {
      background-color: var(--vote-color-recommended);
      border: 1px solid var(--vote-outline-recommended);
      line-height: calc(var(--line-height-normal) - 2px);
      color: var(--chip-color);
    }
    .score.positive.max {
      background-color: var(--vote-color-approved);
      border: none;
      padding-top: 1px;
      padding-bottom: 1px;
      color: var(--vote-text-color);
    }
    gr-account-label {
      --gr-account-label-text-style: {
        font-weight: var(--font-weight-bold);
      }
    }
    @media screen and (max-width: 50em) {
      .expanded .content {
        padding-left: 0;
      }
      .score,
      .commentsSummary {
        min-width: 0px;
      }
      .authorLabel {
        width: 100px;
      }
      .dateContainer .patchset:before {
        content: 'PS ';
      }
    }
  </style>
  <div class$="[[_computeClass(_expanded, author)]]">
    <div class="contentContainer">
      <div class="author" on-click="_handleAuthorClick">
        <span hidden$="[[!showOnBehalfOf]]">
          <span class="name">[[message.real_author.name]]</span>
          on behalf of
        </span>
        <gr-account-label
          account="[[author]]"
          class="authorLabel"
        ></gr-account-label>
        <template
          is="dom-repeat"
          items="[[_getScores(message, labelExtremes)]]"
          as="score"
        >
          <span class$="score [[_computeScoreClass(score, labelExtremes)]]">
            [[score.label]] [[score.value]]
          </span>
        </template>
      </div>
      <template is="dom-if" if="[[_commentCountText]]">
        <div class="commentsSummary">
          <iron-icon icon="gr-icons:comment" class="commentsIcon"></iron-icon>
          <span class="numberOfComments">[[_commentCountText]]</span>
        </div>
      </template>
      <template is="dom-if" if="[[message.message]]">
        <div class="content messageContent">
          <div class="message hideOnOpen">[[_messageContentCollapsed]]</div>
          <gr-formatted-text
            no-trailing-margin=""
            class="message hideOnCollapsed"
            content="[[_messageContentExpanded]]"
            config="[[_projectConfig.commentlinks]]"
          ></gr-formatted-text>
          <template is="dom-if" if="[[_expanded]]">
            <template is="dom-if" if="[[_messageContentExpanded]]">
              <div
                class="replyActionContainer"
                hidden$="[[!showReplyButton]]"
                hidden=""
              >
                <gr-button
                  class="replyBtn"
                  link=""
                  small=""
                  on-click="_handleReplyTap"
                >
                  Reply
                </gr-button>
                <gr-button
                  disabled$="[[_isDeletingChangeMsg]]"
                  class="deleteBtn"
                  hidden$="[[!_isAdmin]]"
                  hidden=""
                  link=""
                  small=""
                  on-click="_handleDeleteMessage"
                >
                  Delete
                </gr-button>
              </div>
            </template>
            <gr-thread-list
              change="[[change]]"
              hidden$="[[!message.commentThreads.length]]"
              threads="[[message.commentThreads]]"
              change-num="[[changeNum]]"
              logged-in="[[_loggedIn]]"
              hide-toggle-buttons
              show-comment-context
            >
            </gr-thread-list>
          </template>
        </div>
      </template>
      <template is="dom-if" if="[[_computeIsReviewerUpdate(message)]]">
        <div class="content">
          <template is="dom-repeat" items="[[message.updates]]" as="update">
            <div class="updateCategory">
              [[update.message]]
              <template
                is="dom-repeat"
                items="[[update.reviewers]]"
                as="reviewer"
              >
                <gr-account-chip account="[[reviewer]]" change="[[change]]">
                </gr-account-chip>
              </template>
            </div>
          </template>
        </div>
      </template>
      <span class="dateContainer">
        <template is="dom-if" if="[[_showViewDiffButton(message)]]">
          <gr-button
            class="patchsetDiffButton"
            on-click="_handleViewPatchsetDiff"
            link
          >
            View Diff
          </gr-button>
        </template>
        <template is="dom-if" if="[[message._revision_number]]">
          <span class="patchset">[[message._revision_number]] |</span>
        </template>
        <template is="dom-if" if="[[!message.id]]">
          <span class="date">
            <gr-date-formatter
              has-tooltip=""
              show-date-and-time=""
              date-str="[[message.date]]"
            ></gr-date-formatter>
          </span>
        </template>
        <template is="dom-if" if="[[message.id]]">
          <span class="date" on-click="_handleAnchorClick">
            <gr-date-formatter
              has-tooltip=""
              show-date-and-time=""
              date-str="[[message.date]]"
            ></gr-date-formatter>
          </span>
        </template>
        <iron-icon
          id="expandToggle"
          on-click="_toggleExpanded"
          title="Toggle expanded state"
          icon="[[_computeExpandToggleIcon(_expanded)]]"
        ></iron-icon>
      </span>
    </div>
  </div>
`;var Vx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const Wx=/^(?:Uploaded\s*)?[Pp]atch [Ss]et \d+:\s*(.*)/,qx=/^(-?)([A-Za-z0-9-]+?)([+-]\d+)?[.]?$/,Kx=/Uploaded patch set (\d+)./,Yx=/(\d+) is the latest approved patch-set/;let Xx=class extends fi{constructor(){super(),this.hideAutomated=!1,this.hidden=!1,this.showReplyButton=!1,this._loggedIn=!1,this._isAdmin=!1,this._isDeletingChangeMsg=!1,this._expanded=!1,this._messageContentExpanded="",this._messageContentCollapsed="",this._commentCountText="",this.restApiService=i.restApiService,this.addEventListener("click",e=>this._handleClick(e))}static get template(){return zx}get author(){var e,t;return(null===(e=this.message)||void 0===e?void 0:e.author)||(null===(t=this.message)||void 0===t?void 0:t.updated_by)}get isAutomated(){return!!this.message&&this._computeIsAutomated(this.message)}get showOnBehalfOf(){return!!this.message&&this._computeShowOnBehalfOf(this.message)}connectedCallback(){super.connectedCallback(),this.restApiService.getConfig().then(e=>{this.config=e}),this.restApiService.getLoggedIn().then(e=>{this._loggedIn=e}),this.restApiService.getIsAdmin().then(e=>{this._isAdmin=!!e})}_updateExpandedClass(e){e?this.classList.add("expanded"):this.classList.remove("expanded")}_computeCommentCountText(e){if(e)return Jb(e,"comment")}_computeMessageContentExpanded(e,t){return this._computeMessageContent(!0,e,t)}_patchsetCommentSummary(e=[]){var t;const i=null===(t=this.message)||void 0===t?void 0:t.id;if(!i)return"";const n=e.filter(e=>e.path===Zi.PATCHSET_LEVEL_COMMENTS);for(const e of n)if(e.comments[0].change_message_id===i)return e.comments[0].message;for(const e of n)for(const t of e.comments)if(t.change_message_id===i)return t.message;return""}_computeMessageContentCollapsed(e,t,i){const n=this._computeMessageContent(!1,e,t);return n||!i?n:this._patchsetCommentSummary(i)}_showViewDiffButton(e){return this._isNewPatchsetTag(null==e?void 0:e.tag)||this._isMergePatchset(e)}_isMergePatchset(e){return(null==e?void 0:e.tag)===Yi.TAG_MERGED&&(null==e?void 0:e.message.match(Yx))}_isNewPatchsetTag(e){return e===Yi.TAG_NEW_PATCHSET||e===Yi.TAG_NEW_WIP_PATCHSET}_handleViewPatchsetDiff(e){if(!this.message||!this.change)return;let t,i;if(this.message.message.match(Kx)){const e=this.message.message.match(Kx);if(isNaN(Number(e[1])))throw new Error("invalid patchnum in message");t=Number(e[1]),i=Zn(t)}else if(this.message.message.match(Yx)){const e=this.message.message.match(Yx);if(isNaN(Number(e[1])))throw new Error("invalid patchnum in message");i=Number(e[1]),t=Jn(Yn(this.change))}else t=Jn(Yn(this.change)),i=Zn(t);Qm.navigateToChange(this.change,t,i),e.stopPropagation()}_computeMessageContent(e,t,i){if(!t)return"";const n=this._isNewPatchsetTag(i);return t.split("\n").filter(t=>!(!e&&t.startsWith(">"))&&((!t.startsWith("(")||!t.endsWith(" comment)"))&&((!t.startsWith("(")||!t.endsWith(" comments)"))&&!(!n&&t.match(Wx))))).map(e=>(n&&(e=e.replace(Wx,"$1")),e)).join("\n").trim()}_computeAuthor(e){return e.author||e.updated_by}_computeShowOnBehalfOf(e){const t=this._computeAuthor(e);return!(!t||!e.real_author||t._account_id===e.real_author._account_id)}_computeShowReplyButton(e,t){return e&&!!e.message&&t&&!this._computeIsAutomated(e)}_computeExpanded(e){return e}_handleClick(e){var t;null!==(t=this.message)&&void 0!==t&&t.expanded||(e.stopPropagation(),this.set("message.expanded",!0))}_handleAuthorClick(e){var t;(null===(t=this.message)||void 0===t?void 0:t.expanded)&&(e.stopPropagation(),this.set("message.expanded",!1))}_computeIsAutomated(e){return!!(e.reviewer||this._computeIsReviewerUpdate(e)||e.tag&&e.tag.startsWith("autogenerated"))}_computeIsHidden(e,t){return e&&t}_computeIsReviewerUpdate(e){return"REVIEWER_UPDATE"===e.type}_getScores(e,t){if(!e||!e.message||!t)return[];const i=e.message.split("\n",1)[0],n=Wx;if(!i.match(n))return[];const r=i.split(n)[1];return r?r.split(" ").map(e=>e.match(qx)).filter(e=>e&&4===e.length&&o(t,e[2])).map(e=>({label:null==e?void 0:e[2],value:"-"===(null==e?void 0:e[1])?"removed":null==e?void 0:e[3]})):[]}_computeScoreClass(e,t){if(void 0===e||void 0===t)return"";if(!e.value)return"";if("removed"===e.value)return"removed";const i=[];if(Number(e.value)>0?i.push("positive"):Number(e.value)<0&&i.push("negative"),e.label){const n=t[e.label];if(n){const t=Number(e.value);t===n.max?i.push("max"):t===n.min&&i.push("min")}}return i.join(" ")}_computeClass(e,t){const i=[];return i.push(e?"expanded":"collapsed"),Pn(t)&&i.push("serviceUser"),i.join(" ")}_handleAnchorClick(e){e.preventDefault();const t={id:this.message.id};this.dispatchEvent(new CustomEvent("message-anchor-tap",{bubbles:!0,composed:!0,detail:t}))}_handleReplyTap(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("reply",{detail:{message:this.message},composed:!0,bubbles:!0}))}_handleDeleteMessage(e){e.preventDefault(),this.message&&this.message.id&&this.changeNum&&(this._isDeletingChangeMsg=!0,this.restApiService.deleteChangeCommitMessage(this.changeNum,this.message.id).then(()=>{this._isDeletingChangeMsg=!1,this.dispatchEvent(new CustomEvent("change-message-deleted",{detail:{message:this.message},composed:!0,bubbles:!0}))}))}_projectNameChanged(e){this.restApiService.getProjectConfig(e).then(e=>{this._projectConfig=e})}_computeExpandToggleIcon(e){return e?"gr-icons:expand-less":"gr-icons:expand-more"}_toggleExpanded(e){var t;e.stopPropagation(),this.set("message.expanded",!(null===(t=this.message)||void 0===t?void 0:t.expanded))}};Vx([Oo({type:Object})],Xx.prototype,"change",void 0),Vx([Oo({type:Number})],Xx.prototype,"changeNum",void 0),Vx([Oo({type:Object})],Xx.prototype,"message",void 0),Vx([Lo("message")],Xx.prototype,"author",null),Vx([Oo({type:Object})],Xx.prototype,"config",void 0),Vx([Oo({type:Boolean})],Xx.prototype,"hideAutomated",void 0),Vx([Oo({type:Boolean,reflectToAttribute:!0,computed:"_computeIsHidden(hideAutomated, isAutomated)"})],Xx.prototype,"hidden",void 0),Vx([Lo("message")],Xx.prototype,"isAutomated",null),Vx([Lo("message")],Xx.prototype,"showOnBehalfOf",null),Vx([Oo({type:Boolean,computed:"_computeShowReplyButton(message, _loggedIn)"})],Xx.prototype,"showReplyButton",void 0),Vx([Oo({type:String})],Xx.prototype,"projectName",void 0),Vx([Oo({type:Object})],Xx.prototype,"labelExtremes",void 0),Vx([Oo({type:Object})],Xx.prototype,"_projectConfig",void 0),Vx([Oo({type:Boolean})],Xx.prototype,"_loggedIn",void 0),Vx([Oo({type:Boolean})],Xx.prototype,"_isAdmin",void 0),Vx([Oo({type:Boolean})],Xx.prototype,"_isDeletingChangeMsg",void 0),Vx([Oo({type:Boolean,computed:"_computeExpanded(message.expanded)"})],Xx.prototype,"_expanded",void 0),Vx([Oo({type:String,computed:"_computeMessageContentExpanded(message.message, message.tag)"})],Xx.prototype,"_messageContentExpanded",void 0),Vx([Oo({type:String,computed:"_computeMessageContentCollapsed(message.message, message.tag, message.commentThreads)"})],Xx.prototype,"_messageContentCollapsed",void 0),Vx([Oo({type:String,computed:"_computeCommentCountText(message.commentThreads.length)"})],Xx.prototype,"_commentCountText",void 0),Vx([No("message.expanded")],Xx.prototype,"_updateExpandedClass",null),Vx([No("projectName")],Xx.prototype,"_projectNameChanged",null),Xx=Vx([Po("gr-message")],Xx);const Jx=mi`
  <style include="shared-styles">
    :host {
      display: flex;
      justify-content: space-between;
    }
    .header {
      align-items: center;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-s) var(--spacing-l);
    }
    .highlighted {
      animation: 3s fadeOut;
    }
    @keyframes fadeOut {
      0% {
        background-color: var(--emphasis-color);
      }
      100% {
        background-color: var(--view-background-color);
      }
    }
    .container {
      align-items: center;
      display: flex;
    }
    .hiddenEntries {
      color: var(--deemphasized-text-color);
    }
    gr-message:not(:last-of-type) {
      border-bottom: 1px solid var(--border-color);
    }
  </style>
  <div class="header">
    <div id="showAllActivityToggleContainer" class="container">
      <template
        is="dom-if"
        if="[[_isVisibleShowAllActivityToggle(_combinedMessages)]]"
      >
        <paper-toggle-button
          class="showAllActivityToggle"
          checked="{{_showAllActivity}}"
          aria-labelledby="showAllEntriesLabel"
          role="switch"
          on-click="_onTapShowAllActivityToggle"
        ></paper-toggle-button>
        <div id="showAllEntriesLabel" aria-hidden="true">
          <span>Show all entries</span>
          <span class="hiddenEntries" hidden$="[[_showAllActivity]]">
            ([[_computeHiddenEntriesCount(_combinedMessages)]] hidden)
          </span>
        </div>
        <span class="transparent separator"></span>
      </template>
    </div>
    <gr-button
      id="collapse-messages"
      link=""
      title="[[_expandAllTitle]]"
      on-click="_handleExpandCollapseTap"
    >
      [[_expandAllState]]
    </gr-button>
  </div>
  <template
    id="messageRepeat"
    is="dom-repeat"
    items="[[_combinedMessages]]"
    as="message"
    filter="_isMessageVisible"
  >
    <gr-message
      change="[[change]]"
      change-num="[[changeNum]]"
      message="[[message]]"
      project-name="[[projectName]]"
      show-reply-button="[[showReplyButtons]]"
      on-message-anchor-tap="_handleAnchorClick"
      label-extremes="[[_labelExtremes]]"
      data-message-id$="[[message.id]]"
    ></gr-message>
  </template>
`;var Zx,Qx=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};function eR(e){return function(e){return void 0!==e.id}(e)?e.id:void 0}function tR(e,t){if(void 0===e._index)return[];const i=eR(e);return t.getAllThreadsForChange().filter(e=>e.comments.map(e=>(e.collapsed=!0,e)).some(e=>{const t=e.change_message_id===i;return e.collapsed=!t,t}))}function iR(e){if(!e.tag){const t=e.commentThreads||[],i=eR(e);return t.map(e=>e.comments.find(e=>e.change_message_id===i)).some(Uw)?"autogenerated:has-robot-comments":void 0}return e.tag===Yi.TAG_NEW_WIP_PATCHSET?Yi.TAG_NEW_PATCHSET:e.tag===Yi.TAG_UNSET_ASSIGNEE?Yi.TAG_SET_ASSIGNEE:e.tag===Yi.TAG_UNSET_PRIVATE?Yi.TAG_SET_PRIVATE:e.tag===Yi.TAG_SET_WIP?Yi.TAG_SET_READY:e.tag.replace(/~.*/,"")}function nR(e,t){if(e._revision_number&&e._revision_number>0)return e._revision_number;let i=0;for(const n of t){if(n.date>e.date)break;n._revision_number&&n._revision_number>i&&(i=n._revision_number)}return i>0?i:void 0}function oR(e,t){if(!e.tag)return!0;const i=e._revision_number||0;return!t.filter(t=>t.tag===e.tag).some(e=>(e._revision_number||0)>i)}!function(e){e.EXPAND_ALL="Expand All",e.COLLAPSE_ALL="Collapse All"}(Zx||(Zx={}));let rR=class extends(Kf(fi)){constructor(){super(...arguments),this.messages=[],this.reviewerUpdates=[],this.showReplyButtons=!1,this._expandAllState=Zx.EXPAND_ALL,this._expandAllTitle="",this._showAllActivity=!1,this._combinedMessages=[],this._labelExtremes={},this.reporting=i.reportingService}static get template(){return Jx}scrollToMessage(e){const t=`[data-message-id="${e}"]`,i=this.shadowRoot.querySelector(t);if(!i&&this._showAllActivity)return void console.warn(`Failed to scroll to message: ${e}`);if(!i)return this._showAllActivity=!0,void setTimeout(()=>this.scrollToMessage(e));i.set("message.expanded",!0);let n=i.offsetTop;for(let e=i.offsetParent;e;e=e.offsetParent)n+=e.offsetTop;window.scrollTo(0,n),this._highlightEl(i)}_observeShowAllActivity(){this.$.messageRepeat.render()}_isMessageVisible(e){return this._showAllActivity||e.isImportant}_computeCombinedMessages(e,t,i){if(void 0===e||void 0===t||void 0===i)return[];let n,o,r=0,s=0,a=[];for(let t=0;t<e.length;t++)e[t]._index=t;for(;r<e.length||s<t.length;){if(r>=e.length){a=a.concat(t.slice(s));break}if(s>=t.length){a=a.concat(e.slice(r));break}n=n||Fi(e[r].date),o=o||Fi(t[s].date),o<n?(a.push(t[s++]),o=null):(a.push(e[r++]),n=null)}return a.forEach(e=>{void 0===e.expanded&&(e.expanded=!1),e.commentThreads=tR(e,i),e._revision_number=nR(e,a),e.tag=iR(e)}),a.forEach(e=>{e.isImportant=oR(e,a)}),a}_updateExpandedStateOfAllMessages(e){if(this._combinedMessages)for(let t=0;t<this._combinedMessages.length;t++)this._combinedMessages[t].expanded=e,this.notifyPath(`_combinedMessages.${t}.expanded`)}_computeExpandAllTitle(e){return e===Zx.COLLAPSE_ALL?this.createTitle(Hf.COLLAPSE_ALL_MESSAGES,jf.ACTIONS):e===Zx.EXPAND_ALL?this.createTitle(Hf.EXPAND_ALL_MESSAGES,jf.ACTIONS):""}_highlightEl(e){const t=this.root.querySelectorAll(".highlighted");for(const e of t)e.classList.remove("highlighted");e.addEventListener("animationend",(function t(){e.removeEventListener("animationend",t),e.classList.remove("highlighted")})),e.classList.add("highlighted")}handleExpandCollapse(e){this._expandAllState=e?Zx.COLLAPSE_ALL:Zx.EXPAND_ALL,this._updateExpandedStateOfAllMessages(e)}_handleExpandCollapseTap(e){e.preventDefault(),this.handleExpandCollapse(this._expandAllState===Zx.EXPAND_ALL)}_handleAnchorClick(e){this.scrollToMessage(e.detail.id)}_isVisibleShowAllActivityToggle(e=[]){return e.some(e=>!e.isImportant)}_computeHiddenEntriesCount(e=[]){return e.filter(e=>!e.isImportant).length}_combinedMessagesChanged(e){if(e){if(0===e.length)return;const t=e.map(e=>e.tag||e.type||"none").reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{all:e.length});this.reporting.reportInteraction("messages-count",t)}}_computeLabelExtremes(e){const t={},i=e.base;if(!i)return t;for(const e of Object.keys(i)){const n=sA(i[e]);n&&(t[e]=n)}return t}_onTapShowAllActivityToggle(e){e.preventDefault()}};Qx([Oo({type:Object})],rR.prototype,"change",void 0),Qx([Oo({type:String})],rR.prototype,"changeNum",void 0),Qx([Oo({type:Array})],rR.prototype,"messages",void 0),Qx([Oo({type:Array})],rR.prototype,"reviewerUpdates",void 0),Qx([Oo({type:Object})],rR.prototype,"changeComments",void 0),Qx([Oo({type:String})],rR.prototype,"projectName",void 0),Qx([Oo({type:Boolean})],rR.prototype,"showReplyButtons",void 0),Qx([Oo({type:Object})],rR.prototype,"labels",void 0),Qx([Oo({type:String})],rR.prototype,"_expandAllState",void 0),Qx([Oo({type:String,computed:"_computeExpandAllTitle(_expandAllState)"})],rR.prototype,"_expandAllTitle",void 0),Qx([Oo({type:Boolean,observer:"_observeShowAllActivity"})],rR.prototype,"_showAllActivity",void 0),Qx([Oo({type:Array,computed:"_computeCombinedMessages(messages, reviewerUpdates, changeComments)",observer:"_combinedMessagesChanged"})],rR.prototype,"_combinedMessages",void 0),Qx([Oo({type:Object,computed:"_computeLabelExtremes(labels.*)"})],rR.prototype,"_labelExtremes",void 0),rR=Qx([Po("gr-messages-list")],rR);var sR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let aR=class extends RA{constructor(){super(...arguments),this.showSubmittableCheck=!1,this.showChangeStatus=!1}static get styles(){return[ic,Zl`
        a {
          display: block;
        }
        .changeContainer,
        a {
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        .changeContainer {
          display: flex;
        }
        .strikethrough {
          color: var(--deemphasized-text-color);
          text-decoration: line-through;
        }
        .status {
          color: var(--deemphasized-text-color);
          font-weight: var(--font-weight-bold);
          margin-left: var(--spacing-xs);
        }
        .notCurrent {
          color: var(--warning-foreground);
        }
        .indirectAncestor {
          color: var(--indirect-ancestor-text-color);
        }
        .submittableCheck {
          padding-left: var(--spacing-s);
          color: var(--positive-green-text-color);
          display: none;
        }
        .submittableCheck.submittable {
          display: inline;
        }
        .hidden,
        .mobile {
          display: none;
        }
        .submittableCheck {
          padding-left: var(--spacing-s);
          color: var(--positive-green-text-color);
          display: none;
        }
        .submittableCheck.submittable {
          display: inline;
        }
      `]}render(){const e=this.change;if(!e)throw new Error("Missing change");const t=this._computeLinkClass(e);return Pl`
      <div class="changeContainer">
        <a href="${this.href}" class="${t}"><slot></slot></a>
        ${this.showSubmittableCheck?Pl`<span
              tabindex="-1"
              title="Submittable"
              class="submittableCheck ${t}"
              role="img"
              aria-label="Submittable"
              ></span
            >`:""}
        ${this.showChangeStatus&&!ko(e)?Pl`<span class="${this._computeChangeStatusClass(e)}">
              (${this._computeChangeStatus(e)})
            </span>`:""}
      </div>
    `}_computeLinkClass(e){const t=[];return e.status===Ji.ABANDONED&&t.push("strikethrough"),e.submittable&&t.push("submittable"),t.join(" ")}_computeChangeStatusClass(e){const t=["status"];return e._revision_number!==e._current_revision_number?t.push("notCurrent"):this._isIndirectAncestor(e)?t.push("indirectAncestor"):e.submittable?t.push("submittable"):e.status===Ji.NEW&&t.push("hidden"),t.join(" ")}_computeChangeStatus(e){switch(e.status){case Ji.MERGED:return"Merged";case Ji.ABANDONED:return"Abandoned"}return e._revision_number!==e._current_revision_number?"Not current":this._isIndirectAncestor(e)?"Indirect ancestor":e.submittable?"Submittable":""}_isIndirectAncestor(e){return this.connectedRevisions&&!this.connectedRevisions.includes(e.commit.commit)}};sR([Gl()],aR.prototype,"change",void 0),sR([Gl()],aR.prototype,"href",void 0),sR([Gl()],aR.prototype,"showSubmittableCheck",void 0),sR([Gl()],aR.prototype,"showChangeStatus",void 0),sR([Gl()],aR.prototype,"connectedRevisions",void 0),aR=sR([Hl("gr-related-change")],aR);var lR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let cR=class extends fi{};lR([Oo({type:String})],cR.prototype,"name",void 0),cR=lR([Po("gr-endpoint-slot")],cR);var dR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var hR;!function(e){e.RELATED_CHANGES="related changes",e.SUBMITTED_TOGETHER="submitted together",e.SAME_TOPIC="same topic",e.MERGE_CONFLICTS="merge conflicts",e.CHERRY_PICKS="cherry picks"}(hR||(hR={}));let pR=class extends RA{constructor(){super(...arguments),this.submittedTogether={changes:[],non_visible_changes:0},this.relatedChanges=[],this.conflictingChanges=[],this.cherryPickChanges=[],this.sameTopicChanges=[],this.restApiService=i.restApiService}static get styles(){return[ic,Zl`
        .note {
          color: var(--error-text-color);
          margin-left: 1.2em;
        }
        section {
          margin-bottom: var(--spacing-l);
        }
        gr-related-change {
          display: flex;
        }
        .marker {
          position: absolute;
          margin-left: calc(-1 * var(--spacing-s));
        }
        .arrowToCurrentChange {
          position: absolute;
        }
      `]}render(){var e,t,i,n,o,r,s,a,l,c,d,h,p;const u=this.sectionSizeFactory(this.relatedChanges.length,(null===(e=this.submittedTogether)||void 0===e?void 0:e.changes.length)||0,this.sameTopicChanges.length,this.conflictingChanges.length,this.cherryPickChanges.length),g=this.markersPredicateFactory(this.relatedChanges.length,this.relatedChanges.findIndex(e=>this._changesEqual(e,this.change)),u(hR.RELATED_CHANGES)),m=this._computeConnectedRevisions(this.change,this.patchNum,this.relatedChanges);let f=!1,_=!f&&!!this.relatedChanges.length;f=f||_;const v=Pl` <section
      id="relatedChanges"
      ?hidden=${!this.relatedChanges.length}
    >
      <gr-related-collapse
        title="Relation chain"
        class="${tE({first:_})}"
        .length=${this.relatedChanges.length}
        .numChangesWhenCollapsed=${u(hR.RELATED_CHANGES)}
      >
        ${this.relatedChanges.map((e,t)=>Pl`${this.renderMarkers(g(t))}<gr-related-change
                class="${tE({"show-when-collapsed":g(t).showWhenCollapsed})}"
                .change="${e}"
                .connectedRevisions="${m}"
                .href="${(null==e?void 0:e._change_number)?Qm.getUrlForChangeById(e._change_number,e.project,e._revision_number):""}"
                .showChangeStatus=${!0}
                >${e.commit.subject}</gr-related-change
              >`)}
      </gr-related-collapse>
    </section>`,y=null!==(i=null===(t=this.submittedTogether)||void 0===t?void 0:t.changes)&&void 0!==i?i:[],b=null!==(o=null===(n=this.submittedTogether)||void 0===n?void 0:n.non_visible_changes)&&void 0!==o?o:0,w=this.markersPredicateFactory(y.length,y.findIndex(e=>this._changesEqual(e,this.change)),u(hR.SUBMITTED_TOGETHER));_=!(f||!(null==y?void 0:y.length)&&!(null===(r=this.submittedTogether)||void 0===r?void 0:r.non_visible_changes)),f=f||_;const C=Pl`<section
      id="submittedTogether"
      ?hidden=${!(null==y?void 0:y.length)&&!(null===(s=this.submittedTogether)||void 0===s?void 0:s.non_visible_changes)}
    >
      <gr-related-collapse
        title="Submitted together"
        class="${tE({first:_})}"
        .length=${y.length}
        .numChangesWhenCollapsed=${u(hR.SUBMITTED_TOGETHER)}
      >
        ${y.map((e,t)=>Pl`${this.renderMarkers(w(t))}<gr-related-change
                class="${tE({"show-when-collapsed":w(t).showWhenCollapsed})}"
                .change="${e}"
                .href="${Qm.getUrlForChangeById(e._number,e.project)}"
                .showSubmittableCheck=${!0}
                >${e.project}: ${e.branch}:
                ${e.subject}</gr-related-change
              >`)}
      </gr-related-collapse>
      <div class="note" ?hidden=${!b}>
        (+ ${Jb(b,"non-visible change")})
      </div>
    </section>`,S=this.markersPredicateFactory(this.sameTopicChanges.length,-1,u(hR.SAME_TOPIC));_=!f&&!!(null===(a=this.sameTopicChanges)||void 0===a?void 0:a.length),f=f||_;const E=Pl`<section
      id="sameTopic"
      ?hidden=${!(null===(l=this.sameTopicChanges)||void 0===l?void 0:l.length)}
    >
      <gr-related-collapse
        title="Same topic"
        class="${tE({first:_})}"
        .length=${this.sameTopicChanges.length}
        .numChangesWhenCollapsed=${u(hR.SAME_TOPIC)}
      >
        ${this.sameTopicChanges.map((e,t)=>Pl`${this.renderMarkers(S(t))}<gr-related-change
                class="${tE({"show-when-collapsed":S(t).showWhenCollapsed})}"
                .change="${e}"
                .href="${Qm.getUrlForChangeById(e._number,e.project)}"
                >${e.project}: ${e.branch}:
                ${e.subject}</gr-related-change
              >`)}
      </gr-related-collapse>
    </section>`,A=this.markersPredicateFactory(this.conflictingChanges.length,-1,u(hR.MERGE_CONFLICTS));_=!f&&!!(null===(c=this.conflictingChanges)||void 0===c?void 0:c.length),f=f||_;const x=Pl`<section
      id="mergeConflicts"
      ?hidden=${!(null===(d=this.conflictingChanges)||void 0===d?void 0:d.length)}
    >
      <gr-related-collapse
        title="Merge conflicts"
        class="${tE({first:_})}"
        .length=${this.conflictingChanges.length}
        .numChangesWhenCollapsed=${u(hR.MERGE_CONFLICTS)}
      >
        ${this.conflictingChanges.map((e,t)=>Pl`${this.renderMarkers(A(t))}<gr-related-change
                class="${tE({"show-when-collapsed":A(t).showWhenCollapsed})}"
                .change="${e}"
                .href="${Qm.getUrlForChangeById(e._number,e.project)}"
                >${e.subject}</gr-related-change
              >`)}
      </gr-related-collapse>
    </section>`,R=this.markersPredicateFactory(this.cherryPickChanges.length,-1,u(hR.CHERRY_PICKS));_=!f&&!!(null===(h=this.cherryPickChanges)||void 0===h?void 0:h.length),f=f||_;const T=Pl`<section
      id="cherryPicks"
      ?hidden=${!(null===(p=this.cherryPickChanges)||void 0===p?void 0:p.length)}
    >
      <gr-related-collapse
        title="Cherry picks"
        class="${tE({first:_})}"
        .length=${this.cherryPickChanges.length}
        .numChangesWhenCollapsed=${u(hR.CHERRY_PICKS)}
      >
        ${this.cherryPickChanges.map((e,t)=>Pl`${this.renderMarkers(R(t))}<gr-related-change
                class="${tE({"show-when-collapsed":R(t).showWhenCollapsed})}"
                .change="${e}"
                .href="${Qm.getUrlForChangeById(e._number,e.project)}"
                >${e.branch}: ${e.subject}</gr-related-change
              >`)}
      </gr-related-collapse>
    </section>`;return Pl`<gr-endpoint-decorator name="related-changes-section">
      <gr-endpoint-param
        name="change"
        .value=${this.change}
      ></gr-endpoint-param>
      <gr-endpoint-slot name="top"></gr-endpoint-slot>
      ${v} ${C} ${E}
      ${x} ${T}
      <gr-endpoint-slot name="bottom"></gr-endpoint-slot>
    </gr-endpoint-decorator>`}sectionSizeFactory(e,t,i,n,o){const r=e=>Math.min(e,3),s=[{section:hR.RELATED_CHANGES,size:r(e),len:e},{section:hR.SUBMITTED_TOGETHER,size:r(t),len:t},{section:hR.SAME_TOPIC,size:r(i),len:i},{section:hR.MERGE_CONFLICTS,size:r(n),len:n},{section:hR.CHERRY_PICKS,size:r(o),len:o}];let a=s.reduce((e,t)=>e+t.size+(0!==t.size?1:0),0);for(let e=0;e<s.length&&!(a>=16);e++){const t=s[e];if(t.size===t.len)continue;const i=Math.min(16-a+t.size,t.len);a+=i-t.size,t.size=i}return e=>{const t=s.find(t=>t.section===e);return t?t.size:3}}markersPredicateFactory(e,t,i=3){const n=n=>{if(-1===t)return n<i;if(0===t)return n<=i-1;if(t===e-1)return n>=e-i;let o=Math.floor(i/2),r=Math.floor(i/2)-(i%2?0:1);return o+=Math.max(t+r-e+1,0),r-=Math.min(0,t-o),t-o<=n&&n<=t+r};return i=>({showCurrentChangeArrow:-1!==t&&i===t,showWhenCollapsed:n(i),showTopArrow:i>=1&&i!==t&&n(i)&&!n(i-1),showBottomArrow:i<=e-2&&i!==t&&n(i)&&!n(i+1)})}renderMarkers(e){return e.showCurrentChangeArrow?Pl`<span
        role="img"
        class="arrowToCurrentChange"
        aria-label="Arrow marking current change"
        ></span
      >`:e.showTopArrow?Pl`<span
        role="img"
        class="marker"
        aria-label="Arrow marking change has collapsed ancestors"
        ><iron-icon icon="gr-icons:arrowDropUp"></iron-icon
      ></span> `:e.showBottomArrow?Pl`<span
        role="img"
        class="marker"
        aria-label="Arrow marking change has collapsed descendants"
        ><iron-icon icon="gr-icons:arrowDropDown"></iron-icon
      ></span> `:dl}reload(e){const t=this.change;if(!t)return Promise.reject(new Error("change missing"));if(!this.patchNum)return Promise.reject(new Error("patchNum missing"));e||(e=this.restApiService.getRelatedChanges(t._number,this.patchNum));const i=[e.then(e=>{var t;if(!e)throw new Error("getRelatedChanges returned undefined response");this.relatedChanges=null!==(t=null==e?void 0:e.changes)&&void 0!==t?t:[]}),this.restApiService.getChangesSubmittedTogether(t._number).then(e=>{this.submittedTogether=e}),this.restApiService.getChangeCherryPicks(t.project,t.change_id,t._number).then(e=>{this.cherryPickChanges=e||[]})];if(bo(t)&&this.mergeable&&i.push(this.restApiService.getChangeConflicts(t._number).then(e=>{this.conflictingChanges=null!=e?e:[]})),t.topic){const e=t.topic;i.push(this.restApiService.getConfig().then(i=>i&&!i.change.submit_whole_topic?this.restApiService.getChangesWithSameTopic(e,t._number).then(t=>{var i;e===(null===(i=this.change)||void 0===i?void 0:i.topic)&&(this.sameTopicChanges=null!=t?t:[])}):(this.sameTopicChanges=[],Promise.resolve())))}return Promise.all(i)}_changesEqual(e,t){return this._getChangeNumber(e)===this._getChangeNumber(t)}_getChangeNumber(e){return e?ko(e)?e._number:e._change_number:0}_computeConnectedRevisions(e,t,i){if(!t||!i||!e)return[];const n=[],o=Ro(e,t),r=i.map(e=>e.commit);let s=r.length-1;for(;s>=0;){const e=r[s].commit;if(n.push(e),e==o)break;s--}for(;s>=0;){for(let e=0;e<r[s].parents.length;e++)if(n.includes(r[s].parents[e].commit)){n.push(r[s].commit);break}--s}return n}};dR([Gl()],pR.prototype,"change",void 0),dR([Gl({type:String})],pR.prototype,"patchNum",void 0),dR([Gl()],pR.prototype,"mergeable",void 0),dR([zl()],pR.prototype,"submittedTogether",void 0),dR([zl()],pR.prototype,"relatedChanges",void 0),dR([zl()],pR.prototype,"conflictingChanges",void 0),dR([zl()],pR.prototype,"cherryPickChanges",void 0),dR([zl()],pR.prototype,"sameTopicChanges",void 0),pR=dR([Hl("gr-related-changes-list")],pR);let uR=class extends RA{constructor(){super(...arguments),this.title="",this.showAll=!1,this.length=0,this.numChangesWhenCollapsed=3,this.reporting=i.reportingService}static get styles(){return[ic,Zl`
        .title {
          font-weight: var(--font-weight-bold);
          color: var(--deemphasized-text-color);
          padding-left: var(--metadata-horizontal-padding);
        }
        h4 {
          display: flex;
          align-self: flex-end;
        }
        gr-button {
          display: flex;
        }
        /* This is a hacky solution from old gr-related-change-list
         * TODO(milutin): find layout without needing it
         */
        h4:before,
        gr-button:before,
        ::slotted(gr-related-change):before {
          content: ' ';
          flex-shrink: 0;
          width: 1.2em;
        }
        .collapsed ::slotted(gr-related-change.show-when-collapsed) {
          visibility: visible;
          height: auto;
        }
        .collapsed ::slotted(.marker) {
          display: block;
        }
        .show-all ::slotted(.marker) {
          display: none;
        }
        /* keep width, so width of section and position of show all button
         * are set according to width of all (even hidden) elements
         */
        .collapsed ::slotted(gr-related-change) {
          visibility: hidden;
          height: 0px;
        }
        ::slotted(gr-related-change) {
          visibility: visible;
          height: auto;
        }
        gr-button iron-icon {
          color: inherit;
          --iron-icon-height: 18px;
          --iron-icon-width: 18px;
        }
        .container {
          justify-content: space-between;
          display: flex;
          margin-bottom: var(--spacing-s);
        }
        :host(.first) .container {
          margin-bottom: var(--spacing-m);
        }
      `]}render(){const e=Pl`<h4 class="title">${this.title}</h4>`,t=this.length>this.numChangesWhenCollapsed,i=Pl` <div
      class="${!this.showAll&&t?"collapsed":"show-all"}"
    >
      <slot></slot>
    </div>`;let n=dl;if(t){let e="Show less",t="expand-less";this.showAll||(e=`Show all (${this.length})`,t="expand-more"),n=Pl`<gr-button link="" @click="${this.toggle}"
        >${e}<iron-icon icon="gr-icons:${t}"></iron-icon
      ></gr-button>`}return Pl`<div class="container">${e}${n}</div>
      ${i}`}toggle(e){e.stopPropagation(),this.showAll=!this.showAll,this.reporting.reportInteraction("toggle show all button",{sectionName:this.title,toState:this.showAll?"Show all":"Show less"})}};dR([Gl()],uR.prototype,"title",void 0),dR([Gl()],uR.prototype,"showAll",void 0),dR([Gl()],uR.prototype,"length",void 0),dR([Gl()],uR.prototype,"numChangesWhenCollapsed",void 0),uR=dR([Hl("gr-related-collapse")],uR);const gR=mi`
  <style include="shared-styles">
    gr-diff {
      --content-width: 90vw;
    }
    .diffContainer {
      padding: var(--spacing-l) 0;
      border-bottom: 1px solid var(--border-color);
    }
    .file-name {
      display: block;
      padding: var(--spacing-s) var(--spacing-l);
      background-color: var(--background-color-secondary);
      border-bottom: 1px solid var(--border-color);
    }
    .fixActions {
      display: flex;
      justify-content: flex-end;
    }
    gr-button {
      margin-left: var(--spacing-m);
    }
    .fix-picker {
      display: flex;
      align-items: center;
      margin-right: var(--spacing-l);
    }
  </style>
  <gr-overlay id="applyFixOverlay" with-backdrop="">
    <gr-dialog
      id="applyFixDialog"
      on-confirm="_handleApplyFix"
      confirm-label="[[_getApplyFixButtonLabel(_isApplyFixLoading)]]"
      disabled="[[_disableApplyFixButton]]"
      confirm-tooltip="[[_computeTooltip(change, _patchNum)]]"
      on-cancel="onCancel"
    >
      <div slot="header">[[_robotId]] - [[getFixDescription(_currentFix)]]</div>
      <div slot="main">
        <template is="dom-repeat" items="[[_currentPreviews]]">
          <div class="file-name">
            <span>[[item.filepath]]</span>
          </div>
          <div class="diffContainer">
            <gr-diff
              prefs="[[overridePartialPrefs(prefs)]]"
              change-num="[[changeNum]]"
              path="[[item.filepath]]"
              diff="[[item.preview]]"
            ></gr-diff>
          </div>
        </template>
      </div>
      <div
        slot="footer"
        class="fix-picker"
        hidden$="[[hasSingleFix(_fixSuggestions)]]"
      >
        <span
          >Suggested fix [[addOneTo(_selectedFixIdx)]] of
          [[_fixSuggestions.length]]</span
        >
        <gr-button
          id="prevFix"
          on-click="_onPrevFixClick"
          disabled$="[[_noPrevFix(_selectedFixIdx)]]"
        >
          <iron-icon icon="gr-icons:chevron-left"></iron-icon>
        </gr-button>
        <gr-button
          id="nextFix"
          on-click="_onNextFixClick"
          disabled$="[[_noNextFix(_selectedFixIdx, _fixSuggestions)]]"
        >
          <iron-icon icon="gr-icons:chevron-right"></iron-icon>
        </gr-button>
      </div>
    </gr-dialog>
  </gr-overlay>
`;var mR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let fR=class extends fi{constructor(){super(...arguments),this._currentPreviews=[],this._isApplyFixLoading=!1,this._selectedFixIdx=0,this.restApiService=i.restApiService}static get template(){return gR}open(e){const t=e.detail,i=t.comment;if(!t.patchNum||!i||!Uw(i))return Promise.resolve();if(this._patchNum=t.patchNum,this._fixSuggestions=i.fix_suggestions,this._robotId=i.robot_id,!this._fixSuggestions||!this._fixSuggestions.length)return Promise.resolve();this._selectedFixIdx=0;const n=[];return n.push(this._showSelectedFixSuggestion(this._fixSuggestions[0]),this.$.applyFixOverlay.open()),Promise.all(n).then(()=>{bi(this.$.applyFixOverlay,"iron-resize")})}connectedCallback(){super.connectedCallback(),this.refitOverlay=()=>{bi(this.$.applyFixOverlay,"iron-resize")},this.addEventListener("diff-context-expanded",this.refitOverlay)}disconnectedCallback(){this.refitOverlay&&this.removeEventListener("diff-context-expanded",this.refitOverlay),super.disconnectedCallback()}_showSelectedFixSuggestion(e){return this._currentFix=e,this._fetchFixPreview(e.fix_id)}_fetchFixPreview(e){return this.changeNum&&this._patchNum?this.restApiService.getRobotCommentFixPreview(this.changeNum,this._patchNum,e).then(e=>{e&&(this._currentPreviews=Object.keys(e).map(t=>({filepath:t,preview:e[t]})))}).catch(e=>{throw this._close(!1),e}):Promise.reject(new Error("Both _patchNum and changeNum must be set"))}hasSingleFix(e){return 1===(e||[]).length}overridePartialPrefs(e){return{...e,line_length:50}}onCancel(e){e&&e.stopPropagation(),this._close(!1)}addOneTo(e){return e+1}_onPrevFixClick(e){e&&e.stopPropagation(),this._selectedFixIdx>=1&&this._fixSuggestions&&(this._selectedFixIdx-=1,this._showSelectedFixSuggestion(this._fixSuggestions[this._selectedFixIdx]))}_onNextFixClick(e){e&&e.stopPropagation(),this._fixSuggestions&&this._selectedFixIdx<this._fixSuggestions.length&&(this._selectedFixIdx+=1,this._showSelectedFixSuggestion(this._fixSuggestions[this._selectedFixIdx]))}_noPrevFix(e){return 0===e}_noNextFix(e,t){return!t||e===t.length-1}_close(e){this._currentFix=void 0,this._currentPreviews=[],this._isApplyFixLoading=!1,function(e,t){wi(e,vi.CLOSE_FIX_PREVIEW,{fixApplied:t})}(this,e),this.$.applyFixOverlay.close()}_getApplyFixButtonLabel(e){return e?"Saving...":"Apply Fix"}_computeTooltip(e,t){if(!e||!t)return"";return e.revisions[e.current_revision]._number!==t?"Fix can only be applied to the latest patchset":""}_computeDisableApplyFixButton(e,t,i){if(!t||void 0===e||void 0===i)return!0;return i!==t.revisions[t.current_revision]._number||e}_handleApplyFix(e){e&&e.stopPropagation();const t=this.changeNum,i=this._patchNum,n=this.change;return t&&i&&n&&this._currentFix?(this._isApplyFixLoading=!0,this.restApiService.applyFixSuggestion(t,i,this._currentFix.fix_id).then(e=>{e&&e.ok&&(Qm.navigateToChange(n,"edit",i),this._close(!0)),this._isApplyFixLoading=!1})):Promise.reject(new Error("Not all required properties are set."))}getFixDescription(e){return e&&e.description?e.description:""}};mR([Oo({type:Object})],fR.prototype,"prefs",void 0),mR([Oo({type:Object})],fR.prototype,"change",void 0),mR([Oo({type:String})],fR.prototype,"changeNum",void 0),mR([Oo({type:Number})],fR.prototype,"_patchNum",void 0),mR([Oo({type:String})],fR.prototype,"_robotId",void 0),mR([Oo({type:Object})],fR.prototype,"_currentFix",void 0),mR([Oo({type:Array})],fR.prototype,"_currentPreviews",void 0),mR([Oo({type:Array})],fR.prototype,"_fixSuggestions",void 0),mR([Oo({type:Boolean})],fR.prototype,"_isApplyFixLoading",void 0),mR([Oo({type:Number})],fR.prototype,"_selectedFixIdx",void 0),mR([Oo({type:Boolean,computed:"_computeDisableApplyFixButton(_isApplyFixLoading, change, _patchNum)"})],fR.prototype,"_disableApplyFixButton",void 0),fR=mR([Po("gr-apply-fix-dialog")],fR),zh({is:"iron-selector",behaviors:[bf]});const _R=mi`
  <style include="gr-voting-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    .labelNameCell,
    .buttonsCell,
    .selectedValueCell {
      padding: var(--spacing-s) var(--spacing-m);
      display: table-cell;
    }
    /* We want the :hover highlight to extend to the border of the dialog. */
    .labelNameCell {
      padding-left: var(--spacing-xl);
    }
    .selectedValueCell {
      padding-right: var(--spacing-xl);
    }
    /* This is a trick to let the selectedValueCell take the remaining width. */
    .labelNameCell,
    .buttonsCell {
      white-space: nowrap;
    }
    .selectedValueCell {
      width: 75%;
    }
    .labelMessage {
      color: var(--deemphasized-text-color);
    }
    gr-button {
      min-width: 42px;
      box-sizing: border-box;
      --gr-button: {
        background-color: var(
          --button-background-color,
          var(--table-header-background-color)
        );
        padding: 0 var(--spacing-m);
        @apply --vote-chip-styles;
      }
    }
    gr-button.iron-selected[vote='max'] {
      --button-background-color: var(--vote-color-approved);
    }
    gr-button.iron-selected[vote='positive'] {
      --button-background-color: var(--vote-color-recommended);
      --gr-button: {
        padding: 0 var(--spacing-m);
        border-style: solid;
        border-color: var(--vote-outline-recommended);
        border-top-left-radius: 1em;
        border-top-right-radius: 1em;
        border-bottom-right-radius: 1em;
        border-bottom-left-radius: 1em;
        border-top-width: 1px;
        border-right-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        color: var(--chip-color);
      }
    }
    gr-button.iron-selected[vote='min'] {
      --button-background-color: var(--vote-color-rejected);
    }
    gr-button.iron-selected[vote='negative'] {
      --button-background-color: var(--vote-color-disliked);
      --gr-button: {
        padding: 0 var(--spacing-m);
        border-style: solid;
        border-color: var(--vote-outline-disliked);
        border-top-left-radius: 1em;
        border-top-right-radius: 1em;
        border-bottom-right-radius: 1em;
        border-bottom-left-radius: 1em;
        border-top-width: 1px;
        border-right-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        color: var(--chip-color);
      }
    }
    gr-button.iron-selected[vote='neutral'] {
      --button-background-color: var(--vote-color-neutral);
    }
    .placeholder {
      display: inline-block;
      width: 42px;
      height: 1px;
    }
    .placeholder::before {
      content: ' ';
    }
    .selectedValueCell {
      color: var(--deemphasized-text-color);
      font-style: italic;
    }
    .selectedValueCell.hidden {
      display: none;
    }
    @media only screen and (max-width: 50em) {
      .selectedValueCell {
        display: none;
      }
    }
  </style>
  <span class="labelNameCell" id="labelName" aria-hidden="true"
    >[[label.name]]</span
  >
  <div class="buttonsCell">
    <template
      is="dom-repeat"
      items="[[_computeBlankItems(permittedLabels, label.name, 'start')]]"
      as="value"
    >
      <span class="placeholder" data-label$="[[label.name]]"></span>
    </template>
    <iron-selector
      id="labelSelector"
      attr-for-selected="data-value"
      selected="[[_computeLabelValue(labels, permittedLabels, label)]]"
      hidden$="[[!_computeAnyPermittedLabelValues(permittedLabels, label.name)]]"
      on-selected-item-changed="_setSelectedValueText"
      role="radiogroup"
      aria-labelledby="labelName"
    >
      <template is="dom-repeat" items="[[_items]]" as="value">
        <gr-button
          role="radio"
          vote$="[[_computeVoteAttribute(value, index, _items.length)]]"
          has-tooltip=""
          data-name$="[[label.name]]"
          data-value$="[[value]]"
          title$="[[_computeLabelValueTitle(labels, label.name, value)]]"
        >
          [[value]]</gr-button
        >
      </template>
    </iron-selector>
    <template
      is="dom-repeat"
      items="[[_computeBlankItems(permittedLabels, label.name, 'end')]]"
      as="value"
    >
      <span class="placeholder" data-label$="[[label.name]]"></span>
    </template>
    <span
      class="labelMessage"
      hidden$="[[_computeAnyPermittedLabelValues(permittedLabels, label.name)]]"
    >
      You don't have permission to edit this label.
    </span>
  </div>
  <div
    class$="selectedValueCell [[_computeHiddenClass(permittedLabels, label.name)]]"
  >
    <span id="selectedValueLabel">[[_selectedValueText]]</span>
  </div>
`;var vR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let yR=class extends fi{constructor(){super(...arguments),this._selectedValueText="No value selected"}static get template(){return _R}get selectedItem(){if(this._ironSelector)return this._ironSelector.selectedItem}get selectedValue(){if(this._ironSelector)return this._ironSelector.selected}setSelectedValue(e){this._ironSelector&&this._ironSelector.select(e)}get _ironSelector(){return this.$&&this.$.labelSelector}_computeBlankItems(e,t,i){if(!(e&&e[t]&&e[t].length&&this.labelValues&&Object.keys(this.labelValues).length))return[];const n=this.labelValues[Number(e[t][0])];if("start"===i)return new Array(n);const o=this.labelValues[Number(e[t][e[t].length-1])];return new Array(Object.keys(this.labelValues).length-o-1)}_getLabelValue(e,t,i){return i.value?i.value:o(e[i.name],"default_value")&&o(t,i.name)?t[i.name].find(t=>Number(t)===e[i.name].default_value):void 0}_computeVoteAttribute(e,t,i){return e<0&&0===t?"min":e<0?"negative":e>0&&t===i-1?"max":e>0?"positive":"neutral"}_computeLabelValue(e,t,i){if(void 0===e||void 0===t||void 0===i)return null;if(!e[i.name])return null;const n=this._getLabelValue(e,t,i),o=t[i.name]?t[i.name].length:0;for(let e=0;e<o;e++){const o=t[i.name][e];if(o===n)return o}return null}_setSelectedValueText(e){const t=e.target.selectedItem;if(!t)return;if(!this.$.labelSelector.items)return;for(const e of this.$.labelSelector.items)t===e?e.setAttribute("aria-checked","true"):e.removeAttribute("aria-checked");this._selectedValueText=t.getAttribute("title")||"",this.updateStyles();const i=t.dataset.name,n=t.dataset.value;this.dispatchEvent(new CustomEvent("labels-changed",{detail:{name:i,value:n},bubbles:!0,composed:!0}))}_computeAnyPermittedLabelValues(e,t){return e&&o(e,t)&&e[t].length}_computeHiddenClass(e,t){return this._computeAnyPermittedLabelValues(e,t)?"":"hidden"}_computePermittedLabelValues(e,t){return void 0===e||void 0===t?[]:e[t]||[]}_computeLabelValueTitle(e,t,i){return e[t]&&e[t].values&&e[t].values[i]}};vR([Oo({type:Object})],yR.prototype,"label",void 0),vR([Oo({type:Object})],yR.prototype,"labels",void 0),vR([Oo({type:String,reflectToAttribute:!0})],yR.prototype,"name",void 0),vR([Oo({type:Object})],yR.prototype,"permittedLabels",void 0),vR([Oo({type:Object})],yR.prototype,"labelValues",void 0),vR([Oo({type:String})],yR.prototype,"_selectedValueText",void 0),vR([Oo({computed:"_computePermittedLabelValues(permittedLabels, label.name)",type:Array})],yR.prototype,"_items",void 0),yR=vR([Po("gr-label-score-row")],yR);const bR=mi`
  <style include="shared-styles">
    .scoresTable {
      display: table;
      width: 100%;
    }
    .mergedMessage {
      font-style: italic;
      text-align: center;
      width: 100%;
    }
    gr-label-score-row:hover {
      background-color: var(--hover-background-color);
    }
    gr-label-score-row {
      display: table-row;
    }
    gr-label-score-row.no-access {
      display: none;
    }
  </style>
  <div class="scoresTable">
    <template is="dom-repeat" items="[[_labels]]" as="label">
      <gr-label-score-row
        class$="[[_computeLabelAccessClass(label.name, permittedLabels)]]"
        label="[[label]]"
        name="[[label.name]]"
        labels="[[change.labels]]"
        permitted-labels="[[permittedLabels]]"
        label-values="[[_labelValues]]"
      ></gr-label-score-row>
    </template>
  </div>
  <div class="mergedMessage" hidden$="[[!_changeIsMerged(change.status)]]">
    Because this change has been merged, votes may not be decreased.
  </div>
`;var wR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let CR=class extends fi{constructor(){super(...arguments),this._labels=[],this.reporting=i.reportingService}static get template(){return bR}getLabelValues(e=!0){var t;const i={};if(null===this.shadowRoot||!this.change)return i;for(const n of Object.keys(null!==(t=this.permittedLabels)&&void 0!==t?t:{})){const t=this.shadowRoot.querySelector(`gr-label-score-row[name="${n}"]`);if(!(null==t?void 0:t.selectedItem))continue;const o="string"==typeof t.selectedValue?Number(t.selectedValue):t.selectedValue;if(void 0===o)continue;const r=this._getDefaultValue(this.change.labels,n);(e||o!==r)&&(i[n]=o)}return i}_getStringLabelValue(e,t,i){const n=e[t];if(n.values)for(const e of Object.keys(n.values))if(Number(e)===i)return e;const o=`${i}`;return this.reporting.reportExecution(h.REACHABLE_CODE,{value:o,id:"label-value-not-found"}),o}_getDefaultValue(e,t){if(!t||!(null==e?void 0:e[t]))return;return e[t].default_value}_getVoteForAccount(e,t,i){if(!e)return null;const n=e[t];if(n.all&&n.all.length>0)for(let o=0;o<n.all.length;o++)if(i&&n.all[o]._account_id==i._account_id)return this._getStringLabelValue(e,t,n.all[o].value);return null}_computeLabels(e,t){if(!t)return[];if(!(null==e?void 0:e.base))return[];const i=e.base;return Object.keys(i).sort(cA).map(e=>({name:e,value:this._getVoteForAccount(i,e,this.account)}))}_computeColumns(e){if(!e)return;const t=Object.keys(e),i=new Set;for(const n of t)for(const t of e[n])i.add(Number(t));const n=Array.from(i.values()).sort((e,t)=>e-t),o={};for(let e=0;e<n.length;e++)o[n[e]]=e;this._labelValues=o}_changeIsMerged(e){return"MERGED"===e}_computeLabelAccessClass(e,t){return t&&e?o(t,e)&&t[e].length?"access":"no-access":""}};wR([Oo({type:Array,computed:"_computeLabels(change.labels.*, account)"})],CR.prototype,"_labels",void 0),wR([Oo({type:Object,observer:"_computeColumns"})],CR.prototype,"permittedLabels",void 0),wR([Oo({type:Object})],CR.prototype,"change",void 0),wR([Oo({type:Object})],CR.prototype,"account",void 0),wR([Oo({type:Object})],CR.prototype,"_labelValues",void 0),CR=wR([Po("gr-label-scores")],CR);const SR=mi`
  <style include="shared-styles">
    :host {
      background-color: var(--dialog-background-color);
      display: block;
      max-height: 90vh;
    }
    :host([disabled]) {
      pointer-events: none;
    }
    :host([disabled]) .container {
      opacity: 0.5;
    }
    .container {
      display: flex;
      flex-direction: column;
      max-height: 100%;
    }
    section {
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
      padding: var(--spacing-m) var(--spacing-xl);
      width: 100%;
    }
    section.labelsContainer {
      /* We want the :hover highlight to extend to the border of the dialog. */
      padding: var(--spacing-m) 0;
    }
    .stickyBottom {
      background-color: var(--dialog-background-color);
      box-shadow: 0px 0px 8px 0px rgba(60, 64, 67, 0.15);
      margin-top: var(--spacing-s);
      bottom: 0;
      position: sticky;
      /* @see Issue 8602 */
      z-index: 1;
    }
    .actions {
      display: flex;
      justify-content: space-between;
    }
    .actions .right gr-button {
      margin-left: var(--spacing-l);
    }
    .peopleContainer,
    .labelsContainer {
      flex-shrink: 0;
    }
    .peopleContainer {
      border-top: none;
      display: table;
    }
    .peopleList {
      display: flex;
    }
    .peopleListLabel {
      color: var(--deemphasized-text-color);
      margin-top: var(--spacing-xs);
      min-width: 6em;
      padding-right: var(--spacing-m);
    }
    gr-account-list {
      display: flex;
      flex-wrap: wrap;
      flex: 1;
    }
    #reviewerConfirmationOverlay {
      padding: var(--spacing-l);
      text-align: center;
    }
    .reviewerConfirmationButtons {
      margin-top: var(--spacing-l);
    }
    .groupName {
      font-weight: var(--font-weight-bold);
    }
    .groupSize {
      font-style: italic;
    }
    .textareaContainer {
      min-height: 12em;
      position: relative;
    }
    .textareaContainer,
    #textarea,
    gr-endpoint-decorator[name='reply-text'] {
      display: flex;
      width: 100%;
    }
    gr-endpoint-decorator[name='reply-text'] {
      flex-direction: column;
    }
    #textarea {
      flex: 1;
    }
    .previewContainer gr-formatted-text {
      background: var(--table-header-background-color);
      padding: var(--spacing-l);
    }
    #checkingStatusLabel,
    #notLatestLabel {
      margin-left: var(--spacing-l);
    }
    #checkingStatusLabel {
      color: var(--deemphasized-text-color);
      font-style: italic;
    }
    #notLatestLabel,
    #savingLabel {
      color: var(--error-text-color);
    }
    #savingLabel {
      display: none;
    }
    #savingLabel.saving {
      display: inline;
    }
    #pluginMessage {
      color: var(--deemphasized-text-color);
      margin-left: var(--spacing-l);
      margin-bottom: var(--spacing-m);
    }
    #pluginMessage:empty {
      display: none;
    }
    .preview-formatting {
      margin-left: var(--spacing-m);
    }
    .attention-icon {
      width: 14px;
      height: 14px;
      vertical-align: top;
      position: relative;
      top: 3px;
      --iron-icon-height: 24px;
      --iron-icon-width: 24px;
    }
    .attention .edit-attention-button {
      vertical-align: top;
      --padding: 0px 4px;
    }
    .attention .edit-attention-button iron-icon {
      color: inherit;
    }
    .attention a,
    .attention-detail a {
      text-decoration: none;
    }
    .attentionSummary {
      display: flex;
      justify-content: space-between;
    }
    .attentionSummary {
      /* The account label for selection is misbehaving currently: It consumes
         26px height instead of 20px, which is the default line-height and thus
         the max that can be nicely fit into an inline layout flow. We
         acknowledge that using a fixed 26px value here is a hack and not a
         great solution. */
      line-height: 26px;
    }
    .attentionSummary gr-account-label,
    .attention-detail gr-account-label {
      --account-max-length: 120px;
      display: inline-block;
      padding: var(--spacing-xs) var(--spacing-m);
      user-select: none;
      --label-border-radius: 8px;
    }
    .attentionSummary gr-account-label {
      margin: 0 var(--spacing-xs);
      line-height: var(--line-height-normal);
      vertical-align: top;
    }
    .attention-detail .peopleListValues {
      line-height: calc(var(--line-height-normal) + 10px);
    }
    .attention-detail gr-account-label {
      line-height: var(--line-height-normal);
    }
    .attentionSummary gr-account-label:focus,
    .attention-detail gr-account-label:focus {
      outline: none;
    }
    .attentionSummary gr-account-label:hover,
    .attention-detail gr-account-label:hover {
      box-shadow: var(--elevation-level-1);
      cursor: pointer;
    }
    .attention-detail .attentionDetailsTitle {
      display: flex;
      justify-content: space-between;
    }
    .attention-detail .selectUsers {
      color: var(--deemphasized-text-color);
      margin-bottom: var(--spacing-m);
    }
    .attentionTip {
      padding: var(--spacing-m);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      margin-top: var(--spacing-m);
      background-color: var(--assignee-highlight-color);
    }
    .attentionTip div iron-icon {
      margin-right: var(--spacing-s);
    }
  </style>
  <div class="container" tabindex="-1">
    <section class="peopleContainer">
      <gr-endpoint-decorator name="reply-reviewers">
        <gr-endpoint-param name="change" value="[[change]]"></gr-endpoint-param>
        <gr-endpoint-param name="reviewers" value="[[_allReviewers]]">
        </gr-endpoint-param>
        <div class="peopleList">
          <div class="peopleListLabel">Reviewers</div>
          <gr-account-list
            id="reviewers"
            accounts="{{_reviewers}}"
            removable-values="[[change.removable_reviewers]]"
            filter="[[filterReviewerSuggestion]]"
            pending-confirmation="{{_reviewerPendingConfirmation}}"
            placeholder="Add reviewer..."
            on-account-text-changed="_handleAccountTextEntry"
            suggestions-provider="[[_getReviewerSuggestionsProvider(change)]]"
          >
          </gr-account-list>
          <gr-endpoint-slot name="right"></gr-endpoint-slot>
        </div>
        <gr-endpoint-slot name="below"></gr-endpoint-slot>
      </gr-endpoint-decorator>
      <div class="peopleList">
        <div class="peopleListLabel">CC</div>
        <gr-account-list
          id="ccs"
          accounts="{{_ccs}}"
          filter="[[filterCCSuggestion]]"
          pending-confirmation="{{_ccPendingConfirmation}}"
          allow-any-input=""
          placeholder="Add CC..."
          on-account-text-changed="_handleAccountTextEntry"
          suggestions-provider="[[_getCcSuggestionsProvider(change)]]"
        >
        </gr-account-list>
      </div>
      <gr-overlay
        id="reviewerConfirmationOverlay"
        on-iron-overlay-canceled="_cancelPendingReviewer"
      >
        <div class="reviewerConfirmation">
          Group
          <span class="groupName">
            [[_pendingConfirmationDetails.group.name]]
          </span>
          has
          <span class="groupSize"> [[_pendingConfirmationDetails.count]] </span>
          members.
          <br />
          Are you sure you want to add them all?
        </div>
        <div class="reviewerConfirmationButtons">
          <gr-button on-click="_confirmPendingReviewer">Yes</gr-button>
          <gr-button on-click="_cancelPendingReviewer">No</gr-button>
        </div>
      </gr-overlay>
    </section>
    <section class="textareaContainer">
      <gr-endpoint-decorator name="reply-text">
        <gr-textarea
          id="textarea"
          class="message"
          autocomplete="on"
          placeholder="[[_messagePlaceholder]]"
          fixed-position-dropdown=""
          hide-border="true"
          monospace="true"
          disabled="{{disabled}}"
          rows="4"
          text="{{draft}}"
          on-bind-value-changed="_handleHeightChanged"
        >
        </gr-textarea>
      </gr-endpoint-decorator>
    </section>
    <section class="previewContainer">
      <label>
        <input
          id="resolvedPatchsetLevelCommentCheckbox"
          type="checkbox"
          checked="{{_isResolvedPatchsetLevelComment::change}}"
        />
        Resolved
      </label>
      <label class="preview-formatting">
        <input type="checkbox" checked="{{_previewFormatting::change}}" />
        Preview formatting
      </label>
      <gr-formatted-text
        content="[[draft]]"
        hidden$="[[!_previewFormatting]]"
        config="[[projectConfig.commentlinks]]"
      ></gr-formatted-text>
    </section>
    <section class="labelsContainer">
      <gr-endpoint-decorator name="reply-label-scores">
        <gr-label-scores
          id="labelScores"
          account="[[_account]]"
          change="[[change]]"
          on-labels-changed="_handleLabelsChanged"
          permitted-labels="[[permittedLabels]]"
        ></gr-label-scores>
      </gr-endpoint-decorator>
      <div id="pluginMessage">[[_pluginMessage]]</div>
    </section>
    <section
      class="draftsContainer"
      hidden$="[[_computeHideDraftList(draftCommentThreads)]]"
    >
      <div class="includeComments">
        <input
          type="checkbox"
          id="includeComments"
          checked="{{_includeComments::change}}"
        />
        <label for="includeComments"
          >Publish [[_computeDraftsTitle(draftCommentThreads)]]</label
        >
      </div>
      <gr-thread-list
        id="commentList"
        hidden$="[[!_includeComments]]"
        threads="[[draftCommentThreads]]"
        change="[[change]]"
        change-num="[[change._number]]"
        logged-in="true"
        hide-toggle-buttons=""
      >
      </gr-thread-list>
      <span
        id="savingLabel"
        class$="[[_computeSavingLabelClass(_savingComments)]]"
      >
        Saving comments...
      </span>
    </section>
    <div class="stickyBottom">
      <section
        hidden$="[[!_showAttentionSummary(serverConfig, _attentionExpanded)]]"
        class="attention"
      >
        <div class="attentionSummary">
          <div>
            <template
              is="dom-if"
              if="[[_computeShowNoAttentionUpdate(serverConfig, _currentAttentionSet, _newAttentionSet, _sendDisabled)]]"
            >
              <span
                >[[_computeDoNotUpdateMessage(_currentAttentionSet,
                _newAttentionSet, _sendDisabled)]]</span
              >
            </template>
            <template
              is="dom-if"
              if="[[!_computeShowNoAttentionUpdate(serverConfig, _currentAttentionSet, _newAttentionSet, _sendDisabled)]]"
            >
              <span>Bring to attention of</span>
              <template
                is="dom-repeat"
                items="[[_computeNewAttentionAccounts(serverConfig, _currentAttentionSet, _newAttentionSet)]]"
                as="account"
              >
                <gr-account-label
                  account="[[account]]"
                  force-attention="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                  selected="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                  deselected="[[!_computeHasNewAttention(account, _newAttentionSet)]]"
                  hide-hovercard=""
                  on-click="_handleAttentionClick"
                ></gr-account-label>
              </template>
            </template>
            <gr-button
              class="edit-attention-button"
              on-click="_handleAttentionModify"
              disabled="[[_sendDisabled]]"
              link=""
              position-below=""
              data-label="Edit"
              data-action-type="change"
              data-action-key="edit"
              has-tooltip=""
              title="[[_computeAttentionButtonTitle(_sendDisabled)]]"
              role="button"
              tabindex="0"
            >
              <iron-icon icon="gr-icons:edit"></iron-icon>
              Modify
            </gr-button>
          </div>
          <div>
            <a
              href="https://gerrit-review.googlesource.com/Documentation/user-attention-set.html"
              target="_blank"
            >
              <iron-icon
                icon="gr-icons:help-outline"
                title="read documentation"
              ></iron-icon>
            </a>
          </div>
        </div>
      </section>
      <section
        hidden$="[[!_showAttentionDetails(serverConfig, _attentionExpanded)]]"
        class="attention-detail"
      >
        <div class="attentionDetailsTitle">
          <div>
            <span>Modify attention to</span>
          </div>
          <div></div>
          <div>
            <a
              href="https://gerrit-review.googlesource.com/Documentation/user-attention-set.html"
              target="_blank"
            >
              <iron-icon
                icon="gr-icons:help-outline"
                title="read documentation"
              ></iron-icon>
            </a>
          </div>
        </div>
        <div class="selectUsers">
          <span
            >Select chips to set who will be in the attention set after sending
            this reply</span
          >
        </div>
        <div class="peopleList">
          <div class="peopleListLabel">Owner</div>
          <div class="peopleListValues">
            <gr-account-label
              account="[[_owner]]"
              force-attention="[[_computeHasNewAttention(_owner, _newAttentionSet)]]"
              selected="[[_computeHasNewAttention(_owner, _newAttentionSet)]]"
              deselected="[[!_computeHasNewAttention(_owner, _newAttentionSet)]]"
              hide-hovercard=""
              on-click="_handleAttentionClick"
            >
            </gr-account-label>
          </div>
        </div>
        <template is="dom-if" if="[[_uploader]]">
          <div class="peopleList">
            <div class="peopleListLabel">Uploader</div>
            <div class="peopleListValues">
              <gr-account-label
                account="[[_uploader]]"
                force-attention="[[_computeHasNewAttention(_uploader, _newAttentionSet)]]"
                selected="[[_computeHasNewAttention(_uploader, _newAttentionSet)]]"
                deselected="[[!_computeHasNewAttention(_uploader, _newAttentionSet)]]"
                hide-hovercard=""
                on-click="_handleAttentionClick"
              >
              </gr-account-label>
            </div>
          </div>
        </template>
        <div class="peopleList">
          <div class="peopleListLabel">Reviewers</div>
          <div class="peopleListValues">
            <template
              is="dom-repeat"
              items="[[_removeServiceUsers(_reviewers, _newAttentionSet)]]"
              as="account"
            >
              <gr-account-label
                account="[[account]]"
                force-attention="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                selected="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                deselected="[[!_computeHasNewAttention(account, _newAttentionSet)]]"
                hide-hovercard=""
                on-click="_handleAttentionClick"
              >
              </gr-account-label>
            </template>
          </div>
        </div>
        <template is="dom-if" if="[[_attentionCcsCount]]">
          <div class="peopleList">
            <div class="peopleListLabel">CC</div>
            <div class="peopleListValues">
              <template
                is="dom-repeat"
                items="[[_removeServiceUsers(_ccs, _newAttentionSet)]]"
                as="account"
              >
                <gr-account-label
                  account="[[account]]"
                  force-attention="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                  selected="[[_computeHasNewAttention(account, _newAttentionSet)]]"
                  deselected="[[!_computeHasNewAttention(account, _newAttentionSet)]]"
                  hide-hovercard=""
                  on-click="_handleAttentionClick"
                >
                </gr-account-label>
              </template>
            </div>
          </div>
        </template>
        <template
          is="dom-if"
          if="[[_computeShowAttentionTip(_account, _owner, _currentAttentionSet, _newAttentionSet)]]"
        >
          <div class="attentionTip">
            <iron-icon
              class="pointer"
              icon="gr-icons:lightbulb-outline"
            ></iron-icon>
            Be mindful of requiring attention from too many users.
          </div>
        </template>
      </section>
      <section class="actions">
        <div class="left">
          <span
            id="checkingStatusLabel"
            hidden$="[[!_isState(knownLatestState, 'checking')]]"
          >
            Checking whether patch [[patchNum]] is latest...
          </span>
          <span
            id="notLatestLabel"
            hidden$="[[!_isState(knownLatestState, 'not-latest')]]"
          >
            [[_computePatchSetWarning(patchNum, _labelsChanged)]]
            <gr-button link="" on-click="_reload">Reload</gr-button>
          </span>
        </div>
        <div class="right">
          <gr-button
            link=""
            id="cancelButton"
            class="action cancel"
            on-click="_cancelTapHandler"
            >Cancel</gr-button
          >
          <template is="dom-if" if="[[canBeStarted]]">
            <!-- Use 'Send' here as the change may only about reviewers / ccs
                and when this button is visible, the next button will always
                be 'Start review' -->
            <gr-button
              link=""
              disabled="[[_isState(knownLatestState, 'not-latest')]]"
              class="action save"
              has-tooltip=""
              title="[[_saveTooltip]]"
              on-click="_saveClickHandler"
              >Send As WIP</gr-button
            >
          </template>
          <gr-button
            id="sendButton"
            primary=""
            disabled="[[_sendDisabled]]"
            class="action send"
            has-tooltip=""
            title$="[[_computeSendButtonTooltip(canBeStarted, _commentEditing)]]"
            on-click="_sendTapHandler"
            >[[_sendButtonLabel]]</gr-button
          >
        </div>
      </section>
    </div>
  </div>
`;var ER=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};var AR,xR,RR;!function(e){e.ANY="any",e.BODY="body",e.CCS="cc",e.REVIEWERS="reviewers"}(AR||(AR={})),function(e){e.REVIEWER="REVIEWER",e.CC="CC"}(xR||(xR={})),function(e){e.LATEST="latest",e.CHECKING="checking",e.NOT_LATEST="not-latest"}(RR||(RR={}));const TR="Start review",kR="Send",PR="Send changes and comments as work in progress but do not start review",IR="Mark as ready for review and send reply",OR="Send reply",NR="Save draft comments to enable send",LR=[xR.CC,xR.REVIEWER];let DR=class extends(Kf(fi)){constructor(){super(),this.FocusTarget=AR,this.reporting=i.reportingService,this.flagsService=i.flagsService,this.canBeStarted=!1,this.disabled=!1,this.hasDrafts=!1,this.draft="",this.quote="",this.underReview=!0,this._ccs=[],this._attentionCcsCount=0,this._ccPendingConfirmation=null,this._pendingConfirmationDetails=null,this._includeComments=!0,this._reviewers=[],this._reviewerPendingConfirmation=null,this._previewFormatting=!1,this._reviewersPendingRemove={CC:[],REVIEWER:[]},this._savingComments=!1,this._reviewersMutated=!1,this._labelsChanged=!1,this._saveTooltip=PR,this._pluginMessage="",this._commentEditing=!1,this._attentionExpanded=!1,this._currentAttentionSet=new Set,this._newAttentionSet=new Set,this._isResolvedPatchsetLevelComment=!0,this._allReviewers=[],this.restApiService=i.restApiService,this.storage=i.storageService,this.jsAPI=i.jsApiService,this.filterReviewerSuggestion=this._filterReviewerSuggestionGenerator(!1),this.filterCCSuggestion=this._filterReviewerSuggestionGenerator(!0)}static get template(){return SR}get keyBindings(){return{esc:"_handleEscKey","ctrl+enter meta+enter":"_handleEnterKey"}}connectedCallback(){super.connectedCallback(),T_.requestAvailability(),this._getAccount().then(e=>{e&&(this._account=e)}),this.addEventListener("comment-editing-changed",e=>{this._commentEditing=e.detail}),this.addEventListener("add-reviewer",e=>{this.$.reviewers.addAccountItem({account:e.detail.reviewer})}),this.addEventListener("remove-reviewer",e=>{this.$.reviewers.removeAccount(e.detail.reviewer)})}ready(){super.ready(),this.jsAPI.addElement(Ma.REPLY_DIALOG,this)}disconnectedCallback(){var e;null===(e=this.storeTask)||void 0===e||e.cancel(),super.disconnectedCallback()}open(e){a(this.change,"change"),this.knownLatestState=RR.CHECKING,Qn(this.change,this.restApiService).then(e=>{this.knownLatestState=e.isLatest?RR.LATEST:RR.NOT_LATEST}),this._focusOn(e),this.quote&&this.quote.length?(this.draft=this.quote,this.quote=""):this.draft=this._loadStoredDraft(),this.restApiService.hasPendingDiffDrafts()&&(this._savingComments=!0,this.restApiService.awaitPendingDiffDrafts().then(()=>{bi(this,"comment-refresh"),this._savingComments=!1}))}_computeHasDrafts(e,t){return void 0!==t.base&&(e.length>0||t.base.length>0)}focus(){this._focusOn(AR.ANY)}getFocusStops(){const e=this._sendDisabled?this.$.cancelButton:this.$.sendButton;return{start:this.$.reviewers.focusStart,end:e}}setLabelValue(e,t){var i;const n=null===(i=this.$.labelScores.shadowRoot)||void 0===i?void 0:i.querySelector(`gr-label-score-row[name="${e}"]`);n&&n.setSelectedValue(t)}getLabelValue(e){var t;const i=null===(t=this.$.labelScores.shadowRoot)||void 0===t?void 0:t.querySelector(`gr-label-score-row[name="${e}"]`);return i?i.selectedValue:null}_handleEscKey(){this.cancel()}_handleEnterKey(){this._submit()}_ccsChanged(e){this._reviewerTypeChanged(e,xR.CC)}_reviewersChanged(e){this._reviewerTypeChanged(e,xR.REVIEWER)}_reviewerTypeChanged(e,t){if(e&&e.indexSplices){let i,n,o;this._reviewersMutated=!0,this._processReviewerChange(e.indexSplices,t);const r=xR.REVIEWER===t;for(const t of e.indexSplices)for(let e=0;e<t.addedCount;e++){if(o=t.object[t.index+e],i=this._accountOrGroupKey(o),n=(r?this._ccs:this._reviewers).findIndex(e=>this._accountOrGroupKey(e)===i),n>=0){this.splice(r?"_ccs":"_reviewers",n,1);const e=r?"CC":"reviewer",t=r?"reviewer":"CC";Ci(this,`${o.name||o.email||i} moved from ${e} to ${t}.`)}}}}_processReviewerChange(e,t){for(const i of e)for(const e of i.removed){if(!this._reviewersPendingRemove[t])return void this.reporting.error(new Error(`Invalid type ${t} for reviewer.`));this._reviewersPendingRemove[t].push(e)}}_purgeReviewersPendingRemove(e,t=new Map){let i;for(const n of LR){if(!e){i=this._reviewersPendingRemove[n];for(let e=0;e<i.length;e++){const o=i[e];$n(o)&&t.get(kn(o))||this._removeAccount(o,n)}}this._reviewersPendingRemove[n]=[]}}_removeAccount(e,t){if(a(this.change,"change"),!e._pendingAdd&&$n(e))return this.restApiService.removeChangeReviewer(this.change._number,kn(e)).then(i=>{if(!(null==i?void 0:i.ok)||!this.change)return;const n=this.change.reviewers[t]||[];for(let i=0;i<n.length;i++)if(n[i]._account_id===e._account_id){this.splice(`change.reviewers.${t}`,i,1);break}})}_mapReviewer(e){if(e.account)return{reviewer:kn(e.account)};if(e.group){return{reviewer:decodeURIComponent(e.group.id),confirmed:e.group.confirmed}}throw new Error("Reviewer must be either an account or a group.")}send(e,t){this.reporting.time(p.SEND_REPLY);const i=this.$.labelScores.getLabelValues(),n={drafts:e?Sn.PUBLISH_ALL_REVISIONS:Sn.KEEP,labels:i};if(t&&(n.ready=!0),Sv(this.serverConfig)){const e=`${yv(this.serverConfig,this._account)} replied on the change`;n.ignore_automatic_attention_set_rules=!0,n.add_to_attention_set=[];for(const t of this._newAttentionSet)this._currentAttentionSet.has(t)||n.add_to_attention_set.push({user:t,reason:e});n.remove_from_attention_set=[];for(const t of this._currentAttentionSet)this._newAttentionSet.has(t)||n.remove_from_attention_set.push({user:t,reason:e});this.reportAttentionSetChanges(this._attentionExpanded,n.add_to_attention_set,n.remove_from_attention_set)}if(this.draft){const e={message:this.draft,unresolved:!this._isResolvedPatchsetLevelComment};n.comments={[Zi.PATCHSET_LEVEL_COMMENTS]:[e]}}const o=new Map;n.reviewers=this.$.reviewers.additions().map(e=>(e.account&&o.set(kn(e.account),!0),this._mapReviewer(e)));const r=this.$.ccs;if(r)for(const e of r.additions()){e.account&&o.set(kn(e.account),!0);const t=this._mapReviewer(e);t.state=en.CC,n.reviewers.push(t)}this.disabled=!0;return this._saveReview(n,e=>this._handle400Error(e)).then(e=>e?e.ok?(this.draft="",this._includeComments=!0,this.dispatchEvent(new CustomEvent("send",{composed:!0,bubbles:!1})),Ti(this,"Reply sent"),o):(Ei(e),new Map):new Map).then(e=>(this.disabled=!1,e)).catch(e=>{throw this.disabled=!1,e})}_focusOn(e){if(e&&e!==AR.ANY||(e=this._chooseFocusTarget()),e===AR.BODY){const e=this.$.textarea;setTimeout(()=>e.getNativeTextarea().focus())}else if(e===AR.REVIEWERS){const e=this.$.reviewers.focusStart;setTimeout(()=>e.focus())}else if(e===AR.CCS){const e=this.$.ccs.focusStart;setTimeout(()=>e.focus())}}_chooseFocusTarget(){return this._account&&this.change&&this.change.owner&&this._account._account_id===this.change.owner._account_id&&(!this._reviewers||0===this._reviewers.length)?AR.REVIEWERS:AR.BODY}_isOwner(e,t){return!!(e&&t&&t.owner)&&e._account_id===t.owner._account_id}_handle400Error(e){if(!e)throw new Error("Response is empty.");let t=e;return this.disabled=!1,this.restApiService.getResponseObject(t.clone()).then(e=>{const i=e;if(400===t.status&&i&&i.reviewers){const e=[];Object.values(i.reviewers).forEach(t=>{var i;return e.push(null!==(i=t.error)&&void 0!==i?i:"no explanation")}),t={...t,ok:!1,text:()=>Promise.resolve(e.join(", "))}}Ei(t)})}_computeHideDraftList(e){return!e||0===e.length}_computeDraftsTitle(e){return Jb(e?e.length:0,"Draft")}_computeMessagePlaceholder(e){return e?"Add a note for your reviewers...":"Say something nice..."}_changeUpdated(e,t){void 0!==e&&void 0!==t&&this._rebuildReviewerArrays(e.base,t)}_rebuildReviewerArrays(e,t){this._owner=t;const i=[],n=[];if(e)for(const o of Object.keys(e))if("REVIEWER"===o||"CC"===o){if(e[o])for(const r of e[o])if(r._account_id!==t._account_id)switch(o){case"REVIEWER":i.push(r);break;case"CC":n.push(r)}}else console.warn("unexpected reviewer state:",o);this._ccs=n,this._reviewers=i}_handleAttentionModify(){this._attentionExpanded=!0}_onAttentionExpandedChange(){bi(this,"iron-resize")}_showAttentionSummary(e,t){return Sv(e)&&!t}_showAttentionDetails(e,t){return Sv(e)&&t}_computeAttentionButtonTitle(e){return e?"Modify the attention set by adding a comment or use the account hovercard in the change page.":"Edit attention set changes"}_handleAttentionClick(e){var t,i;const n=null===(i=null===(t=e.target)||void 0===t?void 0:t.account)||void 0===i?void 0:i._account_id;if(!n)return;const o=n===(this._account&&this._account._account_id||-1)?"_SELF":"",r=n===(this.change&&this.change.owner&&this.change.owner._account_id||-1)?"_OWNER":"_REVIEWER";this._newAttentionSet.has(n)?(this._newAttentionSet.delete(n),this.reporting.reportInteraction("attention-set-chip",{action:`REMOVE${o}${r}`})):(this._newAttentionSet.add(n),this.reporting.reportInteraction("attention-set-chip",{action:`ADD${o}${r}`})),this._newAttentionSet=new Set(this._newAttentionSet)}_computeHasNewAttention(e,t){return t&&e&&e._account_id&&t.has(e._account_id)}_computeNewAttention(e,t,i,n,o,r,s,a){var l,c,d;if(void 0===e||void 0===e._account_id||void 0===t||void 0===i||void 0===n||void 0===o||void 0===r)return;o=r?o:[];const h=!!s,p=this._isOwner(e,n),u=(null===(l=this._uploader)||void 0===l?void 0:l._account_id)===e._account_id;this._attentionCcsCount=On(i.base).length,this._currentAttentionSet=new Set(Object.keys(n.attention_set||{}).map(e=>Number(e)));const g=new Set(this._currentAttentionSet);if(n.status===Ji.NEW){this._computeCommentAccounts(o).forEach(e=>g.add(e)),g.delete(e._account_id);const i=t=>!(t._account_id===e._account_id&&(a||h));t.base.filter(e=>e._account_id).filter(e=>e._pendingAdd||this.canBeStarted&&p).filter(i).forEach(e=>g.add(e._account_id)),(a||h)&&((null===(c=this._uploader)||void 0===c?void 0:c._account_id)&&!u&&g.add(this._uploader._account_id),(null===(d=n.owner)||void 0===d?void 0:d._account_id)&&!p&&g.add(n.owner._account_id))}else{const t=o.some(Kw);n.owner&&t&&g.add(n.owner._account_id),g.delete(e._account_id)}const m=this._allAccounts().map(e=>e._account_id).filter(e=>!!e);this._newAttentionSet=new Set([...g].filter(e=>m.includes(e))),this._attentionExpanded=this._computeShowAttentionTip(e,n.owner,this._currentAttentionSet,this._newAttentionSet)}_computeShowAttentionTip(e,t,i,n){if(!(e&&t&&i&&n))return!1;const o=e._account_id===t._account_id,r=[...n].filter(e=>!i.has(e));return o&&r.length>2}_computeCommentAccounts(e){var t,i;const n=function(e){if(!e||!Fn(e)||!e.all)return[];const t=aA(e);return e.all.filter(e=>e.value===t.max)}(null===(i=null===(t=this.change)||void 0===t?void 0:t.labels)||void 0===i?void 0:i["Code-Review"]).map(e=>e._account_id),o=new Set;return e.forEach(e=>{const t=Kw(e);e.comments.forEach(e=>{if(e.author){const i=e.author._account_id,r=n.includes(i);!t&&r||o.add(i)}})}),o}_computeShowNoAttentionUpdate(e,t,i,n){return n||0===this._computeNewAttentionAccounts(e,t,i).length}_computeDoNotUpdateMessage(e,t,i){return e&&t?i||(o=t,(n=e).size===o.size&&l(n,o))?"No changes to the attention set.":l(e,t)?"No additions to the attention set.":(this.reporting.error(new Error("_computeDoNotUpdateMessage()should not be called when users were added to the attention set.")),""):"";var n,o}_computeNewAttentionAccounts(e,t,i){return void 0===t||void 0===i?[]:[...i].filter(e=>!t.has(e)).map(e=>this._findAccountById(e)).filter(e=>!!e)}_findAccountById(e){return this._allAccounts().find(t=>t._account_id===e)}_allAccounts(){let e=[];return this.change&&this.change.owner&&e.push(this.change.owner),this._uploader&&e.push(this._uploader),this._reviewers&&(e=[...e,...this._reviewers]),this._ccs&&(e=[...e,...this._ccs]),On(e.filter($n))}_removeServiceUsers(e,t){return On(e)}_computeUploader(e){if(!(e&&e.current_revision&&e.revisions&&e.revisions[e.current_revision]))return;const t=e.revisions[e.current_revision];return t.uploader&&e.owner._account_id!==t.uploader._account_id?t.uploader:void 0}_accountOrGroupKey(e){return $n(e)?kn(e):void 0!==e.id?e.id:void r(e,"entry must be account or group")}_filterReviewerSuggestionGenerator(e){return t=>{var i;let n;if(Bn(t)){if(n=t.account,n._account_id===(null===(i=this._owner)||void 0===i?void 0:i._account_id))return!1}else{if(!jn(t))return console.warn("received suggestion that was neither account nor group:",t),!1;n=t.group}const o=this._accountOrGroupKey(n),r=e=>this._accountOrGroupKey(e)===o;return e?void 0===this._ccs.find(r):void 0===this._reviewers.find(r)}}_getAccount(){return this.restApiService.getAccount()}_cancelTapHandler(e){e.preventDefault(),this.cancel()}cancel(){if(a(this.change,"change"),!this._owner)throw new Error("missing required _owner property");this.dispatchEvent(new CustomEvent("cancel",{composed:!0,bubbles:!1})),this.$.textarea.closeDropdown(),this._purgeReviewersPendingRemove(!0),this._rebuildReviewerArrays(this.change.reviewers,this._owner)}_saveClickHandler(e){e.preventDefault(),this.$.ccs.submitEntryText()&&this.send(this._includeComments,!1).then(e=>{this._purgeReviewersPendingRemove(!1,e)})}_sendTapHandler(e){e.preventDefault(),this._submit()}_submit(){if(this.$.ccs.submitEntryText()){if(!this._sendDisabled)return this.send(this._includeComments,this.canBeStarted).then(e=>{this._purgeReviewersPendingRemove(!1,e)}).catch(e=>{this.dispatchEvent(new CustomEvent("show-error",{bubbles:!0,composed:!0,detail:{message:`Error submitting review ${e}`}}))});Ci(this,"Cannot send an empty reply.")}}_saveReview(e,t){return a(this.change,"change"),a(this.patchNum,"patchNum"),this.restApiService.saveChangeReview(this.change._number,this.patchNum,e,t)}_reviewerPendingConfirmationUpdated(e){null===e?this.$.reviewerConfirmationOverlay.close():(this._pendingConfirmationDetails=this._ccPendingConfirmation||this._reviewerPendingConfirmation,this.$.reviewerConfirmationOverlay.open())}_confirmPendingReviewer(){return this._ccPendingConfirmation?(this.$.ccs.confirmGroup(this._ccPendingConfirmation.group),void this._focusOn(AR.CCS)):this._reviewerPendingConfirmation?(this.$.reviewers.confirmGroup(this._reviewerPendingConfirmation.group),void this._focusOn(AR.REVIEWERS)):void this.reporting.error(new Error("_confirmPendingReviewer called without pending confirm"))}_cancelPendingReviewer(){this._ccPendingConfirmation=null,this._reviewerPendingConfirmation=null;const e=this._ccPendingConfirmation?AR.CCS:AR.REVIEWERS;this._focusOn(e)}_getStorageLocation(){return a(this.change,"change"),{changeNum:this.change._number,patchNum:"@change",path:"@change"}}_loadStoredDraft(){var e;const t=this.storage.getDraftComment(this._getStorageLocation());return null!==(e=null==t?void 0:t.message)&&void 0!==e?e:""}_handleAccountTextEntry(){this._reviewersMutated=!0}_draftChanged(e,t){this.storeTask=Cu(this.storeTask,()=>{!e.length&&t?this.storage.eraseDraftComment(this._getStorageLocation()):e.length&&this.storage.setDraftComment(this._getStorageLocation(),this.draft)},400)}_handleHeightChanged(){bi(this,"autogrow")}_handleLabelsChanged(){this._labelsChanged=0!==Object.keys(this.$.labelScores.getLabelValues(!1)).length}_isState(e,t){return e===t}_reload(){this.dispatchEvent(new CustomEvent("reload",{detail:{clearPatchset:!0},bubbles:!1,composed:!0})),this.cancel()}_computeSendButtonLabel(e){return e?kR+" and "+TR:kR}_computeSendButtonTooltip(e,t){return t?NR:e?IR:OR}_computeSavingLabelClass(e){return e?"saving":""}_computeSendButtonDisabled(e,t,i,n,o,r,s,a,l,c){if(void 0===e||void 0===t||void 0===i||void 0===n||void 0===o||void 0===r||void 0===s||void 0===a||void 0===(null==l?void 0:l.labels)||void 0===c)return;if(a||s)return!0;if(!0===e)return!1;const d=Object.values(l.labels).some(e=>Fn(e)&&lA(e,c)),h=o||d;return!(r&&t.length||i.length||n||h)}_computePatchSetWarning(e,t){let i=`Patch ${e} is not latest.`;return t&&(i+=" Voting will have no effect."),i}setPluginMessage(e){this._pluginMessage=e}_sendDisabledChanged(){this.dispatchEvent(new CustomEvent("send-disabled-changed"))}_getReviewerSuggestionsProvider(e){const t=vx.create(this.restApiService,e._number,fx.REVIEWER);return t.init(),t}_getCcSuggestionsProvider(e){const t=vx.create(this.restApiService,e._number,fx.CC);return t.init(),t}reportAttentionSetChanges(e,t,i){const n=e?["MODIFIED"]:["NOT_MODIFIED"],o=this.change&&this.change.owner&&this.change.owner._account_id||-1,r=this._account&&this._account._account_id||-1;for(const e of t||[]){const t=e.user,i=t===r?"_SELF":"",s=t===o?"_OWNER":"_REVIEWER";n.push("ADD"+i+s)}for(const e of i||[]){const t=e.user,i=t===r?"_SELF":"",s=t===o?"_OWNER":"_REVIEWER";n.push("REMOVE"+i+s)}this.reporting.reportInteraction("attention-set-actions",{actions:n})}_computeAllReviewers(){return[...this._reviewers]}};ER([Oo({type:Object})],DR.prototype,"change",void 0),ER([Oo({type:String})],DR.prototype,"patchNum",void 0),ER([Oo({type:Boolean})],DR.prototype,"canBeStarted",void 0),ER([Oo({type:Boolean,reflectToAttribute:!0})],DR.prototype,"disabled",void 0),ER([Oo({type:Boolean,computed:"_computeHasDrafts(draft, draftCommentThreads.*)"})],DR.prototype,"hasDrafts",void 0),ER([Oo({type:String,observer:"_draftChanged"})],DR.prototype,"draft",void 0),ER([Oo({type:String})],DR.prototype,"quote",void 0),ER([Oo({type:Object})],DR.prototype,"filterReviewerSuggestion",void 0),ER([Oo({type:Object})],DR.prototype,"filterCCSuggestion",void 0),ER([Oo({type:Object})],DR.prototype,"permittedLabels",void 0),ER([Oo({type:Object})],DR.prototype,"projectConfig",void 0),ER([Oo({type:Object})],DR.prototype,"serverConfig",void 0),ER([Oo({type:String})],DR.prototype,"knownLatestState",void 0),ER([Oo({type:Boolean})],DR.prototype,"underReview",void 0),ER([Oo({type:Object})],DR.prototype,"_account",void 0),ER([Oo({type:Array})],DR.prototype,"_ccs",void 0),ER([Oo({type:Number})],DR.prototype,"_attentionCcsCount",void 0),ER([Oo({type:Object,observer:"_reviewerPendingConfirmationUpdated"})],DR.prototype,"_ccPendingConfirmation",void 0),ER([Oo({type:String,computed:"_computeMessagePlaceholder(canBeStarted)"})],DR.prototype,"_messagePlaceholder",void 0),ER([Oo({type:Object})],DR.prototype,"_owner",void 0),ER([Oo({type:Object,computed:"_computeUploader(change)"})],DR.prototype,"_uploader",void 0),ER([Oo({type:Object})],DR.prototype,"_pendingConfirmationDetails",void 0),ER([Oo({type:Boolean})],DR.prototype,"_includeComments",void 0),ER([Oo({type:Array})],DR.prototype,"_reviewers",void 0),ER([Oo({type:Object,observer:"_reviewerPendingConfirmationUpdated"})],DR.prototype,"_reviewerPendingConfirmation",void 0),ER([Oo({type:Boolean,observer:"_handleHeightChanged"})],DR.prototype,"_previewFormatting",void 0),ER([Oo({type:Object})],DR.prototype,"_reviewersPendingRemove",void 0),ER([Oo({type:String,computed:"_computeSendButtonLabel(canBeStarted)"})],DR.prototype,"_sendButtonLabel",void 0),ER([Oo({type:Boolean})],DR.prototype,"_savingComments",void 0),ER([Oo({type:Boolean})],DR.prototype,"_reviewersMutated",void 0),ER([Oo({type:Boolean})],DR.prototype,"_labelsChanged",void 0),ER([Oo({type:String})],DR.prototype,"_saveTooltip",void 0),ER([Oo({type:String})],DR.prototype,"_pluginMessage",void 0),ER([Oo({type:Boolean})],DR.prototype,"_commentEditing",void 0),ER([Oo({type:Boolean})],DR.prototype,"_attentionExpanded",void 0),ER([Oo({type:Object})],DR.prototype,"_currentAttentionSet",void 0),ER([Oo({type:Object})],DR.prototype,"_newAttentionSet",void 0),ER([Oo({type:Boolean,computed:"_computeSendButtonDisabled(canBeStarted, draftCommentThreads, draft, _reviewersMutated, _labelsChanged, _includeComments, disabled, _commentEditing, change, _account)",observer:"_sendDisabledChanged"})],DR.prototype,"_sendDisabled",void 0),ER([Oo({type:Array,observer:"_handleHeightChanged"})],DR.prototype,"draftCommentThreads",void 0),ER([Oo({type:Boolean})],DR.prototype,"_isResolvedPatchsetLevelComment",void 0),ER([Oo({type:Array,computed:"_computeAllReviewers(_reviewers.*)"})],DR.prototype,"_allReviewers",void 0),ER([No("_ccs.splices")],DR.prototype,"_ccsChanged",null),ER([No("_reviewers.splices")],DR.prototype,"_reviewersChanged",null),ER([No("change.reviewers.*","change.owner")],DR.prototype,"_changeUpdated",null),ER([No("_attentionExpanded")],DR.prototype,"_onAttentionExpandedChange",null),ER([No("_account","_reviewers.*","_ccs.*","change","draftCommentThreads","_includeComments","_labelsChanged","hasDrafts")],DR.prototype,"_computeNewAttention",null),DR=ER([Po("gr-reply-dialog")],DR);const MR=document.createElement("template"),FR=Zl`
  iron-icon.error {
    color: var(--error-foreground);
  }
  iron-icon.warning {
    color: var(--warning-foreground);
  }
  iron-icon.info-outline {
    color: var(--info-foreground);
  }
  iron-icon.check-circle-outline {
    color: var(--success-foreground);
  }
`;MR.innerHTML=`<dom-module id="gr-checks-styles">\n  <template>\n    <style>\n    ${FR.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(MR.content);const $R=mi`
  <style include="gr-checks-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-hovercard-shared-style">
    #container {
      min-width: 356px;
      max-width: 356px;
      padding: var(--spacing-xl) 0 var(--spacing-m) 0;
    }
    .row {
      display: flex;
      margin-top: var(--spacing-s);
    }
    .chipRow {
      display: flex;
      margin-top: var(--spacing-s);
    }
    .chip {
      background: var(--gray-background);
      color: var(--gray-foreground);
      border-radius: 20px;
      padding: var(--spacing-xs) var(--spacing-m) var(--spacing-xs)
        var(--spacing-s);
    }
    .title {
      color: var(--deemphasized-text-color);
      margin-right: var(--spacing-m);
    }
    div.section {
      margin: 0 var(--spacing-xl) var(--spacing-m) var(--spacing-xl);
      display: flex;
    }
    div.sectionIcon {
      flex: 0 0 30px;
    }
    div.chip iron-icon {
      width: 16px;
      height: 16px;
      /* Positioning of a 16px icon in the middle of a 20px line. */
      position: relative;
      top: 2px;
    }
    div.sectionIcon iron-icon {
      position: relative;
      top: 2px;
      width: 20px;
      height: 20px;
    }
    div.sectionIcon iron-icon.small {
      position: relative;
      top: 6px;
      width: 16px;
      height: 16px;
    }
    div.sectionContent iron-icon.link {
      color: var(--link-color);
    }
    div.sectionContent .attemptIcon iron-icon,
    div.sectionContent iron-icon.small {
      width: 16px;
      height: 16px;
      margin-right: var(--spacing-s);
      /* Positioning of a 16px icon in the middle of a 20px line. */
      position: relative;
      top: 2px;
    }
    .attemptNumber {
      margin-right: var(--spacing-s);
      color: var(--deemphasized-text-color);
      text-align: center;
    }
    div.action {
      border-top: 1px solid var(--border-color);
      margin-top: var(--spacing-m);
      padding: var(--spacing-m) var(--spacing-xl) 0;
    }
  </style>
  <div id="container" role="tooltip" tabindex="-1">
    <div class="section">
      <div hidden$="[[hideChip(run)]]" class="chipRow">
        <div class="chip">
          <iron-icon icon="gr-icons:[[computeChipIcon(run)]]"></iron-icon>
          <span>[[run.status]]</span>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="sectionIcon" hidden$="[[hideHeaderSectionIcon(run)]]">
        <iron-icon
          class$="[[computeIcon(run)]]"
          icon="gr-icons:[[computeIcon(run)]]"
        ></iron-icon>
      </div>
      <div class="sectionContent">
        <h3 class="name heading-3">
          <span>[[run.checkName]]</span>
        </h3>
      </div>
    </div>
    <div class="section" hidden$="[[hideStatusSection(run)]]">
      <div class="sectionIcon">
        <iron-icon class="small" icon="gr-icons:info-outline"></iron-icon>
      </div>
      <div class="sectionContent">
        <div hidden$="[[!run.statusLink]]" class="row">
          <div class="title">Status</div>
          <div>
            <a href="[[run.statusLink]]" target="_blank"
              ><iron-icon
                aria-label="external link to check status"
                class="small link"
                icon="gr-icons:launch"
              ></iron-icon
              >[[computeHostName(run.statusLink)]]
            </a>
          </div>
        </div>
        <div hidden$="[[!run.statusDescription]]" class="row">
          <div class="title">Message</div>
          <div>[[run.statusDescription]]</div>
        </div>
      </div>
    </div>
    <div class="section" hidden$="[[hideAttemptSection(run)]]">
      <div class="sectionIcon">
        <iron-icon class="small" icon="gr-icons:schedule"></iron-icon>
      </div>
      <div class="sectionContent">
        <div hidden$="[[hideAttempts(run)]]" class="row">
          <div class="title">Attempt</div>
          <template is="dom-repeat" items="[[run.attemptDetails]]">
            <div>
              <div class="attemptIcon">
                <iron-icon
                  class$="[[item.icon]]"
                  icon="gr-icons:[[item.icon]]"
                ></iron-icon>
              </div>
              <div class="attemptNumber">[[item.attempt]]</div>
            </div>
          </template>
        </div>
        <div hidden$="[[hideScheduled(run)]]" class="row">
          <div class="title">Scheduled</div>
          <div>[[computeDuration(run.scheduledTimestamp)]]</div>
        </div>
        <div hidden$="[[!run.startedTimestamp]]" class="row">
          <div class="title">Started</div>
          <div>[[computeDuration(run.startedTimestamp)]]</div>
        </div>
        <div hidden$="[[!run.finishedTimestamp]]" class="row">
          <div class="title">Ended</div>
          <div>[[computeDuration(run.finishedTimestamp)]]</div>
        </div>
        <div hidden$="[[hideCompletion(run)]]" class="row">
          <div class="title">Completion</div>
          <div>[[computeCompletionDuration(run)]]</div>
        </div>
      </div>
    </div>
    <div class="section" hidden$="[[hideDescriptionSection(run)]]">
      <div class="sectionIcon">
        <iron-icon class="small" icon="gr-icons:link"></iron-icon>
      </div>
      <div class="sectionContent">
        <div hidden$="[[!run.checkDescription]]" class="row">
          <div class="title">Description</div>
          <div>[[run.checkDescription]]</div>
        </div>
        <div hidden$="[[!run.checkLink]]" class="row">
          <div class="title">Documentation</div>
          <div>
            <a href="[[run.checkLink]]" target="_blank"
              ><iron-icon
                aria-label="external link to check documentation"
                class="small link"
                icon="gr-icons:launch"
              ></iron-icon
              >[[computeHostName(run.checkLink)]]
            </a>
          </div>
        </div>
      </div>
    </div>
    <template is="dom-repeat" items="[[computeActions(run)]]">
      <div class="action"><gr-button link>[[item.name]]</gr-button></div>
    </template>
  </div>
`;var BR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let jR=class extends(Au(fi)){static get template(){return $R}computeIcon(e){if(!e)return"";const t=zs(e);return t?Vs(t):e.status===Fs.COMPLETED?Ys(Fs.COMPLETED):""}computeActions(e){return qs(e)}computeChipIcon(e){return(null==e?void 0:e.status)===Fs.COMPLETED?"check":(null==e?void 0:e.status)===Fs.RUNNING?"timelapse":""}computeCompletionDuration(e){return(null==e?void 0:e.finishedTimestamp)&&(null==e?void 0:e.startedTimestamp)?ji(e.startedTimestamp,e.finishedTimestamp,!0):""}computeDuration(e){return e?Bi(e):""}computeHostName(e){return e?new URL(e).hostname:""}hideChip(e){return!e||e.status===Fs.RUNNABLE}hideHeaderSectionIcon(e){return 0===this.computeIcon(e).length}hideStatusSection(e){return!e||!e.statusLink&&!e.statusDescription}hideAttemptSection(e){return!e||!e.startedTimestamp&&!e.scheduledTimestamp&&!e.finishedTimestamp&&this.hideAttempts(e)}hideAttempts(e){var t;const i=null===(t=null==e?void 0:e.attemptDetails)||void 0===t?void 0:t.length;return void 0===i||i<2}hideScheduled(e){return!(null==e?void 0:e.scheduledTimestamp)||!!(null==e?void 0:e.startedTimestamp)}hideCompletion(e){return!(null==e?void 0:e.startedTimestamp)||!(null==e?void 0:e.finishedTimestamp)}hideDescriptionSection(e){return!e||!e.checkLink&&!e.checkDescription}};function HR(e,t){const i=e.get(t.checkName);return void 0===i&&t.isLatestAttempt||i===t.attempt}BR([Oo({type:Object})],jR.prototype,"run",void 0),jR=BR([Po("gr-hovercard-run")],jR);var UR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let GR=class extends RA{constructor(){super(...arguments),this.selected=!1,this.deselected=!1,this.shouldRender=!1}static get styles(){return[ic,Zl`
        :host {
          display: block;
          --thick-border: 6px;
        }
        .chip {
          display: flex;
          justify-content: space-between;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: var(--spacing-s) var(--spacing-m);
          margin-top: var(--spacing-s);
          cursor: pointer;
        }
        .left {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
        }
        .name {
          font-weight: var(--font-weight-bold);
        }
        .attempt {
          display: inline-block;
          background-color: var(--tag-gray);
          border-radius: var(--line-height-normal);
          height: var(--line-height-normal);
          width: var(--line-height-normal);
          text-align: center;
          vertical-align: top;
          font-size: var(--font-size-small);
        }
        .chip.error {
          border-left: var(--thick-border) solid var(--error-foreground);
        }
        .chip.warning {
          border-left: var(--thick-border) solid var(--warning-foreground);
        }
        .chip.info-outline {
          border-left: var(--thick-border) solid var(--info-foreground);
        }
        .chip.check-circle-outline {
          border-left: var(--thick-border) solid var(--success-foreground);
        }
        .chip.timelapse {
          border-left: var(--thick-border) solid var(--border-color);
        }
        .chip.placeholder {
          border-left: var(--thick-border) solid var(--border-color);
        }
        .chip.placeholder iron-icon {
          display: none;
        }
        iron-icon.error {
          color: var(--error-foreground);
        }
        iron-icon.warning {
          color: var(--warning-foreground);
        }
        iron-icon.info-outline {
          color: var(--info-foreground);
        }
        iron-icon.check-circle-outline {
          color: var(--success-foreground);
        }
        /* Additional 'div' for increased specificity. */
        div.chip.selected {
          border: 1px solid var(--selected-background);
          background-color: var(--selected-background);
          padding-left: calc(var(--spacing-m) + var(--thick-border) - 1px);
        }
        div.chip.selected .name,
        div.chip.selected iron-icon.filter {
          color: var(--selected-foreground);
        }
        .chip.selected gr-button.action,
        .chip.deselected gr-button.action {
          display: none;
        }
        gr-button.action {
          --padding: var(--spacing-xs) var(--spacing-m);
          /* The button should fit into the 20px line-height. The negative
             margin provides the extra space needed for the vertical padding.
             Alternatively we could have set the vertical padding to 0, but
             that would not have been a nice click target. */
          margin: calc(0px - var(--spacing-xs));
        }
        .attemptDetails {
          padding-bottom: var(--spacing-s);
        }
        .attemptDetail {
          /* This is thick-border (6) + spacing-m (8) + icon (20) + padding. */
          padding-left: 39px;
          padding-top: var(--spacing-s);
        }
        .attemptDetail input {
          width: 14px;
          height: 14px;
          /* The next 3 are for placing in the middle of 20px line-height. */
          vertical-align: top;
          position: relative;
          top: 3px;
          margin-right: var(--spacing-s);
        }
      `]}firstUpdated(){a(this.chipElement,"chip element"),_u(this.chipElement,()=>this.setAttribute("shouldRender","true"),200)}updated(e){var t,i;super.updated(e);const n=null!==(t=this.selectedAttempt)&&void 0!==t?t:this.run.attempt,o=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector(`.attemptDetails input#attempt-${n}`);o&&(o.checked=!0)}render(){if(!this.shouldRender)return Pl`<div class="chip">Loading ...</div>`;const e=Ks(this.run),t={chip:!0,[e]:!0,selected:this.selected,deselected:this.deselected},i=Ws(this.run);return Pl`
      <div @click="${this.handleChipClick}" class="${tE(t)}">
        <gr-hovercard-run .run="${this.run}"></gr-hovercard-run>
        <div class="left">
          ${this.renderFilterIcon()}
          <iron-icon class="${e}" icon="gr-icons:${e}"></iron-icon>
          ${this.renderAdditionalIcon()}
          <span class="name">${this.run.checkName}</span>
          <span class="attempt" ?hidden="${this.run.isSingleAttempt}"
            >${this.run.attempt}</span
          >
        </div>
        <div class="right">
          ${i?Pl`<gr-button
                class="action"
                link
                @click="${e=>this.handleAction(e,i)}"
                >${i.name}</gr-button
              >`:""}
        </div>
      </div>
      <div
        class="attemptDetails"
        ?hidden="${this.run.isSingleAttempt||!this.selected}"
      >
        ${this.run.attemptDetails.map(e=>this.renderAttempt(e))}
      </div>
    `}isSelected(e){var t;const i=null!==(t=this.selectedAttempt)&&void 0!==t?t:this.run.attempt;return e.attempt===i}renderAttempt(e){const t=Qb(this.run.checkName).toLowerCase(),i=`attempt-${e.attempt}`,n=e.icon;return Pl`<div class="attemptDetail">
      <input
        type="radio"
        id="${i}"
        name="${`${t}-attempt-choice`}"
        ?checked="${this.isSelected(e)}"
        @change="${()=>this.handleAttemptChange(e)}"
      />
      <iron-icon class="${n}" icon="gr-icons:${n}"></iron-icon>
      <label for="${i}">Attempt ${e.attempt}</label>
    </div>`}handleAttemptChange(e){var t,i,n;this.isSelected(e)||(t=this,i=this.run.checkName,n=e.attempt,t.dispatchEvent(new CustomEvent("attempt-selected",{detail:{checkName:i,attempt:n},composed:!0,bubbles:!0})))}renderFilterIcon(){if(this.selected)return Pl`
      <iron-icon class="filter" icon="gr-icons:filter"></iron-icon>
    `}renderAdditionalIcon(){if(this.run.status!==Fs.RUNNING)return dl;const e=zs(this.run);if(!e)return dl;const t=Vs(e);return Pl`
      <iron-icon class="${t}" icon="gr-icons:${t}"></iron-icon>
    `}handleChipClick(e){var t,i;e.stopPropagation(),e.preventDefault(),t=this,i=this.run.checkName,t.dispatchEvent(new CustomEvent("run-selected",{detail:{reset:!1,checkName:i},composed:!0,bubbles:!0}))}handleAction(e,t){e.stopPropagation(),e.preventDefault(),na(this,t,this.run)}};UR([Vl(".chip")],GR.prototype,"chipElement",void 0),UR([Gl()],GR.prototype,"run",void 0),UR([Gl()],GR.prototype,"selected",void 0),UR([Gl()],GR.prototype,"selectedAttempt",void 0),UR([Gl()],GR.prototype,"deselected",void 0),UR([Gl()],GR.prototype,"shouldRender",void 0),GR=UR([Hl("gr-checks-run")],GR);let zR=class extends RA{constructor(){super(),this.filterRegExp=new RegExp(""),this.runs=[],this.selectedRuns=[],this.selectedAttempts=new Map,this.isSectionExpanded=new Map,this.subscribe("runs",fa)}static get styles(){return[ic,Zl`
        :host {
          display: block;
          padding: var(--spacing-l) var(--spacing-xl) var(--spacing-xl)
            var(--spacing-xl);
        }
        .expandIcon {
          width: var(--line-height-h3);
          height: var(--line-height-h3);
        }
        .sectionHeader {
          padding-top: var(--spacing-l);
          text-transform: capitalize;
          cursor: default;
        }
        .sectionHeader h3 {
          display: inline-block;
        }
        .collapsed .sectionRuns {
          display: none;
        }
        .collapsed {
          border-bottom: 1px solid var(--border-color);
          padding-bottom: var(--spacing-m);
        }
        input#filterInput {
          margin-top: var(--spacing-m);
          padding: var(--spacing-s) var(--spacing-m);
          width: 100%;
        }
        .testing {
          margin-top: var(--spacing-xxl);
          color: var(--deemphasized-text-color);
        }
        .testing gr-button {
          min-width: 25px;
        }
        .testing * {
          visibility: hidden;
        }
        .testing:hover * {
          visibility: visible;
        }
      `]}updated(e){if(super.updated(e),e.has("tabState")&&this.tabState){const{statusOrCategory:e}=this.tabState;e!==Fs.RUNNING&&e!==Fs.RUNNABLE||this.updateComplete.then(()=>{var t;const i=e.toString().toLowerCase(),n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(`.${i} .sectionHeader`);null==n||n.scrollIntoView({block:"center"})})}}render(){return Pl`
      <h2 class="heading-2">Runs</h2>
      <input
        id="filterInput"
        type="text"
        placeholder="Filter runs by regular expression"
        ?hidden="${!this.showFilter()}"
        @input="${this.onInput}"
      />
      ${this.renderSection(Fs.COMPLETED)}
      ${this.renderSection(Fs.RUNNING)}
      ${this.renderSection(Fs.RUNNABLE)}
      <div class="testing">
        <div>Toggle fake runs by clicking buttons:</div>
        <gr-button link @click="${this.none}">none</gr-button>
        <gr-button
          link
          @click="${()=>this.toggle("f0",[ba],Ta,ka)}"
          >0</gr-button
        >
        <gr-button link @click="${()=>this.toggle("f1",[wa])}"
          >1</gr-button
        >
        <gr-button link @click="${()=>this.toggle("f2",[Ca])}"
          >2</gr-button
        >
        <gr-button link @click="${()=>this.toggle("f3",[Sa])}"
          >3</gr-button
        >
        <gr-button
          link
          @click="${()=>{this.toggle("f4",[Ea,Aa,xa,Ra])}}"
          >4</gr-button
        >
        <gr-button link @click="${this.all}">all</gr-button>
      </div>
    `}onInput(){a(this.filterInput,"filter <input> element"),this.filterRegExp=new RegExp(this.filterInput.value,"i")}none(){Pa("f0",[],[]),Pa("f1",[]),Pa("f2",[]),Pa("f3",[]),Pa("f4",[])}all(){Pa("f0",[ba],Ta,ka),Pa("f1",[wa]),Pa("f2",[Ca]),Pa("f3",[Sa]),Pa("f4",[Ea,Aa,xa,Ra])}toggle(e,t,i=[],n=[]){Pa(e,this.runs.includes(t[0])?[]:t,i,n)}renderSection(e){var t;const i=this.runs.filter(e=>e.isLatestAttempt).filter(t=>t.status===e).filter(e=>this.filterRegExp.test(e.checkName)).sort(ta);if(0===i.length)return;const n=null===(t=this.isSectionExpanded.get(e))||void 0===t||t,o=n?"expanded":"collapsed",r=n?"gr-icons:expand-less":"gr-icons:expand-more";return Pl`
      <div class="${e.toLowerCase()} ${o}">
        <div
          class="sectionHeader"
          @click="${()=>this.toggleExpanded(e)}"
        >
          <iron-icon class="expandIcon" icon="${r}"></iron-icon>
          <h3 class="heading-3">${e.toLowerCase()}</h3>
        </div>
        <div class="sectionRuns">${i.map(e=>this.renderRun(e))}</div>
      </div>
    `}toggleExpanded(e){var t;const i=null===(t=this.isSectionExpanded.get(e))||void 0===t||t;this.isSectionExpanded.set(e,!i),this.requestUpdate()}renderRun(e){const t=this.selectedRuns.includes(e.checkName),i=this.selectedAttempts.get(e.checkName),n=!t&&this.selectedRuns.length>0;return Pl`<gr-checks-run
      .run="${e}"
      .selected="${t}"
      .selectedAttempt="${i}"
      .deselected="${n}"
    ></gr-checks-run>`}showFilter(){const e=this.runs.length>10;return!e&&this.filterRegExp.source.length>0&&(this.filterRegExp=new RegExp("")),e}};UR([Vl("#filterInput")],zR.prototype,"filterInput",void 0),UR([zl()],zR.prototype,"filterRegExp",void 0),UR([Gl()],zR.prototype,"runs",void 0),UR([Gl()],zR.prototype,"selectedRuns",void 0),UR([Gl()],zR.prototype,"selectedAttempts",void 0),UR([Gl()],zR.prototype,"tabState",void 0),zR=UR([Hl("gr-checks-runs")],zR);const VR=(e,t)=>{const i=e.startNode.parentNode,n=void 0===t?e.endNode:t.startNode,o=i.insertBefore(tl(),n);i.insertBefore(tl(),n);const r=new yl(e.options);return r.insertAfterNode(o),r},WR=(e,t)=>(e.setValue(t),e.commit(),e),qR=(e,t,i)=>{const n=e.startNode.parentNode,o=i?i.startNode:e.endNode,r=t.endNode.nextSibling;r!==o&&qa(n,t.startNode,r,o)},KR=e=>{Ka(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},YR=(e,t,i)=>{const n=new Map;for(let o=t;o<=i;o++)n.set(e[o],o);return n},XR=new WeakMap,JR=new WeakMap,ZR=al((e,t,i)=>{let n;return void 0===i?i=t:void 0!==t&&(n=t),t=>{if(!(t instanceof yl))throw new Error("repeat can only be used in text bindings");const o=XR.get(t)||[],r=JR.get(t)||[],s=[],a=[],l=[];let c,d,h=0;for(const t of e)l[h]=n?n(t,h):h,a[h]=i(t,h),h++;let p=0,u=o.length-1,g=0,m=a.length-1;for(;p<=u&&g<=m;)if(null===o[p])p++;else if(null===o[u])u--;else if(r[p]===l[g])s[g]=WR(o[p],a[g]),p++,g++;else if(r[u]===l[m])s[m]=WR(o[u],a[m]),u--,m--;else if(r[p]===l[m])s[m]=WR(o[p],a[m]),qR(t,o[p],s[m+1]),p++,m--;else if(r[u]===l[g])s[g]=WR(o[u],a[g]),qR(t,o[u],o[p]),u--,g++;else if(void 0===c&&(c=YR(l,g,m),d=YR(r,p,u)),c.has(r[p]))if(c.has(r[u])){const e=d.get(l[g]),i=void 0!==e?o[e]:null;if(null===i){const e=VR(t,o[p]);WR(e,a[g]),s[g]=e}else s[g]=WR(i,a[g]),qR(t,i,o[p]),o[e]=null;g++}else KR(o[u]),u--;else KR(o[p]),p++;for(;g<=m;){const e=VR(t,s[m+1]);WR(e,a[g]),s[g++]=e}for(;p<=u;){const e=o[p++];null!==e&&KR(e)}XR.set(t,s),JR.set(t,l)}});zh({_template:mi`
    <style>
      :host {
        display: block;
        position: absolute;
        outline: none;
        z-index: 1002;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;
        cursor: default;
      }

      #tooltip {
        display: block;
        outline: none;
        @apply --paper-font-common-base;
        font-size: 10px;
        line-height: 1;
        background-color: var(--paper-tooltip-background, #616161);
        color: var(--paper-tooltip-text-color, white);
        padding: 8px;
        border-radius: 2px;
        @apply --paper-tooltip;
      }

      @keyframes keyFrameScaleUp {
        0% {
          transform: scale(0.0);
        }
        100% {
          transform: scale(1.0);
        }
      }

      @keyframes keyFrameScaleDown {
        0% {
          transform: scale(1.0);
        }
        100% {
          transform: scale(0.0);
        }
      }

      @keyframes keyFrameFadeInOpacity {
        0% {
          opacity: 0;
        }
        100% {
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
      }

      @keyframes keyFrameFadeOutOpacity {
        0% {
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes keyFrameSlideDownIn {
        0% {
          transform: translateY(-2000px);
          opacity: 0;
        }
        10% {
          opacity: 0.2;
        }
        100% {
          transform: translateY(0);
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
      }

      @keyframes keyFrameSlideDownOut {
        0% {
          transform: translateY(0);
          opacity: var(--paper-tooltip-opacity, 0.9);
        }
        10% {
          opacity: 0.2;
        }
        100% {
          transform: translateY(-2000px);
          opacity: 0;
        }
      }

      .fade-in-animation {
        opacity: 0;
        animation-delay: var(--paper-tooltip-delay-in, 500ms);
        animation-name: keyFrameFadeInOpacity;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-in, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .fade-out-animation {
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 0ms);
        animation-name: keyFrameFadeOutOpacity;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .scale-up-animation {
        transform: scale(0);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-in, 500ms);
        animation-name: keyFrameScaleUp;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-in, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .scale-down-animation {
        transform: scale(1);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameScaleDown;
        animation-iteration-count: 1;
        animation-timing-function: ease-in;
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .slide-down-animation {
        transform: translateY(-2000px);
        opacity: 0;
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameSlideDownIn;
        animation-iteration-count: 1;
        animation-timing-function: cubic-bezier(0.0, 0.0, 0.2, 1);
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .slide-down-animation-out {
        transform: translateY(0);
        opacity: var(--paper-tooltip-opacity, 0.9);
        animation-delay: var(--paper-tooltip-delay-out, 500ms);
        animation-name: keyFrameSlideDownOut;
        animation-iteration-count: 1;
        animation-timing-function: cubic-bezier(0.4, 0.0, 1, 1);
        animation-duration: var(--paper-tooltip-duration-out, 500ms);
        animation-fill-mode: forwards;
        @apply --paper-tooltip-animation;
      }

      .cancel-animation {
        animation-delay: -30s !important;
      }

      /* Thanks IE 10. */

      .hidden {
        display: none !important;
      }
    </style>

    <div id="tooltip" class="hidden">
      <slot></slot>
    </div>
`,is:"paper-tooltip",hostAttributes:{role:"tooltip",tabindex:-1},properties:{for:{type:String,observer:"_findTarget"},manualMode:{type:Boolean,value:!1,observer:"_manualModeChanged"},position:{type:String,value:"bottom"},fitToVisibleBounds:{type:Boolean,value:!1},offset:{type:Number,value:14},marginTop:{type:Number,value:14},animationDelay:{type:Number,value:500,observer:"_delayChange"},animationEntry:{type:String,value:""},animationExit:{type:String,value:""},animationConfig:{type:Object,value:function(){return{entry:[{name:"fade-in-animation",node:this,timing:{delay:0}}],exit:[{name:"fade-out-animation",node:this}]}}},_showing:{type:Boolean,value:!1}},listeners:{webkitAnimationEnd:"_onAnimationEnd"},get target(){var e=Th(this).parentNode,t=Th(this).getOwnerRoot();return this.for?Th(t).querySelector("#"+this.for):e.nodeType==Node.DOCUMENT_FRAGMENT_NODE?t.host:e},attached:function(){this._findTarget()},detached:function(){this.manualMode||this._removeListeners()},playAnimation:function(e){"entry"===e?this.show():"exit"===e&&this.hide()},cancelAnimation:function(){this.$.tooltip.classList.add("cancel-animation")},show:function(){if(!this._showing){if(""===Th(this).textContent.trim()){for(var e=!0,t=Th(this).getEffectiveChildNodes(),i=0;i<t.length;i++)if(""!==t[i].textContent.trim()){e=!1;break}if(e)return}this._showing=!0,this.$.tooltip.classList.remove("hidden"),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.updatePosition(),this._animationPlaying=!0,this.$.tooltip.classList.add(this._getAnimationType("entry"))}},hide:function(){if(this._showing){if(this._animationPlaying)return this._showing=!1,void this._cancelAnimation();this._onAnimationFinish(),this._showing=!1,this._animationPlaying=!0}},updatePosition:function(){if(this._target&&this.offsetParent){var e=this.offset;14!=this.marginTop&&14==this.offset&&(e=this.marginTop);var t,i,n=this.offsetParent.getBoundingClientRect(),o=this._target.getBoundingClientRect(),r=this.getBoundingClientRect(),s=(o.width-r.width)/2,a=(o.height-r.height)/2,l=o.left-n.left,c=o.top-n.top;switch(this.position){case"top":t=l+s,i=c-r.height-e;break;case"bottom":t=l+s,i=c+o.height+e;break;case"left":t=l-r.width-e,i=c+a;break;case"right":t=l+o.width+e,i=c+a}this.fitToVisibleBounds?(n.left+t+r.width>window.innerWidth?(this.style.right="0px",this.style.left="auto"):(this.style.left=Math.max(0,t)+"px",this.style.right="auto"),n.top+i+r.height>window.innerHeight?(this.style.bottom=n.height-c+e+"px",this.style.top="auto"):(this.style.top=Math.max(-n.top,i)+"px",this.style.bottom="auto")):(this.style.left=t+"px",this.style.top=i+"px")}},_addListeners:function(){this._target&&(this.listen(this._target,"mouseenter","show"),this.listen(this._target,"focus","show"),this.listen(this._target,"mouseleave","hide"),this.listen(this._target,"blur","hide"),this.listen(this._target,"tap","hide")),this.listen(this.$.tooltip,"animationend","_onAnimationEnd"),this.listen(this,"mouseenter","hide")},_findTarget:function(){this.manualMode||this._removeListeners(),this._target=this.target,this.manualMode||this._addListeners()},_delayChange:function(e){500!==e&&this.updateStyles({"--paper-tooltip-delay-in":e+"ms"})},_manualModeChanged:function(){this.manualMode?this._removeListeners():this._addListeners()},_cancelAnimation:function(){this.$.tooltip.classList.remove(this._getAnimationType("entry")),this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.add("hidden")},_onAnimationFinish:function(){this._showing&&(this.$.tooltip.classList.remove(this._getAnimationType("entry")),this.$.tooltip.classList.remove("cancel-animation"),this.$.tooltip.classList.add(this._getAnimationType("exit")))},_onAnimationEnd:function(){this._animationPlaying=!1,this._showing||(this.$.tooltip.classList.remove(this._getAnimationType("exit")),this.$.tooltip.classList.add("hidden"))},_getAnimationType:function(e){if("entry"===e&&""!==this.animationEntry)return this.animationEntry;if("exit"===e&&""!==this.animationExit)return this.animationExit;if(this.animationConfig[e]&&"string"==typeof this.animationConfig[e][0].name){if(this.animationConfig[e][0].timing&&this.animationConfig[e][0].timing.delay&&0!==this.animationConfig[e][0].timing.delay){var t=this.animationConfig[e][0].timing.delay;"entry"===e?this.updateStyles({"--paper-tooltip-delay-in":t+"ms"}):"exit"===e&&this.updateStyles({"--paper-tooltip-delay-out":t+"ms"})}return this.animationConfig[e][0].name}},_removeListeners:function(){this._target&&(this.unlisten(this._target,"mouseenter","show"),this.unlisten(this._target,"focus","show"),this.unlisten(this._target,"mouseleave","hide"),this.unlisten(this._target,"blur","hide"),this.unlisten(this._target,"tap","hide")),this.unlisten(this.$.tooltip,"animationend","_onAnimationEnd"),this.unlisten(this,"mouseenter","hide")}});var QR=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let eT=class extends RA{constructor(){super(...arguments),this.isExpanded=!1,this.isExpandable=!1,this.shouldRender=!1}static get styles(){return[ic,Zl`
        :host {
          display: contents;
        }
        :host([isexpandable]) {
          cursor: pointer;
        }
        gr-result-expanded {
          cursor: default;
        }
        tr {
          border-top: 1px solid var(--border-color);
        }
        iron-icon.link {
          color: var(--link-color);
          margin-right: var(--spacing-m);
        }
        td.iconCol {
          padding-left: var(--spacing-l);
          padding-right: var(--spacing-m);
        }
        .iconCol div {
          width: 20px;
        }
        .nameCol div {
          width: 165px;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .nameCol .attempt {
          display: inline-block;
          background-color: var(--tag-gray);
          border-radius: var(--line-height-normal);
          height: var(--line-height-normal);
          width: var(--line-height-normal);
          text-align: center;
          vertical-align: top;
          font-size: var(--font-size-small);
        }
        .summaryCol {
          /* Forces this column to get the remaining space that is left over by
             the other columns. */
          width: 99%;
        }
        .expanderCol div {
          width: 20px;
        }
        td {
          white-space: nowrap;
          padding: var(--spacing-s);
        }
        td .summary-cell {
          display: flex;
          max-width: calc(100vw - 630px);
        }
        td .summary-cell .summary {
          font-weight: var(--font-weight-bold);
          flex-shrink: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          margin-right: var(--spacing-s);
        }
        td .summary-cell .message {
          flex-grow: 1;
          /* Looks a bit stupid, but the idea is that .message shrinks first,
             and only when that has shrunken to 0, then .summary should also
             start shrinking (substantially). */
          flex-shrink: 1000000;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        tr:hover {
          background: var(--hover-background-color);
        }
        tr td .summary-cell .links,
        tr td .summary-cell .actions,
        tr.collapsed:hover td .summary-cell .links,
        tr.collapsed:hover td .summary-cell .actions,
        :host(.dropdown-open) tr td .summary-cell .links,
        :host(.dropdown-open) tr td .summary-cell .actions {
          display: inline-block;
          margin-left: var(--spacing-s);
        }
        tr.collapsed td .summary-cell .links,
        tr.collapsed td .summary-cell .actions {
          display: none;
        }
        tr.collapsed:hover .summary-cell .tags,
        tr.collapsed:hover .summary-cell .label {
          display: none;
        }
        td .summary-cell .tags .tag {
          color: var(--primary-text-color);
          display: inline-block;
          border-radius: 20px;
          background-color: var(--tag-background);
          padding: 0 var(--spacing-m);
          margin-left: var(--spacing-s);
        }
        td .summary-cell .label {
          color: var(--primary-text-color);
          display: inline-block;
          border-radius: 20px;
          background-color: var(--label-background);
          padding: 0 var(--spacing-m);
          margin-left: var(--spacing-s);
        }
        .tag.gray {
          background-color: var(--tag-gray);
        }
        .tag.yellow {
          background-color: var(--tag-yellow);
        }
        .tag.pink {
          background-color: var(--tag-pink);
        }
        .tag.purple {
          background-color: var(--tag-purple);
        }
        .tag.cyan {
          background-color: var(--tag-cyan);
        }
        .tag.brown {
          background-color: var(--tag-brown);
        }
        .actions gr-checks-action,
        .actions gr-dropdown {
          /* Fitting a 28px button into 20px line-height. */
          margin: -4px 0;
          vertical-align: top;
        }
        #moreActions iron-icon {
          color: var(--link-color);
        }
        #moreMessage {
          display: none;
        }
      `]}update(e){var t,i;e.has("result")&&(this.isExpandable=!!(null===(t=this.result)||void 0===t?void 0:t.summary)&&!!(null===(i=this.result)||void 0===i?void 0:i.message)),super.update(e)}firstUpdated(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".container");a(t,'"Loading" element'),_u(t,()=>this.setAttribute("shouldRender","true"),200)}render(){var e,t,i;return this.result?this.shouldRender?Pl`
      <tr class="${tE({container:!0,collapsed:!this.isExpanded})}">
        <td class="iconCol" @click="${this.toggleExpanded}">
          <div>${this.renderIcon()}</div>
        </td>
        <td class="nameCol" @click="${this.toggleExpanded}">
          <div>
            <span>${this.result.checkName}</span>
            <span class="attempt" ?hidden="${this.result.isSingleAttempt}"
              >${this.result.attempt}</span
            >
          </div>
        </td>
        <td class="summaryCol">
          <div class="summary-cell">
            ${(null!==(t=null===(e=this.result.links)||void 0===e?void 0:e.slice(0,1))&&void 0!==t?t:[]).map(this.renderLink)}
            ${this.renderSummary(this.result.summary)}
            <div class="message" @click="${this.toggleExpanded}">
              ${this.isExpanded?"":this.result.message}
            </div>
            <div class="tags">
              ${(null!==(i=this.result.tags)&&void 0!==i?i:[]).map(e=>this.renderTag(e))}
            </div>
            ${this.renderLabel()} ${this.renderLinks()} ${this.renderActions()}
          </div>
          ${this.renderExpanded()}
        </td>
        <td class="expanderCol" @click="${this.toggleExpanded}">
          <div
            class="show-hide"
            role="switch"
            tabindex="0"
            ?hidden="${!this.isExpandable}"
            ?aria-checked="${this.isExpanded}"
            aria-label="${this.isExpanded?"Collapse result row":"Expand result row"}"
            @keydown="${this.toggleExpanded}"
          >
            <iron-icon
              icon="${this.isExpanded?"gr-icons:expand-less":"gr-icons:expand-more"}"
            ></iron-icon>
          </div>
        </td>
      </tr>
    `:Pl`
        <tr class="container">
          <td class="iconCol"></td>
          <td class="nameCol">
            <div><span class="loading">Loading...</span></div>
          </td>
          <td class="summaryCol"></td>
          <td class="expanderCol"></td>
        </tr>
      `:""}renderExpanded(){if(this.isExpanded)return Pl`<gr-result-expanded
      .result="${this.result}"
    ></gr-result-expanded>`}toggleExpanded(){this.isExpandable&&(this.isExpanded=!this.isExpanded)}renderSummary(e){if(e)return Pl`
      <!-- The &nbsp; is for being able to shrink a tiny amount without
       the text itself getting shrunk with an ellipsis. -->
      <div class="summary" @click="${this.toggleExpanded}">${e}&nbsp;</div>
    `}renderIcon(){var e;if((null===(e=this.result)||void 0===e?void 0:e.status)===Fs.RUNNING)return Pl`<iron-icon icon="gr-icons:timelapse"></iron-icon>`}renderLabel(){var e;const t=null===(e=this.result)||void 0===e?void 0:e.labelName;if(t)return Pl`<div class="label">${t}</div>`}renderLinks(){var e,t;const i=(null!==(t=null===(e=this.result)||void 0===e?void 0:e.links)&&void 0!==t?t:[]).slice(1);if(0!==i.length)return Pl`<div class="links">${i.map(this.renderLink)}</div>`}renderLink(e){var t;const i=null!==(t=e.tooltip)&&void 0!==t?t:Gs(e.icon);return Pl`<a href="${e.url}" target="_blank"
      ><iron-icon
        aria-label="external link to details"
        class="link"
        icon="gr-icons:${Us(e.icon)}"
      ></iron-icon
      ><paper-tooltip offset="5">${i}</paper-tooltip></a
    >`}renderActions(){var e,t;const i=null!==(t=null===(e=this.result)||void 0===e?void 0:e.actions)&&void 0!==t?t:[];if(0===i.length)return;const n=i.slice(2).map(e=>({...e,id:e.name}));return Pl`<div class="actions">
      ${this.renderAction(i[0])} ${this.renderAction(i[1])}
      <gr-dropdown
        id="moreActions"
        link=""
        vertical-offset="32"
        horizontal-align="right"
        @tap-item="${this.handleAction}"
        @opened-changed="${e=>vu(this,"dropdown-open",e.detail.value)}"
        ?hidden="${0===n.length}"
        .items="${n}"
      >
        <iron-icon icon="gr-icons:more-vert" aria-labelledby="moreMessage">
        </iron-icon>
        <span id="moreMessage">More</span>
      </gr-dropdown>
    </div>`}handleAction(e){na(this,e.detail)}renderAction(e){if(e)return Pl`<gr-checks-action .action="${e}"></gr-checks-action>`}renderPrimaryActions(){var e,t;const i=(null!==(t=null===(e=this.result)||void 0===e?void 0:e.actions)&&void 0!==t?t:[]).slice(0,2);if(0!==i.length)return Pl`
      <div class="primaryActions">${i.map(this.renderAction)}</div>
    `}renderSecondaryActions(){var e,t;const i=(null!==(t=null===(e=this.result)||void 0===e?void 0:e.actions)&&void 0!==t?t:[]).slice(2);if(0!==i.length)return Pl`
      <div class="secondaryActions">
        ${i.map(this.renderAction)}
      </div>
    `}renderTag(e){return Pl`<div class="tag ${e.color}">${e.name}</div>`}};QR([Gl()],eT.prototype,"result",void 0),QR([Gl()],eT.prototype,"isExpanded",void 0),QR([Gl({type:Boolean,reflect:!0})],eT.prototype,"isExpandable",void 0),QR([Gl()],eT.prototype,"shouldRender",void 0),eT=QR([Hl("gr-result-row")],eT);let tT=class extends RA{constructor(){super(),this.subscribe("repoConfig",sg)}static get styles(){return[ic,Zl`
        .message {
          padding: var(--spacing-m) var(--spacing-m) var(--spacing-m) 0;
        }
      `]}render(){return this.result?Pl`
      <gr-endpoint-decorator name="check-result-expanded">
        <gr-endpoint-param
          name="run"
          .value="${this.result}"
        ></gr-endpoint-param>
        <gr-endpoint-param
          name="result"
          .value="${this.result}"
        ></gr-endpoint-param>
        <gr-formatted-text
          no-trailing-margin=""
          class="message"
          content="${this.result.message}"
          config="${this.repoConfig}"
        ></gr-formatted-text>
      </gr-endpoint-decorator>
    `:""}};QR([Gl()],tT.prototype,"result",void 0),QR([Gl()],tT.prototype,"repoConfig",void 0),tT=QR([Hl("gr-result-expanded")],tT);const iT=new Map;iT.set($s.ERROR,20),iT.set($s.WARNING,20),iT.set($s.INFO,5),iT.set("SUCCESS",5);let nT=class extends RA{constructor(){super(),this.filterRegExp=new RegExp(""),this.runs=[],this.selectedRuns=[],this.actions=[],this.links=[],this.someProvidersAreLoading=!1,this.checksPatchsetNumber=void 0,this.latestPatchsetNumber=void 0,this.selectedAttempts=new Map,this.isShowAll=new Map,this.isSectionExpanded=new Map,this.isSectionExpandedByUser=new Map,this.checksService=i.checksService,this.subscribe("actions",ga),this.subscribe("links",ma),this.subscribe("checksPatchsetNumber",la),this.subscribe("latestPatchsetNumber",Ls),this.subscribe("someProvidersAreLoading",ha)}static get styles(){return[ic,Zl`
        :host {
          display: block;
          background-color: var(--background-color-secondary);
        }
        .header {
          display: block;
          background-color: var(--background-color-primary);
          padding: var(--spacing-l) var(--spacing-xl) var(--spacing-m)
            var(--spacing-xl);
          border-bottom: 1px solid var(--border-color);
        }
        .headerTopRow,
        .headerBottomRow {
          display: flex;
          justify-content: space-between;
          align-items: flex-end;
        }
        .headerTopRow gr-dropdown-list {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: 0 var(--spacing-m);
        }
        .headerBottomRow {
          margin-top: var(--spacing-s);
        }
        .headerBottomRow .right {
          display: flex;
          align-items: center;
        }
        .headerBottomRow .links iron-icon {
          color: var(--link-color);
          margin-right: var(--spacing-l);
        }
        #moreActions iron-icon {
          color: var(--link-color);
        }
        #moreMessage {
          display: none;
        }
        .body {
          display: block;
          padding: var(--spacing-s) var(--spacing-xl) var(--spacing-xl)
            var(--spacing-xl);
        }
        .filterDiv {
          display: flex;
          margin-top: var(--spacing-s);
          align-items: center;
        }
        .filterDiv input#filterInput {
          padding: var(--spacing-s) var(--spacing-m);
          min-width: 400px;
        }
        .filterDiv .selection {
          padding: var(--spacing-s) var(--spacing-m);
        }
        .filterDiv iron-icon.filter {
          color: var(--selected-foreground);
        }
        .filterDiv gr-button.reset {
          margin: calc(0px - var(--spacing-s)) var(--spacing-l);
        }
        .categoryHeader {
          margin-top: var(--spacing-l);
          margin-left: var(--spacing-l);
          cursor: default;
        }
        .categoryHeader .title {
          text-transform: capitalize;
        }
        .categoryHeader .expandIcon {
          width: var(--line-height-h3);
          height: var(--line-height-h3);
          margin-right: var(--spacing-s);
        }
        .categoryHeader .statusIcon {
          position: relative;
          top: 2px;
        }
        .categoryHeader .statusIcon.error {
          color: var(--error-foreground);
        }
        .categoryHeader .statusIcon.warning {
          color: var(--warning-foreground);
        }
        .categoryHeader .statusIcon.info {
          color: var(--info-foreground);
        }
        .categoryHeader .statusIcon.success {
          color: var(--success-foreground);
        }
        .categoryHeader .filtered {
          color: var(--deemphasized-text-color);
        }
        .collapsed .noResultsMessage,
        .collapsed table {
          display: none;
        }
        .collapsed {
          border-bottom: 1px solid var(--border-color);
          padding-bottom: var(--spacing-m);
        }
        .noResultsMessage {
          width: 100%;
          max-width: 1280px;
          margin-top: var(--spacing-m);
          background-color: var(--background-color-primary);
          box-shadow: var(--elevation-level-1);
          padding: var(--spacing-s)
            calc(20px + var(--spacing-l) + var(--spacing-m) + var(--spacing-s));
        }
        table.resultsTable {
          width: 100%;
          max-width: 1280px;
          margin-top: var(--spacing-m);
          background-color: var(--background-color-primary);
          box-shadow: var(--elevation-level-1);
        }
        tr.headerRow th {
          text-align: left;
          font-weight: var(--font-weight-bold);
          padding: var(--spacing-s);
        }
        gr-button.showAll {
          margin: var(--spacing-m);
        }
        tr {
          border-top: 1px solid var(--border-color);
        }
      `]}updated(e){if(super.updated(e),e.has("tabState")&&this.tabState){const{statusOrCategory:e,checkName:t}=this.tabState;if(e&&e!==Fs.RUNNING&&e!==Fs.RUNNABLE){let t=e.toString().toLowerCase();e===Fs.COMPLETED&&(t="success"),this.scrollElIntoView(`.categoryHeader .${t}`)}else t&&this.scrollElIntoView(`gr-result-row.${Qb(t)}`)}}scrollElIntoView(e){this.updateComplete.then(()=>{var t,i,n;let o=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(e);o=null!==(n=null===(i=null==o?void 0:o.shadowRoot)||void 0===i?void 0:i.firstElementChild)&&void 0!==n?n:o,null==o||o.scrollIntoView({block:"center"})})}render(){return Pl`
      <div class="header">
        <div class="headerTopRow">
          <div class="left">
            <h2 class="heading-2">Results</h2>
          </div>
          <div class="middle">
            <span ?hidden="${!this.someProvidersAreLoading}">Loading...</span>
          </div>
          <div class="right">
            <gr-dropdown-list
              value="${this.checksPatchsetNumber}"
              .items="${this.createPatchsetDropdownItems()}"
              @value-change="${this.onPatchsetSelected}"
            ></gr-dropdown-list>
          </div>
        </div>
        <div class="headerBottomRow">
          <div class="left">${this.renderFilter()}</div>
          <div class="right">${this.renderLinks()}${this.renderActions()}</div>
        </div>
      </div>
      <div class="body">
        ${this.renderSection($s.ERROR)}
        ${this.renderSection($s.WARNING)}
        ${this.renderSection($s.INFO)} ${this.renderSection("SUCCESS")}
      </div>
    `}renderLinks(){var e;const t=(null!==(e=this.links)&&void 0!==e?e:[]).slice(0,4);if(0!==t.length)return Pl`<div class="links">${t.map(this.renderLink)}</div>`}renderLink(e){var t;const i=null!==(t=e.tooltip)&&void 0!==t?t:Gs(e.icon);return Pl`<a href="${e.url}" target="_blank"
      ><iron-icon
        aria-label="${i}"
        class="link"
        icon="gr-icons:${Us(e.icon)}"
      ></iron-icon
      ><paper-tooltip offset="5">${i}</paper-tooltip></a
    >`}renderActions(){const e=this.actions.slice(2).map(e=>({...e,id:e.name}));return Pl`
      ${this.renderAction(this.actions[0])}
      ${this.renderAction(this.actions[1])}
      <gr-dropdown
        id="moreActions"
        link=""
        vertical-offset="32"
        horizontal-align="right"
        @tap-item="${this.handleAction}"
        ?hidden="${0===e.length}"
        .items="${e}"
      >
        <iron-icon icon="gr-icons:more-vert" aria-labelledby="moreMessage">
        </iron-icon>
        <span id="moreMessage">More</span>
      </gr-dropdown>
    `}handleAction(e){na(this,e.detail)}renderAction(e){if(e)return Pl`<gr-checks-action .action="${e}"></gr-checks-action>`}onPatchsetSelected(e){const t=Number(e.detail.value);s(!isNaN(t),"selected patchset must be a number"),this.checksService.setPatchset(t)}createPatchsetDropdownItems(){return this.latestPatchsetNumber?Array.from(Array(this.latestPatchsetNumber),(e,t)=>{a(this.latestPatchsetNumber,"latestPatchsetNumber");const i=this.latestPatchsetNumber-t;return{value:`${i}`,text:`Patchset ${i}${i===this.latestPatchsetNumber?" (latest)":""}`}}):[]}isRunSelected(e){return 0===this.selectedRuns.length||this.selectedRuns.includes(e.checkName)}renderFilter(){const e=this.runs.filter(e=>this.isRunSelected(e)&&HR(this.selectedAttempts,e));if(!(0===this.selectedRuns.length&&function(e){return e.reduce((e,t)=>{var i;return[...e,...null!==(i=t.results)&&void 0!==i?i:[]]},[])}(e).length<=3))return Pl`
      <div class="filterDiv">
        <input
          id="filterInput"
          type="text"
          placeholder="Filter results by regular expression"
          @input="${this.onInput}"
        />
        <div class="selection">${this.renderSelectionFilter()}</div>
      </div>
    `;this.filterRegExp.source.length>0&&(this.filterRegExp=new RegExp(""))}renderSelectionFilter(){const e=this.selectedRuns.length;if(0!==e)return Pl`
      <iron-icon class="filter" icon="gr-icons:filter"></iron-icon>
      <span>Filtered by ${Jb(e,"run")}</span>
      <gr-button link class="reset" @click="${this.handleClick}"
        >Reset View</gr-button
      >
    `}handleClick(){this.filterRegExp=new RegExp(""),this.dispatchEvent(new CustomEvent("run-selected",{detail:{reset:!0},composed:!0,bubbles:!0}))}onInput(){a(this.filterInput,"filter <input> element"),this.filterRegExp=new RegExp(this.filterInput.value,"i")}renderSection(e){var t,i,n;const o=e.toString().toLowerCase();let r=this.runs.filter(e=>HR(this.selectedAttempts,e));r="SUCCESS"===e?r.filter(Zs):r.filter(t=>Qs(t,e));const s=r.reduce((t,i)=>[...t,...this.computeRunResults(e,i)],[]),a=s.filter(e=>this.isRunSelected(e)),l=a.filter(e=>this.filterRegExp.test(e.checkName)||this.filterRegExp.test(e.summary));let c=this.isSectionExpanded.get(e);null!==(t=this.isSectionExpandedByUser.get(e))&&void 0!==t&&t&&void 0!==c||(c=a.length>0,this.isSectionExpanded.set(e,c));const d=c?"expanded":"collapsed",h=c?"gr-icons:expand-less":"gr-icons:expand-more",p=null!==(i=this.isShowAll.get(e))&&void 0!==i&&i,u=null!==(n=iT.get(e))&&void 0!==n?n:5,g=l.length,m=p?1e3:u,f=this.renderShowAllButton(e,p,u,g);return Pl`
      <div class="${d}">
        <h3
          class="categoryHeader ${o} heading-3"
          @click="${()=>this.toggleExpanded(e)}"
        >
          <iron-icon class="expandIcon" icon="${h}"></iron-icon>
          <iron-icon
            icon="gr-icons:${Vs(e)}"
            class="statusIcon ${o}"
          ></iron-icon>
          <span class="title">${o}</span>
          <span class="count"
            >${this.renderCount(s,a,l)}</span
          >
        </h3>
        ${this.renderResults(s,a,l,m,f)}
      </div>
    `}renderShowAllButton(e,t,i,n){if(n<=i)return;return Pl`
      <tr class="showAllRow">
        <td colspan="4">
          <gr-button class="showAll" link @click="${()=>this.toggleShowAll(e)}"
            >${t?"Show Less":`Show All (${n})`}</gr-button
          >
        </td>
      </tr>
    `}toggleShowAll(e){var t;const i=null!==(t=this.isShowAll.get(e))&&void 0!==t&&t;this.isShowAll.set(e,!i),this.requestUpdate()}renderResults(e,t,i,n,o){return 0===e.length?Pl`<div class="noResultsMessage">No results</div>`:0===t.length?Pl`<div class="noResultsMessage">
        No results for this filtered view
      </div>`:0===i.length?Pl`<div class="noResultsMessage">
        No results match the regular expression
      </div>`:(i=i.slice(0,n),Pl`
      <table class="resultsTable">
        <thead>
          <tr class="headerRow">
            <th class="iconCol"></th>
            <th class="nameCol">Run</th>
            <th class="summaryCol">Summary</th>
            <th class="expanderCol"></th>
          </tr>
        </thead>
        <tbody>
          ${ZR(i,e=>e.internalResultId,e=>Pl`
              <gr-result-row
                class="${Qb(e.checkName)}"
                .result="${e}"
              ></gr-result-row>
            `)}
          ${o}
        </tbody>
      </table>
    `)}renderCount(e,t,i){return e.length===i.length?Pl`(${e.length})`:e.length!==t.length?Pl`<span class="filtered"> - filtered</span>`:Pl`(${i.length} of ${e.length})`}toggleExpanded(e){const t=this.isSectionExpanded.get(e);a(t,"expanded must have been set in initial render"),this.isSectionExpanded.set(e,!t),this.isSectionExpandedByUser.set(e,!0),this.requestUpdate()}computeRunResults(e,t){var i,n;return"SUCCESS"===e?[this.computeSuccessfulRunResult(t)]:null!==(n=null===(i=t.results)||void 0===i?void 0:i.filter(t=>t.category===e).map(e=>({...t,...e})))&&void 0!==n?n:[]}computeSuccessfulRunResult(e){var t,i;const n={internalResultId:e.internalRunId+"-0",category:$s.INFO,summary:null!==(t=e.statusDescription)&&void 0!==t?t:"",...e};if(!e.statusDescription){const t=null!==(i=e.scheduledTimestamp)&&void 0!==i?i:e.startedTimestamp,o=e.finishedTimestamp;let r="";t&&o&&(r=` in ${ji(t,o,!0)}`),n.message=`Completed without results${r}.`}return e.statusLink&&(n.links=[{url:e.statusLink,primary:!0,icon:js.EXTERNAL}]),n}};QR([Vl("#filterInput")],nT.prototype,"filterInput",void 0),QR([zl()],nT.prototype,"filterRegExp",void 0),QR([Gl()],nT.prototype,"runs",void 0),QR([Gl()],nT.prototype,"selectedRuns",void 0),QR([Gl()],nT.prototype,"actions",void 0),QR([Gl()],nT.prototype,"links",void 0),QR([Gl()],nT.prototype,"tabState",void 0),QR([Gl()],nT.prototype,"someProvidersAreLoading",void 0),QR([Gl()],nT.prototype,"checksPatchsetNumber",void 0),QR([Gl()],nT.prototype,"latestPatchsetNumber",void 0),QR([Gl()],nT.prototype,"selectedAttempts",void 0),QR([zl()],nT.prototype,"isShowAll",void 0),nT=QR([Hl("gr-checks-results")],nT);let oT=class extends RA{connectedCallback(){super.connectedCallback(),function(e,t){if(null==e)throw new Error(`Required property '${t}' not set.`)}(this.action,"action")}static get styles(){return[Zl`
        :host {
          display: inline-block;
        }
        gr-button {
          --padding: var(--spacing-s) var(--spacing-m);
        }
        gr-button paper-tooltip {
          text-transform: none;
        }
      `]}render(){return Pl`
      <gr-button link class="action" @click="${this.handleClick}">
        ${this.action.name}
        <paper-tooltip ?hidden="${!this.action.tooltip}" offset="5"
          >${this.action.tooltip}</paper-tooltip
        >
      </gr-button>
    `}handleClick(){na(this,this.action)}};QR([Gl()],oT.prototype,"action",void 0),oT=QR([Hl("gr-checks-action")],oT);var rT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let sT=class extends RA{constructor(){super(),this.runs=[],this.results=[],this.checksPatchsetNumber=void 0,this.changeNum=void 0,this.selectedRuns=[],this.selectedAttempts=new Map,this.checksService=i.checksService,this.subscribe("runs",fa),this.subscribe("results",ya),this.subscribe("checksPatchsetNumber",la),this.subscribe("changeNum",Os),this.addEventListener("action-triggered",e=>this.handleActionTriggered(e.detail.action,e.detail.run))}static get styles(){return Zl`
      :host {
        display: block;
      }
      .container {
        display: flex;
      }
      .runs {
        min-width: 300px;
        min-height: 400px;
        border-right: 1px solid var(--border-color);
      }
      .results {
        flex-grow: 1;
      }
    `}render(){return Pl`
      <div class="container">
        <gr-checks-runs
          class="runs"
          .runs="${this.runs}"
          .selectedRuns="${this.selectedRuns}"
          .selectedAttempts="${this.selectedAttempts}"
          .tabState="${this.tabState}"
          @run-selected="${this.handleRunSelected}"
          @attempt-selected="${this.handleAttemptSelected}"
        ></gr-checks-runs>
        <gr-checks-results
          class="results"
          .tabState="${this.tabState}"
          .runs="${this.runs}"
          .selectedRuns="${this.selectedRuns}"
          .selectedAttempts="${this.selectedAttempts}"
          @run-selected="${this.handleRunSelected}"
        ></gr-checks-results>
      </div>
    `}updated(e){super.updated(e),e.has("tabState")&&this.tabState&&(this.selectedRuns=[])}handleActionTriggered(e,t){if(!this.changeNum)return;if(!this.checksPatchsetNumber)return;const i=e.callback(this.changeNum,this.checksPatchsetNumber,null==t?void 0:t.attempt,null==t?void 0:t.externalId,null==t?void 0:t.checkName,e.name);(null==i?void 0:i.then)&&(Ci(this,`Triggering action '${e.name}' ...`),Vr(i).pipe(cs(Qr(5e3))).subscribe(e=>{var i;e.errorMessage||e.message?Ci(this,`${null!==(i=e.message)&&void 0!==i?i:e.errorMessage}`):bi(this,"hide-alert"),e.shouldReload&&this.checksService.reloadForCheck(null==t?void 0:t.checkName)}))}handleRunSelected(e){if(e.detail.reset)return this.selectedRuns=[],void(this.selectedAttempts=new Map);e.detail.checkName&&this.toggleSelected(e.detail.checkName)}handleAttemptSelected(e){const{checkName:t,attempt:i}=e.detail;this.selectedAttempts.set(t,i),this.selectedAttempts=new Map(this.selectedAttempts)}toggleSelected(e){this.selectedRuns.includes(e)?(this.selectedRuns=this.selectedRuns.filter(t=>t!==e),this.selectedAttempts.set(e,void 0),this.selectedAttempts=new Map(this.selectedAttempts)):this.selectedRuns=[...this.selectedRuns,e]}};rT([Gl()],sT.prototype,"runs",void 0),rT([Gl()],sT.prototype,"results",void 0),rT([Gl()],sT.prototype,"tabState",void 0),rT([Gl()],sT.prototype,"checksPatchsetNumber",void 0),rT([Gl()],sT.prototype,"changeNum",void 0),rT([zl()],sT.prototype,"selectedRuns",void 0),rT([zl()],sT.prototype,"selectedAttempts",void 0),sT=rT([Hl("gr-checks-tab")],sT);const aT=mi`
  <style include="shared-styles">
    .container:not(.loading) {
      background-color: var(--background-color-tertiary);
    }
    .container.loading {
      color: var(--deemphasized-text-color);
      padding: var(--spacing-l);
    }
    .header {
      align-items: center;
      background-color: var(--background-color-primary);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      padding: var(--spacing-s) var(--spacing-l);
      z-index: 99; /* Less than gr-overlay's backdrop */
    }
    .header.editMode {
      background-color: var(--edit-mode-background-color);
    }
    .header .download {
      margin-right: var(--spacing-l);
    }
    gr-change-status {
      display: initial;
      margin-left: var(--spacing-s);
    }
    gr-change-status:first-child {
      margin-left: 0;
    }
    .headerTitle {
      align-items: center;
      display: flex;
      flex: 1;
    }
    .headerSubject {
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
      margin-left: var(--spacing-l);
    }
    .changeNumberColon {
      color: transparent;
    }
    .changeCopyClipboard {
      margin-left: var(--spacing-s);
    }
    #replyBtn {
      margin-bottom: var(--spacing-m);
    }
    gr-change-star {
      margin-left: var(--spacing-s);
      --gr-change-star-size: var(--line-height-normal);
    }
    a.changeNumber {
      margin-left: var(--spacing-xs);
    }
    gr-reply-dialog {
      width: 60em;
    }
    .changeStatus {
      text-transform: capitalize;
    }
    /* Strong specificity here is needed due to
         https://github.com/Polymer/polymer/issues/2531 */
    .container .changeInfo {
      display: flex;
      background-color: var(--background-color-secondary);
      padding-right: var(--spacing-m);
    }
    section {
      background-color: var(--view-background-color);
      box-shadow: var(--elevation-level-1);
    }
    .changeMetadata {
      /* Limit meta section to half of the screen at max */
      max-width: 50%;
    }
    .commitMessage {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      margin-right: var(--spacing-l);
      margin-bottom: var(--spacing-m);
      /* Account for border and padding and rounding errors. */
      max-width: calc(72ch + 2px + 2 * var(--spacing-m) + 0.4px);
    }
    .commitMessage gr-linked-text {
      word-break: break-word;
    }
    #commitMessageEditor {
      /* Account for border and padding and rounding errors. */
      min-width: calc(72ch + 2px + 2 * var(--spacing-m) + 0.4px);
      --collapsed-max-height: 300px;
    }
    .changeStatuses,
    .commitActions,
    .statusText {
      align-items: center;
      display: flex;
    }
    .changeStatuses {
      flex-wrap: wrap;
    }
    .mainChangeInfo {
      display: flex;
      flex: 1;
      flex-direction: column;
      min-width: 0;
    }
    #commitAndRelated {
      align-content: flex-start;
      display: flex;
      flex: 1;
      overflow-x: hidden;
    }
    .relatedChanges {
      flex: 0 1 auto;
      overflow: hidden;
      padding: var(--spacing-l) 0;
    }
    .mobile {
      display: none;
    }
    hr {
      border: 0;
      border-top: 1px solid var(--border-color);
      height: 0;
      margin-bottom: var(--spacing-l);
    }
    .emptySpace {
      flex-grow: 1;
    }
    .commitContainer {
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      margin: var(--spacing-l) 0;
      padding: 0 var(--spacing-l);
    }
    .showOnEdit {
      display: none;
    }
    .scrollable {
      overflow: auto;
    }
    .text {
      white-space: pre;
    }
    gr-commit-info {
      display: inline-block;
    }
    paper-tabs {
      background-color: var(--background-color-tertiary);
      margin-top: var(--spacing-m);
      height: calc(var(--line-height-h3) + var(--spacing-m));
      --paper-tabs-selection-bar-color: var(--link-color);
    }
    paper-tab {
      box-sizing: border-box;
      max-width: 12em;
      --paper-tab-ink: var(--link-color);
    }
    gr-thread-list,
    gr-messages-list {
      display: block;
    }
    gr-thread-list {
      min-height: 250px;
    }
    #includedInOverlay {
      width: 65em;
    }
    #uploadHelpOverlay {
      width: 50em;
    }
    #metadata {
      --metadata-horizontal-padding: var(--spacing-l);
      padding-top: var(--spacing-l);
      width: 100%;
    }
    gr-change-summary {
      /* temporary for old checks status */
      margin-bottom: var(--spacing-m);
    }
    @media screen and (max-width: 75em) {
      .relatedChanges {
        padding: 0;
      }
      #relatedChanges {
        padding-top: var(--spacing-l);
      }
      #commitAndRelated {
        flex-direction: column;
        flex-wrap: nowrap;
      }
      #commitMessageEditor {
        min-width: 0;
      }
      .commitMessage {
        margin-right: 0;
      }
      .mainChangeInfo {
        padding-right: 0;
      }
    }
    @media screen and (max-width: 50em) {
      .mobile {
        display: block;
      }
      .header {
        align-items: flex-start;
        flex-direction: column;
        flex: 1;
        padding: var(--spacing-s) var(--spacing-l);
      }
      gr-change-star {
        vertical-align: middle;
      }
      .headerTitle {
        flex-wrap: wrap;
        font-family: var(--header-font-family);
        font-size: var(--font-size-h3);
        font-weight: var(--font-weight-h3);
        line-height: var(--line-height-h3);
      }
      .desktop {
        display: none;
      }
      .reply {
        display: block;
        margin-right: 0;
        /* px because don't have the same font size */
        margin-bottom: 6px;
      }
      .changeInfo-column:not(:last-of-type) {
        margin-right: 0;
        padding-right: 0;
      }
      .changeInfo,
      #commitAndRelated {
        flex-direction: column;
        flex-wrap: nowrap;
      }
      .commitContainer {
        margin: 0;
        padding: var(--spacing-l);
      }
      .changeMetadata {
        margin-top: var(--spacing-xs);
        max-width: none;
      }
      #metadata,
      .mainChangeInfo {
        padding: 0;
      }
      .commitActions {
        display: block;
        margin-top: var(--spacing-l);
        width: 100%;
      }
      .commitMessage {
        flex: initial;
        margin: 0;
      }
      /* Change actions are the only thing thant need to remain visible due
        to the fact that they may have the currently visible overlay open. */
      #mainContent.overlayOpen .hideOnMobileOverlay {
        display: none;
      }
      gr-reply-dialog {
        height: 100vh;
        min-width: initial;
        width: 100vw;
      }
      #replyOverlay {
        z-index: var(--reply-overlay-z-index);
      }
    }
    .patch-set-dropdown {
      margin: var(--spacing-m) 0 0 var(--spacing-m);
    }
    .show-robot-comments {
      margin: var(--spacing-m);
    }
  </style>
  <div class="container loading" hidden$="[[!_loading]]">Loading...</div>
  <!-- TODO(taoalpha): remove on-show-checks-table,
    Gerrit should not have any thing too special for a plugin,
    replace with a generic event: show-primary-tab. -->
  <div
    id="mainContent"
    class="container"
    on-show-checks-table="_setActivePrimaryTab"
    hidden$="{{_loading}}"
    aria-hidden="[[_changeViewAriaHidden]]"
  >
    <section class="changeInfoSection">
      <div class$="[[_computeHeaderClass(_editMode)]]">
        <h1 class="assistive-tech-only">
          Change [[_change._number]]: [[_change.subject]]
        </h1>
        <div class="headerTitle">
          <div class="changeStatuses">
            <template is="dom-repeat" items="[[_changeStatuses]]" as="status">
              <gr-change-status
                max-width="100"
                status="[[status]]"
              ></gr-change-status>
            </template>
          </div>
          <gr-change-star
            id="changeStar"
            change="{{_change}}"
            on-toggle-star="_handleToggleStar"
            hidden$="[[!_loggedIn]]"
          ></gr-change-star>

          <a
            class="changeNumber"
            aria-label$="[[_computeChangePermalinkAriaLabel(_change._number)]]"
            href$="[[_computeChangeUrl(_change)]]"
            >[[_change._number]]</a
          >
          <span class="changeNumberColon">:&nbsp;</span>
          <span class="headerSubject">[[_change.subject]]</span>
          <gr-copy-clipboard
            class="changeCopyClipboard"
            hide-input=""
            text="[[_computeCopyTextForTitle(_change)]]"
          >
          </gr-copy-clipboard>
        </div>
        <!-- end headerTitle -->
        <div class="commitActions" hidden$="[[!_loggedIn]]">
          <gr-change-actions
            id="actions"
            change="[[_change]]"
            disable-edit="[[disableEdit]]"
            has-parent="[[hasParent]]"
            actions="[[_change.actions]]"
            revision-actions="{{_currentRevisionActions}}"
            account="[[_account]]"
            change-num="[[_changeNum]]"
            change-status="[[_change.status]]"
            commit-num="[[_commitInfo.commit]]"
            latest-patch-num="[[_computeLatestPatchNum(_allPatchSets)]]"
            commit-message="[[_latestCommitMessage]]"
            edit-patchset-loaded="[[_hasEditPatchsetLoaded(_patchRange.*)]]"
            edit-mode="[[_editMode]]"
            edit-based-on-current-patch-set="[[_hasEditBasedOnCurrentPatchSet(_allPatchSets)]]"
            private-by-default="[[_projectConfig.private_by_default]]"
            on-edit-tap="_handleEditTap"
            on-stop-edit-tap="_handleStopEditTap"
            on-download-tap="_handleOpenDownloadDialog"
            comment-threads="[[_commentThreads]]"
          ></gr-change-actions>
        </div>
        <!-- end commit actions -->
      </div>
      <!-- end header -->
      <h2 class="assistive-tech-only">Change metadata</h2>
      <div class="changeInfo">
        <div class="changeInfo-column changeMetadata hideOnMobileOverlay">
          <gr-change-metadata
            id="metadata"
            change="{{_change}}"
            account="[[_account]]"
            revision="[[_selectedRevision]]"
            commit-info="[[_commitInfo]]"
            server-config="[[_serverConfig]]"
            parent-is-current="[[_parentIsCurrent]]"
            on-show-reply-dialog="_handleShowReplyDialog"
          >
          </gr-change-metadata>
        </div>
        <div id="mainChangeInfo" class="changeInfo-column mainChangeInfo">
          <div id="commitAndRelated" class="hideOnMobileOverlay">
            <div class="commitContainer">
              <h3 class="assistive-tech-only">Commit Message</h3>
              <div>
                <gr-button
                  id="replyBtn"
                  class="reply"
                  title="[[createTitle(Shortcut.OPEN_REPLY_DIALOG,
                        ShortcutSection.ACTIONS)]]"
                  hidden$="[[!_loggedIn]]"
                  primary=""
                  disabled="[[_replyDisabled]]"
                  on-click="_handleReplyTap"
                  >[[_replyButtonLabel]]</gr-button
                >
              </div>
              <div id="commitMessage" class="commitMessage">
                <gr-editable-content
                  id="commitMessageEditor"
                  editing="{{_editingCommitMessage}}"
                  content="{{_latestCommitMessage}}"
                  storage-key="[[_computeCommitMessageKey(_change._number, _change.current_revision)]]"
                  hide-edit-commit-message="[[_hideEditCommitMessage]]"
                  commit-collapsible="[[_commitCollapsible]]"
                  remove-zero-width-space=""
                >
                  <gr-linked-text
                    pre=""
                    content="[[_latestCommitMessage]]"
                    config="[[_projectConfig.commentlinks]]"
                    remove-zero-width-space=""
                  ></gr-linked-text>
                </gr-editable-content>
              </div>
              <gr-change-summary
                change-comments="[[_changeComments]]"
                comment-threads="[[_commentThreads]]"
                self-account="[[_account]]"
              >
              </gr-change-summary>
              <gr-endpoint-decorator name="commit-container">
                <gr-endpoint-param name="change" value="[[_change]]">
                </gr-endpoint-param>
                <gr-endpoint-param
                  name="revision"
                  value="[[_selectedRevision]]"
                >
                </gr-endpoint-param>
              </gr-endpoint-decorator>
            </div>
            <div class="relatedChanges">
              <gr-related-changes-list
                change="[[_change]]"
                id="relatedChanges"
                mergeable="[[_mergeable]]"
                patch-num="[[_computeLatestPatchNum(_allPatchSets)]]"
              ></gr-related-changes-list>
            </div>
            <div class="emptySpace"></div>
          </div>
        </div>
      </div>
    </section>

    <h2 class="assistive-tech-only">Files and Comments tabs</h2>
    <paper-tabs id="primaryTabs" on-selected-changed="_setActivePrimaryTab">
      <paper-tab data-name$="[[_constants.PrimaryTab.FILES]]">Files</paper-tab>
      <paper-tab
        data-name$="[[_constants.PrimaryTab.COMMENT_THREADS]]"
        class="commentThreads"
      >
        <gr-tooltip-content
          has-tooltip=""
          title$="[[_computeTotalCommentCounts(_change.unresolved_comment_count, _changeComments)]]"
        >
          <span>Comments</span></gr-tooltip-content
        >
      </paper-tab>
      <template is="dom-if" if="[[_showChecksTab]]">
        <paper-tab data-name$="[[_constants.PrimaryTab.CHECKS]]"
          >Checks</paper-tab
        >
      </template>
      <template
        is="dom-repeat"
        items="[[_dynamicTabHeaderEndpoints]]"
        as="tabHeader"
      >
        <paper-tab data-name$="[[tabHeader]]">
          <gr-endpoint-decorator name$="[[tabHeader]]">
            <gr-endpoint-param name="change" value="[[_change]]">
            </gr-endpoint-param>
            <gr-endpoint-param name="revision" value="[[_selectedRevision]]">
            </gr-endpoint-param>
          </gr-endpoint-decorator>
        </paper-tab>
      </template>
      <paper-tab data-name$="[[_constants.PrimaryTab.FINDINGS]]">
        Findings
      </paper-tab>
    </paper-tabs>

    <section class="patchInfo">
      <div
        hidden$="[[!_isTabActive(_constants.PrimaryTab.FILES, _activeTabs)]]"
      >
        <gr-file-list-header
          id="fileListHeader"
          account="[[_account]]"
          all-patch-sets="[[_allPatchSets]]"
          change="[[_change]]"
          change-num="[[_changeNum]]"
          revision-info="[[_revisionInfo]]"
          change-comments="[[_changeComments]]"
          commit-info="[[_commitInfo]]"
          change-url="[[_computeChangeUrl(_change)]]"
          edit-mode="[[_editMode]]"
          logged-in="[[_loggedIn]]"
          server-config="[[_serverConfig]]"
          shown-file-count="[[_shownFileCount]]"
          diff-prefs="[[_diffPrefs]]"
          diff-view-mode="{{viewState.diffMode}}"
          patch-num="{{_patchRange.patchNum}}"
          base-patch-num="{{_patchRange.basePatchNum}}"
          files-expanded="[[_filesExpanded]]"
          diff-prefs-disabled="[[_diffPrefsDisabled]]"
          on-open-diff-prefs="_handleOpenDiffPrefs"
          on-open-download-dialog="_handleOpenDownloadDialog"
          on-open-included-in-dialog="_handleOpenIncludedInDialog"
          on-expand-diffs="_expandAllDiffs"
          on-collapse-diffs="_collapseAllDiffs"
        >
        </gr-file-list-header>
        <gr-file-list
          id="fileList"
          class="hideOnMobileOverlay"
          diff-prefs="{{_diffPrefs}}"
          change="[[_change]]"
          change-num="[[_changeNum]]"
          patch-range="{{_patchRange}}"
          change-comments="[[_changeComments]]"
          revisions="[[_change.revisions]]"
          selected-index="{{viewState.selectedFileIndex}}"
          diff-view-mode="[[viewState.diffMode]]"
          edit-mode="[[_editMode]]"
          num-files-shown="{{_numFilesShown}}"
          files-expanded="{{_filesExpanded}}"
          file-list-increment="{{_numFilesShown}}"
          on-files-shown-changed="_setShownFiles"
          on-file-action-tap="_handleFileActionTap"
          on-reload-drafts="_reloadDraftsWithCallback"
        >
        </gr-file-list>
      </div>
      <template
        is="dom-if"
        if="[[_isTabActive(_constants.PrimaryTab.COMMENT_THREADS, _activeTabs)]]"
      >
        <gr-thread-list
          threads="[[_commentThreads]]"
          change="[[_change]]"
          change-num="[[_changeNum]]"
          logged-in="[[_loggedIn]]"
          comment-tab-state="[[_tabState.commentTab]]"
          only-show-robot-comments-with-human-reply=""
          unresolved-only
          show-comment-context
        ></gr-thread-list>
      </template>
      <template
        is="dom-if"
        if="[[_isTabActive(_constants.PrimaryTab.CHECKS, _activeTabs)]]"
      >
        <gr-checks-tab
          id="checksTab"
          tab-state="[[_tabState.checksTab]]"
        ></gr-checks-tab>
      </template>
      <template
        is="dom-if"
        if="[[_isTabActive(_constants.PrimaryTab.FINDINGS, _activeTabs)]]"
      >
        <gr-dropdown-list
          class="patch-set-dropdown"
          items="[[_robotCommentsPatchSetDropdownItems]]"
          on-value-change="_handleRobotCommentPatchSetChanged"
          value="[[_currentRobotCommentsPatchSet]]"
        >
        </gr-dropdown-list>
        <gr-thread-list
          threads="[[_robotCommentThreads]]"
          change="[[_change]]"
          change-num="[[_changeNum]]"
          logged-in="[[_loggedIn]]"
          hide-toggle-buttons
          empty-thread-msg="[[_messages.NO_ROBOT_COMMENTS_THREADS_MSG]]"
        >
        </gr-thread-list>
        <template is="dom-if" if="[[_showRobotCommentsButton]]">
          <gr-button
            class="show-robot-comments"
            on-click="_toggleShowRobotComments"
          >
            [[_computeShowText(_showAllRobotComments)]]
          </gr-button>
        </template>
      </template>

      <template
        is="dom-if"
        if="[[_isTabActive(_selectedTabPluginHeader, _activeTabs)]]"
      >
        <gr-endpoint-decorator name$="[[_selectedTabPluginEndpoint]]">
          <gr-endpoint-param name="change" value="[[_change]]">
          </gr-endpoint-param>
          <gr-endpoint-param name="revision" value="[[_selectedRevision]]">
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </template>
    </section>

    <gr-endpoint-decorator name="change-view-integration">
      <gr-endpoint-param name="change" value="[[_change]]"> </gr-endpoint-param>
      <gr-endpoint-param name="revision" value="[[_selectedRevision]]">
      </gr-endpoint-param>
    </gr-endpoint-decorator>

    <paper-tabs id="secondaryTabs" on-selected-changed="_setActiveSecondaryTab">
      <paper-tab
        data-name$="[[_constants.SecondaryTab.CHANGE_LOG]]"
        class="changeLog"
      >
        Change Log
      </paper-tab>
    </paper-tabs>
    <section class="changeLog">
      <h2 class="assistive-tech-only">Change Log</h2>
      <template
        is="dom-if"
        if="[[_isTabActive(_constants.SecondaryTab.CHANGE_LOG, _activeTabs)]]"
      >
        <gr-messages-list
          class="hideOnMobileOverlay"
          change="[[_change]]"
          change-num="[[_changeNum]]"
          labels="[[_change.labels]]"
          messages="[[_change.messages]]"
          reviewer-updates="[[_change.reviewer_updates]]"
          change-comments="[[_changeComments]]"
          project-name="[[_change.project]]"
          show-reply-buttons="[[_loggedIn]]"
          on-message-anchor-tap="_handleMessageAnchorTap"
          on-reply="_handleMessageReply"
        ></gr-messages-list>
      </template>
    </section>
  </div>

  <gr-apply-fix-dialog
    id="applyFixDialog"
    prefs="[[_diffPrefs]]"
    change="[[_change]]"
    change-num="[[_changeNum]]"
  ></gr-apply-fix-dialog>
  <gr-overlay id="downloadOverlay" with-backdrop="">
    <gr-download-dialog
      id="downloadDialog"
      change="[[_change]]"
      patch-num="[[_patchRange.patchNum]]"
      config="[[_serverConfig.download]]"
      on-close="_handleDownloadDialogClose"
    ></gr-download-dialog>
  </gr-overlay>
  <gr-overlay id="includedInOverlay" with-backdrop="">
    <gr-included-in-dialog
      id="includedInDialog"
      change-num="[[_changeNum]]"
      on-close="_handleIncludedInDialogClose"
    ></gr-included-in-dialog>
  </gr-overlay>
  <gr-overlay
    id="replyOverlay"
    class="scrollable"
    no-cancel-on-outside-click=""
    no-cancel-on-esc-key=""
    scroll-action="lock"
    with-backdrop=""
    on-iron-overlay-canceled="onReplyOverlayCanceled"
  >
    <gr-reply-dialog
      id="replyDialog"
      change="{{_change}}"
      patch-num="[[_computeLatestPatchNum(_allPatchSets)]]"
      permitted-labels="[[_change.permitted_labels]]"
      draft-comment-threads="[[_draftCommentThreads]]"
      project-config="[[_projectConfig]]"
      server-config="[[_serverConfig]]"
      can-be-started="[[_canStartReview]]"
      on-send="_handleReplySent"
      on-cancel="_handleReplyCancel"
      on-autogrow="_handleReplyAutogrow"
      on-send-disabled-changed="_resetReplyOverlayFocusStops"
      hidden$="[[!_loggedIn]]"
    >
    </gr-reply-dialog>
  </gr-overlay>
  <gr-comment-api id="commentAPI"></gr-comment-api>
`;class lT{constructor(e){this.change=e}getMaxParents(){return this.change&&this.change.revisions?Object.values(this.change.revisions).reduce((e,t)=>Math.max(t.commit?t.commit.parents.length:0,e),0):0}getParentCountMap(){const e={};return this.change&&this.change.revisions?(Object.values(this.change.revisions).forEach(t=>{t.commit&&(e[t._number]=t.commit.parents.length)}),e):{}}getParentCount(e){return this.getParentCountMap()[e]}getParentId(e,t){if(!this.change.revisions)return;const i=Object.values(this.change.revisions).find(t=>t._number===e);return i&&i.commit?i.commit.parents[t].commit:void 0}}const cT=mi``;var dT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let hT=class extends fi{constructor(){super(),this.preventAutoScrollOnManualScroll=!1,this.lastDisplayedNavigateToFileToast=new Map,this.side=zi.RIGHT,this.diffs=[],this.initialLineNumber=null,this._listeningForScroll=!1,this.cursorManager=new J_,this._boundHandleWindowScroll=()=>{this.preventAutoScrollOnManualScroll&&(this.cursorManager.scrollMode=Xi.NEVER,this.cursorManager.focusOnMove=!1,this.preventAutoScrollOnManualScroll=!1)},this.boundHandleDiffLoadingChanged=()=>{this._updateStops()},this._boundHandleDiffRenderStart=()=>{this.preventAutoScrollOnManualScroll=!0},this._boundHandleDiffRenderContent=()=>{this._updateStops(),this.cursorManager.focusOnMove=!0,this.preventAutoScrollOnManualScroll=!1},this._boundHandleDiffLineSelected=e=>{const t=e;this.moveToLineNumber(t.detail.number,t.detail.side,t.detail.path)},this.cursorManager.cursorTargetClass="target-row",this.cursorManager.scrollMode=Xi.KEEP_VISIBLE,this.cursorManager.focusOnMove=!0}static get template(){return cT}ready(){super.ready(),hh(this,()=>{this.dispatchEvent(new CustomEvent("ready",{composed:!0,bubbles:!1}))})}connectedCallback(){super.connectedCallback(),window.addEventListener("scroll",this._boundHandleWindowScroll),this.targetSubscription=this.cursorManager.target$.subscribe(e=>{this.diffRow=e||void 0})}disconnectedCallback(){this.targetSubscription&&this.targetSubscription.unsubscribe(),window.removeEventListener("scroll",this._boundHandleWindowScroll),this.cursorManager.unsetCursor(),super.disconnectedCallback()}isAtStart(){return this.cursorManager.isAtStart()}isAtEnd(){return this.cursorManager.isAtEnd()}moveLeft(){this.side=zi.LEFT,this._isTargetBlank()&&this.moveUp()}moveRight(){this.side=zi.RIGHT,this._isTargetBlank()&&this.moveUp()}moveDown(){return this._getViewMode()===Gi.SIDE_BY_SIDE?this.cursorManager.next({filter:e=>this._rowHasSide(e)}):this.cursorManager.next()}moveUp(){return this._getViewMode()===Gi.SIDE_BY_SIDE?this.cursorManager.previous({filter:e=>this._rowHasSide(e)}):this.cursorManager.previous()}moveToVisibleArea(){this._getViewMode()===Gi.SIDE_BY_SIDE?this.cursorManager.moveToVisibleArea(e=>this._rowHasSide(e)):this.cursorManager.moveToVisibleArea()}showToastAndFireEvent(e,t){this.lastDisplayedNavigateToFileToast.get(e)&&Date.now()-this.lastDisplayedNavigateToFileToast.get(e)<=5e3?(this.lastDisplayedNavigateToFileToast.delete(e),bi(this,`navigate-to-${e}-unreviewed-file`)):(this.lastDisplayedNavigateToFileToast.set(e,Date.now()),Ci(this,`Press ${t} again to navigate to ${e} unreviewed file`))}moveToNextChunk(e,t){const i=this.cursorManager.next({filter:e=>this._isFirstRowOfChunk(e),getTargetHeight:e=>{var t;return(null===(t=null==e?void 0:e.parentNode)||void 0===t?void 0:t.scrollHeight)||0},clipToTop:e});return t&&i===K_.CLIPPED&&this.isAtEnd()&&this.showToastAndFireEvent("next","n"),this._fixSide(),i}moveToPreviousChunk(e){const t=this.cursorManager.previous({filter:e=>this._isFirstRowOfChunk(e)});return e&&this.isAtStart()&&this.showToastAndFireEvent("previous","p"),this._fixSide(),t}moveToNextCommentThread(){if(this.isAtEnd())return void bi(this,"navigate-to-next-file-with-comments");const e=this.cursorManager.next({filter:e=>this._rowHasThread(e)});return this._fixSide(),e}moveToPreviousCommentThread(){const e=this.cursorManager.previous({filter:e=>this._rowHasThread(e)});return this._fixSide(),e}moveToLineNumber(e,t,i){const n=this._findRowByNumberAndFile(e,t,i);n&&(this.side=t,this.cursorManager.setCursor(n))}getTargetLineElement(){let e=".lineNum";return this.diffRow?(this._getViewMode()===Gi.SIDE_BY_SIDE&&(e+=this.side===zi.LEFT?".left":".right"),this.diffRow.querySelector(e)):null}getTargetDiffElement(){var e;if(!this.diffRow)return null;const t=Th(this.diffRow).getOwnerRoot();return"GR-DIFF"===(null===(e=null==t?void 0:t.host)||void 0===e?void 0:e.tagName)?t.host:null}moveToFirstChunk(){this.cursorManager.moveToStart(),this.diffRow&&!this._isFirstRowOfChunk(this.diffRow)?this.moveToNextChunk(!0):this._fixSide()}moveToLastChunk(){this.cursorManager.moveToEnd(),this.diffRow&&!this._isFirstRowOfChunk(this.diffRow)?this.moveToPreviousChunk():this._fixSide()}reInitCursor(){this.diffRow||(this.cursorManager.scrollMode=this.initialLineNumber?Xi.KEEP_VISIBLE:Xi.NEVER,this.initialLineNumber?(this.moveToLineNumber(this.initialLineNumber,this.side),this.initialLineNumber=null):this.moveToFirstChunk()),this.reInit()}reInit(){this.cursorManager.scrollMode=Xi.KEEP_VISIBLE}reInitAndUpdateStops(){this.reInit(),this._updateStops()}handleDiffUpdate(){this._updateStops(),this.reInitCursor()}createCommentInPlace(){const e=this.diffs.find(e=>e.isRangeSelected());if(e)e.createRangeComment();else{const e=this.getTargetLineElement(),t=this.getTargetDiffElement();t&&e&&t.addDraftAtLine(e)}}getAddress(){if(!this.diffRow)return null;let e;if(this._getViewMode()===Gi.UNIFIED?(e=this.diffRow.querySelector(".lineNum.right"),e||(e=this.diffRow.querySelector(".lineNum.left"))):e=this.diffRow.querySelector(".lineNum."+this.side),!e)return null;const t=e.getAttribute("data-value");return t&&"FILE"!==t?{leftSide:e.matches(".left"),number:Number(t)}:null}_getViewMode(){return this.diffRow?this.diffRow.classList.contains("side-by-side")?Gi.SIDE_BY_SIDE:Gi.UNIFIED:null}_rowHasSide(e){const t=(this.side===zi.LEFT?".left":".right")+" + .content";return!!e.querySelector(t)}_isFirstRowOfChunk(e){const t=e.parentNode.classList,i=t.contains("section")&&t.contains("delta"),n=e.previousSibling,o=!n||n.classList.contains("moveControls");return i&&o}_rowHasThread(e){return!!e.querySelector(".thread-group")}_fixSide(){this._getViewMode()===Gi.SIDE_BY_SIDE&&this._isTargetBlank()&&(this.side=this.side===zi.LEFT?zi.RIGHT:zi.LEFT)}_isTargetBlank(){if(!this.diffRow)return!1;const e=this._getActionsForRow();return this.side===zi.LEFT&&!e.left||this.side===zi.RIGHT&&!e.right}_rowChanged(e,t){t&&t.classList.remove("target-side-left","target-side-right"),this._updateSideClass()}_updateSideClass(){this.diffRow&&(vu(this.diffRow,"target-side-left",this.side===zi.LEFT),vu(this.diffRow,"target-side-right",this.side===zi.RIGHT))}_isActionType(e){return e!==Wi.BLANK&&e!==dS.CONTEXT_CONTROL}_getActionsForRow(){const e={left:!1,right:!1};return this.diffRow&&(e.left=this._isActionType(this.diffRow.getAttribute("left-type")),e.right=this._isActionType(this.diffRow.getAttribute("right-type"))),e}_updateStops(){this.cursorManager.stops=this.diffs.reduce((e,t)=>e.concat(t.getCursorStops()),[])}_diffsChanged(e){if(!e)return;let t,i;this._updateStops();for(let n=0;e.indexSplices&&n<e.indexSplices.length;n++){for(t=e.indexSplices[n],i=0;i<(null==t?void 0:t.removed.length);i++)t.removed[i].removeEventListener("loading-changed",this.boundHandleDiffLoadingChanged),t.removed[i].removeEventListener("render-start",this._boundHandleDiffRenderStart),t.removed[i].removeEventListener("render-content",this._boundHandleDiffRenderContent),t.removed[i].removeEventListener("line-selected",this._boundHandleDiffLineSelected);for(i=t.index;i<t.index+t.addedCount;i++)this.diffs[i].addEventListener("loading-changed",this.boundHandleDiffLoadingChanged),this.diffs[i].addEventListener("render-start",this._boundHandleDiffRenderStart),this.diffs[i].addEventListener("render-content",this._boundHandleDiffRenderContent),this.diffs[i].addEventListener("line-selected",this._boundHandleDiffLineSelected)}}_findRowByNumberAndFile(e,t,i){let n;if(i){n=this.diffs.filter(e=>e.path===i)[0].getCursorStops()}else n=this.cursorManager.stops;const o=n.filter(X_),r=`.lineNum.${t}[data-value="${e}"]`;return o.find(e=>e.querySelector(r))}};dT([Oo({type:String})],hT.prototype,"side",void 0),dT([Oo({type:Object,notify:!0,observer:"_rowChanged"})],hT.prototype,"diffRow",void 0),dT([Oo({type:Object})],hT.prototype,"diffs",void 0),dT([Oo({type:Number})],hT.prototype,"initialLineNumber",void 0),dT([Oo({type:Boolean})],hT.prototype,"_listeningForScroll",void 0),dT([No("side")],hT.prototype,"_updateSideClass",null),dT([No("diffs.splices")],hT.prototype,"_diffsChanged",null),hT=dT([Po("gr-diff-cursor")],hT);const pT=mi`
  <gr-diff
    id="diff"
    change-num="[[changeNum]]"
    no-auto-render="[[noAutoRender]]"
    path="[[path]]"
    prefs="[[prefs]]"
    display-line="[[displayLine]]"
    is-image-diff="[[isImageDiff]]"
    hidden$="[[hidden]]"
    no-render-on-prefs-change="[[noRenderOnPrefsChange]]"
    line-wrapping="[[lineWrapping]]"
    view-mode="[[viewMode]]"
    line-of-interest="[[lineOfInterest]]"
    logged-in="[[_loggedIn]]"
    error-message="[[_errorMessage]]"
    base-image="[[_baseImage]]"
    revision-image="[[_revisionImage]]"
    coverage-ranges="[[_coverageRanges]]"
    blame="[[_blame]]"
    layers="[[_layers]]"
    diff="[[diff]]"
    show-newline-warning-left="[[_showNewlineWarningLeft(diff)]]"
    show-newline-warning-right="[[_showNewlineWarningRight(diff)]]"
    use-new-image-diff-ui="[[_useNewImageDiffUi()]]"
  >
  </gr-diff>
`;var uT;!function(e){e.NEW_IMAGE_DIFF_UI="UiFeature__new_image_diff_ui",e.TOKEN_HIGHLIGHTING="UiFeature__token_highlighting"}(uT||(uT={}));var gT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};function mT(e){if(!e)return!1;const t=e.meta_a&&e.meta_a.content_type.startsWith("image/"),i=e.meta_b&&e.meta_b.content_type.startsWith("image/");return!(!e.binary||!t&&!i)}let fT=class extends fi{constructor(){super(),this.noAutoRender=!1,this.displayLine=!1,this.filesWeblinks={},this.hidden=!1,this.noRenderOnPrefsChange=!1,this.lineWrapping=!1,this.viewMode=Gi.SIDE_BY_SIDE,this._loggedIn=!1,this._errorMessage=null,this._baseImage=null,this._revisionImage=null,this._fetchDiffPromise=null,this._blame=null,this._coverageRanges=[],this._parentIndex=null,this._layers=[],this.reporting=i.reportingService,this.flags=i.flagsService,this.restApiService=i.restApiService,this.jsAPI=i.jsApiService,this.syntaxLayer=new YE,this.addEventListener("create-comment",e=>this._handleCreateComment(e)),this.addEventListener("comment-discard",()=>this._handleCommentSaveOrDiscard()),this.addEventListener("comment-save",()=>this._handleCommentSaveOrDiscard()),this.addEventListener("render-start",()=>this._handleRenderStart()),this.addEventListener("render-content",()=>this._handleRenderContent()),this.addEventListener("normalize-range",e=>this._handleNormalizeRange(e)),this.addEventListener("diff-context-expanded",e=>this._handleDiffContextExpanded(e))}static get template(){return pT}ready(){super.ready(),this._canReload()&&this.reload()}connectedCallback(){super.connectedCallback(),this._getLoggedIn().then(e=>{this._loggedIn=e})}disconnectedCallback(){this.clear(),super.disconnectedCallback()}initLayers(){return Qu().awaitPluginsLoaded().then(()=>{a(this.path,"path"),this._layers=this._getLayers(this.path),this._coverageRanges=[],this._getCoverageData()})}diffChanged(e){this.syntaxLayer.init(e)}async reload(e){var t;this.clear(),a(this.path,"path"),a(this.changeNum,"changeNum"),this.diff=void 0,this._errorMessage=null;const i=this._getIgnoreWhitespace();e&&this._listenToViewportRender();try{const n=this.initLayers(),o=await this._getDiff();this._loadedWhitespaceLevel=i,this._reportDiff(o),await this._loadDiffAssets(o),await n,this.filesWeblinks=this._getFilesWeblinks(o),this.diff=o;const r=await Pi(this,"render");if(e&&this.reporting.diffViewContentDisplayed(),!!(null===(t=r.detail)||void 0===t?void 0:t.contentRendered)){this.reporting.time(p.DIFF_SYNTAX);try{await this.syntaxLayer.process()}finally{this.reporting.timeEnd(p.DIFF_SYNTAX)}}}catch(e){e instanceof Response?this._handleGetDiffError(e):console.warn("Error encountered loading diff:",e)}finally{this.reporting.timeEnd(p.DIFF_TOTAL)}}_getLayers(e){return[this.syntaxLayer,...this.jsAPI.getDiffLayers(e)]}clear(){this.path&&this.jsAPI.disposeDiffLayers(this.path),this._layers=[]}_getCoverageData(){a(this.changeNum,"changeNum"),a(this.change,"change"),a(this.path,"path"),a(this.patchRange,"patchRange");const e=this.changeNum,t=this.change,i=this.path,n=e=>Wn(e)?e:void 0,o=n(this.patchRange.basePatchNum),r=n(this.patchRange.patchNum);this.jsAPI.getCoverageAnnotationApis().then(s=>{s.forEach(s=>{const l=s.getCoverageProvider();l&&l(e,i,o,r,t).then(l=>{if(a(this.patchRange,"patchRange"),!l||e!==this.changeNum||t!==this.change||i!==this.path||o!==n(this.patchRange.basePatchNum)||r!==n(this.patchRange.patchNum))return;const c=this._coverageRanges;this._coverageRanges=l,c.forEach(e=>{s.notify(i,e.code_range.start_line,e.code_range.end_line,e.side)}),l.forEach(e=>{s.notify(i,e.code_range.start_line,e.code_range.end_line,e.side)})}).catch(e=>{console.warn("Applying coverage from provider failed: ",e)})})}).catch(e=>{console.warn("Loading coverage ranges failed: ",e)})}_getFilesWeblinks(e){var t,i;return this.projectName&&this.commitRange&&this.path?{meta_a:Qm.getFileWebLinks(this.projectName,this.commitRange.baseCommit,this.path,{weblinks:null===(t=null==e?void 0:e.meta_a)||void 0===t?void 0:t.web_links}),meta_b:Qm.getFileWebLinks(this.projectName,this.commitRange.commit,this.path,{weblinks:null===(i=null==e?void 0:e.meta_b)||void 0===i?void 0:i.web_links})}:{}}cancel(){this.$.diff.cancel(),this.syntaxLayer.cancel()}getCursorStops(){return this.$.diff.getCursorStops()}isRangeSelected(){return this.$.diff.isRangeSelected()}createRangeComment(){return this.$.diff.createRangeComment()}toggleLeftDiff(){this.$.diff.toggleLeftDiff()}loadBlame(){return a(this.changeNum,"changeNum"),a(this.patchRange,"patchRange"),a(this.path,"path"),this.restApiService.getBlame(this.changeNum,this.patchRange.patchNum,this.path,!0).then(e=>e&&e.length?(this._blame=e,e):(Ci(this,"No blame information for this diff."),Promise.reject("No blame information for this diff.")))}clearBlame(){this._blame=null}getThreadEls(){return Array.from(this.$.diff.querySelectorAll(".comment-thread"))}addDraftAtLine(e){this.$.diff.addDraftAtLine(e)}clearDiffContent(){this.$.diff.clearDiffContent()}toggleAllContext(){this.$.diff.toggleAllContext()}_getLoggedIn(){return this.restApiService.getLoggedIn()}_canReload(){return!(!this.changeNum||!this.patchRange||!this.path||this.noAutoRender)}prefetchDiff(){this.changeNum&&this.patchRange&&this.path&&null===this._fetchDiffPromise&&(this._fetchDiffPromise=this._getDiff())}_getDiff(){if(null!==this._fetchDiffPromise){const e=this._fetchDiffPromise;return this._fetchDiffPromise=null,e}return new Promise((e,t)=>{a(this.changeNum,"changeNum"),a(this.patchRange,"patchRange"),a(this.path,"path"),this.restApiService.getDiff(this.changeNum,this.patchRange.basePatchNum,this.patchRange.patchNum,this.path,this._getIgnoreWhitespace(),t).then(t=>e(t))})}_handleGetDiffError(e){409!==e.status?this.showLoadFailure?this._errorMessage=["Encountered error when loading the diff:",e.status,e.statusText].join(" "):Si(e):Ei(e)}_reportDiff(e){if(!e||!e.content)return;let t=0,i=0;e.content.forEach(e=>{if(e.ab)return;const n=Math.max(e.a?e.a.length:0,e.b?e.b.length:0);e.due_to_rebase?i+=n:t+=n});const n=i+t,o=n?Math.round(100*i/n):0;a(this.patchRange,"patchRange"),"PARENT"===this.patchRange.basePatchNum?this.reporting.reportInteraction("diff-against-parent"):0===o?this.reporting.reportInteraction("rebase-percent-zero"):this.reporting.reportInteraction("rebase-percent-nonzero",{percentRebaseDelta:o})}_loadDiffAssets(e){return mT(e)?this._getImages(e).then(e=>{this._baseImage=e.baseImage,this._revisionImage=e.revisionImage}):(this._baseImage=null,this._revisionImage=null,Promise.resolve())}_computeIsImageDiff(e){return mT(e)}_threadsChanged(e){this._clearThreads();for(const t of e){const e=this._createThreadElement(t);this._attachThreadElement(e)}const t=e.filter(e=>e.ported).length,i=e.filter(e=>e.ported&&e.rangeInfoLost).length;t>0&&this.reporting.reportInteraction("ported-threads-shown",{ported:t,portedThreadsWithoutRange:i})}_computeIsBlameLoaded(e){return!!e}_getImages(e){return a(this.changeNum,"changeNum"),a(this.patchRange,"patchRange"),this.restApiService.getImagesForDiff(this.changeNum,e,this.patchRange)}_handleCreateComment(e){if(!this.patchRange)throw Error("patch range not set");const{lineNum:t,side:i,range:n,path:o}=e.detail,r=i!==zi.LEFT||zn(this.patchRange.basePatchNum)?this.patchRange.patchNum:this.patchRange.basePatchNum,s=i===zi.LEFT&&zn(this.patchRange.basePatchNum)?fn.PARENT:fn.REVISION;this.canCommentOnPatchSetNum(r)&&(this._getOrCreateThread(r,t,i,s,o,n).addOrEditDraft(t,n),this.reporting.recordDraftInteraction())}canCommentOnPatchSetNum(e){if(!this._loggedIn)return bi(this,"show-auth-required"),!1;if(!this.patchRange)return Ci(this,"Cannot create comment. patchRange undefined."),!1;const t="edit"===e,i="PARENT"===e&&"edit"===this.patchRange.patchNum;return t?(Ci(this,"You cannot comment on an edit."),!1):!i||(Ci(this,"You cannot comment on the base patchset of an edit."),!1)}_getOrCreateThread(e,t,i,n,o,r){let s=this._getThreadEl(t,i,r);return s||(s=this._createThreadElement({comments:[],path:o,diffSide:i,commentSide:n,patchNum:e,line:t,range:r}),this._attachThreadElement(s)),s}_attachThreadElement(e){this.$.diff.appendChild(e)}_clearThreads(){for(const e of this.getThreadEls()){const t=e.parentNode;t&&t.removeChild(e)}}_createThreadElement(e){const t=document.createElement("gr-comment-thread");t.className="comment-thread",t.setAttribute("slot",`${e.diffSide}-${e.line||"LOST"}`),t.comments=e.comments,t.diffSide=e.diffSide,t.isOnParent=e.commentSide===fn.PARENT,t.parentIndex=this._parentIndex,this.file&&this.file.basePath&&e.diffSide===zi.LEFT&&!t.isOnParent?t.path=this.file.basePath:t.path=this.path,t.changeNum=this.changeNum,t.patchNum=e.patchNum,t.showPatchset=!1,t.showPortedComment=!!e.ported,e.rangeInfoLost?t.lineNum="LOST":t.lineNum="FILE"!==e.line?e.line:void 0,t.projectName=this.projectName,t.range=e.range;const i=e=>{const t=e.currentTarget,n=t.parentNode;n&&n.removeChild(t),t.removeEventListener("thread-discard",i)};return t.addEventListener("thread-discard",i),t}_getThreadEl(e,t,i){let n;if(t===zi.LEFT)n={beforeNumber:e};else{if(t!==zi.RIGHT)throw new Error(`Unknown side: ${t}`);n={afterNumber:e}}const o=this._filterThreadElsForLocation(this.getThreadEls(),n,t).filter((function(e){return wS(xS(e),i)}));return o.length?o[0]:null}_filterThreadElsForLocation(e,t,i){const n=[];return i===zi.LEFT&&n.push((function(e){return AS(e)===zi.LEFT&&ES(e)===t.beforeNumber})),i===zi.RIGHT&&n.push((function(e){return AS(e)===zi.RIGHT&&ES(e)===t.afterNumber})),"FILE"!==t.afterNumber&&"FILE"!==t.beforeNumber||n.push((function(e){return AS(e)===i&&"FILE"===ES(e)})),e.filter(e=>n.some(t=>t(e)))}_getIgnoreWhitespace(){return this.prefs&&this.prefs.ignore_whitespace?this.prefs.ignore_whitespace:"IGNORE_NONE"}_whitespaceChanged(e,t,i){void 0!==e&&void 0!==t&&void 0!==i&&(this._fetchDiffPromise=null,e===t||i||this.reload())}_syntaxHighlightingChanged(e,t){void 0!==e&&void 0!==t&&"prefs.syntax_highlighting"===t.path&&(e||this.reload())}_computeParentIndex(e){return e.base&&Gn(e.base.basePatchNum)?to(e.base.basePatchNum):null}_handleCommentSaveOrDiscard(){bi(this,"diff-comments-modified")}_syntaxHighlightingEnabledChanged(e){this.syntaxLayer.setEnabled(e)}_isSyntaxHighlightingEnabled(e,t){var i;return!!((null===(i=null==e?void 0:e.base)||void 0===i?void 0:i.syntax_highlighting)&&t)&&(this._anyLineTooLong(t)?(Ci(this,"Files with line longer than 500 characters  will not be syntax highlighted."),!1):!(this.$.diff.getDiffLength(t)>2e4)||(Ci(this,"Files with more than 20000 lines  will not be syntax highlighted."),!1))}_anyLineTooLong(e){return!!e&&e.content.some(e=>(e.ab?e.ab:(e.a||[]).concat(e.b||[])).some(e=>e.length>=500))}_listenToViewportRender(){const e=t=>{t>120&&(this.reporting.diffViewDisplayed(),this.syntaxLayer.removeListener(e))};this.syntaxLayer.addListener(e)}_handleRenderStart(){this.reporting.time(p.DIFF_TOTAL),this.reporting.time(p.DIFF_CONTENT)}_handleRenderContent(){this.reporting.timeEnd(p.DIFF_CONTENT)}_handleNormalizeRange(e){this.reporting.reportInteraction("normalize-range",{side:e.detail.side,lineNum:e.detail.lineNum})}_handleDiffContextExpanded(e){this.reporting.reportInteraction("diff-context-expanded",{numLines:e.detail.numLines})}_lastChunkForSide(e,t){if(!(null==e?void 0:e.content.length))return null;let i,n=e.content.length;do{n--,i=e.content[n]}while(n>=0&&!i.ab&&(t&&(!i.a||!i.a.length)||!t&&(!i.b||!i.b.length)));return-1===n?null:i}_hasTrailingNewlines(e,t){const i=this._lastChunkForSide(e,t);if(!i)return null;let n;return n=i.ab?i.ab:t?i.a:i.b,n?""===n[n.length-1]:null}_showNewlineWarningLeft(e){return!1===this._hasTrailingNewlines(e,!0)}_showNewlineWarningRight(e){return!1===this._hasTrailingNewlines(e,!1)}_useNewImageDiffUi(){return this.flags.isEnabled(uT.NEW_IMAGE_DIFF_UI)}};gT([Oo({type:Number})],fT.prototype,"changeNum",void 0),gT([Oo({type:Object})],fT.prototype,"change",void 0),gT([Oo({type:Boolean})],fT.prototype,"noAutoRender",void 0),gT([Oo({type:Object})],fT.prototype,"patchRange",void 0),gT([Oo({type:Object})],fT.prototype,"file",void 0),gT([Oo({type:String})],fT.prototype,"path",void 0),gT([Oo({type:Object})],fT.prototype,"prefs",void 0),gT([Oo({type:String})],fT.prototype,"projectName",void 0),gT([Oo({type:Boolean})],fT.prototype,"displayLine",void 0),gT([Oo({type:Boolean,computed:"_computeIsImageDiff(diff)",notify:!0})],fT.prototype,"isImageDiff",void 0),gT([Oo({type:Object})],fT.prototype,"commitRange",void 0),gT([Oo({type:Object,notify:!0})],fT.prototype,"filesWeblinks",void 0),gT([Oo({type:Boolean,reflectToAttribute:!0})],fT.prototype,"hidden",void 0),gT([Oo({type:Boolean})],fT.prototype,"noRenderOnPrefsChange",void 0),gT([Oo({type:Object,observer:"_threadsChanged"})],fT.prototype,"threads",void 0),gT([Oo({type:Boolean})],fT.prototype,"lineWrapping",void 0),gT([Oo({type:String})],fT.prototype,"viewMode",void 0),gT([Oo({type:Object})],fT.prototype,"lineOfInterest",void 0),gT([Oo({type:Boolean})],fT.prototype,"showLoadFailure",void 0),gT([Oo({type:Boolean,notify:!0,computed:"_computeIsBlameLoaded(_blame)"})],fT.prototype,"isBlameLoaded",void 0),gT([Oo({type:Boolean})],fT.prototype,"_loggedIn",void 0),gT([Oo({type:String})],fT.prototype,"_errorMessage",void 0),gT([Oo({type:Object})],fT.prototype,"_baseImage",void 0),gT([Oo({type:Object})],fT.prototype,"_revisionImage",void 0),gT([Oo({type:Object,notify:!0,observer:"diffChanged"})],fT.prototype,"diff",void 0),gT([Oo({type:Object})],fT.prototype,"_fetchDiffPromise",void 0),gT([Oo({type:Object})],fT.prototype,"_blame",void 0),gT([Oo({type:Array})],fT.prototype,"_coverageRanges",void 0),gT([Oo({type:String})],fT.prototype,"_loadedWhitespaceLevel",void 0),gT([Oo({type:Number,computed:"_computeParentIndex(patchRange.*)"})],fT.prototype,"_parentIndex",void 0),gT([Oo({type:Boolean,computed:"_isSyntaxHighlightingEnabled(prefs.*, diff)",observer:"_syntaxHighlightingEnabledChanged"})],fT.prototype,"_syntaxHighlightingEnabled",void 0),gT([Oo({type:Array})],fT.prototype,"_layers",void 0),gT([No("prefs.ignore_whitespace","_loadedWhitespaceLevel","noRenderOnPrefsChange")],fT.prototype,"_whitespaceChanged",null),gT([No("noRenderOnPrefsChange","prefs.*")],fT.prototype,"_syntaxHighlightingChanged",null),fT=gT([Po("gr-diff-host")],fT);const _T=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div id="diffPreferences" class="gr-form-styles">
    <section>
      <label for="contextLineSelect" class="title">Context</label>
      <span class="value">
        <gr-select id="contextSelect" bind-value="{{diffPrefs.context}}">
          <select
            id="contextLineSelect"
            on-keypress="_handleDiffPrefsChanged"
            on-change="_handleDiffPrefsChanged"
          >
            <option value="3">3 lines</option>
            <option value="10">10 lines</option>
            <option value="25">25 lines</option>
            <option value="50">50 lines</option>
            <option value="75">75 lines</option>
            <option value="100">100 lines</option>
            <option value="-1">Whole file</option>
          </select>
        </gr-select>
      </span>
    </section>
    <section>
      <label for="lineWrappingInput" class="title">Fit to screen</label>
      <span class="value">
        <input
          id="lineWrappingInput"
          type="checkbox"
          checked="[[diffPrefs.line_wrapping]]"
          on-change="_handleLineWrappingTap"
        />
      </span>
    </section>
    <section>
      <label for="columnsInput" class="title">Diff width</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{diffPrefs.line_length}}"
          on-keypress="_handleDiffPrefsChanged"
          on-change="_handleDiffPrefsChanged"
        >
          <input
            is="iron-input"
            type="number"
            id="columnsInput"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{diffPrefs.line_length}}"
            on-keypress="_handleDiffPrefsChanged"
            on-change="_handleDiffPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label for="tabSizeInput" class="title">Tab width</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{diffPrefs.tab_size}}"
          on-keypress="_handleDiffPrefsChanged"
          on-change="_handleDiffPrefsChanged"
        >
          <input
            is="iron-input"
            type="number"
            id="tabSizeInput"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{diffPrefs.tab_size}}"
            on-keypress="_handleDiffPrefsChanged"
            on-change="_handleDiffPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section hidden$="[[!diffPrefs.font_size]]">
      <label for="fontSizeInput" class="title">Font size</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{diffPrefs.font_size}}"
          on-keypress="_handleDiffPrefsChanged"
          on-change="_handleDiffPrefsChanged"
        >
          <input
            is="iron-input"
            type="number"
            id="fontSizeInput"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{diffPrefs.font_size}}"
            on-keypress="_handleDiffPrefsChanged"
            on-change="_handleDiffPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label for="showTabsInput" class="title">Show tabs</label>
      <span class="value">
        <input
          id="showTabsInput"
          type="checkbox"
          checked="[[diffPrefs.show_tabs]]"
          on-change="_handleShowTabsTap"
        />
      </span>
    </section>
    <section>
      <label for="showTrailingWhitespaceInput" class="title"
        >Show trailing whitespace</label
      >
      <span class="value">
        <input
          id="showTrailingWhitespaceInput"
          type="checkbox"
          checked="[[diffPrefs.show_whitespace_errors]]"
          on-change="_handleShowTrailingWhitespaceTap"
        />
      </span>
    </section>
    <section>
      <label for="syntaxHighlightInput" class="title"
        >Syntax highlighting</label
      >
      <span class="value">
        <input
          id="syntaxHighlightInput"
          type="checkbox"
          checked="[[diffPrefs.syntax_highlighting]]"
          on-change="_handleSyntaxHighlightTap"
        />
      </span>
    </section>
    <section>
      <label for="automaticReviewInput" class="title"
        >Automatically mark viewed files reviewed</label
      >
      <span class="value">
        <input
          id="automaticReviewInput"
          type="checkbox"
          checked="[[!diffPrefs.manual_review]]"
          on-change="_handleAutomaticReviewTap"
        />
      </span>
    </section>
    <section>
      <div class="pref">
        <label for="ignoreWhiteSpace" class="title">Ignore Whitespace</label>
        <span class="value">
          <gr-select bind-value="{{diffPrefs.ignore_whitespace}}">
            <select
              id="ignoreWhiteSpace"
              on-keypress="_handleDiffPrefsChanged"
              on-change="_handleDiffPrefsChanged"
            >
              <option value="IGNORE_NONE">None</option>
              <option value="IGNORE_TRAILING">Trailing</option>
              <option value="IGNORE_LEADING_AND_TRAILING">
                Leading &amp; trailing
              </option>
              <option value="IGNORE_ALL">All</option>
            </select>
          </gr-select>
        </span>
      </div>
    </section>
  </div>
`;var vT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let yT=class extends fi{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this.restApiService=i.restApiService}static get template(){return _T}loadData(){return this.restApiService.getDiffPreferences().then(e=>{this.diffPrefs=e})}_handleDiffPrefsChanged(){this.hasUnsavedChanges=!0}_handleLineWrappingTap(){this.set("diffPrefs.line_wrapping",this.$.lineWrappingInput.checked),this._handleDiffPrefsChanged()}_handleShowTabsTap(){this.set("diffPrefs.show_tabs",this.$.showTabsInput.checked),this._handleDiffPrefsChanged()}_handleShowTrailingWhitespaceTap(){this.set("diffPrefs.show_whitespace_errors",this.$.showTrailingWhitespaceInput.checked),this._handleDiffPrefsChanged()}_handleSyntaxHighlightTap(){this.set("diffPrefs.syntax_highlighting",this.$.syntaxHighlightInput.checked),this._handleDiffPrefsChanged()}_handleAutomaticReviewTap(){this.set("diffPrefs.manual_review",!this.$.automaticReviewInput.checked),this._handleDiffPrefsChanged()}save(){return this.diffPrefs?this.restApiService.saveDiffPreferences(this.diffPrefs).then(e=>{this.hasUnsavedChanges=!1}):Promise.reject(new Error("Missing diff preferences"))}};vT([Oo({type:Boolean,notify:!0})],yT.prototype,"hasUnsavedChanges",void 0),vT([Oo({type:Object})],yT.prototype,"diffPrefs",void 0),yT=vT([Po("gr-diff-preferences")],yT);const bT=mi`
  <style include="shared-styles">
    .diffHeader,
    .diffActions {
      padding: var(--spacing-l) var(--spacing-xl);
    }
    .diffHeader,
    .diffActions {
      background-color: var(--dialog-background-color);
    }
    .diffHeader {
      border-bottom: 1px solid var(--border-color);
      font-weight: var(--font-weight-bold);
    }
    .diffActions {
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: flex-end;
    }
    .diffPrefsOverlay gr-button {
      margin-left: var(--spacing-l);
    }
    div.edited:after {
      color: var(--deemphasized-text-color);
      content: ' *';
    }
    #diffPreferences {
      display: flex;
      padding: var(--spacing-s) var(--spacing-xl);
    }
  </style>
  <gr-overlay id="diffPrefsOverlay" with-backdrop="">
    <div role="dialog" aria-labelledby="diffPreferencesTitle">
      <h1
        class$="diffHeader [[_computeHeaderClass(_diffPrefsChanged)]]"
        id="diffPreferencesTitle"
      >
        Diff Preferences
      </h1>
      <gr-diff-preferences
        id="diffPreferences"
        diff-prefs="{{_editableDiffPrefs}}"
        has-unsaved-changes="{{_diffPrefsChanged}}"
      ></gr-diff-preferences>
      <div class="diffActions">
        <gr-button id="cancelButton" link="" on-click="_handleCancelDiff">
          Cancel
        </gr-button>
        <gr-button
          id="saveButton"
          link=""
          primary=""
          on-click="_handleSaveDiffPreferences"
          disabled$="[[!_diffPrefsChanged]]"
        >
          Save
        </gr-button>
      </div>
    </div>
  </gr-overlay>
`;var wT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let CT=class extends fi{static get template(){return bT}getFocusStops(){return{start:this.$.diffPreferences.$.contextSelect,end:this.$.saveButton.disabled?this.$.cancelButton:this.$.saveButton}}resetFocus(){this.$.diffPreferences.$.contextSelect.focus()}_computeHeaderClass(e){return e?"edited":""}_handleCancelDiff(e){e.stopPropagation(),this.$.diffPrefsOverlay.close()}_onDiffPrefsChanged(){this.$.diffPrefsOverlay.setFocusStops(this.getFocusStops())}open(){this._editableDiffPrefs=JSON.parse(JSON.stringify(this.diffPrefs)),this.$.diffPrefsOverlay.open().then(()=>{const e=this.getFocusStops();this.$.diffPrefsOverlay.setFocusStops(e),this.resetFocus()})}_handleSaveDiffPreferences(){this.diffPrefs=this._editableDiffPrefs,this.$.diffPreferences.save().then(()=>{this.dispatchEvent(new CustomEvent("reload-diff-preference",{composed:!0,bubbles:!1})),this.$.diffPrefsOverlay.close()})}};wT([Oo({type:Object})],CT.prototype,"diffPrefs",void 0),wT([Oo({type:Object})],CT.prototype,"_editableDiffPrefs",void 0),wT([Oo({type:Boolean,observer:"_onDiffPrefsChanged"})],CT.prototype,"_diffPrefsChanged",void 0),CT=wT([Po("gr-diff-preferences-dialog")],CT);const ST=mi`
  <style include="shared-styles">
    :host {
      align-items: center;
      display: flex;
      justify-content: flex-end;
    }
    #actions {
      margin-right: var(--spacing-l);
    }
    gr-button,
    gr-dropdown {
      --gr-button: {
        height: 1.8em;
      }
    }
    gr-dropdown {
      --gr-dropdown-item: {
        background-color: transparent;
        border: none;
        color: var(--link-color);
        text-transform: uppercase;
      }
    }
  </style>
  <gr-dropdown
    id="actions"
    items="[[_fileActions]]"
    down-arrow=""
    vertical-offset="20"
    on-tap-item="_handleActionTap"
    link=""
    >Actions</gr-dropdown
  >
`;var ET=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let AT=class extends fi{constructor(){super(...arguments),this._allFileActions=Object.values(Lx)}static get template(){return ST}_handleActionTap(e){e.preventDefault(),e.stopPropagation(),this._dispatchFileAction(e.detail.id,this.filePath)}_dispatchFileAction(e,t){this.dispatchEvent(new CustomEvent("file-action-tap",{detail:{action:e,path:t},bubbles:!0,composed:!0}))}_computeFileActions(e){return e.map(e=>({name:e.label,id:e.id}))}};ET([Oo({type:String})],AT.prototype,"filePath",void 0),ET([Oo({type:Array})],AT.prototype,"_allFileActions",void 0),ET([Oo({type:Array,computed:"_computeFileActions(_allFileActions)"})],AT.prototype,"_fileActions",void 0),AT=ET([Po("gr-edit-file-controls")],AT);const xT=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    .row {
      align-items: center;
      border-top: 1px solid var(--border-color);
      display: flex;
      min-height: calc(var(--line-height-normal) + 2 * var(--spacing-s));
      padding: var(--spacing-xs) var(--spacing-l);
    }
    /* The class defines a content visible only to screen readers */
    .noCommentsScreenReaderText {
      opacity: 0;
      max-width: 1px;
      overflow: hidden;
      display: none;
    }
    div[role='gridcell']
      > div.comments
      > span:empty
      + span:empty
      + span.noCommentsScreenReaderText {
      display: inline;
    }
    :host(.loading) .row {
      opacity: 0.5;
    }
    :host(.editMode) .hideOnEdit {
      display: none;
    }
    .showOnEdit {
      display: none;
    }
    :host(.editMode) .showOnEdit {
      display: initial;
    }
    .invisible {
      visibility: hidden;
    }
    .header-row {
      background-color: var(--background-color-secondary);
    }
    .controlRow {
      align-items: center;
      display: flex;
      height: 2.25em;
      justify-content: center;
    }
    .controlRow.invisible,
    .show-hide.invisible {
      display: none;
    }
    .reviewed,
    .status {
      align-items: center;
      display: inline-flex;
    }
    .reviewed {
      display: inline-block;
      text-align: left;
      width: 1.5em;
    }
    .file-row {
      cursor: pointer;
    }
    .file-row.expanded {
      border-bottom: 1px solid var(--border-color);
      position: -webkit-sticky;
      position: sticky;
      top: 0;
      /* Has to visible above the diff view, and by default has a lower
         z-index. setting to 1 places it directly above. */
      z-index: 1;
    }
    .file-row:hover {
      background-color: var(--hover-background-color);
    }
    .file-row.selected {
      background-color: var(--selection-background-color);
    }
    .file-row.expanded,
    .file-row.expanded:hover {
      background-color: var(--expanded-background-color);
    }
    .path {
      cursor: pointer;
      flex: 1;
      /* Wrap it into multiple lines if too long. */
      white-space: normal;
      word-break: break-word;
    }
    .oldPath {
      color: var(--deemphasized-text-color);
    }
    .header-stats {
      text-align: center;
      min-width: 7.5em;
    }
    .stats {
      text-align: right;
      min-width: 7.5em;
    }
    .comments {
      padding-left: var(--spacing-l);
      min-width: 7.5em;
    }
    .row:not(.header-row) .stats,
    .total-stats {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      display: flex;
    }
    .sizeBars {
      margin-left: var(--spacing-m);
      min-width: 7em;
      text-align: center;
    }
    .sizeBars.hide {
      display: none;
    }
    .added,
    .removed {
      display: inline-block;
      min-width: 3.5em;
    }
    .added {
      color: var(--positive-green-text-color);
    }
    .removed {
      color: var(--negative-red-text-color);
      text-align: left;
      min-width: 4em;
      padding-left: var(--spacing-s);
    }
    .drafts {
      color: var(--error-foreground);
      font-weight: var(--font-weight-bold);
    }
    .show-hide-icon:focus {
      outline: none;
    }
    .show-hide {
      margin-left: var(--spacing-s);
      width: 1.9em;
    }
    .fileListButton {
      margin: var(--spacing-m);
    }
    .totalChanges {
      justify-content: flex-end;
      text-align: right;
    }
    .warning {
      color: var(--deemphasized-text-color);
    }
    input.show-hide {
      display: none;
    }
    label.show-hide {
      cursor: pointer;
      display: block;
      min-width: 2em;
    }
    gr-diff {
      display: block;
      overflow-x: auto;
    }
    .truncatedFileName {
      display: none;
    }
    .mobile {
      display: none;
    }
    .reviewed {
      margin-left: var(--spacing-xxl);
      width: 15em;
    }
    .reviewedSwitch {
      color: var(--link-color);
      opacity: 0;
      justify-content: flex-end;
      width: 100%;
    }
    .reviewedSwitch:hover {
      cursor: pointer;
      opacity: 100;
    }
    .row:focus {
      outline: none;
    }
    .row:hover .reviewedSwitch,
    .row:focus-within .reviewedSwitch,
    .row.expanded .reviewedSwitch {
      opacity: 100;
    }
    .reviewedLabel {
      color: var(--deemphasized-text-color);
      margin-right: var(--spacing-l);
      opacity: 0;
    }
    .reviewedLabel.isReviewed {
      display: initial;
      opacity: 100;
    }
    .editFileControls {
      width: 7em;
    }
    .markReviewed:focus {
      outline: none;
    }
    .markReviewed,
    .pathLink {
      display: inline-block;
      margin: -2px 0;
      padding: var(--spacing-s) 0;
      text-decoration: none;
    }
    .pathLink:hover span.fullFileName,
    .pathLink:hover span.truncatedFileName {
      text-decoration: underline;
    }

    /** copy on file path **/
    .pathLink gr-copy-clipboard,
    .oldPath gr-copy-clipboard {
      display: inline-block;
      visibility: hidden;
      vertical-align: bottom;
      --gr-button: {
        padding: 0px;
      }
    }
    .row:focus-within gr-copy-clipboard,
    .row:hover gr-copy-clipboard {
      visibility: visible;
    }

    /** small screen breakpoint: 768px */
    @media screen and (max-width: 55em) {
      .desktop {
        display: none;
      }
      .mobile {
        display: block;
      }
      .row.selected {
        background-color: var(--view-background-color);
      }
      .stats {
        display: none;
      }
      .reviewed,
      .status {
        justify-content: flex-start;
      }
      .reviewed {
        display: none;
      }
      .comments {
        min-width: initial;
      }
      .expanded .fullFileName,
      .truncatedFileName {
        display: inline;
      }
      .expanded .truncatedFileName,
      .fullFileName {
        display: none;
      }
    }
    :host(.hideComments) {
      --gr-comment-thread-display: none;
    }
  </style>
  <h3 class="assistive-tech-only">File list</h3>
  <div
    id="container"
    on-click="_handleFileListClick"
    role="grid"
    aria-label="Files list"
  >
    <div class="header-row row" role="row">
      <!-- endpoint: change-view-file-list-header-prepend -->
      <template is="dom-if" if="[[_showPrependedDynamicColumns]]">
        <template
          is="dom-repeat"
          items="[[_dynamicPrependedHeaderEndpoints]]"
          as="headerEndpoint"
        >
          <gr-endpoint-decorator name$="[[headerEndpoint]]" role="columnheader">
            <gr-endpoint-param
              name="change"
              value="[[change]]"
            ></gr-endpoint-param>
            <gr-endpoint-param name="patchRange" value="[[patchRange]]">
            </gr-endpoint-param>
          </gr-endpoint-decorator>
        </template>
      </template>
      <div class="path" role="columnheader">File</div>
      <div class="comments" role="columnheader">Comments</div>
      <div class="sizeBars" role="columnheader">Size</div>
      <div class="header-stats" role="columnheader">Delta</div>
      <!-- endpoint: change-view-file-list-header -->
      <template is="dom-if" if="[[_showDynamicColumns]]">
        <template
          is="dom-repeat"
          items="[[_dynamicHeaderEndpoints]]"
          as="headerEndpoint"
        >
          <gr-endpoint-decorator name$="[[headerEndpoint]]" role="columnheader">
          </gr-endpoint-decorator>
        </template>
      </template>
      <!-- Empty div here exists to keep spacing in sync with file rows. -->
      <div
        class="reviewed hideOnEdit"
        hidden$="[[!_loggedIn]]"
        aria-hidden="true"
      ></div>
      <div class="editFileControls showOnEdit" aria-hidden="true"></div>
      <div class="show-hide" aria-hidden="true"></div>
    </div>

    <template
      is="dom-repeat"
      items="[[_shownFiles]]"
      id="files"
      as="file"
      initial-count="[[fileListIncrement]]"
      target-framerate="1"
    >
      [[_reportRenderedRow(index)]]
      <div class="stickyArea">
        <div
          class$="file-row row [[_computePathClass(file.__path, _expandedFiles.*)]]"
          data-file$="[[_computePatchSetFile(file)]]"
          tabindex="-1"
          role="row"
        >
          <!-- endpoint: change-view-file-list-content-prepend -->
          <template is="dom-if" if="[[_showPrependedDynamicColumns]]">
            <template
              is="dom-repeat"
              items="[[_dynamicPrependedContentEndpoints]]"
              as="contentEndpoint"
            >
              <gr-endpoint-decorator name="[[contentEndpoint]]" role="gridcell">
                <gr-endpoint-param name="change" value="[[change]]">
                </gr-endpoint-param>
                <gr-endpoint-param name="changeNum" value="[[changeNum]]">
                </gr-endpoint-param>
                <gr-endpoint-param name="patchRange" value="[[patchRange]]">
                </gr-endpoint-param>
                <gr-endpoint-param name="path" value="[[file.__path]]">
                </gr-endpoint-param>
                <gr-endpoint-param name="oldPath" value="[[_getOldPath(file)]]">
                </gr-endpoint-param>
              </gr-endpoint-decorator>
            </template>
          </template>
          <!-- TODO: Remove data-url as it appears its not used -->
          <span
            data-url="[[_computeDiffURL(change, patchRange, file.__path, editMode)]]"
            class="path"
            role="gridcell"
          >
            <a
              class="pathLink"
              href$="[[_computeDiffURL(change, patchRange, file.__path, editMode)]]"
            >
              <span
                title$="[[_computeDisplayPath(file.__path)]]"
                class="fullFileName"
              >
                [[_computeDisplayPath(file.__path)]]
              </span>
              <span
                title$="[[_computeDisplayPath(file.__path)]]"
                class="truncatedFileName"
              >
                [[_computeTruncatedPath(file.__path)]]
              </span>
              <gr-file-status-chip file="[[file]]"></gr-file-status-chip>
              <gr-copy-clipboard
                hide-input=""
                text="[[file.__path]]"
              ></gr-copy-clipboard>
            </a>
            <template is="dom-if" if="[[file.old_path]]">
              <div class="oldPath" title$="[[file.old_path]]">
                [[file.old_path]]
                <gr-copy-clipboard
                  hide-input=""
                  text="[[file.old_path]]"
                ></gr-copy-clipboard>
              </div>
            </template>
          </span>
          <div role="gridcell">
            <div class="comments desktop">
              <span class="drafts"
                ><!-- This comments ensure that span is empty when the function
                returns empty string.
              -->[[_computeDraftsString(changeComments, patchRange,
                file.__path)]]<!-- This comments ensure that span is empty when
                the function returns empty string.
           --></span
              >
              <span
                ><!--
              -->[[_computeCommentsString(changeComments, patchRange, file)]]<!--
           --></span
              >
              <span class="noCommentsScreenReaderText">
                <!-- Screen readers read the following content only if 2 other
              spans in the parent div is empty. The content is not visible on
              the page.
              Without this span, screen readers don't navigate correctly inside
              table, because empty div doesn't rendered. For example, VoiceOver
              jumps back to the whole table.
              We can use &nbsp instead, but it sounds worse.
              -->
                No comments
              </span>
            </div>
            <div class="comments mobile">
              <span class="drafts"
                ><!-- This comments ensure that span is empty when the function
                returns empty string.
              -->[[_computeDraftsStringMobile(changeComments, patchRange,
                file.__path)]]<!-- This comments ensure that span is empty when
                the function returns empty string.
           --></span
              >
              <span
                ><!--
             -->[[_computeCommentsStringMobile(changeComments, patchRange,
                file.__path)]]<!--
           --></span
              >
              <span class="noCommentsScreenReaderText">
                <!-- The same as for desktop comments -->
                No comments
              </span>
            </div>
          </div>
          <div role="gridcell">
            <!-- The content must be in a separate div. It guarantees, that
              gridcell always visible for screen readers.
              For example, without a nested div screen readers pronounce the
              "Commit message" row content with incorrect column headers.
            -->
            <div
              class$="[[_computeSizeBarsClass(_showSizeBars, file.__path)]]"
              aria-label="A bar that represents the addition and deletion ratio for the current file"
            >
              <svg width="61" height="8">
                <rect
                  x$="[[_computeBarAdditionX(file, _sizeBarLayout)]]"
                  y="0"
                  height="8"
                  fill="var(--positive-green-text-color)"
                  width$="[[_computeBarAdditionWidth(file, _sizeBarLayout)]]"
                ></rect>
                <rect
                  x$="[[_computeBarDeletionX(_sizeBarLayout)]]"
                  y="0"
                  height="8"
                  fill="var(--negative-red-text-color)"
                  width$="[[_computeBarDeletionWidth(file, _sizeBarLayout)]]"
                ></rect>
              </svg>
            </div>
          </div>
          <div class="stats" role="gridcell">
            <!-- The content must be in a separate div. It guarantees, that
            gridcell always visible for screen readers.
            For example, without a nested div screen readers pronounce the
            "Commit message" row content with incorrect column headers.
            -->
            <div class$="[[_computeClass('', file.__path)]]">
              <span
                class="added"
                tabindex="0"
                aria-label$="[[file.lines_inserted]] lines added"
                hidden$="[[file.binary]]"
              >
                +[[file.lines_inserted]]
              </span>
              <span
                class="removed"
                tabindex="0"
                aria-label$="[[file.lines_deleted]] lines removed"
                hidden$="[[file.binary]]"
              >
                -[[file.lines_deleted]]
              </span>
              <span
                class$="[[_computeBinaryClass(file.size_delta)]]"
                hidden$="[[!file.binary]]"
              >
                [[_formatBytes(file.size_delta)]] [[_formatPercentage(file.size,
                file.size_delta)]]
              </span>
            </div>
          </div>
          <!-- endpoint: change-view-file-list-content -->
          <template is="dom-if" if="[[_showDynamicColumns]]">
            <template
              is="dom-repeat"
              items="[[_dynamicContentEndpoints]]"
              as="contentEndpoint"
            >
              <div class$="[[_computeClass('', file.__path)]]" role="gridcell">
                <gr-endpoint-decorator name="[[contentEndpoint]]">
                  <gr-endpoint-param name="change" value="[[change]]">
                  </gr-endpoint-param>
                  <gr-endpoint-param name="changeNum" value="[[changeNum]]">
                  </gr-endpoint-param>
                  <gr-endpoint-param name="patchRange" value="[[patchRange]]">
                  </gr-endpoint-param>
                  <gr-endpoint-param name="path" value="[[file.__path]]">
                  </gr-endpoint-param>
                </gr-endpoint-decorator>
              </div>
            </template>
          </template>
          <div
            class="reviewed hideOnEdit"
            role="gridcell"
            hidden$="[[!_loggedIn]]"
          >
            <span
              class$="reviewedLabel [[_computeReviewedClass(file.isReviewed)]]"
              aria-hidden$="[[!file.isReviewed]]"
              >Reviewed</span
            >
            <!-- Do not use input type="checkbox" with hidden input and
                  visible label here. Screen readers don't read/interract
                  correctly with such input.
              -->
            <span
              class="reviewedSwitch"
              role="switch"
              tabindex="0"
              on-click="_reviewedClick"
              on-keydown="_reviewedClick"
              aria-label="Reviewed"
              aria-checked$="[[_booleanToString(file.isReviewed)]]"
            >
              <!-- Trick with tabindex to avoid outline on mouse focus, but
                preserve focus outline for keyboard navigation -->
              <span
                tabindex="-1"
                class="markReviewed"
                title$="[[_reviewedTitle(file.isReviewed)]]"
                >[[_computeReviewedText(file.isReviewed)]]</span
              >
            </span>
          </div>
          <div
            class="editFileControls showOnEdit"
            role="gridcell"
            aria-hidden$="[[!editMode]]"
          >
            <template is="dom-if" if="[[editMode]]">
              <gr-edit-file-controls
                class$="[[_computeClass('', file.__path)]]"
                file-path="[[file.__path]]"
              ></gr-edit-file-controls>
            </template>
          </div>
          <div class="show-hide" role="gridcell">
            <!-- Do not use input type="checkbox" with hidden input and
                visible label here. Screen readers don't read/interract
                correctly with such input.
            -->
            <span
              class="show-hide"
              data-path$="[[file.__path]]"
              data-expand="true"
              role="switch"
              tabindex="0"
              aria-checked$="[[_isFileExpandedStr(file.__path, _expandedFiles.*)]]"
              aria-label="Expand file"
              on-click="_expandedClick"
              on-keydown="_expandedClick"
            >
              <!-- Trick with tabindex to avoid outline on mouse focus, but
              preserve focus outline for keyboard navigation -->
              <iron-icon
                class="show-hide-icon"
                tabindex="-1"
                id="icon"
                icon="[[_computeShowHideIcon(file.__path, _expandedFiles.*)]]"
              >
              </iron-icon>
            </span>
          </div>
        </div>
        <template
          is="dom-if"
          if="[[_isFileExpanded(file.__path, _expandedFiles.*)]]"
        >
          <gr-diff-host
            no-auto-render=""
            show-load-failure=""
            display-line="[[_displayLine]]"
            hidden="[[!_isFileExpanded(file.__path, _expandedFiles.*)]]"
            change-num="[[changeNum]]"
            change="[[change]]"
            patch-range="[[patchRange]]"
            file="[[_computePatchSetFile(file)]]"
            path="[[file.__path]]"
            prefs="[[diffPrefs]]"
            project-name="[[change.project]]"
            no-render-on-prefs-change=""
            view-mode="[[diffViewMode]]"
          ></gr-diff-host>
        </template>
      </div>
    </template>
  </div>
  <div class="row totalChanges" hidden$="[[_hideChangeTotals]]">
    <div class="total-stats">
      <div>
        <span
          class="added"
          tabindex="0"
          aria-label$="Total [[_patchChange.inserted]] lines added"
        >
          +[[_patchChange.inserted]]
        </span>
        <span
          class="removed"
          tabindex="0"
          aria-label$="Total [[_patchChange.deleted]] lines removed"
        >
          -[[_patchChange.deleted]]
        </span>
      </div>
    </div>
    <!-- endpoint: change-view-file-list-summary -->
    <template is="dom-if" if="[[_showDynamicColumns]]">
      <template
        is="dom-repeat"
        items="[[_dynamicSummaryEndpoints]]"
        as="summaryEndpoint"
      >
        <gr-endpoint-decorator name="[[summaryEndpoint]]">
          <gr-endpoint-param
            name="change"
            value="[[change]]"
          ></gr-endpoint-param>
          <gr-endpoint-param name="patchRange" value="[[patchRange]]">
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </template>
    </template>
    <!-- Empty div here exists to keep spacing in sync with file rows. -->
    <div class="reviewed hideOnEdit" hidden$="[[!_loggedIn]]"></div>
    <div class="editFileControls showOnEdit"></div>
    <div class="show-hide"></div>
  </div>
  <div class="row totalChanges" hidden$="[[_hideBinaryChangeTotals]]">
    <div class="total-stats">
      <span
        class="added"
        aria-label$="Total bytes inserted: [[_formatBytes(_patchChange.size_delta_inserted)]] "
      >
        [[_formatBytes(_patchChange.size_delta_inserted)]]
        [[_formatPercentage(_patchChange.total_size,
        _patchChange.size_delta_inserted)]]
      </span>
      <span
        class="removed"
        aria-label$="Total bytes removed: [[_formatBytes(_patchChange.size_delta_deleted)]]"
      >
        [[_formatBytes(_patchChange.size_delta_deleted)]]
        [[_formatPercentage(_patchChange.total_size,
        _patchChange.size_delta_deleted)]]
      </span>
    </div>
  </div>
  <div
    class$="row controlRow [[_computeFileListControlClass(numFilesShown, _files)]]"
  >
    <gr-button
      class="fileListButton"
      id="incrementButton"
      link=""
      on-click="_incrementNumFilesShown"
    >
      [[_computeIncrementText(numFilesShown, _files)]]
    </gr-button>
    <gr-tooltip-content
      has-tooltip="[[_computeWarnShowAll(_files)]]"
      show-icon="[[_computeWarnShowAll(_files)]]"
      title$="[[_computeShowAllWarning(_files)]]"
    >
      <gr-button
        class="fileListButton"
        id="showAllButton"
        link=""
        on-click="_showAllFiles"
      >
        [[_computeShowAllText(_files)]] </gr-button
      ><!--
  --></gr-tooltip-content>
  </div>
  <gr-diff-preferences-dialog
    id="diffPreferencesDialog"
    diff-prefs="{{diffPrefs}}"
    on-reload-diff-preference="_handleReloadingDiffPreference"
  >
  </gr-diff-preferences-dialog>
  <gr-diff-cursor id="diffCursor"></gr-diff-cursor>
`;var RT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let TT=class extends(Kf(fi)){constructor(){super(),this.selectedIndex=-1,this.keyEventTarget=document.body,this.filesExpanded=$x.NONE,this._files=[],this._loggedIn=!1,this._reviewed=[],this.numFilesShown=200,this._patchChange={inserted:0,deleted:0,size_delta_inserted:0,size_delta_deleted:0,total_size:0},this.fileListIncrement=200,this._hideChangeTotals=!0,this._hideBinaryChangeTotals=!0,this._shownFiles=[],this._reportinShownFilesIncrement=0,this._expandedFiles=[],this._sizeBarLayout={maxInserted:0,maxDeleted:0,maxAdditionWidth:0,maxDeletionWidth:0,deletionOffset:0},this._showSizeBars=!0,this._showDynamicColumns=!1,this._showPrependedDynamicColumns=!1,this.reporting=i.reportingService,this.restApiService=i.restApiService,this.fileCursor=new J_,this.fileCursor.scrollMode=Xi.KEEP_VISIBLE,this.fileCursor.cursorTargetClass="selected",this.fileCursor.focusOnMove=!0,this.addEventListener("keydown",e=>this._scopedKeydownHandler(e))}static get template(){return xT}get keyBindings(){return{esc:"_handleEscKey"}}keyboardShortcuts(){return{[Hf.LEFT_PANE]:"_handleLeftPane",[Hf.RIGHT_PANE]:"_handleRightPane",[Hf.TOGGLE_INLINE_DIFF]:"_handleToggleInlineDiff",[Hf.TOGGLE_ALL_INLINE_DIFFS]:"_handleToggleAllInlineDiffs",[Hf.TOGGLE_HIDE_ALL_COMMENT_THREADS]:"_handleToggleHideAllCommentThreads",[Hf.CURSOR_NEXT_FILE]:"_handleCursorNext",[Hf.CURSOR_PREV_FILE]:"_handleCursorPrev",[Hf.NEXT_LINE]:"_handleCursorNext",[Hf.PREV_LINE]:"_handleCursorPrev",[Hf.NEW_COMMENT]:"_handleNewComment",[Hf.OPEN_LAST_FILE]:"_handleOpenLastFile",[Hf.OPEN_FIRST_FILE]:"_handleOpenFirstFile",[Hf.OPEN_FILE]:"_handleOpenFile",[Hf.NEXT_CHUNK]:"_handleNextChunk",[Hf.PREV_CHUNK]:"_handlePrevChunk",[Hf.TOGGLE_FILE_REVIEWED]:"_handleToggleFileReviewed",[Hf.TOGGLE_LEFT_PANE]:"_handleToggleLeftPane",[Hf.EXPAND_ALL_COMMENT_THREADS]:null,[Hf.COLLAPSE_ALL_COMMENT_THREADS]:null}}connectedCallback(){super.connectedCallback(),Qu().awaitPluginsLoaded().then(()=>{this._dynamicHeaderEndpoints=Gu().getDynamicEndpoints("change-view-file-list-header"),this._dynamicContentEndpoints=Gu().getDynamicEndpoints("change-view-file-list-content"),this._dynamicPrependedHeaderEndpoints=Gu().getDynamicEndpoints("change-view-file-list-header-prepend"),this._dynamicPrependedContentEndpoints=Gu().getDynamicEndpoints("change-view-file-list-content-prepend"),this._dynamicSummaryEndpoints=Gu().getDynamicEndpoints("change-view-file-list-summary"),this._dynamicHeaderEndpoints.length!==this._dynamicContentEndpoints.length&&console.warn("Different number of dynamic file-list header and content."),this._dynamicPrependedHeaderEndpoints.length!==this._dynamicPrependedContentEndpoints.length&&console.warn("Different number of dynamic file-list header and content."),this._dynamicHeaderEndpoints.length!==this._dynamicSummaryEndpoints.length&&console.warn("Different number of dynamic file-list headers and summary.")})}disconnectedCallback(){var e;this.fileCursor.unsetCursor(),this._cancelDiffs(),null===(e=this.loadingTask)||void 0===e||e.cancel(),super.disconnectedCallback()}_scopedKeydownHandler(e){13===e.keyCode&&this._handleOpenFile(e)}reload(){var e;if(!this.changeNum||!(null===(e=this.patchRange)||void 0===e?void 0:e.patchNum))return Promise.resolve();const t=this.changeNum,i=this.patchRange;this._loading=!0,this.collapseAllDiffs();const n=[];return n.push(this.restApiService.getChangeOrEditFiles(t,i).then(e=>{this._filesByPath=e})),n.push(this._getLoggedIn().then(e=>this._loggedIn=e).then(e=>{if(e)return this._getReviewedFiles(t,i).then(e=>{this._reviewed=e})})),n.push(this._getDiffPreferences().then(e=>{this.diffPrefs=e})),n.push(this._getPreferences().then(e=>{this._userPrefs=e})),Promise.all(n).then(()=>{this._loading=!1,this._detectChromiteButler(),this.reporting.fileListDisplayed()})}_detectChromiteButler(){!!document.getElementById("butler-suggested-owners")&&this.reporting.reportExtension("butler")}get diffs(){const e=this.root.querySelectorAll("gr-diff-host");return Array.from(e).filter(e=>!!e&&!!e.style&&"none"!==e.style.display)}openDiffPrefs(){this.$.diffPreferencesDialog.open()}_calculatePatchChange(e){return e.filter(e=>!Kb(e.__path)).reduce((e,t)=>{const i=t.lines_inserted?t.lines_inserted:0,n=t.lines_deleted?t.lines_deleted:0,o=t.size&&t.binary?t.size:0,r=t.binary&&t.size_delta>0?t.size_delta:0,s=t.binary&&t.size_delta<0?t.size_delta:0;return{inserted:e.inserted+i,deleted:e.deleted+n,size_delta_inserted:e.size_delta_inserted+r,size_delta_deleted:e.size_delta_deleted+s,total_size:e.total_size+o}},{inserted:0,deleted:0,size_delta_inserted:0,size_delta_deleted:0,total_size:0})}_getDiffPreferences(){return this.restApiService.getDiffPreferences()}_getPreferences(){return this.restApiService.getPreferences()}_toggleFileExpanded(e){const t=this._expandedFiles.findIndex(t=>t.path===e.path);-1===t?this.push("_expandedFiles",e):this.splice("_expandedFiles",t,1)}_toggleFileExpandedByIndex(e){this._toggleFileExpanded(this._computePatchSetFile(this._files[e]))}_updateDiffPreferences(){this.diffs.length&&(this.reporting.time(p.FILE_EXPAND_ALL),this._renderInOrder(this._expandedFiles,this.diffs,this._expandedFiles.length))}_forEachDiff(e){const t=this.diffs;for(let i=0;i<t.length;i++)e(t[i])}expandAllDiffs(){this._showInlineDiffs=!0;const e=[];let t;for(let i=0;i<this._shownFiles.length;i++)t=this._shownFiles[i].__path,this._expandedFiles.some(e=>e.path===t)||e.push(this._computePatchSetFile(this._shownFiles[i]));this.splice("_expandedFiles",0,0,...e)}collapseAllDiffs(){this._showInlineDiffs=!1,this._expandedFiles=[],this.filesExpanded=this._computeExpandedFiles(this._expandedFiles.length,this._files.length),this.$.diffCursor.handleDiffUpdate()}_computeCommentsString(e,t,i){return void 0===e||void 0===t||void 0===(null==i?void 0:i.__path)?"":e.computeCommentsString(t,i.__path,i)}_computeDraftCount(e,t,i){return void 0===e||void 0===t||void 0===i?"":e.computeDraftCount({patchNum:t.basePatchNum,path:i})+e.computeDraftCount({patchNum:t.patchNum,path:i})+e.computePortedDraftCount({patchNum:t.patchNum,basePatchNum:t.basePatchNum},i)}_computeDraftsString(e,t,i){const n=this._computeDraftCount(e,t,i);return""===n?n:Jb(n,"draft")}_computeDraftsStringMobile(e,t,i){const n=this._computeDraftCount(e,t,i);return 0===n?"":`${n}d`}_computeCommentsStringMobile(e,t,i){if(void 0===e||void 0===t||void 0===i)return"";const n=e.computeCommentThreadCount({patchNum:t.basePatchNum,path:i})+e.computeCommentThreadCount({patchNum:t.patchNum,path:i});return 0===n?"":`${n}c`}_reviewFile(e,t){if(this.editMode)return Promise.resolve();const i=this._files.findIndex(t=>t.__path===e);return t=t||!this._files[i].isReviewed,this.set(["_files",i,"isReviewed"],t),i<this._shownFiles.length&&this.notifyPath(`_shownFiles.${i}.isReviewed`),this._saveReviewedState(e,t)}_saveReviewedState(e,t){if(!this.changeNum||!this.patchRange)throw new Error("changeNum and patchRange must be set");return this.restApiService.saveFileReviewed(this.changeNum,this.patchRange.patchNum,e,t)}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getReviewedFiles(e,t){return this.editMode?Promise.resolve([]):this.restApiService.getReviewedFiles(e,t.patchNum)}_normalizeChangeFilesResponse(e){const t=Object.keys(e).sort(Vb),i=[];for(let n=0;n<t.length;n++){const o=e[t[n]];o.__path=t[n],o.lines_inserted=o.lines_inserted||0,o.lines_deleted=o.lines_deleted||0,o.size_delta=o.size_delta||0,i.push(o)}return i}_isClickEvent(e){if("click"===e.type)return!0;const t=e,i="Enter"===t.key||" "===t.key;return"keydown"===t.type&&i}_fileActionClick(e,t){if(this._isClickEvent(e)){const i=this._getFileRowFromEvent(e);if(!i)return;e.preventDefault(),e.stopPropagation(),this.fileCursor.setCursor(i.element),t(i.file)}}_reviewedClick(e){this._fileActionClick(e,e=>this._reviewFile(e.path))}_expandedClick(e){this._fileActionClick(e,e=>this._toggleFileExpanded(e))}_handleFileListClick(e){if(!e.target)return;const t=this._getFileRowFromEvent(e);if(!t)return;const i=t.file;i.path&&!uu(e.target,"pathLink")&&(uu(e.target,"editFileControls")||(e.preventDefault(),this.fileCursor.setCursor(t.element),this._toggleFileExpanded(i)))}_getFileRowFromEvent(e){let t=e.target;for(;!t.classList.contains("file-row")&&t.parentElement;)t=t.parentElement;return t.dataset.file?{file:JSON.parse(t.dataset.file),element:t}:null}_computePatchSetFile(e){const t={path:e.__path};return e.old_path&&(t.basePath=e.old_path),t}_handleLeftPane(e){this.shouldSuppressKeyboardShortcut(e)||this._noDiffsExpanded()||(e.preventDefault(),this.$.diffCursor.moveLeft())}_handleRightPane(e){this.shouldSuppressKeyboardShortcut(e)||this._noDiffsExpanded()||(e.preventDefault(),this.$.diffCursor.moveRight())}_handleToggleInlineDiff(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||-1===this.fileCursor.index||(e.preventDefault(),this._toggleFileExpandedByIndex(this.fileCursor.index))}_handleToggleAllInlineDiffs(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this._toggleInlineDiffs())}_handleToggleHideAllCommentThreads(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),vu(this,"hideComments"))}_handleCursorNext(e){if(!this.shouldSuppressKeyboardShortcut(e)&&!this.modifierPressed(e))if(this._showInlineDiffs)e.preventDefault(),this.$.diffCursor.moveDown(),this._displayLine=!0;else{if(40===this.getKeyboardEvent(e).keyCode)return;e.preventDefault(),this.fileCursor.next(),this.selectedIndex=this.fileCursor.index}}_handleCursorPrev(e){if(!this.shouldSuppressKeyboardShortcut(e)&&!this.modifierPressed(e))if(this._showInlineDiffs)e.preventDefault(),this.$.diffCursor.moveUp(),this._displayLine=!0;else{if(38===this.getKeyboardEvent(e).keyCode)return;e.preventDefault(),this.fileCursor.previous(),this.selectedIndex=this.fileCursor.index}}_handleNewComment(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.classList.remove("hideComments"),this.$.diffCursor.createCommentInPlace())}_handleOpenLastFile(e){this.shouldSuppressKeyboardShortcut(e)||this.getKeyboardEvent(e).metaKey||(e.preventDefault(),this._openSelectedFile(this._files.length-1))}_handleOpenFirstFile(e){this.shouldSuppressKeyboardShortcut(e)||this.getKeyboardEvent(e).metaKey||(e.preventDefault(),this._openSelectedFile(0))}_handleOpenFile(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._showInlineDiffs?this._openCursorFile():this._openSelectedFile())}_handleNextChunk(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)&&!this.isModifierPressed(e,Wf.SHIFT_KEY)||this._noDiffsExpanded()||(e.preventDefault(),this.isModifierPressed(e,Wf.SHIFT_KEY)?this.$.diffCursor.moveToNextCommentThread():this.$.diffCursor.moveToNextChunk())}_handlePrevChunk(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)&&!this.isModifierPressed(e,Wf.SHIFT_KEY)||this._noDiffsExpanded()||(e.preventDefault(),this.isModifierPressed(e,Wf.SHIFT_KEY)?this.$.diffCursor.moveToPreviousCommentThread():this.$.diffCursor.moveToPreviousChunk())}_handleToggleFileReviewed(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._files[this.fileCursor.index]&&this._reviewFile(this._files[this.fileCursor.index].__path))}_handleToggleLeftPane(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this._forEachDiff(e=>{e.toggleLeftDiff()}))}_toggleInlineDiffs(){this._showInlineDiffs?this.collapseAllDiffs():this.expandAllDiffs()}_openCursorFile(){const e=this.$.diffCursor.getTargetDiffElement();if(!(this.change&&e&&this.patchRange&&e.path))throw new Error("change, diff and patchRange must be all set and valid");Qm.navigateToDiff(this.change,e.path,this.patchRange.patchNum,this.patchRange.basePatchNum)}_openSelectedFile(e){if(void 0!==e&&this.fileCursor.setCursorAtIndex(e),this._files[this.fileCursor.index]){if(!this.change||!this.patchRange)throw new Error("change and patchRange must be set");Qm.navigateToDiff(this.change,this._files[this.fileCursor.index].__path,this.patchRange.patchNum,this.patchRange.basePatchNum)}}_addDraftAtTarget(){const e=this.$.diffCursor.getTargetDiffElement(),t=this.$.diffCursor.getTargetLineElement();e&&t&&e.addDraftAtLine(t)}_shouldHideChangeTotals(e){return 0===e.inserted&&0===e.deleted}_shouldHideBinaryChangeTotals(e){return 0===e.size_delta_inserted&&0===e.size_delta_deleted}_computeDiffURL(e,t,i,n){if(void 0!==e&&void 0!==t&&void 0!==i&&void 0!==n)return n&&i!==Zi.MERGE_LIST?Qm.getEditUrlForDiff(e,i,t.patchNum):Qm.getUrlForDiff(e,i,t.patchNum,t.basePatchNum)}_formatBytes(e){if(!e)return"+/-0 B";const t=Math.floor(Math.log(Math.abs(e))/Math.log(1024));return`${e>0?"+":""}${parseFloat((e/Math.pow(1024,t)).toFixed(1))} ${["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][t]}`}_formatPercentage(e,t){if(void 0===e||void 0===t)return"";const i=e-t;return 0===i?"":`(${t>0?"+":"-"}${Math.round(Math.abs(100*t/i))}%)`}_computeBinaryClass(e){if(e)return e>0?"added":"removed"}_computeClass(e,t){const i=[];return e&&i.push(e),t!==Zi.COMMIT_MESSAGE&&t!==Zi.MERGE_LIST||i.push("invisible"),i.join(" ")}_computePathClass(e,t){return this._isFileExpanded(e,t)?"expanded":""}_computeShowHideIcon(e,t){return this._isFileExpanded(e,t)?"gr-icons:expand-less":"gr-icons:expand-more"}_computeFiles(e,t,i,n,o){if(void 0===e||void 0===t||void 0===i||void 0===n||void 0===o)return;if(o||!t)return;const r=t.getPaths(i),s={...e};Wb(s,r);const a=new Set(n||[]);for(const[e,t]of Object.entries(s))t.isReviewed=a.has(e);this._files=this._normalizeChangeFilesResponse(s)}_computeFilesShown(e,t){if(void 0===e||void 0===t)return;const i=this._shownFiles?this._shownFiles.length:0,n=t.slice(0,e);return this.dispatchEvent(new CustomEvent("files-shown-changed",{detail:{length:n.length},composed:!0,bubbles:!0})),this.reporting.time(p.FILE_RENDER),this._reportinShownFilesIncrement=Math.max(0,n.length-i),n}_updateDiffCursor(){this.$.diffCursor.splice("diffs",0,this.$.diffCursor.diffs.length,...this.diffs)}_filesChanged(){this._files&&this._files.length>0&&(yh(),this.fileCursor.stops=Array.from(this.root.querySelectorAll(".file-row")),this.fileCursor.setCursorAtIndex(this.selectedIndex,!0))}_incrementNumFilesShown(){this.numFilesShown+=this.fileListIncrement}_computeFileListControlClass(e,t){return void 0===e||void 0===t?"invisible":e>=t.length?"invisible":""}_computeIncrementText(e,t){if(void 0===e||void 0===t)return"";return`Show ${Math.min(this.fileListIncrement,t.length-e)} more`}_computeShowAllText(e){return e?`Show all ${e.length} files`:""}_computeWarnShowAll(e){return e.length>1e3}_computeShowAllWarning(e){return this._computeWarnShowAll(e)?`Warning: showing all ${e.length} files may take several seconds.`:""}_showAllFiles(){this.numFilesShown=this._files.length}_booleanToString(e){return e?"true":"false"}_isFileExpanded(e,t){return t.base.some(t=>t.path===e)}_isFileExpandedStr(e,t){return this._booleanToString(this._isFileExpanded(e,t))}_computeExpandedFiles(e,t){return 0===e?$x.NONE:e===t?$x.ALL:$x.SOME}_expandedFilesChanged(e){const t=this.diffs.filter(e=>-1===this._expandedFiles.findIndex(t=>t.path===e.path));if(this._clearCollapsedDiffs(t),!e)return;this.filesExpanded=this._computeExpandedFiles(this._expandedFiles.length,this._files.length);const i=e.indexSplices.map(e=>e.object.slice(e.index,e.index+e.addedCount)).reduce((e,t)=>e.concat(t),[]);yh(),this.reporting.time(p.FILE_EXPAND_ALL),i.length&&this._renderInOrder(i,this.diffs,i.length),this._updateDiffCursor(),this.$.diffCursor.reInitAndUpdateStops()}_clearCollapsedDiffs(e){for(const t of e)t.cancel(),t.clearDiffContent()}_renderInOrder(e,t,i){let n=0;for(const i of e){const e=i.path,n=this._findDiffByPath(e,t);n&&n.prefetchDiff()}return new Promise(e=>{this.dispatchEvent(new CustomEvent("reload-drafts",{detail:{resolve:e},composed:!0,bubbles:!0}))}).then(()=>function e(t,i){if(!t.length)return Promise.resolve();let n=!1;return i(t[0],()=>{n=!0}).then(()=>n?Promise.resolve():e(t.slice(1),i))}(e,(e,o)=>{const r=e.path;this._cancelForEachDiff=o,n++,console.info("Expanding diff",n,"of",i,":",r);const s=this._findDiffByPath(r,t);if(!s)return console.warn(`Did not find <gr-diff-host> element for ${r}`),Promise.resolve();if(!this.changeComments||!this.patchRange||!this.diffPrefs)throw new Error("changeComments, patchRange and diffPrefs must be set");s.threads=this.changeComments.getThreadsBySideForFile(e,this.patchRange);const a=[s.reload()];return this._loggedIn&&!this.diffPrefs.manual_review&&a.push(this._reviewFile(r,!0)),Promise.all(a)}).then(()=>{this._cancelForEachDiff=void 0,console.info("Finished expanding",i,"diff(s)"),this.reporting.timeEndWithAverage(p.FILE_EXPAND_ALL,p.FILE_EXPAND_ALL_AVG,i),this.$.diffCursor.reInitAndUpdateStops()}))}_cancelDiffs(){this._cancelForEachDiff&&this._cancelForEachDiff(),this._forEachDiff(e=>e.cancel())}_findDiffByPath(e,t){for(let i=0;i<t.length;i++)if(t[i].path===e)return t[i]}reloadCommentsForThreadWithRootId(e,t){if(!this._expandedFiles.some(e=>e.path===t))return;const i=this.diffs.find(e=>e.path===t);if(!i)throw new Error("Can't find diff by path");const n=i.getThreadEls().find(t=>t.rootId===e);if(!n)return;if(!this.changeComments)throw new Error("changeComments must be set");const o=this.changeComments.getCommentsForThread(e);o?(n.comments=o.map(e=>({...e})),yh()):n.fireRemoveSelf()}_handleEscKey(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._displayLine=!1)}_loadingChanged(e){this.loadingTask=Cu(this.loadingTask,()=>{this.classList.toggle("loading",e&&!!this._files.length)},100)}_editModeChanged(e){this.classList.toggle("editMode",e)}_computeReviewedClass(e){return e?"isReviewed":""}_computeReviewedText(e){return e?"MARK UNREVIEWED":"MARK REVIEWED"}_showBarsForPath(e){return e!==Zi.COMMIT_MESSAGE&&e!==Zi.MERGE_LIST}_computeSizeBarLayout(e){const t={maxInserted:0,maxDeleted:0,maxAdditionWidth:0,maxDeletionWidth:0,deletionOffset:0};if(!e||!e.base)return t;e.base.filter(e=>this._showBarsForPath(e.__path)).forEach(e=>{e.lines_inserted&&(t.maxInserted=Math.max(t.maxInserted,e.lines_inserted)),e.lines_deleted&&(t.maxDeleted=Math.max(t.maxDeleted,e.lines_deleted))});const i=t.maxInserted/(t.maxInserted+t.maxDeleted);return isNaN(i)||(t.maxAdditionWidth=60*i,t.maxDeletionWidth=60-t.maxAdditionWidth,t.deletionOffset=t.maxAdditionWidth+1),t}_computeBarAdditionWidth(e,t){if(!(e&&t&&0!==t.maxInserted&&e.lines_inserted&&this._showBarsForPath(e.__path)))return 0;const i=t.maxAdditionWidth*e.lines_inserted/t.maxInserted;return 0===i?0:Math.max(1.5,i)}_computeBarAdditionX(e,t){if(e&&t)return t.maxAdditionWidth-this._computeBarAdditionWidth(e,t)}_computeBarDeletionWidth(e,t){if(!(e&&t&&0!==t.maxDeleted&&e.lines_deleted&&this._showBarsForPath(e.__path)))return 0;const i=t.maxDeletionWidth*e.lines_deleted/t.maxDeleted;return 0===i?0:Math.max(1.5,i)}_computeBarDeletionX(e){return e.deletionOffset}_computeShowSizeBars(e){return!!(null==e?void 0:e.size_bar_in_change_table)}_computeSizeBarsClass(e,t){let i="";return e?this._showBarsForPath(t)||(i="invisible"):i="hide",`sizeBars desktop ${i}`}_computeShowDynamicColumns(e,t,i){return e&&t&&i&&e.length&&e.length===t.length&&e.length===i.length}_computeShowPrependedDynamicColumns(e,t){return e&&t&&e.length&&e.length===t.length}_noDiffsExpanded(){return this.filesExpanded===$x.NONE}_reportRenderedRow(e){return e===this._shownFiles.length-1&&setTimeout(()=>{this.reporting.timeEndWithAverage(p.FILE_RENDER,p.FILE_RENDER_AVG,this._reportinShownFilesIncrement)},1),""}_reviewedTitle(e){return e?"Mark as not reviewed (shortcut: r)":"Mark as reviewed (shortcut: r)"}_handleReloadingDiffPreference(){this._getDiffPreferences().then(e=>{this.diffPrefs=e})}_computeDisplayPath(e){return qb(e)}_computeTruncatedPath(e){return Yb(e)}_getOldPath(e){var t;return null!==(t=e.old_path)&&void 0!==t?t:null}};RT([Oo({type:Object})],TT.prototype,"patchRange",void 0),RT([Oo({type:String})],TT.prototype,"patchNum",void 0),RT([Oo({type:Number})],TT.prototype,"changeNum",void 0),RT([Oo({type:Object})],TT.prototype,"changeComments",void 0),RT([Oo({type:Array})],TT.prototype,"revisions",void 0),RT([Oo({type:Number,notify:!0})],TT.prototype,"selectedIndex",void 0),RT([Oo({type:Object})],TT.prototype,"keyEventTarget",void 0),RT([Oo({type:Object})],TT.prototype,"change",void 0),RT([Oo({type:String,notify:!0,observer:"_updateDiffPreferences"})],TT.prototype,"diffViewMode",void 0),RT([Oo({type:Boolean,observer:"_editModeChanged"})],TT.prototype,"editMode",void 0),RT([Oo({type:String,notify:!0})],TT.prototype,"filesExpanded",void 0),RT([Oo({type:Object})],TT.prototype,"_filesByPath",void 0),RT([Oo({type:Array,observer:"_filesChanged"})],TT.prototype,"_files",void 0),RT([Oo({type:Boolean})],TT.prototype,"_loggedIn",void 0),RT([Oo({type:Array})],TT.prototype,"_reviewed",void 0),RT([Oo({type:Object,notify:!0,observer:"_updateDiffPreferences"})],TT.prototype,"diffPrefs",void 0),RT([Oo({type:Object})],TT.prototype,"_userPrefs",void 0),RT([Oo({type:Boolean})],TT.prototype,"_showInlineDiffs",void 0),RT([Oo({type:Number,notify:!0})],TT.prototype,"numFilesShown",void 0),RT([Oo({type:Object,computed:"_calculatePatchChange(_files)"})],TT.prototype,"_patchChange",void 0),RT([Oo({type:Number})],TT.prototype,"fileListIncrement",void 0),RT([Oo({type:Boolean,computed:"_shouldHideChangeTotals(_patchChange)"})],TT.prototype,"_hideChangeTotals",void 0),RT([Oo({type:Boolean,computed:"_shouldHideBinaryChangeTotals(_patchChange)"})],TT.prototype,"_hideBinaryChangeTotals",void 0),RT([Oo({type:Array,computed:"_computeFilesShown(numFilesShown, _files)"})],TT.prototype,"_shownFiles",void 0),RT([Oo({type:Number})],TT.prototype,"_reportinShownFilesIncrement",void 0),RT([Oo({type:Array})],TT.prototype,"_expandedFiles",void 0),RT([Oo({type:Boolean})],TT.prototype,"_displayLine",void 0),RT([Oo({type:Boolean,observer:"_loadingChanged"})],TT.prototype,"_loading",void 0),RT([Oo({type:Object,computed:"_computeSizeBarLayout(_shownFiles.*)"})],TT.prototype,"_sizeBarLayout",void 0),RT([Oo({type:Boolean,computed:"_computeShowSizeBars(_userPrefs)"})],TT.prototype,"_showSizeBars",void 0),RT([Oo({type:Boolean,computed:"_computeShowDynamicColumns(_dynamicHeaderEndpoints, _dynamicContentEndpoints, _dynamicSummaryEndpoints)"})],TT.prototype,"_showDynamicColumns",void 0),RT([Oo({type:Boolean,computed:"_computeShowPrependedDynamicColumns(_dynamicPrependedHeaderEndpoints, _dynamicPrependedContentEndpoints)"})],TT.prototype,"_showPrependedDynamicColumns",void 0),RT([Oo({type:Array})],TT.prototype,"_dynamicHeaderEndpoints",void 0),RT([Oo({type:Array})],TT.prototype,"_dynamicContentEndpoints",void 0),RT([Oo({type:Array})],TT.prototype,"_dynamicSummaryEndpoints",void 0),RT([Oo({type:Array})],TT.prototype,"_dynamicPrependedHeaderEndpoints",void 0),RT([Oo({type:Array})],TT.prototype,"_dynamicPrependedContentEndpoints",void 0),RT([No("_filesByPath","changeComments","patchRange","_reviewed","_loading")],TT.prototype,"_computeFiles",null),RT([No("_expandedFiles.splices")],TT.prototype,"_expandedFilesChanged",null),TT=RT([Po("gr-file-list")],TT);var kT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const PT=/^(R|CC)=/gm,IT=/[ \t]+$/gm,OT="A newer patch set has been uploaded",NT="This change has been restored",LT="This change has been abandoned",DT="This change has been merged",MT="There are new messages on this change";let FT=class extends(Kf(fi)){constructor(){super(),this.reporting=i.reportingService,this.jsAPI=i.jsApiService,this.changeService=i.changeService,this.viewState={},this.keyEventTarget=document.body,this.disableEdit=!1,this.disableDiffPrefs=!1,this._numFilesShown=200,this._diffDrafts={},this._editingCommitMessage=!1,this._latestCommitMessage="",this._constants={SecondaryTab:Ki,PrimaryTab:qi},this._messages="There are no findings for this patchset.",this._loggedIn=!1,this._replyButtonLabel="Reply",this._initialLoadComplete=!1,this._replyDisabled=!0,this._commitCollapsed=!0,this._mergeable=null,this._showFileTabContent=!0,this._dynamicTabHeaderEndpoints=[],this._dynamicTabContentEndpoints=[],this._robotCommentsPatchSetDropdownItems=[],this._changeViewAriaHidden=!1,this._activeTabs=[qi.FILES,Ki.CHANGE_LOG],this._showAllRobotComments=!1,this._showRobotCommentsButton=!1,this._showChecksTab=!1,this.restApiService=i.restApiService,this.checksService=i.checksService,this.disconnected$=new fr,this.handleScroll=()=>{this.scrollTask=Cu(this.scrollTask,()=>this.viewState.scrollTop=document.body.scrollTop,150)},this.handleVisibilityChange=()=>{document.hidden&&this._updateCheckTimerHandle?this._cancelUpdateCheckTimer():this._updateCheckTimerHandle||this._startUpdateCheckTimer()},this.addEventListener("topic-changed",()=>this._handleTopicChanged()),this.addEventListener("fullscreen-overlay-opened",()=>this._handleHideBackgroundContent()),this.addEventListener("fullscreen-overlay-closed",()=>this._handleShowBackgroundContent()),this.addEventListener("diff-comments-modified",()=>this._handleReloadCommentThreads()),this.addEventListener("thread-list-modified",e=>this._handleReloadDiffComments(e)),this.addEventListener("open-reply-dialog",()=>this._openReplyDialog())}static get template(){return aT}keyboardShortcuts(){return{[Hf.SEND_REPLY]:null,[Hf.EMOJI_DROPDOWN]:null,[Hf.REFRESH_CHANGE]:"_handleRefreshChange",[Hf.OPEN_REPLY_DIALOG]:"_handleOpenReplyDialog",[Hf.OPEN_DOWNLOAD_DIALOG]:"_handleOpenDownloadDialogShortcut",[Hf.TOGGLE_DIFF_MODE]:"_handleToggleDiffMode",[Hf.TOGGLE_CHANGE_STAR]:"_throttledToggleChangeStar",[Hf.UP_TO_DASHBOARD]:"_handleUpToDashboard",[Hf.EXPAND_ALL_MESSAGES]:"_handleExpandAllMessages",[Hf.COLLAPSE_ALL_MESSAGES]:"_handleCollapseAllMessages",[Hf.OPEN_DIFF_PREFS]:"_handleOpenDiffPrefsShortcut",[Hf.EDIT_TOPIC]:"_handleEditTopic",[Hf.DIFF_AGAINST_BASE]:"_handleDiffAgainstBase",[Hf.DIFF_AGAINST_LATEST]:"_handleDiffAgainstLatest",[Hf.DIFF_BASE_AGAINST_LEFT]:"_handleDiffBaseAgainstLeft",[Hf.DIFF_RIGHT_AGAINST_LATEST]:"_handleDiffRightAgainstLatest",[Hf.DIFF_BASE_AGAINST_LATEST]:"_handleDiffBaseAgainstLatest"}}ready(){super.ready(),da.pipe(cs(this.disconnected$)).subscribe(e=>{this._showChecksTab=e})}connectedCallback(){super.connectedCallback(),this._throttledToggleChangeStar=this._throttleWrap(e=>this._handleToggleChangeStar(e)),this._getServerConfig().then(e=>{this._serverConfig=e,this._replyDisabled=!1}),this._getLoggedIn().then(e=>{this._loggedIn=e,e&&this.restApiService.getAccount().then(e=>{this._account=e}),this._setDiffViewMode()}),Qu().awaitPluginsLoaded().then(()=>{this._dynamicTabHeaderEndpoints=Gu().getDynamicEndpoints("change-view-tab-header"),this._dynamicTabContentEndpoints=Gu().getDynamicEndpoints("change-view-tab-content"),this._dynamicTabContentEndpoints.length!==this._dynamicTabHeaderEndpoints.length&&console.warn("Different number of tab headers and tab content.")}).then(()=>this._initActiveTabs(this.params)),this.addEventListener("comment-save",e=>this._handleCommentSave(e)),this.addEventListener("comment-refresh",()=>this._reloadDrafts()),this.addEventListener("comment-discard",e=>this._handleCommentDiscard(e)),this.addEventListener("change-message-deleted",()=>this._reload()),this.addEventListener("editable-content-save",e=>this._handleCommitMessageSave(e)),this.addEventListener("editable-content-cancel",()=>this._handleCommitMessageCancel()),this.addEventListener("open-fix-preview",e=>this._onOpenFixPreview(e)),this.addEventListener("close-fix-preview",e=>this._onCloseFixPreview(e)),window.addEventListener("scroll",this.handleScroll),document.addEventListener("visibilitychange",this.handleVisibilityChange),this.addEventListener(vi.SHOW_PRIMARY_TAB,e=>this._setActivePrimaryTab(e)),this.addEventListener("show-secondary-tab",e=>this._setActiveSecondaryTab(e)),this.addEventListener("reload",e=>{e.stopPropagation(),this._reload(!1,e.detail&&e.detail.clearPatchset)})}disconnectedCallback(){var e,t;this.disconnected$.next(),window.removeEventListener("scroll",this.handleScroll),document.removeEventListener("visibilitychange",this.handleVisibilityChange),null===(e=this.replyRefitTask)||void 0===e||e.cancel(),null===(t=this.scrollTask)||void 0===t||t.cancel(),this._updateCheckTimerHandle&&this._cancelUpdateCheckTimer(),super.disconnectedCallback()}get messagesList(){return this.shadowRoot.querySelector("gr-messages-list")}get threadList(){return this.shadowRoot.querySelector("gr-thread-list")}_setDiffViewMode(e){if(e||!this.viewState.diffViewMode)return this._getPreferences().then(e=>{!this.viewState.diffMode&&e&&this.set("viewState.diffMode",e.default_diff_view)}).then(()=>{this.viewState.diffMode||this.set("viewState.diffMode","SIDE_BY_SIDE")})}_onOpenFixPreview(e){this.$.applyFixDialog.open(e)}_onCloseFixPreview(e){e.detail.fixApplied&&this._reload()}_handleToggleDiffMode(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.viewState.diffMode===Gi.SIDE_BY_SIDE?this.$.fileListHeader.setDiffViewMode(Gi.UNIFIED):this.$.fileListHeader.setDiffViewMode(Gi.SIDE_BY_SIDE))}_isTabActive(e,t){return t.includes(e)}_setActiveTab(e,t){if(!e)return;const{activeTabName:i,activeTabIndex:n,scrollIntoView:o}=t,r=e.querySelectorAll("paper-tab");let s=-1;if(void 0!==n)s=n;else for(let e=0;e<=r.length;e++){if(r[e].dataset.name===i){s=e;break}}if(-1===s)return void console.warn("tab not found with given info",t);const a=r[s].dataset.name;return o&&e.scrollIntoView({block:"center"}),e.selected!==s&&(void 0!==e.selected&&this.reporting.reportInteraction("show-tab",{tabName:a}),e.selected=s),a}_setActivePrimaryTab(e){const t=this.shadowRoot.querySelector("#primaryTabs"),i=this._setActiveTab(t,{activeTabName:e.detail.tab,activeTabIndex:e.detail.value,scrollIntoView:e.detail.scrollIntoView});if(i){this._activeTabs=[i,this._activeTabs[1]];const e=(this._dynamicTabHeaderEndpoints||[]).indexOf(i);-1!==e?(this._selectedTabPluginEndpoint=this._dynamicTabContentEndpoints[e],this._selectedTabPluginHeader=this._dynamicTabHeaderEndpoints[e]):(this._selectedTabPluginEndpoint="",this._selectedTabPluginHeader="")}this._tabState=e.detail.tabState}_setActiveSecondaryTab(e){const t=this.shadowRoot.querySelector("#secondaryTabs"),i=this._setActiveTab(t,{activeTabName:e.detail.tab,activeTabIndex:e.detail.value,scrollIntoView:e.detail.scrollIntoView});i&&(this._activeTabs=[this._activeTabs[0],i])}_handleCommitMessageSave(e){if(a(this._change,"_change"),!this._changeNum)throw new Error("missing required changeNum property");const t=e.detail.content.replace(IT,"");this.jsAPI.handleCommitMessage(this._change,t),this.$.commitMessageEditor.disabled=!0,this.restApiService.putChangeCommitMessage(this._changeNum,t).then(e=>{this.$.commitMessageEditor.disabled=!1,e.ok&&(this._latestCommitMessage=this._prepareCommitMsgForLinkify(t),this._editingCommitMessage=!1,this._reloadWindow())}).catch(()=>{this.$.commitMessageEditor.disabled=!1})}_reloadWindow(){hu()}_handleCommitMessageCancel(){this._editingCommitMessage=!1}_computeChangeStatusChips(e,t,i){if(!e)return;if(null===t)return[];return So(e,{includeDerived:!0,mergeable:!!t,submitEnabled:!!i})}_computeHideEditCommitMessage(e,t,i,n){return!!(!e||t||i&&i.status===Ji.MERGED||n)}_robotCommentCountPerPatchSet(e){return e.reduce((e,t)=>{const i=t.comments,n=i.reduce((e,t)=>Uw(t)?e+1:e,0);return i[0].patch_set&&(e[`${i[0].patch_set}`]=(e[`${i[0].patch_set}`]||0)+n),e},{})}_computeText(e,t){const i=this._robotCommentCountPerPatchSet(t)[e._number]||0;return 0===i?`Patchset ${e._number}`:`Patchset ${e._number} (${Jb(i,"finding")})`}_computeRobotCommentsPatchSetDropdownItems(e,t){return e&&t&&e.revisions?Object.values(e.revisions).filter(e=>"edit"!==e._number).map(e=>({text:this._computeText(e,t),value:e._number})).sort((e,t)=>t.value-e.value):[]}_handleCurrentRevisionUpdate(e){this._currentRobotCommentsPatchSet=e._number}_handleRobotCommentPatchSetChanged(e){const t=Number(e.detail.value);t!==this._currentRobotCommentsPatchSet&&(this._currentRobotCommentsPatchSet=t)}_computeShowText(e){return e?"Show Less":"Show more"}_toggleShowRobotComments(){this._showAllRobotComments=!this._showAllRobotComments}_computeRobotCommentThreads(e,t,i){if(!e||!t)return[];const n=e.filter(e=>{const i=e.comments||[];return i.length&&Uw(i[0])&&i[0].patch_set===t});return this._showRobotCommentsButton=n.length>10,n.slice(0,i?void 0:10)}_handleReloadCommentThreads(){this._reloadDrafts().then(()=>{var e;this._commentThreads=null===(e=this._changeComments)||void 0===e?void 0:e.getAllThreadsForChange(),yh()})}_handleReloadDiffComments(e){this._reloadDrafts().then(()=>{this.$.fileList.reloadCommentsForThreadWithRootId(e.detail.rootId,e.detail.path),yh()})}_computeTotalCommentCounts(e,t){if(!t)return;const i=0===e?"":`${e} unresolved`,n=Jb(t.computeDraftCount(),"draft");return i+(i&&n?", ":"")+n}_handleCommentSave(e){const t=e.detail.comment;if(!t.__draft||!t.path)return;if(!this._patchRange)throw new Error("missing required _patchRange property");t.patch_set=t.patch_set||this._patchRange.patchNum;const i={...this._diffDrafts};if(!i[t.path])return i[t.path]=[t],void(this._diffDrafts=i);for(let e=0;e<i[t.path].length;e++)if(i[t.path][e].id===t.id)return i[t.path][e]=t,void(this._diffDrafts=i);i[t.path].push(t),i[t.path].sort((e,t)=>(e.line||-1)-(t.line||-1)),this._diffDrafts=i}_handleCommentDiscard(e){const t=e.detail.comment;if(!t.__draft||!t.path)return;if(!this._diffDrafts||!this._diffDrafts[t.path])return;let i=-1;for(let e=0;e<this._diffDrafts[t.path].length;e++)if(this._diffDrafts[t.path][e].id===t.id){i=e;break}if(-1===i)return;if(!this._patchRange)throw new Error("missing required _patchRange property");t.patch_set=t.patch_set||this._patchRange.patchNum;const n={...this._diffDrafts};n[t.path].splice(i,1),0===n[t.path].length&&delete n[t.path],this._diffDrafts=n}_handleReplyTap(e){e.preventDefault(),this._openReplyDialog(this.$.replyDialog.FocusTarget.ANY)}onReplyOverlayCanceled(){Ri(this,{canceled:!0}),this._changeViewAriaHidden=!1}_handleOpenDiffPrefs(){this.$.fileList.openDiffPrefs()}_handleOpenIncludedInDialog(){this.$.includedInDialog.loadData().then(()=>{yh(),this.$.includedInOverlay.refit()}),this.$.includedInOverlay.open()}_handleIncludedInDialogClose(){this.$.includedInOverlay.close()}_handleOpenDownloadDialog(){this.$.downloadOverlay.open().then(()=>{this.$.downloadOverlay.setFocusStops(this.$.downloadDialog.getFocusStops()),this.$.downloadDialog.focus()})}_handleDownloadDialogClose(){this.$.downloadOverlay.close()}_handleMessageReply(e){const t=e.detail.message.message.split("\n").map(e=>"> "+e).join("\n")+"\n\n";this.$.replyDialog.quote=t,this._openReplyDialog(this.$.replyDialog.FocusTarget.BODY)}_handleHideBackgroundContent(){this.$.mainContent.classList.add("overlayOpen")}_handleShowBackgroundContent(){this.$.mainContent.classList.remove("overlayOpen")}_handleReplySent(){this.addEventListener("change-details-loaded",()=>{this.reporting.timeEnd(p.SEND_REPLY)},{once:!0}),this.$.replyOverlay.cancel(),this._reload()}_handleReplyCancel(){this.$.replyOverlay.cancel()}_handleReplyAutogrow(){this.replyRefitTask=Cu(this.replyRefitTask,()=>this.$.replyOverlay.refit(),500)}_handleShowReplyDialog(e){let t=this.$.replyDialog.FocusTarget.REVIEWERS;e.detail.value&&e.detail.value.ccsOnly&&(t=this.$.replyDialog.FocusTarget.CCS),this._openReplyDialog(t)}_setShownFiles(e){this._shownFileCount=e.detail.length}_expandAllDiffs(e){this.shouldSuppressKeyboardShortcut(e)||this.$.fileList.expandAllDiffs()}_collapseAllDiffs(){this.$.fileList.collapseAllDiffs()}_paramsChanged(e){if(e.view!==bs.CHANGE)return void(this._initialLoadComplete=!1);e.changeNum&&e.project&&this.restApiService.setInProjectLookup(e.changeNum,e.project);const t=this._patchRange&&void 0!==e.patchNum&&void 0!==e.basePatchNum&&(this._patchRange.patchNum!==e.patchNum||this._patchRange.basePatchNum!==e.basePatchNum),i=this._changeNum!==e.changeNum;let n=this._patchRange&&void 0!==e.patchNum&&this._patchRange.patchNum!==e.patchNum;const o={patchNum:e.patchNum,basePatchNum:e.basePatchNum||"PARENT"};if(this.$.fileList.collapseAllDiffs(),this._patchRange=o,!i&&t)return o.patchNum||(o.patchNum=Jn(this._allPatchSets),n=!0),void this._reloadPatchNumDependentResources(n).then(()=>{this._sendShowChangeEvent()});this._initialLoadComplete=!1,this._changeNum=e.changeNum,this._reload(!0).then(()=>{this._performPostLoadTasks()}),Qu().awaitPluginsLoaded().then(()=>{this._initActiveTabs(e)})}_initActiveTabs(e){let t=qi.FILES;e&&e.queryMap&&e.queryMap.has("tab")&&(t=e.queryMap.get("tab")),this._setActivePrimaryTab(new CustomEvent("initActiveTab",{detail:{tab:t}})),this._setActiveSecondaryTab(new CustomEvent("initActiveTab",{detail:{tab:Ki.CHANGE_LOG}}))}_sendShowChangeEvent(){if(!this._patchRange)throw new Error("missing required _patchRange property");this.jsAPI.handleEvent(Fa.SHOW_CHANGE,{change:this._change,patchNum:this._patchRange.patchNum,info:{mergeable:this._mergeable}})}_performPostLoadTasks(){this._maybeShowReplyDialog(),this._maybeShowRevertDialog(),this._maybeShowDownloadDialog(),this._sendShowChangeEvent(),setTimeout(()=>{this.viewState.scrollTop?document.documentElement.scrollTop=document.body.scrollTop=this.viewState.scrollTop:this._maybeScrollToMessage(window.location.hash),this._initialLoadComplete=!0})}_paramsAndChangeChanged(e,t){if(!e||!t)return;if(!this._patchRange)throw new Error("missing required _patchRange property");const i=this.viewState.patchRange;this.viewState.changeNum===this._changeNum&&i&&i.basePatchNum===this._patchRange.basePatchNum&&i.patchNum===this._patchRange.patchNum||this._resetFileListViewState()}_viewStateChanged(e){this._numFilesShown=e.numFilesShown?e.numFilesShown:200}_numFilesShownChanged(e){this.viewState.numFilesShown=e}_handleMessageAnchorTap(e){if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");const t="#message-"+e.detail.id,i=Qm.getUrlForChange(this._change,this._patchRange.patchNum,this._patchRange.basePatchNum,this._editMode,t);history.replaceState(null,"",i)}_maybeScrollToMessage(e){e.startsWith("#message-")&&this.messagesList&&this.messagesList.scrollToMessage(e.substr("#message-".length))}_getLocationSearch(){return window.location.search}_getUrlParameter(e){const t=this._getLocationSearch().substring(1).split("&");for(let i=0;i<t.length;i++){const n=t[i].split("=");if(n[0]===e)return n[0]}return null}_maybeShowRevertDialog(){Qu().awaitPluginsLoaded().then(()=>this._getLoggedIn()).then(e=>{e&&this._change&&this._change.status===Ji.MERGED&&this._getUrlParameter("revert")&&this.$.actions.showRevertDialog()})}_maybeShowReplyDialog(){this._getLoggedIn().then(e=>{e&&this.viewState.showReplyDialog&&(this._openReplyDialog(this.$.replyDialog.FocusTarget.ANY),setTimeout(()=>{this.$.replyOverlay.center()},100),setTimeout(()=>{this.$.replyOverlay.center()},1e3),this.set("viewState.showReplyDialog",!1))})}_maybeShowDownloadDialog(){this.viewState.showDownloadDialog&&(this._handleOpenDownloadDialog(),this.set("viewState.showDownloadDialog",!1))}_resetFileListViewState(){this.set("viewState.selectedFileIndex",0),this.set("viewState.scrollTop",0),this.viewState.changeNum&&this.viewState.changeNum!==this._changeNum&&(this._setDiffViewMode(!0),this.set("_numFilesShown",200)),this.set("viewState.changeNum",this._changeNum),this.set("viewState.patchRange",this._patchRange)}_changeChanged(e){if(!e||!this._patchRange||!this._allPatchSets)return;const t=this._getBasePatchNum(e,this._patchRange);this.set("_patchRange.patchNum",this._patchRange.patchNum||Jn(this._allPatchSets)),this.set("_patchRange.basePatchNum",t),xi(this,e.subject+" ("+e.change_id.substr(0,9)+")")}_getBasePatchNum(e,t){if(t.basePatchNum&&"PARENT"!==t.basePatchNum)return t.basePatchNum;const i=this._getRevisionInfo(e);if(!i)return"PARENT";const n=i.getParentCountMap(),r=o(n,1)?n[1]:1,s=this._prefs&&"FIRST_PARENT"===this._prefs.default_base_for_merges;return r>1&&s&&!t.patchNum?-1:"PARENT"}_computeChangeUrl(e){return Qm.getUrlForChange(e)}_computeShowCommitInfo(e,t){return 1===e.length&&"Merged"===e[0]&&t}_computeReplyButtonLabel(e,t){if(void 0===e||void 0===t)return"Reply";const i=e&&e.base||{},n=Object.keys(i).reduce((e,t)=>e+i[t].length,0);let o=t?"Start Review":"Reply";return n>0&&(o+=` (${n})`),o}_handleOpenReplyDialog(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this._getLoggedIn().then(t=>{t?(e.preventDefault(),this._openReplyDialog(this.$.replyDialog.FocusTarget.ANY)):bi(this,"show-auth-required")})}_handleOpenDownloadDialogShortcut(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._handleOpenDownloadDialog())}_handleEditTopic(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.$.metadata.editTopic())}_handleDiffAgainstBase(e){if(!this.shouldSuppressKeyboardShortcut(e)){if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");"PARENT"!==this._patchRange.basePatchNum?Qm.navigateToChange(this._change,this._patchRange.patchNum):Ci(this,"Base is already selected.")}}_handleDiffBaseAgainstLeft(e){if(!this.shouldSuppressKeyboardShortcut(e)){if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");"PARENT"!==this._patchRange.basePatchNum?Qm.navigateToChange(this._change,this._patchRange.basePatchNum):Ci(this,"Left is already base.")}}_handleDiffAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");const t=Jn(this._allPatchSets);this._patchRange.patchNum!==t?Qm.navigateToChange(this._change,t,this._patchRange.basePatchNum):Ci(this,"Latest is already selected.")}_handleDiffRightAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;a(this._change,"_change");const t=Jn(this._allPatchSets);if(!this._patchRange)throw new Error("missing required _patchRange property");this._patchRange.patchNum!==t?Qm.navigateToChange(this._change,t,this._patchRange.patchNum):Ci(this,"Right is already latest.")}_handleDiffBaseAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");const t=Jn(this._allPatchSets);this._patchRange.patchNum!==t||"PARENT"!==this._patchRange.basePatchNum?Qm.navigateToChange(this._change,t):Ci(this,"Already diffing base against latest.")}_handleRefreshChange(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this._reload(!1,!0))}_handleToggleChangeStar(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.$.changeStar.toggleStar())}_handleUpToDashboard(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._determinePageBack())}_handleExpandAllMessages(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.messagesList&&this.messagesList.handleExpandCollapse(!0))}_handleCollapseAllMessages(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.messagesList&&this.messagesList.handleExpandCollapse(!1))}_handleOpenDiffPrefsShortcut(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this._diffPrefsDisabled||(e.preventDefault(),this.$.fileList.openDiffPrefs())}_determinePageBack(){Qm.navigateToRelativeUrl(this.backPage||Qm.getUrlForRoot())}_handleLabelRemoved(e,t){for(const i of e)for(const e of i.removed){const i=t.split("."),n=i.splice(0,i.length-2),o=this.get(n);if(o.approved&&o.approved._account_id===e._account_id)return void this._reload()}}_labelsChanged(e){e&&(e.value&&void 0!==e.value.indexSplices&&this._handleLabelRemoved(e.value.indexSplices,e.path),this.jsAPI.handleEvent(Fa.LABEL_CHANGE,{change:this._change}))}_openReplyDialog(e){this._change&&(this.$.replyOverlay.open().finally(()=>{this._resetReplyOverlayFocusStops(),this.$.replyDialog.open(e),yh(),this.$.replyOverlay.center()}),Ri(this,{opened:!0}),this._changeViewAriaHidden=!0)}_handleGetChangeDetailError(e){Si(e)}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getServerConfig(){return this.restApiService.getConfig()}_getProjectConfig(){return a(this._change,"_change"),this.restApiService.getProjectConfig(this._change.project).then(e=>{this._projectConfig=e})}_getPreferences(){return this.restApiService.getPreferences()}_prepareCommitMsgForLinkify(e){return e.replace(PT,"$1=")}_processEdit(e,t){var i;if(!t&&"edit"===(null===(i=this._patchRange)||void 0===i?void 0:i.patchNum)&&bo(e))return Ci(this,"Change edit not found. Please create a change edit."),void Qm.navigateToChange(e);if(!t&&(wo(e)||Co(e))&&this._editMode)return Ci(this,"Change edits cannot be created if change is merged or abandoned. Redirected to non edit mode."),void Qm.navigateToChange(e);if(!t)return;if(!this._patchRange)throw new Error("missing required _patchRange property");if(!t.commit.commit)throw new Error("undefined edit.commit.commit");const n=e;n.revisions&&(n.revisions[t.commit.commit]={_number:"edit",basePatchNum:t.base_patch_set_number,commit:t.commit,fetch:t.fetch}),this._patchRange.patchNum||n.current_revision!==t.base_revision||(n.current_revision=t.commit.commit,this.set("_patchRange.patchNum","edit"),n.revisions&&(n.revisions[t.commit.commit].actions=n.revisions[t.base_revision].actions))}_getChangeDetail(){if(!this._changeNum)throw new Error("missing required changeNum property");const e=this.restApiService.getChangeDetail(this._changeNum,e=>this._handleGetChangeDetailError(e)),t=this._getEdit(),i=this._getPreferences();return Promise.all([e,t,i]).then(([e,t,i])=>{var n;if(this._prefs=i,!e)return!1;this._processEdit(e,t),e.topic||(e.topic=null),e.reviewer_updates||(e.reviewer_updates=null);const o=this._getLatestRevisionSHA(e);if(!o)throw new Error("Could not find latest Revision Sha");const r=e.revisions[o];r.commit&&r.commit.message?this._latestCommitMessage=this._prepareCommitMsgForLinkify(r.commit.message):this._latestCommitMessage=null;const s=getComputedStyle(this).lineHeight;if(this._lineHeight=Number(s.slice(0,s.length-2)),this._change=e,this.changeService.updateChange(e),this._patchRange&&this._patchRange.patchNum&&this._patchRange.patchNum!==r._number){if(!(null===(n=this._change)||void 0===n?void 0:n.revisions)||!this._patchRange)return!1;this._selectedRevision=Object.values(this._change.revisions).find(e=>{const t=this._patchRange.patchNum;return"edit"===t?e._number===t:e._number===Number(`${t}`)})}else r.commit&&!r.commit.commit&&(r.commit.commit=o),this._commitInfo=r.commit,this._selectedRevision=r;return!0})}_isSubmitEnabled(e){return!!(e&&e.submit&&e.submit.enabled)}_isParentCurrent(e){return!e||!e.rebase||!e.rebase.enabled}_getEdit(){return this._changeNum?this.restApiService.getChangeEdit(this._changeNum,!0):Promise.reject(new Error("missing required changeNum property"))}_getLatestCommitMessage(){if(!this._changeNum)throw new Error("missing required changeNum property");const e=Jn(this._allPatchSets);if(void 0===e)throw new Error("missing lastPatchNum property");return this.restApiService.getChangeCommitInfo(this._changeNum,e).then(e=>{e&&(this._latestCommitMessage=this._prepareCommitMsgForLinkify(e.message))})}_getLatestRevisionSHA(e){var t;if(e.current_revision)return e.current_revision;let i=null,n=-1;for(const[o,r]of Object.entries(null!==(t=e.revisions)&&void 0!==t?t:{}))r._number>n&&(i=o,n=r._number);return i}_getCommitInfo(){if(!this._changeNum)throw new Error("missing required _changeNum property");if(!this._patchRange)throw new Error("missing required _patchRange property");if(void 0===this._patchRange.patchNum)throw new Error("missing required patchNum property");return"edit"===this._patchRange.patchNum?this._getEdit().then(e=>e?this._getChangeCommitInfo():Promise.resolve()):this._getChangeCommitInfo()}_getChangeCommitInfo(){return this.restApiService.getChangeCommitInfo(this._changeNum,this._patchRange.patchNum).then(e=>{this._commitInfo=e})}_reloadDraftsWithCallback(e){return this._reloadDrafts().then(()=>e.detail.resolve())}_reloadComments(){var e;if(this._changeComments=void 0,this._commentThreads=void 0,this._diffDrafts=void 0,this._draftCommentThreads=void 0,this._robotCommentThreads=void 0,!this._changeNum)throw new Error("missing required changeNum property");return this.$.commentAPI.loadAll(this._changeNum,null===(e=this._patchRange)||void 0===e?void 0:e.patchNum).then(e=>{this._recomputeComments(e)})}_reloadDrafts(){if(!this._changeNum)throw new Error("missing required changeNum property");return this.$.commentAPI.reloadDrafts(this._changeNum).then(e=>this._recomputeComments(e))}_recomputeComments(e){this._changeComments=e,this._diffDrafts={...this._changeComments.drafts},this._commentThreads=this._changeComments.getAllThreadsForChange(),this._draftCommentThreads=this._commentThreads.filter(Xw).map(e=>{const t={...e},i=t.comments=e.comments.map(e=>({...e,collapsed:!0}));return i[i.length-1].collapsed=!1,t})}_reload(e,t){if(t&&this._change)return Qm.navigateToChange(this._change),Promise.resolve([]);this._loading=!0,this.reporting.time(p.CHANGE_RELOAD),this.reporting.time(p.CHANGE_DATA);const i=[],n=this._getChangeDetail();i.push(n),this.checksService.reloadAll();const o=n.then(()=>{this._loading=!1,bi(this,"change-details-loaded")}).then(()=>{this.reporting.timeEnd(p.CHANGE_RELOAD),e&&this.reporting.changeDisplayed()}),r=n.then(e=>e?this._getProjectConfig():Promise.resolve());i.push(r);const s=this._reloadComments();let a;if(i.push(s),this._patchRange&&this._patchRange.patchNum){const e=this._reloadPatchNumDependentResources();i.push(e);const t=Promise.all([e,o]),n=t.then(()=>this._getMergeability());i.push(n);const r=t.then(()=>this.$.actions.reload());i.push(r),a=Promise.all([n,r])}else{const e=o.then(()=>this.$.fileList.reload());i.push(e);const t=o.then(()=>this._latestCommitMessage?Promise.resolve():this._getLatestCommitMessage());i.push(t);const n=o.then(()=>this._getMergeability());i.push(n),a=Promise.all([n])}if(e){this._editingCommitMessage=!1;const e=a.then(()=>{var e;let t;const i=this._computeLatestPatchNum(this._allPatchSets);this._change&&i&&(t=this.restApiService.getRelatedChanges(this._change._number,i).then(e=>(this._change&&e&&(this.hasParent=this._calculateHasParent(this._change.change_id,e.changes)),e))),null===(e=this.getRelatedChangesList())||void 0===e||e.reload(t)});i.push(e)}return Promise.all(i).then(()=>{this.reporting.timeEnd(p.CHANGE_DATA),e&&this.reporting.changeFullyLoaded()}),a}_calculateHasParent(e,t){return t.length>0&&t[t.length-1].change_id!==e}_reloadPatchNumDependentResources(e){var t,i;if(a(this._changeNum,"_changeNum"),!(null===(t=this._patchRange)||void 0===t?void 0:t.patchNum))throw new Error("missing patchNum");const n=[this._getCommitInfo(),this.$.fileList.reload()];return e&&n.push(this.$.commentAPI.reloadPortedComments(this._changeNum,null===(i=this._patchRange)||void 0===i?void 0:i.patchNum)),Promise.all(n)}_getMergeability(){return this._change?this._change.status===Ji.MERGED||this._change.status===Ji.ABANDONED?(this._mergeable=!1,Promise.resolve()):this._changeNum?void 0!==this._change.mergeable?(this._mergeable=this._change.mergeable,Promise.resolve()):(this._mergeable=null,this.restApiService.getMergeable(this._changeNum).then(e=>{e&&(this._mergeable=e.mergeable)})):Promise.reject(new Error("missing required changeNum property")):(this._mergeable=null,Promise.resolve())}_computeCanStartReview(e){return!!(e.actions&&e.actions.ready&&e.actions.ready.enabled)}_computeReplyDisabled(){return!1}_computeChangePermalinkAriaLabel(e){return`Change ${e}`}_computeCopyTextForTitle(e){return`${e._number}: ${e.subject} | `+`${location.protocol}//${location.host}`+`${this._computeChangeUrl(e)}`}_computeCommitCollapsible(e){return!!e&&e.split("\n").length>=17}_startUpdateCheckTimer(){!this._serverConfig||!this._serverConfig.change||void 0===this._serverConfig.change.update_delay||this._serverConfig.change.update_delay<=0||(this._updateCheckTimerHandle=window.setTimeout(()=>{a(this._change,"_change");const e=this._change;Qn(e,this.restApiService).then(t=>{var i;let n=null;t.isLatest?t.newStatus===Ji.MERGED?n=DT:t.newStatus===Ji.ABANDONED?n=LT:t.newStatus===Ji.NEW?n=NT:t.newMessages&&(n=MT,(null===(i=t.newMessages.author)||void 0===i?void 0:i.name)&&(n+=` from ${t.newMessages.author.name}`)):n=OT;const o=e!==this._change;!n||this._loading||o?this._startUpdateCheckTimer():(this._cancelUpdateCheckTimer(),this.dispatchEvent(new CustomEvent("show-alert",{detail:{message:n,dismissOnNavigation:!0,showDismiss:!0,action:"Reload",callback:()=>{this._reload(!1,!0)}},composed:!0,bubbles:!0})))})},1e3*this._serverConfig.change.update_delay))}_cancelUpdateCheckTimer(){this._updateCheckTimerHandle&&window.clearTimeout(this._updateCheckTimerHandle),this._updateCheckTimerHandle=null}_handleTopicChanged(){var e;null===(e=this.getRelatedChangesList())||void 0===e||e.reload()}_computeHeaderClass(e){const t=["header"];return e&&t.push("editMode"),t.join(" ")}_computeEditMode(e,t){if(!e||!t)return;if(t.base&&t.base.edit)return!0;return"edit"===(e.base||{}).patchNum}_handleFileActionTap(e){e.preventDefault();const t=this.$.fileListHeader.shadowRoot.querySelector("#editControls");if(!t)throw new Error("Missing edit controls");if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");const i=e.detail.path;switch(e.detail.action){case Lx.DELETE.id:t.openDeleteDialog(i);break;case Lx.OPEN.id:Qm.navigateToRelativeUrl(Qm.getEditUrlForDiff(this._change,i,this._patchRange.patchNum));break;case Lx.RENAME.id:t.openRenameDialog(i);break;case Lx.RESTORE.id:t.openRestoreDialog(i)}}_computeCommitMessageKey(e,t){return`c${e}_rev${t}`}_patchNumChanged(e){if(!this._selectedRevision)return;let t;a(this._change,"_change"),t="edit"===e?"edit":Number(`${e}`),t!==this._selectedRevision._number&&this._change.revisions&&(this._selectedRevision=Object.values(this._change.revisions).find(e=>e._number===t))}_handleEditTap(){if(!this._change||!this._change.revisions)throw new Error("missing required change property");if(Object.values(this._change.revisions).find(e=>"edit"===e._number))return void Qm.navigateToChange(this._change,"edit");if(!this._patchRange)throw new Error("missing required _patchRange property");let e;this._patchRange.patchNum!==Jn(this._allPatchSets)&&(e=this._patchRange.patchNum),Qm.navigateToChange(this._change,e,void 0,!0)}_handleStopEditTap(){if(a(this._change,"_change"),!this._patchRange)throw new Error("missing required _patchRange property");Qm.navigateToChange(this._change,this._patchRange.patchNum)}_resetReplyOverlayFocusStops(){this.$.replyOverlay.setFocusStops(this.$.replyDialog.getFocusStops())}_handleToggleStar(e){this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred)}_getRevisionInfo(e){return new lT(e)}_computeCurrentRevision(e,t){return e&&t&&t[e]}_computeDiffPrefsDisabled(e,t){return e||!t}_computeLatestPatchNum(e){return Jn(e)}_hasEditBasedOnCurrentPatchSet(e){return function(e){return!(!e||e.length<2)&&"edit"===e[0].num}(e)}_hasEditPatchsetLoaded(e){const t=e.base;return!!t&&function(e){return"edit"===e.patchNum||"edit"===e.basePatchNum}(t)}_computeAllPatchSets(e){return Yn(e)}getRelatedChangesList(){return this.shadowRoot.querySelector("#relatedChanges")}};kT([Oo({type:Object,observer:"_paramsChanged"})],FT.prototype,"params",void 0),kT([Oo({type:Object,notify:!0,observer:"_viewStateChanged"})],FT.prototype,"viewState",void 0),kT([Oo({type:String})],FT.prototype,"backPage",void 0),kT([Oo({type:Boolean})],FT.prototype,"hasParent",void 0),kT([Oo({type:Object})],FT.prototype,"keyEventTarget",void 0),kT([Oo({type:Boolean})],FT.prototype,"disableEdit",void 0),kT([Oo({type:Boolean})],FT.prototype,"disableDiffPrefs",void 0),kT([Oo({type:Boolean,computed:"_computeDiffPrefsDisabled(disableDiffPrefs, _loggedIn)"})],FT.prototype,"_diffPrefsDisabled",void 0),kT([Oo({type:Array})],FT.prototype,"_commentThreads",void 0),kT([Oo({type:Array})],FT.prototype,"_draftCommentThreads",void 0),kT([Oo({type:Array,computed:"_computeRobotCommentThreads(_commentThreads, _currentRobotCommentsPatchSet, _showAllRobotComments)"})],FT.prototype,"_robotCommentThreads",void 0),kT([Oo({type:Object,observer:"_startUpdateCheckTimer"})],FT.prototype,"_serverConfig",void 0),kT([Oo({type:Object})],FT.prototype,"_diffPrefs",void 0),kT([Oo({type:Number,observer:"_numFilesShownChanged"})],FT.prototype,"_numFilesShown",void 0),kT([Oo({type:Object})],FT.prototype,"_account",void 0),kT([Oo({type:Object})],FT.prototype,"_prefs",void 0),kT([Oo({type:Object})],FT.prototype,"_changeComments",void 0),kT([Oo({type:Boolean,computed:"_computeCanStartReview(_change)"})],FT.prototype,"_canStartReview",void 0),kT([Oo({type:Object,observer:"_changeChanged"})],FT.prototype,"_change",void 0),kT([Oo({type:Object,computed:"_getRevisionInfo(_change)"})],FT.prototype,"_revisionInfo",void 0),kT([Oo({type:Object})],FT.prototype,"_commitInfo",void 0),kT([Oo({type:Object,computed:"_computeCurrentRevision(_change.current_revision, _change.revisions)",observer:"_handleCurrentRevisionUpdate"})],FT.prototype,"_currentRevision",void 0),kT([Oo({type:String})],FT.prototype,"_changeNum",void 0),kT([Oo({type:Object})],FT.prototype,"_diffDrafts",void 0),kT([Oo({type:Boolean})],FT.prototype,"_editingCommitMessage",void 0),kT([Oo({type:Boolean,computed:"_computeHideEditCommitMessage(_loggedIn, _editingCommitMessage, _change, _editMode)"})],FT.prototype,"_hideEditCommitMessage",void 0),kT([Oo({type:String})],FT.prototype,"_diffAgainst",void 0),kT([Oo({type:String})],FT.prototype,"_latestCommitMessage",void 0),kT([Oo({type:Object})],FT.prototype,"_constants",void 0),kT([Oo({type:Object})],FT.prototype,"_messages",void 0),kT([Oo({type:Number})],FT.prototype,"_lineHeight",void 0),kT([Oo({type:Object})],FT.prototype,"_patchRange",void 0),kT([Oo({type:String})],FT.prototype,"_filesExpanded",void 0),kT([Oo({type:String})],FT.prototype,"_basePatchNum",void 0),kT([Oo({type:Object})],FT.prototype,"_selectedRevision",void 0),kT([Oo({type:Object})],FT.prototype,"_currentRevisionActions",void 0),kT([Oo({type:Array,computed:"_computeAllPatchSets(_change, _change.revisions.*)"})],FT.prototype,"_allPatchSets",void 0),kT([Oo({type:Boolean})],FT.prototype,"_loggedIn",void 0),kT([Oo({type:Boolean})],FT.prototype,"_loading",void 0),kT([Oo({type:Object})],FT.prototype,"_projectConfig",void 0),kT([Oo({type:String,computed:"_computeReplyButtonLabel(_diffDrafts.*, _canStartReview)"})],FT.prototype,"_replyButtonLabel",void 0),kT([Oo({type:String})],FT.prototype,"_selectedPatchSet",void 0),kT([Oo({type:Number})],FT.prototype,"_shownFileCount",void 0),kT([Oo({type:Boolean})],FT.prototype,"_initialLoadComplete",void 0),kT([Oo({type:Boolean})],FT.prototype,"_replyDisabled",void 0),kT([Oo({type:String,computed:"_computeChangeStatusChips(_change, _mergeable, _submitEnabled)"})],FT.prototype,"_changeStatuses",void 0),kT([Oo({type:Boolean})],FT.prototype,"_commitCollapsed",void 0),kT([Oo({type:Boolean,computed:"_computeCommitCollapsible(_latestCommitMessage)"})],FT.prototype,"_commitCollapsible",void 0),kT([Oo({type:Number})],FT.prototype,"_updateCheckTimerHandle",void 0),kT([Oo({type:Boolean,computed:"_computeEditMode(_patchRange.*, params.*)"})],FT.prototype,"_editMode",void 0),kT([Oo({type:Boolean,computed:"_isParentCurrent(_currentRevisionActions)"})],FT.prototype,"_parentIsCurrent",void 0),kT([Oo({type:Boolean,computed:"_isSubmitEnabled(_currentRevisionActions)"})],FT.prototype,"_submitEnabled",void 0),kT([Oo({type:Boolean})],FT.prototype,"_mergeable",void 0),kT([Oo({type:Boolean})],FT.prototype,"_showFileTabContent",void 0),kT([Oo({type:Array})],FT.prototype,"_dynamicTabHeaderEndpoints",void 0),kT([Oo({type:Array})],FT.prototype,"_dynamicTabContentEndpoints",void 0),kT([Oo({type:String})],FT.prototype,"_selectedTabPluginEndpoint",void 0),kT([Oo({type:String})],FT.prototype,"_selectedTabPluginHeader",void 0),kT([Oo({type:Array,computed:"_computeRobotCommentsPatchSetDropdownItems(_change, _commentThreads)"})],FT.prototype,"_robotCommentsPatchSetDropdownItems",void 0),kT([Oo({type:Number})],FT.prototype,"_currentRobotCommentsPatchSet",void 0),kT([Oo({type:Boolean})],FT.prototype,"_changeViewAriaHidden",void 0),kT([Oo({type:Array})],FT.prototype,"_activeTabs",void 0),kT([Oo({type:Boolean})],FT.prototype,"_showAllRobotComments",void 0),kT([Oo({type:Boolean})],FT.prototype,"_showRobotCommentsButton",void 0),kT([Oo({type:Boolean})],FT.prototype,"_showChecksTab",void 0),kT([Oo({type:String})],FT.prototype,"_tabState",void 0),kT([No("params","_change")],FT.prototype,"_paramsAndChangeChanged",null),kT([No("_change.labels.*")],FT.prototype,"_labelsChanged",null),kT([No("_patchRange.patchNum")],FT.prototype,"_patchNumChanged",null),FT=kT([Po("gr-change-view")],FT);const $T=mi`
  <style include="shared-styles">
    .main {
      max-height: 40em;
      max-width: 60em;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    @media screen and (max-width: 50em) {
      .main {
        max-height: none;
        max-width: 50em;
      }
    }
    .signInLink {
      text-decoration: none;
    }
  </style>
  <gr-dialog
    id="dialog"
    cancel-label=""
    on-confirm="_handleConfirm"
    confirm-label="Dismiss"
    confirm-on-enter=""
  >
    <div class="header" slot="header">An error occurred</div>
    <div class="main" slot="main">[[text]]</div>
    <gr-button
      id="signIn"
      class$="signInLink"
      hidden$="[[!showSignInButton]]"
      link=""
      slot="footer"
    >
      <a href$="[[loginUrl]]" class="signInLink">Sign in</a>
    </gr-button>
  </gr-dialog>
`;var BT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let jT=class extends fi{constructor(){super(...arguments),this.loginUrl="/login",this.showSignInButton=!1}static get template(){return $T}_handleConfirm(){this.dispatchEvent(new CustomEvent("dismiss"))}};BT([Oo({type:String})],jT.prototype,"text",void 0),BT([Oo({type:String})],jT.prototype,"loginUrl",void 0),BT([Oo({type:Boolean})],jT.prototype,"showSignInButton",void 0),jT=BT([Po("gr-error-dialog")],jT);const HT=mi`
  <style include="shared-styles">
    /**
       * ALERT: DO NOT ADD TRANSITION PROPERTIES WITHOUT PROPERLY UNDERSTANDING
       * HOW THEY ARE USED IN THE CODE.
       */
    :host([toast]) {
      background-color: var(--tooltip-background-color);
      bottom: 1.25rem;
      border-radius: var(--border-radius);
      box-shadow: var(--elevation-level-2);
      color: var(--tooltip-text-color);
      left: 1.25rem;
      position: fixed;
      transform: translateY(5rem);
      transition: transform var(--gr-alert-transition-duration, 80ms) ease-out;
      z-index: 1000;
    }
    :host([shown]) {
      transform: translateY(0);
    }
    /**
       * NOTE: To avoid style being overwritten by outside of the shadow DOM
       * (as outside styles always win), .content-wrapper is introduced as a
       * wrapper around main content to have better encapsulation, styles that
       * may be affected by outside should be defined on it.
       * In this case, \`padding:0px\` is defined in main.css for all elements
       * with the universal selector: *.
       */
    .content-wrapper {
      padding: var(--spacing-l) var(--spacing-xl);
    }
    .text {
      color: var(--tooltip-text-color);
      display: inline-block;
      max-height: 10rem;
      max-width: 80vw;
      vertical-align: bottom;
      word-break: break-all;
    }
    .action {
      color: var(--link-color);
      font-weight: var(--font-weight-bold);
      margin-left: var(--spacing-l);
      text-decoration: none;
      --gr-button: {
        padding: 0;
      }
    }
  </style>
  <div class="content-wrapper">
    <span class="text">[[text]]</span>
    <gr-button
      link=""
      class="action"
      hidden$="[[_hideActionButton]]"
      on-click="_handleActionTap"
      >[[actionText]]</gr-button
    ><template is="dom-if" if="[[showDismiss]]"
      ><gr-button link="" class="action" on-click="_handleDismissTap"
        >Dismiss</gr-button
      ></template
    >
  </div>
`;var UT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let GT=class extends fi{constructor(){super(...arguments),this.shown=!0,this.toast=!0,this.showDismiss=!1}static get template(){return HT}connectedCallback(){super.connectedCallback(),this._boundTransitionEndHandler=()=>this._handleTransitionEnd(),this.addEventListener("transitionend",this._boundTransitionEndHandler)}disconnectedCallback(){this._boundTransitionEndHandler&&this.removeEventListener("transitionend",this._boundTransitionEndHandler),super.disconnectedCallback()}show(e,t,i){this.text=e,this.actionText=t,this._hideActionButton=!t,this._actionCallback=i,yu().appendChild(this),this.shown=!0}hide(){this.shown=!1,this._hasZeroTransitionDuration()&&yu().removeChild(this)}_handleDismissTap(){this.hide()}_hasZeroTransitionDuration(){const e=window.getComputedStyle(this);return 0===Math.round(100*parseFloat(e.transitionDuration))}_handleTransitionEnd(){this.shown||yu().removeChild(this)}_handleActionTap(e){e.preventDefault(),this._actionCallback&&this._actionCallback()}};UT([Oo({type:String})],GT.prototype,"text",void 0),UT([Oo({type:String})],GT.prototype,"actionText",void 0),UT([Oo({type:String})],GT.prototype,"type",void 0),UT([Oo({type:Boolean,reflectToAttribute:!0})],GT.prototype,"shown",void 0),UT([Oo({type:Boolean,reflectToAttribute:!0})],GT.prototype,"toast",void 0),UT([Oo({type:Boolean})],GT.prototype,"_hideActionButton",void 0),UT([Oo({type:Boolean})],GT.prototype,"showDismiss",void 0),UT([Oo()],GT.prototype,"_boundTransitionEndHandler",void 0),UT([Oo()],GT.prototype,"_actionCallback",void 0),GT=UT([Po("gr-alert")],GT);const zT=mi`
  <gr-overlay with-backdrop="" id="errorOverlay">
    <gr-error-dialog
      id="errorDialog"
      on-dismiss="_handleDismissErrorDialog"
      confirm-label="Dismiss"
      confirm-on-enter=""
      login-url="[[loginUrl]]"
    ></gr-error-dialog>
  </gr-overlay>
  <gr-overlay
    id="noInteractionOverlay"
    with-backdrop=""
    always-on-top=""
    no-cancel-on-esc-key=""
    no-cancel-on-outside-click=""
  >
  </gr-overlay>
`;var VT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const WT={[Bu.AUTH]:3,[Bu.NETWORK]:2,[Bu.GENERIC]:1};let qT=class extends fi{constructor(){super(...arguments),this._alertElement=null,this._hideAlertHandle=null,this._refreshingCredentials=!1,this._lastCredentialCheck=Date.now(),this.loginUrl="/login",this.reporting=i.reportingService,this._authService=i.authService,this.eventEmitter=i.eventEmitter,this.restApiService=i.restApiService,this.handleAuthRequired=()=>{this._showAuthErrorAlert("Log in is required to perform that action.","Log in.")},this.handleServerError=e=>{const{request:t,response:i}=e.detail;i.text().then(e=>{const n=t&&(t.anonymizedUrl||t.url),{status:o,statusText:r}=i;if(403!==i.status||this._authService.isAuthed||"Authentication required\n"!==e){if(403===i.status&&this._authService.isAuthed&&"Authentication required\n"===e)this._authService.clearCache(),this.restApiService.getLoggedIn();else if(!this._shouldSuppressError(e)){const t=i.headers&&i.headers.get("X-Gerrit-Trace");404===i.status?this._showNotFoundMessageWithTip({status:o,statusText:r,errorText:e,url:n,trace:t}):this._showErrorDialog(this._constructServerErrorMsg({status:o,statusText:r,errorText:e,url:n,trace:t}))}}else this.handleAuthRequired();console.info(`server error: ${e}`)})},this.handleShowAlert=e=>{this._showAlert(e.detail.message,e.detail.action,e.detail.callback,e.detail.dismissOnNavigation,void 0,e.detail.showDismiss)},this.handleNetworkError=e=>{this._showAlert("Server unavailable"),console.error(e.detail.error.message)},this.hideAlert=()=>{this._alertElement&&(this._alertElement.hide(),this._alertElement=null,document.removeEventListener("location-change",this.hideAlert))},this.handleVisibilityChange=()=>{if(!1!==document.hidden)return;const e=Date.now()-this._lastCredentialCheck;!this._refreshingCredentials&&void 0!==this.knownAccountId&&e>6e5&&(this.reporting.reportInteraction("visibility-sign-in-check"),this._lastCredentialCheck=Date.now(),this._checkSignedIn())},this.handleWindowFocus=()=>{var e;null===(e=this.checkLoggedInTask)||void 0===e||e.flush()},this.handleShowErrorDialog=e=>{this._showErrorDialog(e.detail.message)}}static get template(){return zT}connectedCallback(){super.connectedCallback(),document.addEventListener(vi.SERVER_ERROR,this.handleServerError),document.addEventListener(vi.NETWORK_ERROR,this.handleNetworkError),document.addEventListener(vi.SHOW_ALERT,this.handleShowAlert),document.addEventListener("hide-alert",this.hideAlert),document.addEventListener("show-error",this.handleShowErrorDialog),document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("show-auth-required",this.handleAuthRequired),this._authErrorHandlerDeregistrationHook=this.eventEmitter.on("auth-error",e=>{this._handleAuthError(e.message,e.action)}),T_.requestAvailability()}disconnectedCallback(){var e;this._clearHideAlertHandle(),document.removeEventListener(vi.SERVER_ERROR,this.handleServerError),document.removeEventListener(vi.NETWORK_ERROR,this.handleNetworkError),document.removeEventListener(vi.SHOW_ALERT,this.handleShowAlert),document.removeEventListener("hide-alert",this.hideAlert),document.removeEventListener("show-error",this.handleShowErrorDialog),document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("show-auth-required",this.handleAuthRequired),null===(e=this.checkLoggedInTask)||void 0===e||e.cancel(),this._authErrorHandlerDeregistrationHook&&this._authErrorHandlerDeregistrationHook(),super.disconnectedCallback()}_shouldSuppressError(e){return e.includes("too many files to find conflicts")||e.includes("'conflicts:' operator is not supported by server")}_handleAuthError(e,t){this.$.noInteractionOverlay.open().then(()=>{this._showAuthErrorAlert(e,t)})}_showNotFoundMessageWithTip({status:e,statusText:t,errorText:i,url:n,trace:o}){this.restApiService.getLoggedIn().then(r=>{const s=r?"You might have not enough privileges.":"You might have not enough privileges. Sign in and try again.";this._showErrorDialog(this._constructServerErrorMsg({status:e,statusText:t,errorText:i,url:n,trace:o,tip:s}),{showSignInButton:!r})})}_constructServerErrorMsg({errorText:e,status:t,statusText:i,url:n,trace:o,tip:r}){let s="";return r&&(s+=`${r}\n\n`),s+=`Error ${t}`,i&&(s+=` (${i})`),(e||n)&&(s+=": "),e&&(s+=e),n&&(s+=`\nEndpoint: ${n}`),o&&(s+=`\nTrace Id: ${o}`),s}_canOverride(e=Bu.GENERIC,t=Bu.GENERIC){return WT[e]>=WT[t]}_showAlert(e,t,i,n,o,r){if(this._alertElement){if(!this._canOverride(o,this._alertElement.type))return;this.hideAlert()}this._clearHideAlertHandle(),n?document.addEventListener("location-change",this.hideAlert):this._hideAlertHandle=window.setTimeout(this.hideAlert,5e3);const s=this._createToastAlert(r);s.show(e,t,i),this._alertElement=s,Ti(this,`Alert: ${e}`),this.reporting.reportInteraction("show-alert",{text:e})}_clearHideAlertHandle(){null!==this._hideAlertHandle&&(window.clearTimeout(this._hideAlertHandle),this._hideAlertHandle=null)}_showAuthErrorAlert(e,t){this._alertElement&&this._alertElement.hide(),this._alertElement=this._createToastAlert(),this._alertElement.type=Bu.AUTH,this._alertElement.show(e,t,()=>this._createLoginPopup()),Ti(this,e),this.reporting.reportInteraction("show-auth-error",{text:e}),this._refreshingCredentials=!0,this._requestCheckLoggedIn(),document.hidden||this.handleVisibilityChange()}_createToastAlert(e){const t=document.createElement("gr-alert");return t.toast=!0,t.showDismiss=!!e,t}_requestCheckLoggedIn(){this.checkLoggedInTask=Cu(this.checkLoggedInTask,()=>this._checkSignedIn(),6e4)}_checkSignedIn(){this._lastCredentialCheck=Date.now(),this.restApiService.invalidateAccountsCache(),this._authService.clearCache(),this.restApiService.getLoggedIn().then(e=>{this._refreshingCredentials&&(e?this.restApiService.getAccount().then(e=>{if(this._refreshingCredentials){if((null==e?void 0:e._account_id)!==this.knownAccountId)return this.reporting.reportInteraction("sign-in-window-reload",{oldAccount:!!this.knownAccountId,newAccount:!!(null==e?void 0:e._account_id)}),void this._reloadPage();this.handleCredentialRefreshed()}}):this._requestCheckLoggedIn())})}_reloadPage(){hu()}_createLoginPopup(){const e=["width=690","height=500",`left=${window.screenLeft+(window.outerWidth-690)/2}`,`top=${window.screenTop+(window.outerHeight-500)/2}`];window.open(k()+"/login/%3FcloseAfterLogin","_blank",e.join(",")),window.addEventListener("focus",this.handleWindowFocus)}handleCredentialRefreshed(){window.removeEventListener("focus",this.handleWindowFocus),this._refreshingCredentials=!1,this.hideAlert(),this._showAlert("Credentials refreshed."),this.$.noInteractionOverlay.close(),this._authService.clearCache()}_handleDismissErrorDialog(){this.$.errorOverlay.close()}_showErrorDialog(e,t){this.reporting.reportErrorDialog(e),this.$.errorDialog.text=e,this.$.errorDialog.showSignInButton=!!t&&!!t.showSignInButton,this.$.errorOverlay.open()}};VT([Oo({type:Number})],qT.prototype,"knownAccountId",void 0),VT([Oo({type:Object})],qT.prototype,"_alertElement",void 0),VT([Oo({type:Number})],qT.prototype,"_hideAlertHandle",void 0),VT([Oo({type:Boolean})],qT.prototype,"_refreshingCredentials",void 0),VT([Oo({type:Number})],qT.prototype,"_lastCredentialCheck",void 0),VT([Oo({type:String})],qT.prototype,"loginUrl",void 0),qT=VT([Po("gr-error-manager")],qT);const KT=Zl`
  .key {
    background-color: var(--chip-background-color);
    color: var(--primary-text-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    display: inline-block;
    font-weight: var(--font-weight-bold);
    padding: var(--spacing-xxs) var(--spacing-m);
    text-align: center;
  }
`;var YT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let XT=class extends RA{constructor(){super(...arguments),this.binding=[]}static get styles(){return[ic,KT]}render(){const e=this.binding.map((e,t)=>[t>0?Pl` or `:Pl``,this._computeModifiers(e).map(e=>Pl`<span class="key modifier">${e}</span> `),Pl`<span class="key">${this._computeKey(e)}</span>`]);return Pl`${e}`}_computeModifiers(e){return e.slice(0,e.length-1)}_computeKey(e){return e[e.length-1]}};YT([Gl({type:Array})],XT.prototype,"binding",void 0),XT=YT([Hl("gr-key-binding-display")],XT);const JT=mi`
  <style include="shared-styles">
    :host {
      display: block;
      max-height: 100vh;
      overflow-y: auto;
    }
    header {
      padding: var(--spacing-l);
    }
    main {
      display: flex;
      padding: 0 var(--spacing-xxl) var(--spacing-xxl);
    }
    .column {
      flex: 50%;
    }
    header {
      align-items: center;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
    }
    table caption {
      font-weight: var(--font-weight-bold);
      padding-top: var(--spacing-l);
      text-align: left;
    }
    tr {
      height: 32px;
    }
    td {
      padding: var(--spacing-xs) 0;
    }
    td:first-child,
    th:first-child {
      padding-right: var(--spacing-m);
      text-align: right;
      width: 160px;
      color: var(--deemphasized-text-color);
    }
    td:second-child {
      min-width: 200px;
    }
    th {
      color: var(--deemphasized-text-color);
      text-align: left;
    }
    .header {
      font-weight: var(--font-weight-bold);
      padding-top: var(--spacing-l);
    }
    .modifier {
      font-weight: var(--font-weight-normal);
    }
  </style>
  <header>
    <h3 class="heading-3">Keyboard shortcuts</h3>
    <gr-button link="" on-click="_handleCloseTap">Close</gr-button>
  </header>
  <main>
    <div class="column">
      <template is="dom-repeat" items="[[_left]]">
        <table>
          <caption>
            [[item.section]]
          </caption>
          <thead>
            <tr>
              <th>Key</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <template is="dom-repeat" items="[[item.shortcuts]]" as="shortcut">
              <tr>
                <td>
                  <gr-key-binding-display binding="[[shortcut.binding]]">
                  </gr-key-binding-display>
                </td>
                <td>[[shortcut.text]]</td>
              </tr>
            </template>
          </tbody>
        </table>
      </template>
    </div>
    <div class="column">
      <template is="dom-repeat" items="[[_right]]">
        <table>
          <caption>
            [[item.section]]
          </caption>
          <thead>
            <tr>
              <th>Key</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <template is="dom-repeat" items="[[item.shortcuts]]" as="shortcut">
              <tr>
                <td>
                  <gr-key-binding-display binding="[[shortcut.binding]]">
                  </gr-key-binding-display>
                </td>
                <td>[[shortcut.text]]</td>
              </tr>
            </template>
          </tbody>
        </table>
      </template>
    </div>
  </main>
  <footer></footer>
`;var ZT=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let QT=class extends(Kf(fi)){constructor(){super(),this.keyboardShortcutDirectoryListener=e=>this._onDirectoryUpdated(e)}static get template(){return JT}ready(){super.ready(),this._ensureAttribute("role","dialog")}connectedCallback(){super.connectedCallback(),this.addKeyboardShortcutDirectoryListener(this.keyboardShortcutDirectoryListener)}disconnectedCallback(){this.removeKeyboardShortcutDirectoryListener(this.keyboardShortcutDirectoryListener),super.disconnectedCallback()}_handleCloseTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("close",{composed:!0,bubbles:!1}))}_onDirectoryUpdated(e){if(!e)return;const t=[],i=[];e.has(jf.EVERYWHERE)&&t.push({section:jf.EVERYWHERE,shortcuts:e.get(jf.EVERYWHERE)}),e.has(jf.NAVIGATION)&&t.push({section:jf.NAVIGATION,shortcuts:e.get(jf.NAVIGATION)}),e.has(jf.ACTIONS)&&i.push({section:jf.ACTIONS,shortcuts:e.get(jf.ACTIONS)}),e.has(jf.REPLY_DIALOG)&&i.push({section:jf.REPLY_DIALOG,shortcuts:e.get(jf.REPLY_DIALOG)}),e.has(jf.FILE_LIST)&&i.push({section:jf.FILE_LIST,shortcuts:e.get(jf.FILE_LIST)}),e.has(jf.DIFFS)&&i.push({section:jf.DIFFS,shortcuts:e.get(jf.DIFFS)}),this.set("_left",t),this.set("_right",i)}};ZT([Oo({type:Array})],QT.prototype,"_left",void 0),ZT([Oo({type:Array})],QT.prototype,"_right",void 0),QT=ZT([Po("gr-keyboard-shortcuts-dialog")],QT);const ek=mi`
  <style include="shared-styles">
    gr-dropdown {
      padding: 0 var(--spacing-m);
      --gr-button: {
        color: var(--header-text-color);
      }
      --gr-dropdown-item: {
        color: var(--primary-text-color);
      }
    }
    gr-avatar {
      height: 2em;
      width: 2em;
      vertical-align: middle;
    }
  </style>
  <gr-dropdown
    link=""
    items="[[links]]"
    top-content="[[topContent]]"
    on-tap-item-shortcuts="_handleShortcutsTap"
    horizontal-align="right"
  >
    <span hidden$="[[_hasAvatars]]" hidden="">[[_accountName(account)]]</span>
    <gr-avatar
      account="[[account]]"
      hidden$="[[!_hasAvatars]]"
      hidden=""
      image-size="56"
      aria-label="Account avatar"
    ></gr-avatar>
  </gr-dropdown>
`;var tk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const ik=/\${([\w]+)}/g;let nk=class extends fi{constructor(){super(...arguments),this._path="/",this._hasAvatars=!1,this._switchAccountUrl="",this.restApiService=i.restApiService,this.handleLocationChange=()=>{this._path=window.location.pathname+window.location.search+window.location.hash}}static get template(){return ek}connectedCallback(){super.connectedCallback(),this.handleLocationChange(),window.addEventListener("location-change",this.handleLocationChange),this.restApiService.getConfig().then(e=>{this.config=e,e&&e.auth&&e.auth.switch_account_url?this._switchAccountUrl=e.auth.switch_account_url:this._switchAccountUrl="",this._hasAvatars=!!(e&&e.plugin&&e.plugin.has_avatars)})}disconnectedCallback(){window.removeEventListener("location-change",this.handleLocationChange),super.disconnectedCallback()}_getLinks(e,t){if(void 0===e||void 0===t)return;const i=[];if(i.push({name:"Settings",url:"/settings/"}),i.push({name:"Keyboard Shortcuts",id:"shortcuts"}),e){const n={path:t},o=this._interpolateUrl(e,n);i.push({name:"Switch account",url:o,external:!0})}return i.push({name:"Sign out",url:"/logout"}),i}_getTopContent(e){return[{text:this._accountName(e),bold:!0},{text:(null==e?void 0:e.email)?e.email:""}]}_handleShortcutsTap(){bi(this,"show-keyboard-shortcuts")}_interpolateUrl(e,t){return e.replace(ik,(e,i)=>t[i]||"")}_accountName(e){return vv(this.config,e)}};tk([Oo({type:Object})],nk.prototype,"account",void 0),tk([Oo({type:Object})],nk.prototype,"config",void 0),tk([Oo({type:Array,computed:"_getLinks(_switchAccountUrl, _path)"})],nk.prototype,"links",void 0),tk([Oo({type:Array,computed:"_getTopContent(account)"})],nk.prototype,"topContent",void 0),tk([Oo({type:String})],nk.prototype,"_path",void 0),tk([Oo({type:Boolean})],nk.prototype,"_hasAvatars",void 0),tk([Oo({type:String})],nk.prototype,"_switchAccountUrl",void 0),nk=tk([Po("gr-account-dropdown")],nk);const ok=mi`
  <style include="shared-styles">
    form {
      display: flex;
    }
    gr-autocomplete {
      background-color: var(--view-background-color);
      border-radius: var(--border-radius);
      flex: 1;
      outline: none;
    }
  </style>
  <form>
    <gr-autocomplete
      label="[[label]]"
      show-search-icon=""
      id="searchInput"
      text="{{_inputVal}}"
      query="[[query]]"
      on-commit="_handleInputCommit"
      allow-non-suggested-values=""
      multi=""
      threshold="[[_threshold]]"
      tab-complete=""
      vertical-offset="30"
    >
      <a
        slot="suffix"
        href$="[[_computeHelpDocLink(docBaseUrl)]]"
        target="_blank"
        class="help"
        tabindex="-1"
      >
        <iron-icon
          icon="gr-icons:help-outline"
          title="read documentation"
        ></iron-icon>
      </a>
    </gr-autocomplete>
  </form>
`;var rk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const sk=["added:","after:","age:","age:1week","assignee:","attention:","author:","before:","branch:","bug:","cc:","cc:self","change:","cherrypickof:","comment:","commentby:","commit:","committer:","conflicts:","deleted:","delta:","dir:","directory:","ext:","extension:","file:","footer:","from:","has:","has:draft","has:edit","has:star","has:stars","has:unresolved","hashtag:","intopic:","is:","is:abandoned","is:assigned","is:closed","is:ignored","is:merge","is:merged","is:open","is:owner","is:private","is:reviewed","is:reviewer","is:starred","is:submittable","is:watched","is:wip","label:","mergedafter:","mergedbefore:","message:","onlyexts:","onlyextensions:","owner:","ownerin:","parentof:","parentproject:","project:","projects:","query:","ref:","reviewedby:","reviewer:","reviewer:self","reviewerin:","size:","star:","status:","status:abandoned","status:closed","status:merged","status:open","status:reviewed","submissionid:","topic:","tr:"],ak=new Set(sk.concat(sk.map(e=>`-${e}`))),lk=/(?:[^\s"]+|"[^"]*")+\s*/g;let ck=class extends(Kf(fi)){constructor(){super(),this.searchOperators=new Set(ak),this.value="",this.keyEventTarget=document.body,this.projectSuggestions=()=>Promise.resolve([]),this.groupSuggestions=()=>Promise.resolve([]),this.accountSuggestions=()=>Promise.resolve([]),this._threshold=1,this.label="",this.docBaseUrl=null,this.restApiService=i.restApiService,this.query=e=>this._getSearchSuggestions(e)}static get template(){return ok}connectedCallback(){super.connectedCallback(),this.restApiService.getConfig().then(e=>{const t=e&&e.change&&e.change.mergeability_computation_behavior;t!==Tn.API_REF_UPDATED_AND_CHANGE_REINDEX&&t!==Tn.REF_UPDATED_AND_CHANGE_REINDEX||this._addOperator("is:mergeable"),e&&I(e,this.restApiService).then(e=>{this.docBaseUrl=e})})}_computeHelpDocLink(e){let t=e||"https://gerrit-review.googlesource.com/documentation/";return t.endsWith("/")&&(t=t.substring(0,t.length-1)),`${t}/user-search.html`}_addOperator(e,t=!0){this.searchOperators.add(e),t&&this.searchOperators.add(`-${e}`)}keyboardShortcuts(){return{[Hf.SEARCH]:"_handleSearch"}}_valueChanged(e){this._inputVal=e}_handleInputCommit(e){this._preventDefaultAndNavigateToInputVal(e)}_preventDefaultAndNavigateToInputVal(e){e.preventDefault();const t=Th(e).rootTarget;if(t.$.input?t.$.input.blur():t.blur(),!this._inputVal)return;const i=this._inputVal.trim();if(i){if([...this.searchOperators].some(e=>e.endsWith(":")&&e===i))return;const e={inputVal:this._inputVal};this.dispatchEvent(new CustomEvent("handle-search",{detail:e}))}}_fetchSuggestions(e){const t=e.split(":"),i=t[0],n=t[1]||"";switch(i){case"ownerin":case"reviewerin":return this.groupSuggestions(i,n);case"parentproject":case"project":return this.projectSuggestions(i,n);case"assignee":case"attention":case"author":case"cc":case"commentby":case"committer":case"from":case"owner":case"reviewedby":case"reviewer":return this.accountSuggestions(i,n);default:return Promise.resolve([...this.searchOperators].filter(t=>t.includes(e)).map(e=>({text:e})))}}_getSearchSuggestions(e){const t=e.match(lk);if(null===t)return Promise.resolve([]);const i=t[t.length-1].toLowerCase();return this._fetchSuggestions(i).then(e=>e&&e.length?e.sort((e,t)=>{var n,o;const r=null===(n=e.text)||void 0===n?void 0:n.toLowerCase().indexOf(i),s=null===(o=t.text)||void 0===o?void 0:o.toLowerCase().indexOf(i);return void 0===r&&void 0===s?0:void 0===r&&void 0!==s?1:void 0!==r&&void 0===s?-1:r===s?e.text.localeCompare(t.text):-1===r?1:-1===s?-1:r-s}).slice(0,9).map(({text:e,label:t})=>({name:e,value:e,label:t})):[])}_handleSearch(e){const t=this.getKeyboardEvent(e);this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)&&!t.shiftKey||(e.preventDefault(),this.$.searchInput.focus(),this.$.searchInput.selectAll())}};rk([Oo({type:String,notify:!0,observer:"_valueChanged"})],ck.prototype,"value",void 0),rk([Oo({type:Object})],ck.prototype,"keyEventTarget",void 0),rk([Oo({type:Object})],ck.prototype,"query",void 0),rk([Oo({type:Object})],ck.prototype,"projectSuggestions",void 0),rk([Oo({type:Object})],ck.prototype,"groupSuggestions",void 0),rk([Oo({type:Object})],ck.prototype,"accountSuggestions",void 0),rk([Oo({type:String})],ck.prototype,"_inputVal",void 0),rk([Oo({type:Number})],ck.prototype,"_threshold",void 0),rk([Oo({type:String})],ck.prototype,"label",void 0),rk([Oo({type:String})],ck.prototype,"docBaseUrl",void 0),ck=rk([Po("gr-search-bar")],ck);const dk=mi`
  <style include="shared-styles"></style>
  <gr-search-bar
    id="search"
    label="[[label]]"
    value="{{searchQuery}}"
    on-handle-search="_handleSearch"
    project-suggestions="[[_projectSuggestions]]"
    group-suggestions="[[_groupSuggestions]]"
    account-suggestions="[[_accountSuggestions]]"
  ></gr-search-bar>
`;var hk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let pk=class extends fi{constructor(){super(...arguments),this._projectSuggestions=(e,t)=>this._fetchProjects(e,t),this._groupSuggestions=(e,t)=>this._fetchGroups(e,t),this._accountSuggestions=(e,t)=>this._fetchAccounts(e,t),this.label="",this.restApiService=i.restApiService}static get template(){return dk}connectedCallback(){super.connectedCallback(),this.restApiService.getConfig().then(e=>{this._config=e})}_handleSearch(e){const t=e.detail.inputVal;t&&Qm.navigateToSearchQuery(t)}_fetchProjects(e,t){return this.restApiService.getSuggestedProjects(t,10).then(t=>{if(!t)return[];return Object.keys(t).map(t=>({text:e+":"+t}))})}_fetchGroups(e,t){return 0===t.length?Promise.resolve([]):this.restApiService.getSuggestedGroups(t,10).then(t=>{if(!t)return[];return Object.keys(t).map(t=>({text:e+":"+t}))})}_fetchAccounts(e,t){return 0===t.length?Promise.resolve([]):this.restApiService.getSuggestedAccounts(t,10).then(t=>t?this._mapAccountsHelper(t,e):[]).then(i=>"self".startsWith(t)?i.concat([{text:e+":self"}]):"me".startsWith(t)?i.concat([{text:e+":me"}]):i)}_mapAccountsHelper(e,t){return e.map(e=>{const i=vv(this._config,e);return{label:e.name||"",text:e.email?`${t}:${e.email}`:`${t}:"${i}"`}})}};hk([Oo({type:String})],pk.prototype,"searchQuery",void 0),hk([Oo({type:Object})],pk.prototype,"_config",void 0),hk([Oo({type:Object})],pk.prototype,"_projectSuggestions",void 0),hk([Oo({type:Object})],pk.prototype,"_groupSuggestions",void 0),hk([Oo({type:Object})],pk.prototype,"_accountSuggestions",void 0),hk([Oo({type:String})],pk.prototype,"label",void 0),pk=hk([Po("gr-smart-search")],pk);const uk=mi`
  <style include="shared-styles">
    :host {
      display: block;
    }
    nav {
      align-items: center;
      display: flex;
    }
    .bigTitle {
      color: var(--header-text-color);
      font-size: var(--header-title-font-size);
      text-decoration: none;
    }
    .bigTitle:hover {
      text-decoration: underline;
    }
    .titleText::before {
      background-image: var(--header-icon);
      background-size: var(--header-icon-size) var(--header-icon-size);
      background-repeat: no-repeat;
      content: '';
      display: inline-block;
      height: var(--header-icon-size);
      margin-right: calc(var(--header-icon-size) / 4);
      vertical-align: text-bottom;
      width: var(--header-icon-size);
    }
    .titleText::after {
      content: var(--header-title-content);
    }
    ul {
      list-style: none;
      padding-left: var(--spacing-l);
    }
    .links > li {
      cursor: default;
      display: inline-block;
      padding: 0;
      position: relative;
    }
    .linksTitle {
      display: inline-block;
      font-weight: var(--font-weight-bold);
      position: relative;
      text-transform: uppercase;
    }
    .linksTitle:hover {
      opacity: 0.75;
    }
    .rightItems {
      align-items: center;
      display: flex;
      flex: 1;
      justify-content: flex-end;
    }
    .rightItems gr-endpoint-decorator:not(:empty) {
      margin-left: var(--spacing-l);
    }
    gr-smart-search {
      flex-grow: 1;
      margin: 0 var(--spacing-m);
      max-width: 500px;
      min-width: 150px;
    }
    gr-dropdown,
    .browse {
      padding: var(--spacing-m);
    }
    gr-dropdown {
      --gr-dropdown-item: {
        color: var(--primary-text-color);
      }
    }
    .settingsButton {
      margin-left: var(--spacing-m);
    }
    .feedbackButton {
      margin-left: var(--spacing-s);
    }
    .browse {
      color: var(--header-text-color);
      /* Same as gr-button */
      margin: 5px 4px;
      text-decoration: none;
    }
    .invisible,
    .settingsButton,
    gr-account-dropdown {
      display: none;
    }
    :host([loading]) .accountContainer,
    :host([logged-in]) .loginButton,
    :host([logged-in]) .registerButton {
      display: none;
    }
    :host([logged-in]) .settingsButton,
    :host([logged-in]) gr-account-dropdown {
      display: inline;
    }
    .accountContainer {
      align-items: center;
      display: flex;
      margin: 0 calc(0 - var(--spacing-m)) 0 var(--spacing-m);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .loginButton,
    .registerButton {
      padding: var(--spacing-m) var(--spacing-l);
    }
    .dropdown-trigger {
      text-decoration: none;
    }
    .dropdown-content {
      background-color: var(--view-background-color);
      box-shadow: var(--elevation-level-2);
    }
    /*
       * We are not using :host to do this, because :host has a lowest css priority
       * compared to others. This means that using :host to do this would break styles.
       */
    .linksTitle,
    .bigTitle,
    .loginButton,
    .registerButton,
    iron-icon,
    gr-account-dropdown {
      color: var(--header-text-color);
    }
    #mobileSearch {
      display: none;
    }
    @media screen and (max-width: 50em) {
      .bigTitle {
        font-family: var(--header-font-family);
        font-size: var(--font-size-h3);
        font-weight: var(--font-weight-h3);
        line-height: var(--line-height-h3);
      }
      gr-smart-search,
      .browse,
      .rightItems .hideOnMobile,
      .links > li.hideOnMobile {
        display: none;
      }
      #mobileSearch {
        display: inline-flex;
      }
      .accountContainer {
        margin-left: var(--spacing-m) !important;
      }
      gr-dropdown {
        padding: var(--spacing-m) 0 var(--spacing-m) var(--spacing-m);
      }
    }
  </style>
  <nav>
    <a href$="[[_computeRelativeURL('/')]]" class="bigTitle">
      <gr-endpoint-decorator name="header-title">
        <span class="titleText"></span>
      </gr-endpoint-decorator>
    </a>
    <ul class="links">
      <template is="dom-repeat" items="[[_links]]" as="linkGroup">
        <li class$="[[_computeLinkGroupClass(linkGroup)]]">
          <gr-dropdown
            link=""
            down-arrow=""
            items="[[linkGroup.links]]"
            horizontal-align="left"
          >
            <span class="linksTitle" id="[[linkGroup.title]]">
              [[linkGroup.title]]
            </span>
          </gr-dropdown>
        </li>
      </template>
    </ul>
    <div class="rightItems">
      <gr-endpoint-decorator
        class="hideOnMobile"
        name="header-small-banner"
      ></gr-endpoint-decorator>
      <gr-smart-search
        id="search"
        label="Search for changes"
        search-query="{{searchQuery}}"
      ></gr-smart-search>
      <gr-endpoint-decorator
        class="hideOnMobile"
        name="header-browse-source"
      ></gr-endpoint-decorator>
      <template is="dom-if" if="[[_feedbackURL]]">
        <a class="feedbackButton"
          href$="[[_feedbackURL]]"
          title="File a bug"
          aria-label="File a bug"
          role="button"
        >
          <iron-icon icon="gr-icons:bug"></iron-icon>
        </a>
      </template>
      </div>
      <div class="accountContainer" id="accountContainer">
        <iron-icon
          id="mobileSearch"
          icon="gr-icons:search"
          on-click="_onMobileSearchTap"
          role="button"
          aria-label="[[_computeShowHideAriaLabel(mobileSearchHidden)]]"
        ></iron-icon>
        <div
          class="registerDiv"
          hidden="[[_computeRegisterHidden(_registerURL)]]"
        >
          <a class="registerButton" href$="[[_registerURL]]">
            [[_registerText]]
          </a>
        </div>
        <a class="loginButton" href$="[[loginUrl]]">Sign in</a>
        <a
          class="settingsButton"
          href$="[[_generateSettingsLink()]]"
          title="Settings"
          aria-label="Settings"
          role="button"
        >
          <iron-icon icon="gr-icons:settings"></iron-icon>
        </a>
        <template is="dom-if" if="[[_account]]">
          <gr-account-dropdown account="[[_account]]"></gr-account-dropdown>
        </template>
      </div>
    </div>
  </nav>
`;var gk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const mk=[{title:"Changes",links:[{url:"/q/status:open+-is:wip",name:"Open"},{url:"/q/status:merged",name:"Merged"},{url:"/q/status:abandoned",name:"Abandoned"}]}],fk=[{url:"/index.html",name:"Table of Contents"},{url:"/user-search.html",name:"Searching"},{url:"/user-upload.html",name:"Uploading"},{url:"/access-control.html",name:"Access Control"},{url:"/rest-api.html",name:"REST API"},{url:"/intro-project-owner.html",name:"Project Owner Guide"}],_k=new Set([An.LDAP,An.LDAP_BIND,An.CUSTOM_EXTENSION]);let vk=class extends fi{constructor(){super(...arguments),this._adminLinks=[],this._docBaseUrl=null,this.loginUrl="/login",this._userLinks=[],this._topMenus=[],this._registerText="Sign up",this._registerURL="",this._feedbackURL="",this.mobileSearchHidden=!1,this.restApiService=i.restApiService,this.jsAPI=i.jsApiService}static get template(){return uk}ready(){super.ready(),this._ensureAttribute("role","banner")}connectedCallback(){super.connectedCallback(),this._loadAccount(),this._loadConfig()}disconnectedCallback(){super.disconnectedCallback()}reload(){this._loadAccount()}_computeRelativeURL(e){return"//"+window.location.host+k()+e}_computeLinks(e,t,i,n,o=mk){if(void 0===e||void 0===t||void 0===i||void 0===n)return;const r=o.map(e=>({title:e.title,links:e.links.slice()}));e&&e.length>0&&r.push({title:"Your",links:e.slice()});const s=this._getDocLinks(n,fk);s.length&&r.push({title:"Documentation",links:s,class:"hideOnMobile"}),r.push({title:"Browse",links:t.slice()});const a={};r.forEach(e=>{a[e.title]=e.links});for(const e of i){const t=e.items.map(this._createHeaderLink).filter(e=>!e.url.includes("${projectName}"));e.name in a?t.forEach(t=>{a[e.name].push(t)}):t.length>0&&r.push({title:e.name,links:a[e.name]=t})}return r}_getDocLinks(e,t){return e?t.map(t=>{let i=e;return i&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),{url:i+t.url,name:t.name,target:"_blank"}}):[]}_loadAccount(){return this.loading=!0,Promise.all([this.restApiService.getAccount(),this.restApiService.getTopMenus(),Qu().awaitPluginsLoaded()]).then(e=>{const t=e[0];return this._account=t,this.loggedIn=!!t,this.loading=!1,this._topMenus=e[1],bb(t,()=>this.restApiService.getAccountCapabilities().then(e=>{if(!e)throw new Error("getAccountCapabilities returns undefined");return e}),()=>this.jsAPI.getAdminMenuLinks()).then(e=>{this._adminLinks=e.links})})}_loadConfig(){this.restApiService.getConfig().then(e=>{if(!e)throw new Error("getConfig returned undefined");return this._retrieveFeedbackURL(e),this._retrieveRegisterURL(e),I(e,this.restApiService)}).then(e=>{this._docBaseUrl=e})}_accountLoaded(e){e&&this.restApiService.getPreferences().then(e=>{this._userLinks=e&&e.my?e.my.map(this._createHeaderLink):[]})}_retrieveFeedbackURL(e){var t;(null===(t=e.gerrit)||void 0===t?void 0:t.report_bug_url)&&(this._feedbackURL=e.gerrit.report_bug_url)}_retrieveRegisterURL(e){var t;_k.has(e.auth.auth_type)&&(this._registerURL=null!==(t=e.auth.register_url)&&void 0!==t?t:"",e.auth.register_text&&(this._registerText=e.auth.register_text))}_computeRegisterHidden(e){return!e}_createHeaderLink(e){const{target:t,...i}={...e};return i.url.startsWith("#")&&(i.url=e.url.slice(1)),i}_generateSettingsLink(){return k()+"/settings/"}_onMobileSearchTap(e){e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("mobile-search",{composed:!0,bubbles:!1}))}_computeLinkGroupClass(e){var t;return null!==(t=e.class)&&void 0!==t?t:""}_computeShowHideAriaLabel(e){return e?"Show Searchbar":"Hide Searchbar"}};gk([Oo({type:String,notify:!0})],vk.prototype,"searchQuery",void 0),gk([Oo({type:Boolean,reflectToAttribute:!0})],vk.prototype,"loggedIn",void 0),gk([Oo({type:Boolean,reflectToAttribute:!0})],vk.prototype,"loading",void 0),gk([Oo({type:Object})],vk.prototype,"_account",void 0),gk([Oo({type:Array})],vk.prototype,"_adminLinks",void 0),gk([Oo({type:String})],vk.prototype,"_docBaseUrl",void 0),gk([Oo({type:Array,computed:"_computeLinks(_userLinks, _adminLinks, _topMenus, _docBaseUrl)"})],vk.prototype,"_links",void 0),gk([Oo({type:String})],vk.prototype,"loginUrl",void 0),gk([Oo({type:Array})],vk.prototype,"_userLinks",void 0),gk([Oo({type:Array})],vk.prototype,"_topMenus",void 0),gk([Oo({type:String})],vk.prototype,"_registerText",void 0),gk([Oo({type:String})],vk.prototype,"_registerURL",void 0),gk([Oo({type:String})],vk.prototype,"_feedbackURL",void 0),gk([Oo({type:Boolean})],vk.prototype,"mobileSearchHidden",void 0),gk([No("_account")],vk.prototype,"_accountLoaded",null),vk=gk([Po("gr-main-header")],vk);const yk=mi``;var bk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const wk={ROOT:"/",DASHBOARD:/^\/dashboard\/(.+)$/,CUSTOM_DASHBOARD:/^\/dashboard\/?$/,PROJECT_DASHBOARD:/^\/p\/(.+)\/\+\/dashboard\/(.+)/,LEGACY_PROJECT_DASHBOARD:/^\/projects\/(.+),dashboards\/(.+)/,AGREEMENTS:/^\/settings\/agreements\/?/,NEW_AGREEMENTS:/^\/settings\/new-agreement\/?/,REGISTER:/^\/register(\/.*)?$/,LOG_IN_OR_OUT:/\/log(in|out)(\/(.+))?$/,DEFAULT:/.*/,GROUP:/^\/admin\/groups\/(?:uuid-)?([^,]+)$/,GROUP_SELF:/^\/groups\/self/,GROUP_INFO:/^\/admin\/groups\/(?:uuid-)?(.+),info$/,GROUP_AUDIT_LOG:/^\/admin\/groups\/(?:uuid-)?(.+),audit-log$/,GROUP_MEMBERS:/^\/admin\/groups\/(?:uuid-)?(.+),members$/,GROUP_LIST_OFFSET:/^\/admin\/groups(,(\d+))?(\/)?$/,GROUP_LIST_FILTER:"/admin/groups/q/filter::filter",GROUP_LIST_FILTER_OFFSET:"/admin/groups/q/filter::filter,:offset",LEGACY_CREATE_PROJECT:/^\/admin\/create-project\/?$/,LEGACY_CREATE_GROUP:/^\/admin\/create-group\/?$/,PROJECT_OLD:/^\/admin\/(projects)\/?(.+)?$/,REPO:/^\/admin\/repos\/([^,]+)$/,REPO_COMMANDS:/^\/admin\/repos\/(.+),commands$/,REPO_ACCESS:/^\/admin\/repos\/(.+),access$/,REPO_DASHBOARDS:/^\/admin\/repos\/(.+),dashboards$/,REPO_LIST_OFFSET:/^\/admin\/repos(,(\d+))?(\/)?$/,REPO_LIST_FILTER:"/admin/repos/q/filter::filter",REPO_LIST_FILTER_OFFSET:"/admin/repos/q/filter::filter,:offset",BRANCH_LIST_OFFSET:/^\/admin\/repos\/(.+),branches(,(.+))?$/,BRANCH_LIST_FILTER:"/admin/repos/:repo,branches/q/filter::filter",BRANCH_LIST_FILTER_OFFSET:"/admin/repos/:repo,branches/q/filter::filter,:offset",TAG_LIST_OFFSET:/^\/admin\/repos\/(.+),tags(,(.+))?$/,TAG_LIST_FILTER:"/admin/repos/:repo,tags/q/filter::filter",TAG_LIST_FILTER_OFFSET:"/admin/repos/:repo,tags/q/filter::filter,:offset",PLUGINS:/^\/plugins\/(.+)$/,PLUGIN_LIST:/^\/admin\/plugins(\/)?$/,PLUGIN_LIST_OFFSET:/^\/admin\/plugins(,(\d+))?(\/)?$/,PLUGIN_LIST_FILTER:"/admin/plugins/q/filter::filter",PLUGIN_LIST_FILTER_OFFSET:"/admin/plugins/q/filter::filter,:offset",QUERY:/^\/q\/([^,]+)(,(\d+))?$/,QUERY_LEGACY_SUFFIX:/^\/q\/.+,n,z$/,CHANGE_ID_QUERY:/^\/id\/(I[0-9a-f]{40})$/,CHANGE_LEGACY:/^\/c\/(\d+)\/?(((-?\d+|edit)(\.\.(\d+|edit))?))?\/?$/,CHANGE_NUMBER_LEGACY:/^\/(\d+)\/?/,CHANGE:/^\/c\/(.+)\/\+\/(\d+)(\/?((-?\d+|edit)(\.\.(\d+|edit))?))?\/?$/,CHANGE_EDIT:/^\/c\/(.+)\/\+\/(\d+)(\/(\d+))?,edit\/?$/,COMMENT:/^\/c\/(.+)\/\+\/(\d+)\/comment\/(\w+)\/?$/,DIFF:/^\/c\/(.+)\/\+\/(\d+)(\/((-?\d+|edit)(\.\.(\d+|edit))?(\/(.+))))\/?$/,DIFF_EDIT:/^\/c\/(.+)\/\+\/(\d+)\/(\d+|edit)\/(.+),edit(#\d+)?$/,DIFF_LEGACY:/^\/c\/(\d+)\/((-?\d+|edit)(\.\.(\d+|edit))?)\/(.+)/,DIFF_LEGACY_LINENUM:/^\/c\/((.+)\/\+\/)?(\d+)(\/?((-?\d+|edit)(\.\.(\d+|edit))?\/(.+))?)@[ab]?\d+$/,SETTINGS:/^\/settings\/?/,SETTINGS_LEGACY:/^\/settings\/VE\/(\S+)/,IMPROPERLY_ENCODED_PLUS:/^\/c\/(.+)\/ \/(.+)$/,PLUGIN_SCREEN:/^\/x\/([\w-]+)\/([\w-]+)\/?/,DOCUMENTATION_SEARCH_FILTER:"/Documentation/q/filter::filter",DOCUMENTATION_SEARCH:/^\/Documentation\/q\/(.*)$/,DOCUMENTATION:/^\/Documentation(\/)?(.+)?/},Ck=/^([ab]?)(\d+)$/,Sk=/\+/g,Ek=/^\?*/,Ak=/@([ab]?\d+)$/,xk=/,n,z$/,Rk=/\${(project|repo)}/g,Tk=document.querySelector("#app");Tk||console.info("No gr-app found (running tests)"),window.addEventListener("WebComponentsReady",()=>{i.reportingService.timeEnd(p.WEB_COMPONENTS_READY)});let kk=class extends fi{constructor(){super(...arguments),this._app=Tk,this._isInitialLoad=!0,this.reporting=i.reportingService,this.restApiService=i.restApiService}static get template(){return yk}start(){this._app&&this._startRouter()}_setParams(e){var t,i,n,o;i=e.view,n="changeNum"in e?e.changeNum:void 0,o="patchNum"in e&&null!==(t=e.patchNum)&&void 0!==t?t:void 0,Ss.next({...Ss.getValue(),view:i,changeNum:n,patchNum:o}),this._appElement().params=e}_appElement(){return document.getElementById("app-element")||document.getElementById("app").shadowRoot.getElementById("app-element")}_redirect(e){this._isRedirecting=!0,$m.redirect(e)}_generateUrl(e){const t=k();let i="";return e.view===bs.SEARCH?i=this._generateSearchUrl(e):e.view===bs.CHANGE?i=this._generateChangeUrl(e):e.view===bs.DASHBOARD?i=this._generateDashboardUrl(e):e.view===bs.DIFF||e.view===bs.EDIT?i=this._generateDiffOrEditUrl(e):e.view===bs.GROUP?i=this._generateGroupUrl(e):e.view===bs.REPO?i=this._generateRepoUrl(e):e.view===bs.ROOT?i="/":e.view===bs.SETTINGS?i=this._generateSettingsUrl():r(e,"Can't generate"),t+i}_generateWeblinks(e){switch(e.type){case Zm.FILE:return this._getFileWebLinks(e);case Zm.CHANGE:return this._getChangeWeblinks(e);case Zm.PATCHSET:return this._getPatchSetWeblink(e);default:r(e,`Unsupported weblink ${e.type}!`)}}_getPatchSetWeblink(e){const{commit:t,options:i}=e,{weblinks:n,config:o}=i||{},r=t&&t.slice(0,7),s=this._getBrowseCommitWeblink(n,o);return s&&s.url?{name:r,url:s.url}:{name:r}}_firstCodeBrowserWeblink(e){const t=["gitiles","browse","gitweb"];for(let i=0;i<t.length;i++){const n=e.find(e=>e.name===t[i]);if(n)return n}return null}_getBrowseCommitWeblink(e,t){var i;if(!e)return null;let n;if(null===(i=null==t?void 0:t.gerrit)||void 0===i?void 0:i.primary_weblink_name){const i=t.gerrit.primary_weblink_name;n=e.find(e=>e.name===i)}return n||(n=this._firstCodeBrowserWeblink(e)),n||null}_getChangeWeblinks(e){var t,i;const n=null===(t=e.options)||void 0===t?void 0:t.weblinks,o=null===(i=e.options)||void 0===i?void 0:i.config;if(!n||!n.length)return[];const r=this._getBrowseCommitWeblink(n,o);return n.filter(e=>!r||!r.name||e.name!==r.name)}_getFileWebLinks(e){var t;return(null===(t=e.options)||void 0===t?void 0:t.weblinks)||[]}_generateSearchUrl(e){let t="";if(e.offset&&e.offset>0&&(t=`,${e.offset}`),e.query)return"/q/"+O(e.query,!0)+t;const i=[];return e.owner&&i.push("owner:"+O(e.owner,!1)),e.project&&i.push("project:"+O(e.project,!1)),e.branch&&i.push("branch:"+O(e.branch,!1)),e.topic&&i.push("topic:"+Zb(O(e.topic,!1),/\s/.test(e.topic))),e.hashtag&&i.push("hashtag:"+Zb(O(e.hashtag.toLowerCase(),!1),/\s/.test(e.hashtag))),e.statuses&&(1===e.statuses.length?i.push("status:"+O(e.statuses[0],!1)):e.statuses.length>1&&i.push("("+e.statuses.map(e=>`status:${O(e,!1)}`).join(" OR ")+")")),"/q/"+i.join("+")+t}_generateChangeUrl(e){let t=this._getPatchRangeExpression(e);t.length&&(t="/"+t);let i=`${t}`;if(e.querystring?i+="?"+e.querystring:e.edit&&(i+=",edit"),e.messageHash&&(i+=e.messageHash),e.project){return`/c/${O(e.project,!0)}/+/${e.changeNum}${i}`}return`/c/${e.changeNum}${i}`}_generateDashboardUrl(e){const t=e.repo||e.project||void 0;if(e.sections){const i=this._sectionsToEncodedParams(e.sections,t);return e.title&&i.push("title="+encodeURIComponent(e.title)),`/dashboard/${e.user?e.user:""}?${i.join("&")}`}if(t){return`/p/${O(t,!0)}/+/dashboard/${e.dashboard}`}return`/dashboard/${e.user||"self"}`}_sectionsToEncodedParams(e,t){return e.map(e=>{const i=t?e.query.replace(Rk,t):e.query;return encodeURIComponent(e.name)+"="+encodeURIComponent(i)})}_generateDiffOrEditUrl(e){let t=this._getPatchRangeExpression(e);t.length&&(t="/"+t);let i=`${t}/${O(e.path||"",!0)}`;if(e.view===bs.EDIT&&(i+=",edit"),e.lineNum&&(i+="#",Ym(e)&&e.leftSide&&(i+="b"),i+=e.lineNum),Ym(e)&&e.commentId&&(i=`/comment/${e.commentId}`+i),e.project){return`/c/${O(e.project,!0)}/+/${e.changeNum}${i}`}return`/c/${e.changeNum}${i}`}_generateGroupUrl(e){let t=`/admin/groups/${O(`${e.groupId}`,!0)}`;return e.detail===Xm.MEMBERS?t+=",members":e.detail===Xm.LOG&&(t+=",audit-log"),t}_generateRepoUrl(e){let t=`/admin/repos/${O(`${e.repoName}`,!0)}`;return e.detail===Jm.ACCESS?t+=",access":e.detail===Jm.BRANCHES?t+=",branches":e.detail===Jm.TAGS?t+=",tags":e.detail===Jm.COMMANDS?t+=",commands":e.detail===Jm.DASHBOARDS&&(t+=",dashboards"),t}_generateSettingsUrl(){return"/settings"}_getPatchRangeExpression(e){let t="";return e.patchNum&&(t=`${e.patchNum}`),e.basePatchNum&&(t=`${e.basePatchNum}..${t}`),t}_normalizeLegacyRouteParams(e){return e.changeNum?this.restApiService.getFromProjectLookup(e.changeNum).then(t=>{if(!t)return void this._show404();const i={...e,project:t};this._normalizePatchRangeParams(i),this._redirect(this._generateUrl(i))}):Promise.resolve()}_normalizePatchRangeParams(e){if(null===e.basePatchNum||void 0===e.basePatchNum)return!1;const t=null!==e.patchNum&&void 0!==e.patchNum;let i=!1;return e.patchNum&&e.basePatchNum===e.patchNum?(i=!0,e.basePatchNum=null):t||(e.patchNum=e.basePatchNum,e.basePatchNum=null),i}_redirectToLogin(e){const t=k()||"";$m("/login/"+encodeURIComponent(e.substring(t.length)))}_getHashFromCanonicalPath(e){return e.split("#").slice(1).join("#")}_parseLineAddress(e){const t=e.match(Ck);return t?{leftSide:!!t[1],lineNum:Number(t[2])}:null}_redirectIfNotLoggedIn(e){return this.restApiService.getLoggedIn().then(t=>t?Promise.resolve():(this._redirectToLogin(e.canonicalPath),Promise.reject(new Error)))}_loadUserMiddleware(e,t){this.restApiService.getLoggedIn().then(()=>{t()})}_queryStringMiddleware(e,t){e.queryMap=this.createQueryMap(e),t()}createQueryMap(e){return e.querystring?window.URLSearchParams?new URLSearchParams(e.querystring):(this.reporting.reportExecution(h.REACHABLE_CODE,{id:"noURLSearchParams"}),new Map(this._parseQueryString(e.querystring))):new Map}_mapRoute(e,t,i){this[t]?$m(e,(e,t)=>this._loadUserMiddleware(e,t),(e,t)=>this._queryStringMiddleware(e,t),e=>{this.reporting.locationChanged(t),(i?this._redirectIfNotLoggedIn(e):Promise.resolve()).then(()=>{this[t](e)})}):this.reporting.error(new Error(`Attempted to map route to unknown method: ${t}`))}_startRouter(){const e=k();e&&$m.base(e),Qm.setup((e,t)=>{t?$m.redirect(e):$m.show(e)},e=>this._generateUrl(e),e=>this._generateWeblinks(e),e=>e),$m.exit("*",(e,t)=>{this._isRedirecting||this.reporting.beforeLocationChanged(),this._isRedirecting=!1,this._isInitialLoad=!1,t()}),$m((e,t)=>{if(window.URLSearchParams){const t=function(e){const t=e.indexOf("?");return t>-1?e.slice(0,t):e}(e.canonicalPath),i=function(e){const t=e.indexOf("?"),i=t>-1?e.slice(t+1):"";return new URLSearchParams(i)}(e.canonicalPath);if(i.has("usp")){const e=i.get("usp");return this.reporting.reportLifeCycle(d.USER_REFERRED_FROM,{usp:e}),i.delete("usp"),void this._redirect(function(e,t){const i=t.toString();return e+(i?"?":"")+i}(t,i))}}t()}),$m((e,t)=>{document.body.scrollTop=0,e.hash.match(wk.PLUGIN_SCREEN)?this._redirect(e.hash):(setTimeout(()=>{const e={hash:window.location.hash,pathname:window.location.pathname};this.dispatchEvent(new CustomEvent("location-change",{detail:e,composed:!0,bubbles:!0}))},1),t())}),this._mapRoute(wk.ROOT,"_handleRootRoute"),this._mapRoute(wk.DASHBOARD,"_handleDashboardRoute"),this._mapRoute(wk.CUSTOM_DASHBOARD,"_handleCustomDashboardRoute"),this._mapRoute(wk.PROJECT_DASHBOARD,"_handleProjectDashboardRoute"),this._mapRoute(wk.LEGACY_PROJECT_DASHBOARD,"_handleLegacyProjectDashboardRoute"),this._mapRoute(wk.GROUP_INFO,"_handleGroupInfoRoute",!0),this._mapRoute(wk.GROUP_AUDIT_LOG,"_handleGroupAuditLogRoute",!0),this._mapRoute(wk.GROUP_MEMBERS,"_handleGroupMembersRoute",!0),this._mapRoute(wk.GROUP_LIST_OFFSET,"_handleGroupListOffsetRoute",!0),this._mapRoute(wk.GROUP_LIST_FILTER_OFFSET,"_handleGroupListFilterOffsetRoute",!0),this._mapRoute(wk.GROUP_LIST_FILTER,"_handleGroupListFilterRoute",!0),this._mapRoute(wk.GROUP_SELF,"_handleGroupSelfRedirectRoute",!0),this._mapRoute(wk.GROUP,"_handleGroupRoute",!0),this._mapRoute(wk.PROJECT_OLD,"_handleProjectsOldRoute"),this._mapRoute(wk.REPO_COMMANDS,"_handleRepoCommandsRoute",!0),this._mapRoute(wk.REPO_ACCESS,"_handleRepoAccessRoute"),this._mapRoute(wk.REPO_DASHBOARDS,"_handleRepoDashboardsRoute"),this._mapRoute(wk.BRANCH_LIST_OFFSET,"_handleBranchListOffsetRoute"),this._mapRoute(wk.BRANCH_LIST_FILTER_OFFSET,"_handleBranchListFilterOffsetRoute"),this._mapRoute(wk.BRANCH_LIST_FILTER,"_handleBranchListFilterRoute"),this._mapRoute(wk.TAG_LIST_OFFSET,"_handleTagListOffsetRoute"),this._mapRoute(wk.TAG_LIST_FILTER_OFFSET,"_handleTagListFilterOffsetRoute"),this._mapRoute(wk.TAG_LIST_FILTER,"_handleTagListFilterRoute"),this._mapRoute(wk.LEGACY_CREATE_GROUP,"_handleCreateGroupRoute",!0),this._mapRoute(wk.LEGACY_CREATE_PROJECT,"_handleCreateProjectRoute",!0),this._mapRoute(wk.REPO_LIST_OFFSET,"_handleRepoListOffsetRoute"),this._mapRoute(wk.REPO_LIST_FILTER_OFFSET,"_handleRepoListFilterOffsetRoute"),this._mapRoute(wk.REPO_LIST_FILTER,"_handleRepoListFilterRoute"),this._mapRoute(wk.REPO,"_handleRepoRoute"),this._mapRoute(wk.PLUGINS,"_handlePassThroughRoute"),this._mapRoute(wk.PLUGIN_LIST_OFFSET,"_handlePluginListOffsetRoute",!0),this._mapRoute(wk.PLUGIN_LIST_FILTER_OFFSET,"_handlePluginListFilterOffsetRoute",!0),this._mapRoute(wk.PLUGIN_LIST_FILTER,"_handlePluginListFilterRoute",!0),this._mapRoute(wk.PLUGIN_LIST,"_handlePluginListRoute",!0),this._mapRoute(wk.QUERY_LEGACY_SUFFIX,"_handleQueryLegacySuffixRoute"),this._mapRoute(wk.QUERY,"_handleQueryRoute"),this._mapRoute(wk.CHANGE_ID_QUERY,"_handleChangeIdQueryRoute"),this._mapRoute(wk.DIFF_LEGACY_LINENUM,"_handleLegacyLinenum"),this._mapRoute(wk.CHANGE_NUMBER_LEGACY,"_handleChangeNumberLegacyRoute"),this._mapRoute(wk.DIFF_EDIT,"_handleDiffEditRoute",!0),this._mapRoute(wk.CHANGE_EDIT,"_handleChangeEditRoute",!0),this._mapRoute(wk.COMMENT,"_handleCommentRoute"),this._mapRoute(wk.DIFF,"_handleDiffRoute"),this._mapRoute(wk.CHANGE,"_handleChangeRoute"),this._mapRoute(wk.CHANGE_LEGACY,"_handleChangeLegacyRoute"),this._mapRoute(wk.DIFF_LEGACY,"_handleDiffLegacyRoute"),this._mapRoute(wk.AGREEMENTS,"_handleAgreementsRoute",!0),this._mapRoute(wk.NEW_AGREEMENTS,"_handleNewAgreementsRoute",!0),this._mapRoute(wk.SETTINGS_LEGACY,"_handleSettingsLegacyRoute",!0),this._mapRoute(wk.SETTINGS,"_handleSettingsRoute",!0),this._mapRoute(wk.REGISTER,"_handleRegisterRoute"),this._mapRoute(wk.LOG_IN_OR_OUT,"_handlePassThroughRoute"),this._mapRoute(wk.IMPROPERLY_ENCODED_PLUS,"_handleImproperlyEncodedPlusRoute"),this._mapRoute(wk.PLUGIN_SCREEN,"_handlePluginScreen"),this._mapRoute(wk.DOCUMENTATION_SEARCH_FILTER,"_handleDocumentationSearchRoute"),this._mapRoute(wk.DOCUMENTATION_SEARCH,"_handleDocumentationSearchRedirectRoute"),this._mapRoute(wk.DOCUMENTATION,"_handleDocumentationRedirectRoute"),this._mapRoute(wk.DEFAULT,"_handleDefaultRoute"),$m.start()}_handleRootRoute(e){if(e.querystring.match(/^closeAfterLogin/))return window.close(),null;let t=this._getHashFromCanonicalPath(e.canonicalPath);if(t){"/"!==t[0]&&(t="/"+t),t.includes("/ /")&&e.canonicalPath.includes("/+/")&&(t=t.replace("/ /","/+/"));const i=k();let n=i+t;return t.startsWith("/VE/")&&(n=i+"/settings"+t),this._redirect(n),null}return this.restApiService.getLoggedIn().then(e=>{e?this._redirect("/dashboard/self"):this._redirect("/q/status:open+-is:wip")})}_decodeQueryString(e){return decodeURIComponent(e.replace(Sk," "))}_parseQueryString(e){if(!(e=e.replace(Ek,"")))return[];const t=[];return e.split("&").forEach(e=>{const i=e.indexOf("=");let n,o;i<0?(n=this._decodeQueryString(e),o=""):(n=this._decodeQueryString(e.substring(0,i)),o=this._decodeQueryString(e.substring(i+1))),n&&t.push([n,o])}),t}_handleDashboardRoute(e){return this.restApiService.getLoggedIn().then(t=>{t?this._setParams({view:bs.DASHBOARD,user:e.params[0]}):"self"===e.params[0].toLowerCase()?this._redirectToLogin(e.canonicalPath):this._redirect("/q/owner:"+encodeURIComponent(e.params[0]))})}_handleCustomDashboardRoute(e,t=window.location.search){const i=this._parseQueryString(t);let n="Custom Dashboard";const o=i.find(e=>"title"===e[0].toLowerCase());o&&(n=o[1]);const r=i.find(e=>"foreach"===e[0].toLowerCase());let s=null;r&&(s=r[1]);const a=i.filter(e=>e[0]&&e[1]&&"title"!==e[0].toLowerCase()&&"foreach"!==e[0].toLowerCase()).map(e=>{const t=s?`${s} ${e[1]}`:e[1];return{name:e[0],query:t}});return a.length>0?(this._setParams({view:bs.DASHBOARD,user:"self",sections:a,title:n}),Promise.resolve()):(this._redirect("/dashboard/self"),Promise.resolve())}_handleProjectDashboardRoute(e){const t=e.params[0];this._setParams({view:bs.DASHBOARD,project:t,dashboard:decodeURIComponent(e.params[1])}),this.reporting.setRepoName(t)}_handleLegacyProjectDashboardRoute(e){this._redirect("/p/"+e.params[0]+"/+/dashboard/"+e.params[1])}_handleGroupInfoRoute(e){this._redirect("/admin/groups/"+encodeURIComponent(e.params[0]))}_handleGroupSelfRedirectRoute(e){this._redirect("/settings/#Groups")}_handleGroupRoute(e){this._setParams({view:bs.GROUP,groupId:e.params[0]})}_handleGroupAuditLogRoute(e){this._setParams({view:bs.GROUP,detail:Xm.LOG,groupId:e.params[0]})}_handleGroupMembersRoute(e){this._setParams({view:bs.GROUP,detail:Xm.MEMBERS,groupId:e.params[0]})}_handleGroupListOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-admin-group-list",offset:e.params[1]||0,filter:null,openCreateModal:"create"===e.hash})}_handleGroupListFilterOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-admin-group-list",offset:e.params.offset,filter:e.params.filter})}_handleGroupListFilterRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-admin-group-list",filter:e.params.filter||null})}_handleProjectsOldRoute(e){let t="";e.params[1]&&(t=encodeURIComponent(e.params[1]),e.params[1].includes(",")&&(t=encodeURIComponent(e.params[1]).replace("%2C",","))),this._redirect(`/admin/repos/${t}`)}_handleRepoCommandsRoute(e){const t=e.params[0];this._setParams({view:bs.REPO,detail:Jm.COMMANDS,repo:t}),this.reporting.setRepoName(t)}_handleRepoAccessRoute(e){const t=e.params[0];this._setParams({view:bs.REPO,detail:Jm.ACCESS,repo:t}),this.reporting.setRepoName(t)}_handleRepoDashboardsRoute(e){const t=e.params[0];this._setParams({view:bs.REPO,detail:Jm.DASHBOARDS,repo:t}),this.reporting.setRepoName(t)}_handleBranchListOffsetRoute(e){this._setParams({view:bs.REPO,detail:Jm.BRANCHES,repo:e.params[0],offset:e.params[2]||0,filter:null})}_handleBranchListFilterOffsetRoute(e){this._setParams({view:bs.REPO,detail:Jm.BRANCHES,repo:e.params.repo,offset:e.params.offset,filter:e.params.filter})}_handleBranchListFilterRoute(e){this._setParams({view:bs.REPO,detail:Jm.BRANCHES,repo:e.params.repo,filter:e.params.filter||null})}_handleTagListOffsetRoute(e){this._setParams({view:bs.REPO,detail:Jm.TAGS,repo:e.params[0],offset:e.params[2]||0,filter:null})}_handleTagListFilterOffsetRoute(e){this._setParams({view:bs.REPO,detail:Jm.TAGS,repo:e.params.repo,offset:e.params.offset,filter:e.params.filter})}_handleTagListFilterRoute(e){this._setParams({view:bs.REPO,detail:Jm.TAGS,repo:e.params.repo,filter:e.params.filter||null})}_handleRepoListOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-repo-list",offset:e.params[1]||0,filter:null,openCreateModal:"create"===e.hash})}_handleRepoListFilterOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-repo-list",offset:e.params.offset,filter:e.params.filter})}_handleRepoListFilterRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-repo-list",filter:e.params.filter||null})}_handleCreateProjectRoute(e){this._redirect("/admin/repos#create")}_handleCreateGroupRoute(e){this._redirect("/admin/groups#create")}_handleRepoRoute(e){const t=e.params[0];this._setParams({view:bs.REPO,repo:t}),this.reporting.setRepoName(t)}_handlePluginListOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-plugin-list",offset:e.params[1]||0,filter:null})}_handlePluginListFilterOffsetRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-plugin-list",offset:e.params.offset,filter:e.params.filter})}_handlePluginListFilterRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-plugin-list",filter:e.params.filter||null})}_handlePluginListRoute(e){this._setParams({view:bs.ADMIN,adminView:"gr-plugin-list"})}_handleQueryRoute(e){this._setParams({view:bs.SEARCH,query:e.params[0],offset:e.params[2]})}_handleChangeIdQueryRoute(e){this._setParams({view:Qm.View.SEARCH,query:e.params[0]})}_handleQueryLegacySuffixRoute(e){this._redirect(e.path.replace(xk,""))}_handleChangeNumberLegacyRoute(e){this._redirect("/c/"+encodeURIComponent(e.params[0]))}_handleChangeRoute(e){const t=Number(e.params[1]),i={project:e.params[0],changeNum:t,basePatchNum:Vn(e.params[4]),patchNum:Vn(e.params[6]),view:bs.CHANGE,queryMap:e.queryMap};this.reporting.setRepoName(i.project),this.reporting.setChangeId(t),this._redirectOrNavigate(i)}_handleCommentRoute(e){const t=Number(e.params[1]),i={project:e.params[0],changeNum:t,commentId:e.params[2],view:bs.DIFF,commentLink:!0};this.reporting.setRepoName(i.project),this.reporting.setChangeId(t),this._redirectOrNavigate(i)}_handleDiffRoute(e){const t=Number(e.params[1]),i={project:e.params[0],changeNum:t,basePatchNum:Vn(e.params[4]),patchNum:Vn(e.params[6]),path:e.params[8],view:bs.DIFF},n=this._parseLineAddress(e.hash);n&&(i.leftSide=n.leftSide,i.lineNum=n.lineNum),this.reporting.setRepoName(i.project),this.reporting.setChangeId(t),this._redirectOrNavigate(i)}_handleChangeLegacyRoute(e){const t={changeNum:Number(e.params[0]),basePatchNum:Vn(e.params[3]),patchNum:Vn(e.params[5]),view:bs.CHANGE,querystring:e.querystring};this._normalizeLegacyRouteParams(t)}_handleLegacyLinenum(e){this._redirect(e.path.replace(Ak,"#$1"))}_handleDiffLegacyRoute(e){const t={changeNum:Number(e.params[0]),basePatchNum:Vn(e.params[2]),patchNum:Vn(e.params[4]),path:e.params[5],view:bs.DIFF},i=this._parseLineAddress(e.hash);i&&(t.leftSide=i.leftSide,t.lineNum=i.lineNum),this._normalizeLegacyRouteParams(t)}_handleDiffEditRoute(e){const t=e.params[0],i=Number(e.params[1]);this._redirectOrNavigate({project:t,changeNum:i,patchNum:Vn(e.params[2]),path:e.params[3],lineNum:e.hash,view:bs.EDIT}),this.reporting.setRepoName(t),this.reporting.setChangeId(i)}_handleChangeEditRoute(e){const t=e.params[0],i=Number(e.params[1]);this._redirectOrNavigate({project:t,changeNum:i,patchNum:Vn(e.params[3]),view:bs.CHANGE,edit:!0}),this.reporting.setRepoName(t),this.reporting.setChangeId(i)}_redirectOrNavigate(e){this._normalizePatchRangeParams(e)?this._redirect(this._generateUrl(e)):this._setParams(e)}_handleAgreementsRoute(){this._redirect("/settings/#Agreements")}_handleNewAgreementsRoute(e){e.params.view=bs.AGREEMENTS,this._setParams(e.params)}_handleSettingsLegacyRoute(e){const t=e.params[0].replace(/ /g,"+");this._setParams({view:bs.SETTINGS,emailToken:t})}_handleSettingsRoute(e){this._setParams({view:bs.SETTINGS})}_handleRegisterRoute(e){this._setParams({justRegistered:!0});let t=e.params[0]||"/";t.startsWith("/register")&&(t="/"),"/"===t[0]&&this._redirect(k()+t)}_handlePassThroughRoute(){hu()}_handleImproperlyEncodedPlusRoute(e){let t=this._getHashFromCanonicalPath(e.canonicalPath);t.length&&(t="#"+t),this._redirect(`/c/${e.params[0]}/+/${e.params[1]}${t}`)}_handlePluginScreen(e){const t=bs.PLUGIN_SCREEN,i=e.params[0],n=e.params[1];this._setParams({view:t,plugin:i,screen:n})}_handleDocumentationSearchRoute(e){this._setParams({view:bs.DOCUMENTATION_SEARCH,filter:e.params.filter||null})}_handleDocumentationSearchRedirectRoute(e){this._redirect("/Documentation/q/filter:"+encodeURIComponent(e.params[0]))}_handleDocumentationRedirectRoute(e){e.params[1]?hu():this._redirect("/Documentation/index.html")}_handleDefaultRoute(){this._isInitialLoad?this._show404():this._handlePassThroughRoute()}_show404(){Si(new Response("",{status:404}))}};bk([Oo({type:Object})],kk.prototype,"_app",void 0),bk([Oo({type:Boolean})],kk.prototype,"_isRedirecting",void 0),bk([Oo({type:Boolean})],kk.prototype,"_isInitialLoad",void 0),kk=bk([Po("gr-router")],kk);const Pk=mi`
  <style include="shared-styles">
    :host {
      display: block;
      background-color: var(--view-background-color);
    }
    .hidden {
      display: none;
    }
    gr-patch-range-select {
      display: block;
    }
    gr-diff {
      border: none;
      --diff-container-styles: {
        border-bottom: 1px solid var(--border-color);
      }
    }
    .stickyHeader {
      background-color: var(--view-background-color);
      position: sticky;
      top: 0;
      /* TODO(dhruvsri): This is required only because of 'position:relative' in
         <gr-diff-highlight> (which could maybe be removed??). */
      z-index: 1;
      box-shadow: var(--elevation-level-1);
      /* This is just for giving the box-shadow some space. */
      margin-bottom: 2px;
    }
    header,
    .subHeader {
      align-items: center;
      display: flex;
      justify-content: space-between;
    }
    header {
      padding: var(--spacing-s) var(--spacing-xl);
      border-bottom: 1px solid var(--border-color);
    }
    .changeNumberColon {
      color: transparent;
    }
    .headerSubject {
      margin-right: var(--spacing-m);
      font-weight: var(--font-weight-bold);
    }
    .patchRangeLeft {
      align-items: center;
      display: flex;
    }
    .navLink:not([href]) {
      color: var(--deemphasized-text-color);
    }
    .navLinks {
      align-items: center;
      display: flex;
      white-space: nowrap;
    }
    .navLink {
      padding: 0 var(--spacing-xs);
    }
    .reviewed {
      display: inline-block;
      margin: 0 var(--spacing-xs);
      vertical-align: top;
      position: relative;
      top: 8px;
    }
    .jumpToFileContainer {
      display: inline-block;
    }
    .mobile {
      display: none;
    }
    gr-button {
      padding: var(--spacing-s) 0;
      text-decoration: none;
    }
    .loading {
      color: var(--deemphasized-text-color);
      font-family: var(--header-font-family);
      font-size: var(--font-size-h1);
      font-weight: var(--font-weight-h1);
      line-height: var(--line-height-h1);
      height: 100%;
      padding: var(--spacing-l);
      text-align: center;
    }
    .subHeader {
      background-color: var(--background-color-secondary);
      flex-wrap: wrap;
      padding: 0 var(--spacing-l);
    }
    .prefsButton {
      text-align: right;
    }
    .noOverflow {
      display: block;
      overflow: auto;
    }
    .editMode .hideOnEdit {
      display: none;
    }
    .blameLoader,
    .fileNum {
      display: none;
    }
    .blameLoader.show,
    .fileNum.show,
    .download,
    .preferences,
    .rightControls {
      align-items: center;
      display: flex;
    }
    .diffModeSelector,
    .editButton {
      align-items: center;
      display: flex;
    }
    .diffModeSelector span,
    .editButton span {
      margin-right: var(--spacing-xs);
    }
    .diffModeSelector.hide,
    .separator.hide {
      display: none;
    }
    gr-dropdown-list {
      --trigger-style: {
        text-transform: none;
      }
    }
    .editButtona a {
      text-decoration: none;
    }
    @media screen and (max-width: 50em) {
      header {
        padding: var(--spacing-s) var(--spacing-l);
      }
      .dash {
        display: none;
      }
      .desktop {
        display: none;
      }
      .fileNav {
        align-items: flex-start;
        display: flex;
        margin: 0 var(--spacing-xs);
      }
      .fullFileName {
        display: block;
        font-style: italic;
        min-width: 50%;
        padding: 0 var(--spacing-xxs);
        text-align: center;
        width: 100%;
        word-wrap: break-word;
      }
      .reviewed {
        vertical-align: -1px;
      }
      .mobileNavLink {
        color: var(--primary-text-color);
        font-family: var(--header-font-family);
        font-size: var(--font-size-h2);
        font-weight: var(--font-weight-h2);
        line-height: var(--line-height-h2);
        text-decoration: none;
      }
      .mobileNavLink:not([href]) {
        color: var(--deemphasized-text-color);
      }
      .jumpToFileContainer {
        display: block;
        width: 100%;
      }
      gr-dropdown-list {
        width: 100%;
        --gr-select-style: {
          display: block;
          width: 100%;
        }
        --native-select-style: {
          width: 100%;
        }
      }
    }
    :host(.hideComments) {
      --gr-comment-thread-display: none;
    }
  </style>
  <div class$="stickyHeader [[_computeContainerClass(_editMode)]]">
    <h1 class="assistive-tech-only">
      Diff of [[_computeTruncatedPath(_path)]]
    </h1>
    <header>
      <div>
        <a
          href$="[[_computeChangePath(_change, _patchRange.*, _change.revisions)]]"
          >[[_changeNum]]</a
        ><!--
       --><span class="changeNumberColon">:</span>
        <span class="headerSubject">[[_change.subject]]</span>
        <input
          id="reviewed"
          class="reviewed hideOnEdit"
          type="checkbox"
          on-change="_handleReviewedChange"
          hidden$="[[!_loggedIn]]"
          hidden=""
          title="Toggle reviewed status of file"
          aria-label="file reviewed"
        /><!--
       -->
        <div class="jumpToFileContainer">
          <gr-dropdown-list
            id="dropdown"
            value="[[_path]]"
            on-value-change="_handleFileChange"
            items="[[_formattedFiles]]"
            initial-count="75"
            show-copy-for-trigger-text
          >
          </gr-dropdown-list>
        </div>
      </div>
      <div class="navLinks desktop">
        <span
          class$="fileNum [[_computeFileNumClass(_fileNum, _formattedFiles)]]"
        >
          File [[_fileNum]] of [[_formattedFiles.length]]
          <span class="separator"></span>
        </span>
        <a
          class="navLink"
          title="[[createTitle(Shortcut.PREV_FILE,
                    ShortcutSection.NAVIGATION)]]"
          href$="[[_computeNavLinkURL(_change, _path, _fileList, -1)]]"
        >
          Prev</a
        >
        <span class="separator"></span>
        <a
          class="navLink"
          title="[[createTitle(Shortcut.UP_TO_CHANGE,
                ShortcutSection.NAVIGATION)]]"
          href$="[[_computeChangePath(_change, _patchRange.*, _change.revisions)]]"
        >
          Up</a
        >
        <span class="separator"></span>
        <a
          class="navLink"
          title="[[createTitle(Shortcut.NEXT_FILE,
                ShortcutSection.NAVIGATION)]]"
          href$="[[_computeNavLinkURL(_change, _path, _fileList, 1)]]"
        >
          Next</a
        >
      </div>
    </header>
    <div class="subHeader">
      <div class="patchRangeLeft">
        <gr-patch-range-select
          id="rangeSelect"
          change-num="[[_changeNum]]"
          change-comments="[[_changeComments]]"
          patch-num="[[_patchRange.patchNum]]"
          base-patch-num="[[_patchRange.basePatchNum]]"
          files-weblinks="[[_filesWeblinks]]"
          available-patches="[[_allPatchSets]]"
          revisions="[[_change.revisions]]"
          revision-info="[[_revisionInfo]]"
          on-patch-range-change="_handlePatchChange"
        >
        </gr-patch-range-select>
        <span class="download desktop">
          <span class="separator"></span>
          <gr-dropdown
            link=""
            down-arrow=""
            items="[[_computeDownloadDropdownLinks(_change.project, _changeNum, _patchRange, _path, _diff)]]"
            horizontal-align="left"
          >
            <span class="downloadTitle"> Download </span>
          </gr-dropdown>
        </span>
      </div>
      <div class="rightControls">
        <span
          class$="blameLoader [[_computeBlameLoaderClass(_isImageDiff, _path)]]"
        >
          <gr-button
            link=""
            id="toggleBlame"
            title="[[createTitle(Shortcut.TOGGLE_BLAME, ShortcutSection.DIFFS)]]"
            disabled="[[_isBlameLoading]]"
            on-click="_toggleBlame"
            >[[_computeBlameToggleLabel(_isBlameLoaded,
            _isBlameLoading)]]</gr-button
          >
        </span>
        <template is="dom-if" if="[[_computeCanEdit(_loggedIn, _change.*)]]">
          <span class="separator"></span>
          <span class="editButton">
            <gr-button
              link=""
              title="Edit current file"
              on-click="_goToEditFile"
              >edit</gr-button
            >
          </span>
        </template>
        <span class="separator"></span>
        <div class$="diffModeSelector [[_computeModeSelectHideClass(_diff)]]">
          <span>Diff view:</span>
          <gr-diff-mode-selector
            id="modeSelect"
            save-on-change="[[!_diffPrefsDisabled]]"
            mode="{{changeViewState.diffMode}}"
          ></gr-diff-mode-selector>
        </div>
        <span
          id="diffPrefsContainer"
          hidden$="[[_computePrefsButtonHidden(_prefs, _diffPrefsDisabled)]]"
          hidden=""
        >
          <span class="preferences desktop">
            <gr-button
              link=""
              class="prefsButton"
              has-tooltip=""
              title="Diff preferences"
              on-click="_handlePrefsTap"
              ><iron-icon icon="gr-icons:settings"></iron-icon
            ></gr-button>
          </span>
        </span>
        <gr-endpoint-decorator name="annotation-toggler">
          <span hidden="" id="annotation-span">
            <label for="annotation-checkbox" id="annotation-label"></label>
            <iron-input type="checkbox" disabled="">
              <input
                is="iron-input"
                type="checkbox"
                id="annotation-checkbox"
                disabled=""
              />
            </iron-input>
          </span>
        </gr-endpoint-decorator>
      </div>
    </div>
    <div class="fileNav mobile">
      <a
        class="mobileNavLink"
        href$="[[_computeNavLinkURL(_change, _path, _fileList, -1)]]"
      >
        &lt;</a
      >
      <div class="fullFileName mobile">[[_computeDisplayPath(_path)]]</div>
      <a
        class="mobileNavLink"
        href$="[[_computeNavLinkURL(_change, _path, _fileList, 1)]]"
      >
        &gt;</a
      >
    </div>
  </div>
  <div class="loading" hidden$="[[!_loading]]">Loading...</div>
  <h2 class="assistive-tech-only">Diff view</h2>
  <gr-diff-host
    id="diffHost"
    hidden=""
    hidden$="[[_loading]]"
    is-image-diff="{{_isImageDiff}}"
    files-weblinks="{{_filesWeblinks}}"
    diff="{{_diff}}"
    change-num="[[_changeNum]]"
    change="[[_change]]"
    commit-range="[[_commitRange]]"
    patch-range="[[_patchRange]]"
    file="[[_file]]"
    path="[[_path]]"
    prefs="[[_prefs]]"
    project-name="[[_change.project]]"
    view-mode="[[_diffMode]]"
    is-blame-loaded="{{_isBlameLoaded}}"
    on-comment-anchor-tap="_onLineSelected"
    on-line-selected="_onLineSelected"
  >
  </gr-diff-host>
  <gr-apply-fix-dialog
    id="applyFixDialog"
    prefs="[[_prefs]]"
    change="[[_change]]"
    change-num="[[_changeNum]]"
  >
  </gr-apply-fix-dialog>
  <gr-diff-preferences-dialog
    id="diffPreferencesDialog"
    diff-prefs="{{_prefs}}"
    on-reload-diff-preference="_handleReloadingDiffPreference"
  >
  </gr-diff-preferences-dialog>
  <gr-diff-cursor
    id="cursor"
    on-navigate-to-next-unreviewed-file="_navigateToNextUnreviewedFile"
    on-navigate-to-previous-unreviewed-file="_navigateToPreviousUnreviewedFile"
    on-navigate-to-next-file-with-comments="_navigateToNextFileWithCommentThread"
  ></gr-diff-cursor>
  <gr-comment-api id="commentAPI"></gr-comment-api>
`;var Ik=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Ok=class extends(Kf(fi)){constructor(){super(...arguments),this.keyEventTarget=document.body,this.changeViewState={},this.disableDiffPrefs=!1,this._files={sortedFileList:[],changeFilesByPath:{}},this._loggedIn=!1,this._loading=!0,this._isBlameLoading=!1,this._allPatchSets=[],this._reviewedFiles=new Set,this.reporting=i.reportingService,this.flagsService=i.flagsService,this.restApiService=i.restApiService}static get template(){return Pk}get keyBindings(){return{esc:"_handleEscKey"}}keyboardShortcuts(){return{[Hf.LEFT_PANE]:"_handleLeftPane",[Hf.RIGHT_PANE]:"_handleRightPane",[Hf.NEXT_LINE]:"_handleNextLineOrFileWithComments",[Hf.PREV_LINE]:"_handlePrevLineOrFileWithComments",[Hf.VISIBLE_LINE]:"_handleVisibleLine",[Hf.NEXT_FILE_WITH_COMMENTS]:"_handleNextLineOrFileWithComments",[Hf.PREV_FILE_WITH_COMMENTS]:"_handlePrevLineOrFileWithComments",[Hf.NEW_COMMENT]:"_handleNewComment",[Hf.SAVE_COMMENT]:null,[Hf.NEXT_FILE]:"_handleNextFile",[Hf.PREV_FILE]:"_handlePrevFile",[Hf.NEXT_CHUNK]:"_handleNextChunkOrCommentThread",[Hf.NEXT_COMMENT_THREAD]:"_handleNextChunkOrCommentThread",[Hf.PREV_CHUNK]:"_handlePrevChunkOrCommentThread",[Hf.PREV_COMMENT_THREAD]:"_handlePrevChunkOrCommentThread",[Hf.OPEN_REPLY_DIALOG]:"_handleOpenReplyDialog",[Hf.TOGGLE_LEFT_PANE]:"_handleToggleLeftPane",[Hf.OPEN_DOWNLOAD_DIALOG]:"_handleOpenDownloadDialog",[Hf.UP_TO_CHANGE]:"_handleUpToChange",[Hf.OPEN_DIFF_PREFS]:"_handleCommaKey",[Hf.TOGGLE_DIFF_MODE]:"_handleToggleDiffMode",[Hf.TOGGLE_FILE_REVIEWED]:"_throttledToggleFileReviewed",[Hf.TOGGLE_ALL_DIFF_CONTEXT]:"_handleToggleAllDiffContext",[Hf.NEXT_UNREVIEWED_FILE]:"_handleNextUnreviewedFile",[Hf.TOGGLE_BLAME]:"_handleToggleBlame",[Hf.TOGGLE_HIDE_ALL_COMMENT_THREADS]:"_handleToggleHideAllCommentThreads",[Hf.OPEN_FILE_LIST]:"_handleOpenFileList",[Hf.DIFF_AGAINST_BASE]:"_handleDiffAgainstBase",[Hf.DIFF_AGAINST_LATEST]:"_handleDiffAgainstLatest",[Hf.DIFF_BASE_AGAINST_LEFT]:"_handleDiffBaseAgainstLeft",[Hf.DIFF_RIGHT_AGAINST_LATEST]:"_handleDiffRightAgainstLatest",[Hf.DIFF_BASE_AGAINST_LATEST]:"_handleDiffBaseAgainstLatest",[Hf.EXPAND_ALL_COMMENT_THREADS]:null,[Hf.COLLAPSE_ALL_COMMENT_THREADS]:null}}connectedCallback(){super.connectedCallback(),this._throttledToggleFileReviewed=this._throttleWrap(e=>this._handleToggleFileReviewed(e)),this._getLoggedIn().then(e=>{this._loggedIn=e}),this.addEventListener("open-fix-preview",e=>this._onOpenFixPreview(e)),this.$.cursor.push("diffs",this.$.diffHost),this._onRenderHandler=e=>{this.$.cursor.reInitCursor()},this.$.diffHost.addEventListener("render",this._onRenderHandler)}disconnectedCallback(){this._onRenderHandler&&this.$.diffHost.removeEventListener("render",this._onRenderHandler),super.disconnectedCallback()}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getProjectConfig(e){if(e)return this.restApiService.getProjectConfig(e).then(e=>{this._projectConfig=e})}_getChangeDetail(e){return this.restApiService.getDiffChangeDetail(e).then(e=>{if(!e)throw new Error('Missing "change" in API response.');return this._change=e,e})}_getChangeEdit(){return a(this._changeNum,"_changeNum"),this.restApiService.getChangeEdit(this._changeNum)}_getSortedFileList(e){return e?e.sortedFileList:[]}_getCurrentFile(e,t){if(!e||!t)return;const i=e.changeFilesByPath[t],n={path:t};return i&&i.old_path&&(n.basePath=i.old_path),n}_getFiles(e,t,i){if([e,t,t.base,i].some(e=>void 0===e))return Promise.resolve();if(!t.base.patchNum)return Promise.resolve();const n=t.base;return this.restApiService.getChangeFiles(e,n).then(e=>{if(!e)return;const t=i.getPaths(n),o={...e};Wb(o,t),this._files={sortedFileList:Object.keys(o).sort(Vb),changeFilesByPath:o}})}_getDiffPreferences(){return this.restApiService.getDiffPreferences().then(e=>{this._prefs=e})}_getPreferences(){return this.restApiService.getPreferences()}_getWindowWidth(){return window.innerWidth}_handleReviewedChange(e){this._setReviewed(Th(e).rootTarget.checked)}_setReviewed(e){var t;this._editMode||(this.$.reviewed.checked=e,(null===(t=this._patchRange)||void 0===t?void 0:t.patchNum)&&this._saveReviewedState(e).catch(e=>{throw Ci(this,"Couldnt change file review status."),e}))}_saveReviewedState(e){var t,i;return this._changeNum&&(null===(t=this._patchRange)||void 0===t?void 0:t.patchNum)&&this._path?this.restApiService.saveFileReviewed(this._changeNum,null===(i=this._patchRange)||void 0===i?void 0:i.patchNum,this._path,e):Promise.resolve(void 0)}_handleToggleFileReviewed(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._setReviewed(!this.$.reviewed.checked))}_handleEscKey(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.$.diffHost.displayLine=!1)}_handleLeftPane(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this.$.cursor.moveLeft())}_handleRightPane(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this.$.cursor.moveRight())}_handlePrevLineOrFileWithComments(e){var t,i;this.shouldSuppressKeyboardShortcut(e)||(null!==(t=e.detail.keyboardEvent)&&void 0!==t&&t.shiftKey&&75===(null===(i=e.detail.keyboardEvent)||void 0===i?void 0:i.keyCode)?this._moveToPreviousFileWithComment():this.modifierPressed(e)||(e.preventDefault(),this.$.diffHost.displayLine=!0,this.$.cursor.moveUp()))}_handleVisibleLine(e){this.shouldSuppressKeyboardShortcut(e)||(e.preventDefault(),this.$.cursor.moveToVisibleArea())}_onOpenFixPreview(e){this.$.applyFixDialog.open(e)}_handleNextLineOrFileWithComments(e){var t,i;this.shouldSuppressKeyboardShortcut(e)||(null!==(t=e.detail.keyboardEvent)&&void 0!==t&&t.shiftKey&&74===(null===(i=e.detail.keyboardEvent)||void 0===i?void 0:i.keyCode)?this._moveToNextFileWithComment():this.modifierPressed(e)||(e.preventDefault(),this.$.diffHost.displayLine=!0,this.$.cursor.moveDown()))}_moveToPreviousFileWithComment(){var e;this._commentSkips&&this._change&&(null===(e=this._patchRange)||void 0===e?void 0:e.patchNum)&&(this._commentSkips.previous?Qm.navigateToDiff(this._change,this._commentSkips.previous,this._patchRange.patchNum,this._patchRange.basePatchNum):this._navToChangeView())}_moveToNextFileWithComment(){var e;this._commentSkips&&this._change&&(null===(e=this._patchRange)||void 0===e?void 0:e.patchNum)&&(this._commentSkips.next?Qm.navigateToDiff(this._change,this._commentSkips.next,this._patchRange.patchNum,this._patchRange.basePatchNum):this._navToChangeView())}_handleNewComment(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this.classList.remove("hideComments"),this.$.cursor.createCommentInPlace())}_handlePrevFile(e){this.shouldSuppressKeyboardShortcut(e)||this.getKeyboardEvent(e).metaKey||this._path&&this._fileList&&(e.preventDefault(),this._navToFile(this._path,this._fileList,-1))}_handleNextFile(e){this.shouldSuppressKeyboardShortcut(e)||this.getKeyboardEvent(e).metaKey||this._path&&this._fileList&&(e.preventDefault(),this._navToFile(this._path,this._fileList,1))}_handleNextChunkOrCommentThread(e){var t,i;if(!this.shouldSuppressKeyboardShortcut(e))if(e.preventDefault(),null===(t=e.detail.keyboardEvent)||void 0===t?void 0:t.shiftKey)this.$.cursor.moveToNextCommentThread();else{if(this.modifierPressed(e))return;this.$.cursor.moveToNextChunk(!1,!(null===(i=e.detail.keyboardEvent)||void 0===i?void 0:i.repeat))}}_handlePrevChunkOrCommentThread(e){var t,i;if(!this.shouldSuppressKeyboardShortcut(e))if(e.preventDefault(),null===(t=e.detail.keyboardEvent)||void 0===t?void 0:t.shiftKey)this.$.cursor.moveToPreviousCommentThread();else{if(this.modifierPressed(e))return;this.$.cursor.moveToPreviousChunk(!(null===(i=e.detail.keyboardEvent)||void 0===i?void 0:i.repeat))}}_handleOpenReplyDialog(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this._getLoggedIn().then(t=>{t?(this.set("changeViewState.showReplyDialog",!0),e.preventDefault(),this._navToChangeView()):bi(this,"show-auth-required")})}_handleToggleLeftPane(e){var t;this.shouldSuppressKeyboardShortcut(e)||(null===(t=e.detail.keyboardEvent)||void 0===t?void 0:t.shiftKey)&&(e.preventDefault(),this.$.diffHost.toggleLeftDiff())}_handleOpenDownloadDialog(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(this.set("changeViewState.showDownloadDialog",!0),e.preventDefault(),this._navToChangeView())}_handleUpToChange(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._navToChangeView())}_handleCommaKey(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this._diffPrefsDisabled||(e.preventDefault(),this.$.diffPreferencesDialog.open())}_handleToggleDiffMode(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||(e.preventDefault(),this._getDiffViewMode()===Gi.SIDE_BY_SIDE?this.$.modeSelect.setMode(Gi.UNIFIED):this.$.modeSelect.setMode(Gi.SIDE_BY_SIDE))}_navToChangeView(){var e;this._changeNum&&(null===(e=this._patchRange)||void 0===e?void 0:e.patchNum)&&this._navigateToChange(this._change,this._patchRange,this._change&&this._change.revisions)}_navToFile(e,t,i,n){var o,r;const s=this._getNavLinkPath(e,t,i);if(!s)return;if(!this._change)return;if(!this._patchRange)return;if(s.up)return void this._navigateToChange(this._change,this._patchRange,this._change&&this._change.revisions);if(!s.path)return;let a;n&&(a=null===(r=null===(o=this._changeComments)||void 0===o?void 0:o.getCommentsForPath(s.path,this._patchRange))||void 0===r?void 0:r[0].line),Qm.navigateToDiff(this._change,s.path,this._patchRange.patchNum,this._patchRange.basePatchNum,a)}_computeNavLinkURL(e,t,i,n){if(!e)return null;if(!t)return null;if(!i)return null;if(!n)return null;const o=this._getNavLinkPath(t,i,n);return o?o.up?this._getChangePath(this._change,this._patchRange,this._change&&this._change.revisions):this._getDiffUrl(this._change,this._patchRange,o.path):null}_goToEditFile(){if(!this._change)return;if(!this._path)return;if(!this._patchRange)return;const e=this.$.cursor.getAddress(),t=Qm.getEditUrlForDiff(this._change,this._path,this._patchRange.patchNum,null==e?void 0:e.number);Qm.navigateToRelativeUrl(t)}_getNavLinkPath(e,t,i){if(!e||!t||0===t.length)return null;let n=t.indexOf(e);if(-1===n){return{path:i>0?t[0]:t[t.length-1]}}return n+=i,n<0||n>t.length-1?{up:!0}:{path:t[n]}}_getReviewedFiles(e,t){return e&&t?this.restApiService.getReviewedFiles(e,t).then(e=>(this._reviewedFiles=new Set(e),this._reviewedFiles)):Promise.resolve(new Set)}_getReviewedStatus(e,t,i,n){return e||!n?Promise.resolve(!1):this._getReviewedFiles(t,i).then(e=>e.has(n))}_initLineOfInterestAndCursor(e){this.$.diffHost.lineOfInterest=this._getLineOfInterest(e),this._initCursor(e)}_displayDiffBaseAgainstLeftToast(){this._patchRange&&Ci(this,`Patchset ${this._patchRange.basePatchNum} vs `+`${this._patchRange.patchNum} selected. Press v +  to view `+`Base vs ${this._patchRange.basePatchNum}`)}_displayDiffAgainstLatestToast(e){if(!this._patchRange)return;const t="PARENT"===this._patchRange.basePatchNum?"Base":`Patchset ${this._patchRange.basePatchNum}`;Ci(this,`${t} vs\n            ${this._patchRange.patchNum} selected\n. Press v +  to view\n            ${t} vs Patchset ${e}`)}_displayToasts(){if(!this._patchRange)return;if("PARENT"!==this._patchRange.basePatchNum)return void this._displayDiffBaseAgainstLeftToast();const e=Jn(this._allPatchSets);this._patchRange.patchNum===e||this._displayDiffAgainstLatestToast(e)}_initCommitRange(){var e;let t,i;if(!this._change)return;if(!this._patchRange||!this._patchRange.patchNum)return;const n=null!==(e=this._change.revisions)&&void 0!==e?e:{};for(const[e,o]of Object.entries(n)){const n=o._number;if(n===this._patchRange.patchNum){t=e;const n=o.commit,r=(null==n?void 0:n.parents)||[];"PARENT"===this._patchRange.basePatchNum&&r.length&&(i=r[r.length-1].commit)}else n===this._patchRange.basePatchNum&&(i=e)}this._commitRange=t&&i?{commit:t,baseCommit:i}:void 0}_updateUrlToDiffUrl(e,t){if(!this._change)return;if(!this._patchRange)return;if(!this._changeNum)return;if(!this._path)return;const i=Qm.getUrlForDiffById(this._changeNum,this._change.project,this._path,this._patchRange.patchNum,this._patchRange.basePatchNum,e,t);history.replaceState(null,"",i)}_initPatchRange(){var e,t,i,n;let o=!1;if(this._change&&(null===(e=this.params)||void 0===e?void 0:e.view)===bs.DIFF){if(null===(t=this.params)||void 0===t?void 0:t.commentId){const e=null===(i=this._changeComments)||void 0===i?void 0:i.findCommentById(this.params.commentId);if(!e)return Ci(this,"comment not found"),void Qm.navigateToChange(this._change);this._path=e.path;const t=Jn(this._allPatchSets);if(!t)throw new Error("Missing _allPatchSets");this._patchRange=function(e,t){if(!e.patch_set)throw new Error("Missing comment.patch_set");if(e.side===fn.PARENT){if("PARENT"===e.patch_set)throw new Error("diffSide cannot be PARENT");return{patchNum:e.patch_set,basePatchNum:"PARENT"}}return t===e.patch_set?{patchNum:t,basePatchNum:"PARENT"}:{patchNum:t,basePatchNum:e.patch_set}}(e,t),o=Qw(e,this._patchRange),this._focusLineNum=e.line}else this.params.path&&(this._path=this.params.path),this.params.patchNum&&(this._patchRange={patchNum:this.params.patchNum,basePatchNum:this.params.basePatchNum||"PARENT"}),this.params.lineNum&&(this._focusLineNum=this.params.lineNum,o=!!this.params.leftSide);a(this._patchRange,"_patchRange"),this._initLineOfInterestAndCursor(o),(null===(n=this.params)||void 0===n?void 0:n.commentId)&&this._updateUrlToDiffUrl(this._focusLineNum,o),this._commentMap=this._getPaths(this._patchRange)}}_isFileUnchanged(e){return!(!e||!e.content)&&!e.content.some(e=>e.a&&!e.common||e.b&&!e.common)}_paramsChanged(e){if(e.view!==bs.DIFF)return;if(this._change=void 0,this._files={sortedFileList:[],changeFilesByPath:{}},this._path=void 0,this._patchRange=void 0,this._commitRange=void 0,this._changeComments=void 0,this._focusLineNum=void 0,e.changeNum&&e.project&&this.restApiService.setInProjectLookup(e.changeNum,e.project),this._changeNum=e.changeNum,this.classList.remove("hideComments"),!e.patchNum&&!e.commentLink)return void console.warn("invalid url, no patchNum found");const t=[];return t.push(this._getDiffPreferences()),t.push(this._getPreferences().then(e=>{this._userPrefs=e})),t.push(this._getChangeDetail(this._changeNum)),t.push(this._loadComments(e.patchNum)),t.push(this._getChangeEdit()),this.$.diffHost.cancel(),this.$.diffHost.clearDiffContent(),this._loading=!0,Promise.all(t).then(e=>{if(this._loading=!1,this._initPatchRange(),this._initCommitRange(),a(this._path,"_path"),!this._changeComments)throw new Error("change comments must be defined");a(this._patchRange,"_patchRange"),this.$.diffHost.threads=this._changeComments.getThreadsBySideForFile({path:this._path},this._patchRange);const t=e[4];return t&&this.set(`_change.revisions.${t.commit.commit}`,{_number:"edit",basePatchNum:t.base_patch_set_number,commit:t.commit}),this.$.diffHost.reload(!0)}).then(()=>{this.reporting.diffViewFullyLoaded(),this.reporting.diffViewDisplayed()}).then(()=>{if(!this._diff)throw new Error("Missing this._diff");if(this._isFileUnchanged(this._diff)&&e.commentLink){if(a(this._change,"_change"),a(this._path,"_path"),a(this._patchRange,"_patchRange"),"PARENT"===this._patchRange.basePatchNum)return;return Ci(this,`File is unchanged between Patchset\n                  ${this._patchRange.basePatchNum} and\n                  ${this._patchRange.patchNum}. Showing diff of Base vs\n                  ${this._patchRange.basePatchNum}`),void Qm.navigateToDiff(this._change,this._path,this._patchRange.basePatchNum,"PARENT",this._focusLineNum)}e.commentLink&&this._displayToasts(),this._isBlameLoaded&&this._loadBlame()})}_changeViewStateChanged(e){null===e.diffMode&&this.restApiService.getPreferences().then(e=>{e&&this.set("changeViewState.diffMode",e.default_diff_view)})}_setReviewedObserver(e,t,i,n){var o;if(void 0===e)return;if(void 0===t)return;if(void 0===i)return;if(void 0===n)return;if(void 0===n.base)return;const r=n.base;e&&(i.manual_review?r.patchNum&&this._getReviewedStatus(this._editMode,this._changeNum,r.patchNum,this._path).then(e=>{this.$.reviewed.checked=e}):(null===(o=t.base)||void 0===o?void 0:o.view)===Qm.View.DIFF&&this._setReviewed(!0))}_initCursor(e){void 0!==this._focusLineNum&&(this.$.cursor.side=e?zi.LEFT:zi.RIGHT,this.$.cursor.initialLineNumber=this._focusLineNum)}_getLineOfInterest(e){if(this._focusLineNum)return{number:this._focusLineNum,leftSide:e}}_pathChanged(e){e&&xi(this,Yb(e)),this._fileList&&0!==this._fileList.length&&this.set("changeViewState.selectedFileIndex",this._fileList.indexOf(e))}_getDiffUrl(e,t,i){return e&&t&&i?Qm.getUrlForDiff(e,i,t.patchNum,t.basePatchNum):""}_patchRangeStr(e){let t=`${e.patchNum}`;return e.basePatchNum&&"PARENT"!==e.basePatchNum&&(t=`${e.basePatchNum}..${e.patchNum}`),t}_getChangeUrlRange(e,t){let i=void 0,n=void 0,o=-1;for(const e of Object.values(t||{}))"number"==typeof e._number&&(o=Math.max(o,e._number));return e?("PARENT"===e.basePatchNum&&e.patchNum===o||(i=e.patchNum,n=e.basePatchNum),{patchNum:i,basePatchNum:n}):{patchNum:i,basePatchNum:n}}_getChangePath(e,t,i){if(!e)return"";if(!t)return"";const n=this._getChangeUrlRange(t,i);return Qm.getUrlForChange(e,n.patchNum,n.basePatchNum)}_navigateToChange(e,t,i){if(!e)return;const n=this._getChangeUrlRange(t,i);Qm.navigateToChange(e,n.patchNum,n.basePatchNum)}_computeChangePath(e,t,i){return t?this._getChangePath(e,t.base,i):""}_formatFilesForDropdown(e,t,i){if(!e)return[];if(!t)return[];if(!i)return[];const n=[];for(const o of e.sortedFileList)n.push({text:qb(o),mobileText:Yb(o),value:o,bottomText:i.computeCommentsString(t,o,e.changeFilesByPath[o],!0),file:{...e.changeFilesByPath[o],__path:o}});return n}_computePrefsButtonHidden(e,t){return t||!e}_handleFileChange(e){if(!this._change)return;if(!this._patchRange)return;const t=e.detail.value;t!==this._path&&Qm.navigateToDiff(this._change,t,this._patchRange.patchNum,this._patchRange.basePatchNum)}_handlePatchChange(e){if(!this._change)return;if(!this._path)return;if(!this._patchRange)return;const{basePatchNum:t,patchNum:i}=e.detail;t===this._patchRange.basePatchNum&&i===this._patchRange.patchNum||Qm.navigateToDiff(this._change,this._path,i,t)}_handlePrefsTap(e){e.preventDefault(),this.$.diffPreferencesDialog.open()}_getDiffViewMode(){return this.changeViewState.diffMode?this.changeViewState.diffMode:this._userPrefs?(this.set("changeViewState.diffMode",this._userPrefs.default_diff_view),this._userPrefs.default_diff_view):"SIDE_BY_SIDE"}_computeModeSelectHideClass(e){return!e||e.binary?"hide":""}_onLineSelected(e,t){this._updateUrlToDiffUrl(t.number,t.side===zi.LEFT||t.side===fn.PARENT)}_computeDownloadDropdownLinks(e,t,i,n,o){if(!e)return[];if(!t)return[];if(!i||!i.patchNum)return[];if(!n)return[];const r=[{url:this._computeDownloadPatchLink(e,t,i,n),name:"Patch"}];if(o&&o.meta_a){let s=n;"RENAMED"===o.change_type&&(s=o.meta_a.name),r.push({url:this._computeDownloadFileLink(e,t,i,s,!0),name:"Left Content"})}return o&&o.meta_b&&r.push({url:this._computeDownloadFileLink(e,t,i,n,!1),name:"Right Content"}),r}_computeDownloadFileLink(e,t,i,n,o){let r=i.patchNum;const s="PARENT"===i.basePatchNum;o&&!s&&(r=i.basePatchNum);let a=yo(e,t,r)+`/files/${encodeURIComponent(n)}/download`;return o&&s&&(a+="?parent=1"),a}_computeDownloadPatchLink(e,t,i,n){let o=yo(e,t,i.patchNum);return o+="/patch?zip&path="+encodeURIComponent(n),o}_loadComments(e){return a(this._changeNum,"_changeNum"),this.$.commentAPI.loadAll(this._changeNum,e).then(e=>{this._changeComments=e})}_recomputeComments(e,t,i,n){if(!e)return;if(!t)return;if(!i)return;if(!n)return;if(!this._changeComments)return;const o=e[t];o&&o.old_path&&(this.$.diffHost.threads=this._changeComments.getThreadsBySideForFile({path:t,basePath:o.old_path},i))}_getPaths(e){return this._changeComments?this._changeComments.getPaths(e):{}}_getDiffDrafts(){return a(this._changeNum,"_changeNum"),this.restApiService.getDiffDrafts(this._changeNum)}_computeCommentSkips(e,t,i){if(!e)return;if(!t)return;if(!i)return;const n={previous:null,next:null};if(!t.length)return n;const o=t.indexOf(i);for(let i=o-1;i>=0;i--)if(e[t[i]]){n.previous=t[i];break}for(let i=o+1;i<t.length;i++)if(e[t[i]]){n.next=t[i];break}return n}_computeContainerClass(e){return e?"editMode":""}_computeEditMode(e){return"edit"===(e.base||{}).patchNum}_computeBlameToggleLabel(e,t){return e&&!t?"Hide blame":"Show blame"}_loadBlame(){this._isBlameLoading=!0,Ci(this,"Loading blame..."),this.$.diffHost.loadBlame().then(()=>{this._isBlameLoading=!1,Ci(this,"Blame loaded")}).catch(()=>{this._isBlameLoading=!1})}_toggleBlame(){this._isBlameLoaded?this.$.diffHost.clearBlame():this._loadBlame()}_handleToggleBlame(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this._toggleBlame()}_handleToggleHideAllCommentThreads(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||vu(this,"hideComments")}_handleOpenFileList(e){this.shouldSuppressKeyboardShortcut(e)||this.modifierPressed(e)||this.$.dropdown.open()}_handleDiffAgainstBase(e){this.shouldSuppressKeyboardShortcut(e)||this._change&&this._path&&this._patchRange&&("PARENT"!==this._patchRange.basePatchNum?Qm.navigateToDiff(this._change,this._path,this._patchRange.patchNum):Ci(this,"Base is already selected."))}_handleDiffBaseAgainstLeft(e){var t,i;this.shouldSuppressKeyboardShortcut(e)||this._change&&this._path&&this._patchRange&&("PARENT"!==this._patchRange.basePatchNum?Qm.navigateToDiff(this._change,this._path,this._patchRange.basePatchNum,"PARENT",(null===(t=this.params)||void 0===t?void 0:t.view)===bs.DIFF&&(null===(i=this.params)||void 0===i?void 0:i.commentLink)?this._focusLineNum:void 0):Ci(this,"Left is already base."))}_handleDiffAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;if(!this._change)return;if(!this._path)return;if(!this._patchRange)return;const t=Jn(this._allPatchSets);this._patchRange.patchNum!==t?Qm.navigateToDiff(this._change,this._path,t,this._patchRange.basePatchNum):Ci(this,"Latest is already selected.")}_handleDiffRightAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;if(!this._change)return;if(!this._path)return;if(!this._patchRange)return;const t=Jn(this._allPatchSets);this._patchRange.patchNum!==t?Qm.navigateToDiff(this._change,this._path,t,this._patchRange.patchNum):Ci(this,"Right is already latest.")}_handleDiffBaseAgainstLatest(e){if(this.shouldSuppressKeyboardShortcut(e))return;if(!this._change)return;if(!this._path)return;if(!this._patchRange)return;const t=Jn(this._allPatchSets);this._patchRange.patchNum!==t||"PARENT"!==this._patchRange.basePatchNum?Qm.navigateToDiff(this._change,this._path,t):Ci(this,"Already diffing base against latest.")}_computeBlameLoaderClass(e,t){return Kb(t)||e?"":"show"}_getRevisionInfo(e){return new lT(e)}_computeFileNum(e,t){if(e&&t)return t.findIndex(({value:t})=>t===e)+1}_computeFileNumClass(e,t){return t&&e&&e>0?"show":""}_handleToggleAllDiffContext(e){this.shouldSuppressKeyboardShortcut(e)||this.$.diffHost.toggleAllContext()}_computeDiffPrefsDisabled(e,t){return e||!t}_navigateToNextUnreviewedFile(){if(!this._path)return;if(!this._fileList)return;if(!this._reviewedFiles)return;const e=this._fileList.filter(e=>e===this._path||!this._reviewedFiles.has(e));this._navToFile(this._path,e,1)}_navigateToPreviousUnreviewedFile(){if(!this._path)return;if(!this._fileList)return;if(!this._reviewedFiles)return;const e=this._fileList.filter(e=>e===this._path||!this._reviewedFiles.has(e));this._navToFile(this._path,e,-1)}_handleNextUnreviewedFile(e){this.shouldSuppressKeyboardShortcut(e)||(this._setReviewed(!0),this._navigateToNextUnreviewedFile())}_navigateToNextFileWithCommentThread(){if(!this._path)return;if(!this._fileList)return;if(!this._patchRange)return;if(!this._change)return;const e=e=>{var t,i,n;return null!==(n=null===(i=null===(t=this._changeComments)||void 0===t?void 0:t.getCommentsForPath(e,this._patchRange))||void 0===i?void 0:i.length)&&void 0!==n&&n},t=this._fileList.filter(t=>t===this._path||e(t));this._navToFile(this._path,t,1,!0)}_handleReloadingDiffPreference(){this._getDiffPreferences()}_computeCanEdit(e,t){return!(null==t||!t.base)&&(e&&bo(t.base))}_computeIsLoggedIn(e){return!!e}_computeAllPatchSets(e){return Yn(e)}_computeDisplayPath(e){return qb(e)}_computeTruncatedPath(e){return e?Yb(e):""}};Ik([Oo({type:Object,observer:"_paramsChanged"})],Ok.prototype,"params",void 0),Ik([Oo({type:Object})],Ok.prototype,"keyEventTarget",void 0),Ik([Oo({type:Object,notify:!0,observer:"_changeViewStateChanged"})],Ok.prototype,"changeViewState",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"disableDiffPrefs",void 0),Ik([Oo({type:Boolean,computed:"_computeDiffPrefsDisabled(disableDiffPrefs, _loggedIn)"})],Ok.prototype,"_diffPrefsDisabled",void 0),Ik([Oo({type:Object})],Ok.prototype,"_patchRange",void 0),Ik([Oo({type:Object})],Ok.prototype,"_commitRange",void 0),Ik([Oo({type:Object})],Ok.prototype,"_change",void 0),Ik([Oo({type:Object})],Ok.prototype,"_changeComments",void 0),Ik([Oo({type:String})],Ok.prototype,"_changeNum",void 0),Ik([Oo({type:Object})],Ok.prototype,"_diff",void 0),Ik([Oo({type:Array,computed:"_formatFilesForDropdown(_files, _patchRange, _changeComments)"})],Ok.prototype,"_formattedFiles",void 0),Ik([Oo({type:Array,computed:"_getSortedFileList(_files)"})],Ok.prototype,"_fileList",void 0),Ik([Oo({type:Object})],Ok.prototype,"_files",void 0),Ik([Oo({type:Object,computed:"_getCurrentFile(_files, _path)"})],Ok.prototype,"_file",void 0),Ik([Oo({type:String,observer:"_pathChanged"})],Ok.prototype,"_path",void 0),Ik([Oo({type:Number,computed:"_computeFileNum(_path, _formattedFiles)"})],Ok.prototype,"_fileNum",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"_loggedIn",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"_loading",void 0),Ik([Oo({type:Object})],Ok.prototype,"_prefs",void 0),Ik([Oo({type:Object})],Ok.prototype,"_projectConfig",void 0),Ik([Oo({type:Object})],Ok.prototype,"_userPrefs",void 0),Ik([Oo({type:String,computed:"_getDiffViewMode(changeViewState.diffMode, _userPrefs)"})],Ok.prototype,"_diffMode",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"_isImageDiff",void 0),Ik([Oo({type:Object})],Ok.prototype,"_filesWeblinks",void 0),Ik([Oo({type:Object})],Ok.prototype,"_commentMap",void 0),Ik([Oo({type:Object,computed:"_computeCommentSkips(_commentMap, _fileList, _path)"})],Ok.prototype,"_commentSkips",void 0),Ik([Oo({type:Boolean,computed:"_computeEditMode(_patchRange.*)"})],Ok.prototype,"_editMode",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"_isBlameLoaded",void 0),Ik([Oo({type:Boolean})],Ok.prototype,"_isBlameLoading",void 0),Ik([Oo({type:Array,computed:"_computeAllPatchSets(_change, _change.revisions.*)"})],Ok.prototype,"_allPatchSets",void 0),Ik([Oo({type:Object,computed:"_getRevisionInfo(_change)"})],Ok.prototype,"_revisionInfo",void 0),Ik([Oo({type:Object})],Ok.prototype,"_reviewedFiles",void 0),Ik([Oo({type:Number})],Ok.prototype,"_focusLineNum",void 0),Ik([No("_change.project")],Ok.prototype,"_getProjectConfig",null),Ik([No("_changeNum","_patchRange.*","_changeComments")],Ok.prototype,"_getFiles",null),Ik([No("_loggedIn","params.*","_prefs","_patchRange.*")],Ok.prototype,"_setReviewedObserver",null),Ik([No("_files.changeFilesByPath","_path","_patchRange","_projectConfig")],Ok.prototype,"_recomputeComments",null),Ok=Ik([Po("gr-diff-view")],Ok);const Nk=mi`
  <style include="shared-styles">
    textarea {
      border: none;
      box-sizing: border-box;
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-code);
      /* usually 16px = 12px + 4px */
      line-height: calc(var(--font-size-code) + var(--spacing-s));
      min-height: 60vh;
      resize: none;
      white-space: pre;
      width: 100%;
    }
    textarea:focus {
      outline: none;
    }
  </style>
  <textarea
    id="textarea"
    value="[[fileContent]]"
    on-input="_handleTextareaInput"
  ></textarea>
`;var Lk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Dk=class extends fi{constructor(){super(...arguments),this.fileContent=null}static get template(){return Nk}_handleTextareaInput(e){this.dispatchEvent(new CustomEvent("content-change",{detail:{value:e.target.value},bubbles:!0,composed:!0}))}};Lk([Oo({type:String})],Dk.prototype,"fileContent",void 0),Dk=Lk([Po("gr-default-editor")],Dk);const Mk=mi`
  <style include="shared-styles">
    :host {
      background-color: var(--view-background-color);
    }
    .stickyHeader {
      background-color: var(--edit-mode-background-color);
      border-bottom: 1px var(--border-color) solid;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    header,
    .subHeader {
      align-items: center;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      padding: var(--spacing-m) var(--spacing-l);
    }
    header gr-editable-label {
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
      --label-style: {
        text-overflow: initial;
        white-space: initial;
        word-break: break-all;
      }
      --input-style: {
        margin-top: var(--spacing-l);
      }
    }
    .textareaWrapper {
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      margin: var(--spacing-l);
    }
    .textareaWrapper .editButtons {
      display: none;
    }
    .controlGroup {
      align-items: center;
      display: flex;
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
    }
    .rightControls {
      justify-content: flex-end;
    }
  </style>
  <div class="stickyHeader">
    <header>
      <span class="controlGroup">
        <span>Edit mode</span>
        <span class="separator"></span>
        <gr-editable-label
          label-text="File path"
          value="[[_path]]"
          placeholder="File path..."
          on-changed="_handlePathChanged"
        ></gr-editable-label>
      </span>
      <span class="controlGroup rightControls">
        <gr-button id="close" link="" on-click="_handleCloseTap"
          >Cancel</gr-button
        >
        <gr-button
          id="save"
          disabled$="[[_saveDisabled]]"
          primary=""
          link=""
          title="Save and Close the file"
          on-click="_handleSaveTap"
          >Save</gr-button
        >
        <gr-button
          id="publish"
          link=""
          primary=""
          title="Publish your edit. A new patchset will be created."
          on-click="_handlePublishTap"
          disabled$="[[_saveDisabled]]"
          >Save & Publish</gr-button
        >
      </span>
    </header>
  </div>
  <div class="textareaWrapper">
    <gr-endpoint-decorator id="editorEndpoint" name="editor">
      <gr-endpoint-param
        name="fileContent"
        value="[[_newContent]]"
      ></gr-endpoint-param>
      <gr-endpoint-param name="prefs" value="[[_prefs]]"></gr-endpoint-param>
      <gr-endpoint-param name="fileType" value="[[_type]]"></gr-endpoint-param>
      <gr-endpoint-param
        name="lineNum"
        value="[[_lineNum]]"
      ></gr-endpoint-param>
      <gr-default-editor
        id="file"
        file-content="[[_newContent]]"
      ></gr-default-editor>
    </gr-endpoint-decorator>
  </div>
`;var Fk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let $k=class extends(Kf(fi)){constructor(){super(),this._saving=!1,this._successfulSave=!1,this._saveDisabled=!0,this.restApiService=i.restApiService,this.storage=i.storageService,this.reporting=i.reportingService,this.addEventListener("content-change",e=>{this._handleContentChange(e)})}static get template(){return Mk}get keyBindings(){return{"ctrl+s meta+s":"_handleSaveShortcut"}}connectedCallback(){super.connectedCallback(),this._getEditPrefs().then(e=>{this._prefs=e})}disconnectedCallback(){var e;null===(e=this.storeTask)||void 0===e||e.cancel(),super.disconnectedCallback()}get storageKey(){return`c${this._changeNum}_ps${this._patchNum}_${this._path}`}_getLoggedIn(){return this.restApiService.getLoggedIn()}_getEditPrefs(){return this.restApiService.getEditPreferences()}_paramsChanged(e){if(e.view!==Qm.View.EDIT)return;this._changeNum=e.changeNum,this._path=e.path,this._patchNum=e.patchNum||"edit",this._lineNum="string"==typeof e.lineNum?Number(e.lineNum):e.lineNum,setTimeout(()=>{xi(this,`Editing ${Yb(e.path)}`)});const t=[];return t.push(this._getChangeDetail(this._changeNum)),t.push(this._getFileData(this._changeNum,this._path,this._patchNum)),Promise.all(t)}_getChangeDetail(e){return this.restApiService.getDiffChangeDetail(e).then(e=>{this._change=e})}_editChange(e){(wo(e)||Co(e))&&e&&(Ci(this,"Change edits cannot be created if change is merged or abandoned. Redirected to non edit mode."),Qm.navigateToChange(e))}_handlePathChanged(e){if(void 0===this._changeNum||!this._path)return Promise.reject(new Error("changeNum or path undefined"));const t=e.detail;return t===this._path?Promise.resolve():this.restApiService.renameFileInChangeEdit(this._changeNum,this._path,t).then(e=>{e&&e.ok&&(this._successfulSave=!0,this._viewEditInChangeView())})}_viewEditInChangeView(){this._change&&Qm.navigateToChange(this._change,void 0,void 0,!0)}_getFileData(e,t,i){if(void 0===i)return Promise.reject(new Error("patchNum undefined"));const n=this.storage.getEditableContentItem(this.storageKey);return this.restApiService.getFileContent(e,t,i).then(e=>{const t=e&&e.content||"";n&&n.message&&n.message!==t?(Ci(this,"Content restored from a previous edit."),this._newContent=n.message):this._newContent=t,this._content=t,e&&e.ok&&e.type?this._type=e.type:this._type=""})}_saveEdit(){return void 0!==this._changeNum&&this._path?(this._saving=!0,this._showAlert("Saving changes..."),this.storage.eraseEditableContentItem(this.storageKey),this._newContent?this.restApiService.saveChangeEdit(this._changeNum,this._path,this._newContent).then(e=>(this._saving=!1,this._showAlert(e.ok?"All changes saved":"Failed to save changes"),e.ok?(this._content=this._newContent,this._successfulSave=!0,e):e)):Promise.reject(new Error("new content undefined"))):Promise.reject(new Error("changeNum or path undefined"))}_showAlert(e){Ci(this,e)}_computeSaveDisabled(e,t,i){return!![e,t,i].includes(void 0)||(!!i||e===t)}_handleCloseTap(){this._viewEditInChangeView()}_handleSaveTap(){this._saveEdit().then(e=>{e.ok&&this._viewEditInChangeView()})}_handlePublishTap(){a(this._changeNum,"_changeNum");const e=this._changeNum;this._saveEdit().then(()=>{this._showAlert("Publishing edit..."),this.restApiService.executeChangeAction(e,mn.POST,"/edit:publish",void 0,{notify:En.NONE},e=>{this._showAlert("Failed to publish edit"),this.reporting.error(new Error(null==e?void 0:e.statusText))}).then(()=>{a(this._change,"_change"),Qm.navigateToChange(this._change)})})}_handleContentChange(e){this.storeTask=Cu(this.storeTask,()=>{const t=e.detail.value;t?(this.set("_newContent",e.detail.value),this.storage.setEditableContentItem(this.storageKey,t)):this.storage.eraseEditableContentItem(this.storageKey)},100)}_handleSaveShortcut(e){e.preventDefault(),this._saveDisabled||this._saveEdit()}};Fk([Oo({type:Object,observer:"_paramsChanged"})],$k.prototype,"params",void 0),Fk([Oo({type:Object,observer:"_editChange"})],$k.prototype,"_change",void 0),Fk([Oo({type:Number})],$k.prototype,"_changeNum",void 0),Fk([Oo({type:String})],$k.prototype,"_patchNum",void 0),Fk([Oo({type:String})],$k.prototype,"_path",void 0),Fk([Oo({type:String})],$k.prototype,"_type",void 0),Fk([Oo({type:String})],$k.prototype,"_content",void 0),Fk([Oo({type:String})],$k.prototype,"_newContent",void 0),Fk([Oo({type:Boolean})],$k.prototype,"_saving",void 0),Fk([Oo({type:Boolean})],$k.prototype,"_successfulSave",void 0),Fk([Oo({type:Boolean,computed:"_computeSaveDisabled(_content, _newContent, _saving)"})],$k.prototype,"_saveDisabled",void 0),Fk([Oo({type:Object})],$k.prototype,"_prefs",void 0),Fk([Oo({type:Number})],$k.prototype,"_lineNum",void 0),$k=Fk([Po("gr-editor-view")],$k);var Bk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let jk=class extends fi{_configChanged(e){const t=e.plugin,i=t&&t.js_resource_paths||[],n=(!!e.default_theme&&!Qu().isPluginPreloaded("preloaded:gerrit-theme")?[e.default_theme]:[]).concat(i);Qu().loadPlugins(n)}};Bk([Oo({type:Object,observer:"_configChanged"})],jk.prototype,"config",void 0),jk=Bk([Po("gr-plugin-host")],jk);const Hk=mi`
  <style include="shared-styles">
    h1 {
      margin-bottom: var(--spacing-m);
    }
    h3 {
      margin-bottom: var(--spacing-m);
    }
    .agreementsUrl {
      border: 1px solid var(--border-color);
      margin-bottom: var(--spacing-xl);
      margin-left: var(--spacing-xl);
      margin-right: var(--spacing-xl);
      padding: var(--spacing-s);
    }
    #claNewAgreementsLabel {
      font-weight: var(--font-weight-bold);
    }
    #claNewAgreement {
      display: none;
    }
    #claNewAgreement.show {
      display: block;
    }
    .contributorAgreementButton {
      font-weight: var(--font-weight-bold);
    }
    .alreadySubmittedText {
      color: var(--error-text-color);
      margin: 0 var(--spacing-xxl);
      padding: var(--spacing-m);
    }
    .alreadySubmittedText.hide,
    .hideAgreementsTextBox {
      display: none;
    }
    main {
      margin: var(--spacing-xxl) auto;
      max-width: 50em;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <main>
    <h1 class="heading-1">New Contributor Agreement</h1>
    <h3 class="heading-3">Select an agreement type:</h3>
    <template
      is="dom-repeat"
      items="[[_serverConfig.auth.contributor_agreements]]"
    >
      <span class="contributorAgreementButton">
        <input
          id$="claNewAgreementsInput[[item.name]]"
          name="claNewAgreementsRadio"
          type="radio"
          data-name$="[[item.name]]"
          data-url$="[[item.url]]"
          on-click="_handleShowAgreement"
          disabled$="[[_disableAgreements(item, _groups, _signedAgreements)]]"
        />
        <label id="claNewAgreementsLabel">[[item.name]]</label>
      </span>
      <div
        class$="alreadySubmittedText [[_hideAgreements(item, _groups, _signedAgreements)]]"
      >
        Agreement already submitted.
      </div>
      <div class="agreementsUrl">[[item.description]]</div>
    </template>
    <div
      id="claNewAgreement"
      class$="[[_computeShowAgreementsClass(_showAgreements)]]"
    >
      <h3 class="heading-3">Review the agreement:</h3>
      <div id="agreementsUrl" class="agreementsUrl">
        <a href$="[[_agreementsUrl]]" target="blank" rel="noopener">
          Please review the agreement.</a
        >
      </div>
      <div
        class$="agreementsTextBox [[_computeHideAgreementClass(_agreementName, _serverConfig.auth.contributor_agreements)]]"
      >
        <h3 class="heading-3">Complete the agreement:</h3>
        <iron-input
          bind-value="{{_agreementsText}}"
          placeholder="Enter 'I agree' here"
        >
          <input
            id="input-agreements"
            is="iron-input"
            bind-value="{{_agreementsText}}"
            placeholder="Enter 'I agree' here"
          />
        </iron-input>
        <gr-button
          on-click="_handleSaveAgreements"
          disabled="[[_disableAgreementsText(_agreementsText)]]"
        >
          Submit
        </gr-button>
      </div>
    </div>
  </main>
`;var Uk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Gk=class extends fi{constructor(){super(...arguments),this._showAgreements=!1,this.restApiService=i.restApiService}static get template(){return Hk}connectedCallback(){super.connectedCallback(),this.loadData(),xi(this,"New Contributor Agreement")}loadData(){const e=[];return e.push(this.restApiService.getConfig(!0).then(e=>{this._serverConfig=e})),e.push(this.restApiService.getAccountGroups().then(e=>{e&&(this._groups=e.sort((e,t)=>(e.name||"").localeCompare(t.name||"")))})),e.push(this.restApiService.getAccountAgreements().then(e=>{this._signedAgreements=e||[]})),Promise.all(e)}_getAgreementsUrl(e){let t;return e?(t=e.startsWith("http:")||e.startsWith("https:")?e:k()+"/"+e,t):""}_handleShowAgreement(e){this._agreementName=e.target.getAttribute("data-name");const t=e.target.getAttribute("data-url");this._agreementsUrl=this._getAgreementsUrl(t),this._showAgreements=!0}_handleSaveAgreements(){this._createToast("Agreement saving...");const e=this._agreementName;return this.restApiService.saveAccountAgreement({name:e}).then(e=>{let t="Agreement failed to be submitted, please try again";200===e.status&&(t="Agreement has been successfully submitted."),this._createToast(t),this.loadData(),this._agreementsText="",this._showAgreements=!1})}_createToast(e){Ci(this,e)}_computeShowAgreementsClass(e){return e?"show":""}_disableAgreements(e,t,i){var n;if(!t)return!1;for(const o of t)if((null===(n=null==e?void 0:e.auto_verify_group)||void 0===n?void 0:n.id)===o.id||(null==i?void 0:i.find(t=>t.name===e.name)))return!0;return!1}_hideAgreements(e,t,i){return this._disableAgreements(e,t,i)?"":"hide"}_disableAgreementsText(e){return"i agree"!==e.toLowerCase()}_computeHideAgreementClass(e,t){return t&&t.some(t=>e===t.name&&!t.auto_verify_group)?"hideAgreementsTextBox":""}};Uk([Oo({type:Object})],Gk.prototype,"_groups",void 0),Uk([Oo({type:Object})],Gk.prototype,"_serverConfig",void 0),Uk([Oo({type:String})],Gk.prototype,"_agreementsText",void 0),Uk([Oo({type:String})],Gk.prototype,"_agreementName",void 0),Uk([Oo({type:Array})],Gk.prototype,"_signedAgreements",void 0),Uk([Oo({type:Boolean})],Gk.prototype,"_showAgreements",void 0),Uk([Oo({type:String})],Gk.prototype,"_agreementsUrl",void 0),Gk=Uk([Po("gr-cla-view")],Gk);const zk=mi`
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="shared-styles">
    :host {
      display: block;
    }
    main {
      max-width: 46em;
    }
    :host(.loading) main {
      display: none;
    }
    .loadingMessage {
      display: none;
      font-style: italic;
    }
    :host(.loading) .loadingMessage {
      display: block;
    }
    hr {
      margin-top: var(--spacing-l);
      margin-bottom: var(--spacing-l);
    }
    header {
      border-bottom: 1px solid var(--border-color);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--spacing-l);
    }
    .container {
      padding: var(--spacing-m) var(--spacing-xl);
    }
    footer {
      display: flex;
      justify-content: flex-end;
    }
    footer gr-button {
      margin-left: var(--spacing-l);
    }
    input {
      width: 20em;
    }
  </style>
  <div class="container gr-form-styles">
    <header>Please confirm your contact information</header>
    <div class="loadingMessage">Loading...</div>
    <main>
      <p>
        The following contact information was automatically obtained when you
        signed in to the site. This information is used to display who you are
        to others, and to send updates to code reviews you have either started
        or subscribed to.
      </p>
      <hr />
      <section>
        <span class="title">Full Name</span>
        <span class="value">
          <iron-input bind-value="{{_account.name}}">
            <input
              is="iron-input"
              id="name"
              bind-value="{{_account.name}}"
              disabled="[[_saving]]"
            />
          </iron-input>
        </span>
      </section>
      <template is="dom-if" if="[[_computeUsernameEditable(_serverConfig)]]">
        <section>
          <span class="title">Username</span>
          <span hidden$="[[_usernameMutable]]" class="value"
            >[[_username]]</span
          >
          <span hidden$="[[!_usernameMutable]]" class="value">
            <iron-input bind-value="{{_username}}">
              <input
                is="iron-input"
                id="username"
                bind-value="{{_username}}"
                disabled="[[_saving]]"
              />
            </iron-input>
          </span>
        </section>
      </template>
      <hr />
      <p>
        More configuration options for Gerrit may be found in the
        <a on-click="close" href$="[[settingsUrl]]">settings</a>.
      </p>
    </main>
    <footer>
      <gr-button
        id="closeButton"
        link=""
        disabled="[[_saving]]"
        on-click="_handleClose"
        >Close</gr-button
      >
      <gr-button
        id="saveButton"
        primary=""
        link=""
        disabled="[[_computeSaveDisabled(_account.name, _username, _saving)]]"
        on-click="_handleSave"
        >Save</gr-button
      >
    </footer>
  </div>
`;var Vk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Wk=class extends fi{constructor(){super(...arguments),this._account={},this._loading=!0,this._saving=!1,this._usernameMutable=!1,this.restApiService=i.restApiService}static get template(){return zk}ready(){super.ready(),this._ensureAttribute("role","dialog")}loadData(){this._loading=!0;const e=this.restApiService.getAccount().then(e=>{e&&(this._hasUsernameChange=!1,e.username=e.username||"",this._account=e,this._username=e.username)}),t=this.restApiService.getConfig().then(e=>{this._serverConfig=e});return Promise.all([e,t]).then(()=>{this._loading=!1})}_usernameChanged(){!this._loading&&this._account&&(this._hasUsernameChange=(this._account.username||"")!==(this._username||""))}_computeUsernameMutable(e){return!e}_computeUsernameEditable(e){return!!(null==e?void 0:e.auth.editable_account_fields.includes(Rn.USER_NAME))}_save(){this._saving=!0;const e=[this.restApiService.setAccountName(this.$.name.value)];return this._hasUsernameChange&&this._usernameMutable&&this._username&&e.push(this.restApiService.setAccountUsername(this._username)),Promise.all(e).then(()=>{this._saving=!1,bi(this,"account-detail-update")})}_handleSave(e){e.preventDefault(),this._save().then(()=>this.close())}_handleClose(e){e.preventDefault(),this.close()}close(){this._saving=!0,bi(this,"close")}_computeSaveDisabled(e,t,i){return i||!e&&!t}_loadingChanged(){this.classList.toggle("loading",this._loading)}};Vk([Oo({type:String})],Wk.prototype,"settingsUrl",void 0),Vk([Oo({type:Object})],Wk.prototype,"_account",void 0),Vk([Oo({type:Boolean})],Wk.prototype,"_loading",void 0),Vk([Oo({type:Boolean})],Wk.prototype,"_saving",void 0),Vk([Oo({type:Object})],Wk.prototype,"_serverConfig",void 0),Vk([Oo({computed:"_computeUsernameMutable(_account.username)",type:Boolean})],Wk.prototype,"_usernameMutable",void 0),Vk([Oo({type:Boolean})],Wk.prototype,"_hasUsernameChange",void 0),Vk([Oo({type:String,observer:"_usernameChanged"})],Wk.prototype,"_username",void 0),Vk([No("_loading")],Wk.prototype,"_loadingChanged",null),Wk=Vk([Po("gr-registration-dialog")],Wk);const qk=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    #changeCols {
      width: auto;
    }
    #changeCols .visibleHeader {
      text-align: center;
    }
    .checkboxContainer {
      cursor: pointer;
      text-align: center;
    }
    .checkboxContainer input {
      cursor: pointer;
    }
    .checkboxContainer:hover {
      outline: 1px solid var(--border-color);
    }
  </style>
  <div class="gr-form-styles">
    <table id="changeCols">
      <thead>
        <tr>
          <th class="nameHeader">Column</th>
          <th class="visibleHeader">Visible</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><label for="numberCheckbox">Number</label></td>
          <td
            class="checkboxContainer"
            on-click="_handleCheckboxContainerClick"
          >
            <input
              id="numberCheckbox"
              type="checkbox"
              name="number"
              on-click="_handleNumberCheckboxClick"
              checked$="[[showNumber]]"
            />
          </td>
        </tr>
        <template is="dom-repeat" items="[[defaultColumns]]">
          <tr>
            <td><label for$="[[item]]">[[item]]</label></td>
            <td
              class="checkboxContainer"
              on-click="_handleCheckboxContainerClick"
            >
              <input
                id$="[[item]]"
                type="checkbox"
                name="[[item]]"
                on-click="_handleTargetClick"
                checked$="[[!isColumnHidden(item, displayedColumns)]]"
              />
            </td>
          </tr>
        </template>
      </tbody>
    </table>
  </div>
`;var Kk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Yk=class extends(zb(fi)){constructor(){super(...arguments),this.displayedColumns=[],this.defaultColumns=[],this.flagsService=i.flagsService}static get template(){return qk}_configChanged(e){this.defaultColumns=this.getEnabledColumns(this.columnNames,e,this.flagsService.enabledExperiments),this.displayedColumns&&(this.displayedColumns=this.displayedColumns.filter(t=>this.isColumnEnabled(t,e,this.flagsService.enabledExperiments)))}_getDisplayedColumns(){return null===this.root?[]:Array.from(this.root.querySelectorAll(".checkboxContainer input:not([name=number])")).filter(e=>e.checked).map(e=>e.name)}_handleCheckboxContainerClick(e){if(null===e.target)return;const t=e.target.querySelector("input");t&&t.click()}_handleNumberCheckboxClick(e){this.showNumber=Th(e).rootTarget.checked}_handleTargetClick(){this.set("displayedColumns",this._getDisplayedColumns())}};Kk([Oo({type:Array,notify:!0})],Yk.prototype,"displayedColumns",void 0),Kk([Oo({type:Boolean,notify:!0})],Yk.prototype,"showNumber",void 0),Kk([Oo({type:Object})],Yk.prototype,"serverConfig",void 0),Kk([Oo({type:Array})],Yk.prototype,"defaultColumns",void 0),Kk([No("serverConfig")],Yk.prototype,"_configChanged",null),Yk=Kk([Po("gr-change-table-editor")],Yk);const Xk=mi`
  <style include="shared-styles">
    gr-avatar {
      height: 120px;
      width: 120px;
      margin-right: var(--spacing-xs);
      vertical-align: -0.25em;
    }
    div section.hide {
      display: none;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="gr-form-styles">
    <section>
      <span class="title"></span>
      <span class="value">
        <gr-avatar account="[[_account]]" image-size="120"></gr-avatar>
      </span>
    </section>
    <section class$="[[_hideAvatarChangeUrl(_avatarChangeUrl)]]">
      <span class="title"></span>
      <span class="value">
        <a href$="[[_avatarChangeUrl]]"> Change avatar </a>
      </span>
    </section>
    <section>
      <span class="title">ID</span>
      <span class="value">[[_account._account_id]]</span>
    </section>
    <section>
      <span class="title">Email</span>
      <span class="value">[[_account.email]]</span>
    </section>
    <section>
      <span class="title">Registered</span>
      <span class="value">
        <gr-date-formatter
          has-tooltip=""
          date-str="[[_account.registered_on]]"
        ></gr-date-formatter>
      </span>
    </section>
    <section id="usernameSection">
      <span class="title">Username</span>
      <span hidden$="[[usernameMutable]]" class="value">[[_username]]</span>
      <span hidden$="[[!usernameMutable]]" class="value">
        <iron-input
          on-keydown="_handleKeydown"
          bind-value="{{_username}}"
          id="usernameIronInput"
        >
          <input
            is="iron-input"
            id="usernameInput"
            disabled="[[_saving]]"
            on-keydown="_handleKeydown"
          />
        </iron-input>
      </span>
    </section>
    <section id="nameSection">
      <label class="title" for="nameInput">Full name</label>
      <span hidden$="[[nameMutable]]" class="value">[[_account.name]]</span>
      <span hidden$="[[!nameMutable]]" class="value">
        <iron-input
          on-keydown="_handleKeydown"
          bind-value="{{_account.name}}"
          id="nameIronInput"
        >
          <input
            is="iron-input"
            id="nameInput"
            disabled="[[_saving]]"
            on-keydown="_handleKeydown"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label class="title" for="displayNameInput">Display name</label>
      <span class="value">
        <iron-input
          on-keydown="_handleKeydown"
          bind-value="{{_account.display_name}}"
        >
          <input
            is="iron-input"
            id="displayNameInput"
            disabled="[[_saving]]"
            on-keydown="_handleKeydown"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label class="title" for="statusInput">Status (e.g. "Vacation")</label>
      <span class="value">
        <iron-input
          on-keydown="_handleKeydown"
          bind-value="{{_account.status}}"
        >
          <input
            is="iron-input"
            id="statusInput"
            disabled="[[_saving]]"
            on-keydown="_handleKeydown"
          />
        </iron-input>
      </span>
    </section>
  </div>
`;var Jk=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let Zk=class extends fi{constructor(){super(...arguments),this._loading=!1,this._saving=!1,this._avatarChangeUrl="",this.restApiService=i.restApiService}static get template(){return Xk}loadData(){const e=[];return this._loading=!0,e.push(this.restApiService.getConfig().then(e=>{this._serverConfig=e})),e.push(this.restApiService.invalidateAccountsDetailCache()),e.push(this.restApiService.getAccount().then(e=>{e&&(this._hasNameChange=!1,this._hasUsernameChange=!1,this._hasDisplayNameChange=!1,this._hasStatusChange=!1,e.username=e.username||"",this._account=e,this._username=e.username)})),e.push(this.restApiService.getAvatarChangeUrl().then(e=>{this._avatarChangeUrl=e||""})),Promise.all(e).then(()=>{this._loading=!1})}save(){return this.hasUnsavedChanges?(this._saving=!0,this._maybeSetName().then(()=>this._maybeSetUsername()).then(()=>this._maybeSetDisplayName()).then(()=>this._maybeSetStatus()).then(()=>{this._hasNameChange=!1,this._hasDisplayNameChange=!1,this._hasStatusChange=!1,this._saving=!1,bi(this,"account-detail-update")})):Promise.resolve()}_maybeSetName(){var e;return this._hasNameChange&&this.nameMutable&&(null===(e=this._account)||void 0===e?void 0:e.name)?this.restApiService.setAccountName(this._account.name):Promise.resolve()}_maybeSetUsername(){return this._hasUsernameChange&&this.usernameMutable&&this._username?this.restApiService.setAccountUsername(this._username):Promise.resolve()}_maybeSetDisplayName(){var e;return this._hasDisplayNameChange&&void 0!==(null===(e=this._account)||void 0===e?void 0:e.display_name)?this.restApiService.setAccountDisplayName(this._account.display_name):Promise.resolve()}_maybeSetStatus(){var e;return this._hasStatusChange&&void 0!==(null===(e=this._account)||void 0===e?void 0:e.status)?this.restApiService.setAccountStatus(this._account.status):Promise.resolve()}_computeHasUnsavedChanges(e,t,i,n){return e||t||i||n}_computeUsernameMutable(e,t){if(![e,t].includes(void 0))return e.auth.editable_account_fields.includes(Rn.USER_NAME)&&!t}_computeNameMutable(e){return e.auth.editable_account_fields.includes(Rn.FULL_NAME)}_statusChanged(){this._loading||(this._hasStatusChange=!0)}_displayNameChanged(){this._loading||(this._hasDisplayNameChange=!0)}_usernameChanged(){!this._loading&&this._account&&(this._hasUsernameChange=(this._account.username||"")!==(this._username||""))}_nameChanged(){this._loading||(this._hasNameChange=!0)}_handleKeydown(e){13===e.keyCode&&(e.stopPropagation(),this.save())}_hideAvatarChangeUrl(e){return e?"":"hide"}};Jk([Oo({type:Boolean,notify:!0,computed:"_computeUsernameMutable(_serverConfig, _account.username)"})],Zk.prototype,"usernameMutable",void 0),Jk([Oo({type:Boolean,notify:!0,computed:"_computeNameMutable(_serverConfig)"})],Zk.prototype,"nameMutable",void 0),Jk([Oo({type:Boolean,notify:!0,computed:"_computeHasUnsavedChanges(_hasNameChange, _hasUsernameChange, _hasStatusChange, _hasDisplayNameChange)"})],Zk.prototype,"hasUnsavedChanges",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_hasNameChange",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_hasUsernameChange",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_hasDisplayNameChange",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_hasStatusChange",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_loading",void 0),Jk([Oo({type:Boolean})],Zk.prototype,"_saving",void 0),Jk([Oo({type:Object})],Zk.prototype,"_account",void 0),Jk([Oo({type:Object})],Zk.prototype,"_serverConfig",void 0),Jk([Oo({type:String,observer:"_usernameChanged"})],Zk.prototype,"_username",void 0),Jk([Oo({type:String})],Zk.prototype,"_avatarChangeUrl",void 0),Jk([No("_account.status")],Zk.prototype,"_statusChanged",null),Jk([No("_account.display_name")],Zk.prototype,"_displayNameChanged",null),Jk([No("_account.name")],Zk.prototype,"_nameChanged",null),Zk=Jk([Po("gr-account-info")],Zk);const Qk=mi`
  <style include="shared-styles">
    #agreements .nameColumn {
      min-width: 15em;
      width: auto;
    }
    #agreements .descriptionColumn {
      width: auto;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="gr-form-styles">
    <table id="agreements">
      <thead>
        <tr>
          <th class="nameColumn">Name</th>
          <th class="descriptionColumn">Description</th>
        </tr>
      </thead>
      <tbody>
        <template is="dom-repeat" items="[[_agreements]]">
          <tr>
            <td class="nameColumn">
              <a href$="[[getUrlBase(item.url)]]" rel="external">
                [[item.name]]
              </a>
            </td>
            <td class="descriptionColumn">[[item.description]]</td>
          </tr>
        </template>
      </tbody>
    </table>
    <a href$="[[getUrl()]]">New Contributor Agreement</a>
  </div>
`;var eP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let tP=class extends fi{constructor(){super(...arguments),this.restApiService=i.restApiService}static get template(){return Qk}connectedCallback(){super.connectedCallback(),this.loadData()}loadData(){return this.restApiService.getAccountAgreements().then(e=>{this._agreements=e})}getUrl(){return`${k()}/settings/new-agreement`}getUrlBase(e){return`${k()}/${e}`}};eP([Oo({type:Array})],tP.prototype,"_agreements",void 0),tP=eP([Po("gr-agreements-list")],tP);const iP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div id="editPreferences" class="gr-form-styles">
    <section>
      <label for="editTabWidth" class="title">Tab width</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{editPrefs.tab_size}}"
          on-keypress="_handleEditPrefsChanged"
          on-change="_handleEditPrefsChanged"
        >
          <input
            is="iron-input"
            id="editTabWidth"
            type="number"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{editPrefs.tab_size}}"
            on-keypress="_handleEditPrefsChanged"
            on-change="_handleEditPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label for="editColumns" class="title">Columns</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{editPrefs.line_length}}"
          on-keypress="_handleEditPrefsChanged"
          on-change="_handleEditPrefsChanged"
        >
          <input
            id="editColumns"
            is="iron-input"
            type="number"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{editPrefs.line_length}}"
            on-keypress="_handleEditPrefsChanged"
            on-change="_handleEditPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label for="indentUnit" class="title">Indent unit</label>
      <span class="value">
        <iron-input
          type="number"
          prevent-invalid-input=""
          allowed-pattern="[0-9]"
          bind-value="{{editPrefs.indent_unit}}"
          on-keypress="_handleEditPrefsChanged"
          on-change="_handleEditPrefsChanged"
        >
          <input
            is="iron-input"
            id="indentUnit"
            type="number"
            prevent-invalid-input=""
            allowed-pattern="[0-9]"
            bind-value="{{editPrefs.indent_unit}}"
            on-keypress="_handleEditPrefsChanged"
            on-change="_handleEditPrefsChanged"
          />
        </iron-input>
      </span>
    </section>
    <section>
      <label for="editSyntaxHighlighting" class="title"
        >Syntax highlighting</label
      >
      <span class="value">
        <input
          id="editSyntaxHighlighting"
          type="checkbox"
          checked$="[[editPrefs.syntax_highlighting]]"
          on-change="_handleEditSyntaxHighlightingChanged"
        />
      </span>
    </section>
    <section>
      <label for="editShowTabs" class="title">Show tabs</label>
      <span class="value">
        <input
          id="editShowTabs"
          type="checkbox"
          checked$="[[editPrefs.show_tabs]]"
          on-change="_handleEditShowTabsChanged"
        />
      </span>
    </section>
    <section>
      <label for="showTrailingWhitespaceInput" class="title"
        >Show trailing whitespace</label
      >
      <span class="value">
        <input
          id="editShowTrailingWhitespaceInput"
          type="checkbox"
          checked$="[[editPrefs.show_whitespace_errors]]"
          on-change="_handleEditShowTrailingWhitespaceTap"
        />
      </span>
    </section>
    <section>
      <label for="showMatchBrackets" class="title">Match brackets</label>
      <span class="value">
        <input
          id="showMatchBrackets"
          type="checkbox"
          checked$="[[editPrefs.match_brackets]]"
          on-change="_handleMatchBracketsChanged"
        />
      </span>
    </section>
    <section>
      <label for="editShowLineWrapping" class="title">Line wrapping</label>
      <span class="value">
        <input
          id="editShowLineWrapping"
          type="checkbox"
          checked$="[[editPrefs.line_wrapping]]"
          on-change="_handleEditLineWrappingChanged"
        />
      </span>
    </section>
    <section>
      <label for="showIndentWithTabs" class="title">Indent with tabs</label>
      <span class="value">
        <input
          id="showIndentWithTabs"
          type="checkbox"
          checked$="[[editPrefs.indent_with_tabs]]"
          on-change="_handleIndentWithTabsChanged"
        />
      </span>
    </section>
    <section>
      <label for="showAutoCloseBrackets" class="title"
        >Auto close brackets</label
      >
      <span class="value">
        <input
          id="showAutoCloseBrackets"
          type="checkbox"
          checked$="[[editPrefs.auto_close_brackets]]"
          on-change="_handleAutoCloseBracketsChanged"
        />
      </span>
    </section>
  </div>
`;var nP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let oP=class extends fi{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this.restApiService=i.restApiService}static get template(){return iP}loadData(){return this.restApiService.getEditPreferences().then(e=>{this.editPrefs=e})}_handleEditPrefsChanged(){this.hasUnsavedChanges=!0}_handleEditSyntaxHighlightingChanged(){this.set("editPrefs.syntax_highlighting",this.$.editSyntaxHighlighting.checked),this._handleEditPrefsChanged()}_handleEditShowTabsChanged(){this.set("editPrefs.show_tabs",this.$.editShowTabs.checked),this._handleEditPrefsChanged()}_handleEditShowTrailingWhitespaceTap(){this.set("editPrefs.show_whitespace_errors",this.$.editShowTrailingWhitespaceInput.checked),this._handleEditPrefsChanged()}_handleMatchBracketsChanged(){this.set("editPrefs.match_brackets",this.$.showMatchBrackets.checked),this._handleEditPrefsChanged()}_handleEditLineWrappingChanged(){this.set("editPrefs.line_wrapping",this.$.editShowLineWrapping.checked),this._handleEditPrefsChanged()}_handleIndentWithTabsChanged(){this.set("editPrefs.indent_with_tabs",this.$.showIndentWithTabs.checked),this._handleEditPrefsChanged()}_handleAutoCloseBracketsChanged(){this.set("editPrefs.auto_close_brackets",this.$.showAutoCloseBrackets.checked),this._handleEditPrefsChanged()}save(){return this.editPrefs?this.restApiService.saveEditPreferences(this.editPrefs).then(()=>{this.hasUnsavedChanges=!1}):Promise.reject(new Error("Missing edit preferences"))}};nP([Oo({type:Boolean,notify:!0})],oP.prototype,"hasUnsavedChanges",void 0),nP([Oo({type:Object})],oP.prototype,"editPrefs",void 0),oP=nP([Po("gr-edit-preferences")],oP);const rP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    th {
      color: var(--deemphasized-text-color);
      text-align: left;
    }
    #emailTable .emailColumn {
      min-width: 32.5em;
      width: auto;
    }
    #emailTable .preferredHeader {
      text-align: center;
      width: 6em;
    }
    #emailTable .preferredControl {
      cursor: pointer;
      height: auto;
      text-align: center;
    }
    #emailTable .preferredControl .preferredRadio {
      height: auto;
    }
    .preferredControl:hover {
      outline: 1px solid var(--border-color);
    }
  </style>
  <div class="gr-form-styles">
    <table id="emailTable">
      <thead>
        <tr>
          <th class="emailColumn">Email</th>
          <th class="preferredHeader">Preferred</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <template is="dom-repeat" items="[[_emails]]">
          <tr>
            <td class="emailColumn">[[item.email]]</td>
            <td
              class="preferredControl"
              on-click="_handlePreferredControlClick"
            >
              <iron-input
                class="preferredRadio"
                type="radio"
                on-change="_handlePreferredChange"
                name="preferred"
                bind-value="[[item.email]]"
                checked$="[[item.preferred]]"
              >
                <input
                  is="iron-input"
                  class="preferredRadio"
                  type="radio"
                  on-change="_handlePreferredChange"
                  name="preferred"
                  value="[[item.email]]"
                  checked$="[[item.preferred]]"
                />
              </iron-input>
            </td>
            <td>
              <gr-button
                data-index$="[[index]]"
                on-click="_handleDeleteButton"
                disabled="[[item.preferred]]"
                class="remove-button"
                >Delete</gr-button
              >
            </td>
          </tr>
        </template>
      </tbody>
    </table>
  </div>
`;var sP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let aP=class extends fi{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this._emails=[],this._emailsToRemove=[],this._newPreferred=null,this.restApiService=i.restApiService}static get template(){return rP}loadData(){return this.restApiService.getAccountEmails().then(e=>{this._emails=null!=e?e:[]})}save(){const e=[];for(const t of this._emailsToRemove)e.push(this.restApiService.deleteAccountEmail(t.email));return this._newPreferred&&e.push(this.restApiService.setPreferredAccountEmail(this._newPreferred)),Promise.all(e).then(()=>{this._emailsToRemove=[],this._newPreferred=null,this.hasUnsavedChanges=!1})}_handleDeleteButton(e){const t=Th(e).localTarget;if(!(t instanceof Element))return;const i=t.getAttribute("data-index");if(null===i)return;const n=Number(i),o=this._emails[n];this.push("_emailsToRemove",o),this.splice("_emails",n,1),this.hasUnsavedChanges=!0}_handlePreferredControlClick(e){e.target instanceof HTMLElement&&e.target.classList.contains("preferredControl")&&e.target.firstElementChild instanceof HTMLInputElement&&e.target.firstElementChild.click()}_handlePreferredChange(e){if(!(e.target instanceof HTMLInputElement))return;const t=e.target.value;for(let e=0;e<this._emails.length;e++)t===this._emails[e].email?(this.set(["_emails",e,"preferred"],!0),this._newPreferred=t,this.hasUnsavedChanges=!0):this._emails[e].preferred&&this.set(["_emails",e,"preferred"],!1)}};sP([Oo({type:Boolean,notify:!0})],aP.prototype,"hasUnsavedChanges",void 0),sP([Oo({type:Array})],aP.prototype,"_emails",void 0),sP([Oo({type:Array})],aP.prototype,"_emailsToRemove",void 0),sP([Oo({type:String})],aP.prototype,"_newPreferred",void 0),aP=sP([Po("gr-email-editor")],aP);const lP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    .keyHeader {
      width: 9em;
    }
    .userIdHeader {
      width: 15em;
    }
    #viewKeyOverlay {
      padding: var(--spacing-xxl);
      width: 50em;
    }
    .publicKey {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      overflow-x: scroll;
      overflow-wrap: break-word;
      width: 30em;
    }
    .closeButton {
      bottom: 2em;
      position: absolute;
      right: 2em;
    }
    #existing {
      margin-bottom: var(--spacing-l);
    }
  </style>
  <div class="gr-form-styles">
    <fieldset id="existing">
      <table>
        <thead>
          <tr>
            <th class="idColumn">ID</th>
            <th class="fingerPrintColumn">Fingerprint</th>
            <th class="userIdHeader">User IDs</th>
            <th class="keyHeader">Public Key</th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <template is="dom-repeat" items="[[_keys]]" as="key">
            <tr>
              <td class="idColumn">[[key.id]]</td>
              <td class="fingerPrintColumn">[[key.fingerprint]]</td>
              <td class="userIdHeader">
                <template is="dom-repeat" items="[[key.user_ids]]">
                  [[item]]
                </template>
              </td>
              <td class="keyHeader">
                <gr-button on-click="_showKey" data-index$="[[index]]" link=""
                  >Click to View</gr-button
                >
              </td>
              <td>
                <gr-copy-clipboard
                  has-tooltip=""
                  button-title="Copy GPG public key to clipboard"
                  hide-input=""
                  text="[[key.key]]"
                >
                </gr-copy-clipboard>
              </td>
              <td>
                <gr-button data-index$="[[index]]" on-click="_handleDeleteKey"
                  >Delete</gr-button
                >
              </td>
            </tr>
          </template>
        </tbody>
      </table>
      <gr-overlay id="viewKeyOverlay" with-backdrop="">
        <fieldset>
          <section>
            <span class="title">Status</span>
            <span class="value">[[_keyToView.status]]</span>
          </section>
          <section>
            <span class="title">Key</span>
            <span class="value">[[_keyToView.key]]</span>
          </section>
        </fieldset>
        <gr-button class="closeButton" on-click="_closeOverlay"
          >Close</gr-button
        >
      </gr-overlay>
      <gr-button on-click="save" disabled$="[[!hasUnsavedChanges]]"
        >Save changes</gr-button
      >
    </fieldset>
    <fieldset>
      <section>
        <span class="title">New GPG key</span>
        <span class="value">
          <iron-autogrow-textarea
            id="newKey"
            autocomplete="on"
            bind-value="{{_newKey}}"
            placeholder="New GPG Key"
          ></iron-autogrow-textarea>
        </span>
      </section>
      <gr-button
        id="addButton"
        disabled$="[[_computeAddButtonDisabled(_newKey)]]"
        on-click="_handleAddKey"
        >Add new GPG key</gr-button
      >
    </fieldset>
  </div>
`;var cP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let dP=class extends fi{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this._keys=[],this._newKey="",this._keysToRemove=[],this.restApiService=i.restApiService}static get template(){return lP}loadData(){return this._keys=[],this.restApiService.getAccountGPGKeys().then(e=>{e&&(this._keys=Object.keys(e).map(t=>{const i=e[t];return i.id=t,i}))})}save(){const e=this._keysToRemove.map(e=>this.restApiService.deleteAccountGPGKey(e.id));return Promise.all(e).then(()=>{this._keysToRemove=[],this.hasUnsavedChanges=!1})}_showKey(e){const t=Th(e).localTarget,i=Number(t.getAttribute("data-index"));this._keyToView=this._keys[i],this.$.viewKeyOverlay.open()}_closeOverlay(){this.$.viewKeyOverlay.close()}_handleDeleteKey(e){const t=Th(e).localTarget,i=Number(t.getAttribute("data-index"));this.push("_keysToRemove",this._keys[i]),this.splice("_keys",i,1),this.hasUnsavedChanges=!0}_handleAddKey(){return this.$.addButton.disabled=!0,this.$.newKey.disabled=!0,this.restApiService.addAccountGPGKey({add:[this._newKey.trim()]}).then(()=>{this.$.newKey.disabled=!1,this._newKey="",this.loadData()}).catch(()=>{this.$.addButton.disabled=!1,this.$.newKey.disabled=!1})}_computeAddButtonDisabled(e){return!e.length}};cP([Oo({type:Boolean,notify:!0})],dP.prototype,"hasUnsavedChanges",void 0),cP([Oo({type:Array})],dP.prototype,"_keys",void 0),cP([Oo({type:Object})],dP.prototype,"_keyToView",void 0),cP([Oo({type:String})],dP.prototype,"_newKey",void 0),cP([Oo({type:Array})],dP.prototype,"_keysToRemove",void 0),dP=cP([Po("gr-gpg-editor")],dP);const hP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    #groups .nameColumn {
      min-width: 11em;
      width: auto;
    }
    .descriptionHeader {
      min-width: 21.5em;
    }
    .visibleCell {
      text-align: center;
      width: 6em;
    }
  </style>
  <div class="gr-form-styles">
    <table id="groups">
      <thead>
        <tr>
          <th class="nameHeader">Name</th>
          <th class="descriptionHeader">Description</th>
          <th class="visibleCell">Visible to all</th>
        </tr>
      </thead>
      <tbody>
        <template is="dom-repeat" items="[[_groups]]">
          <tr>
            <td class="nameColumn">
              <a href$="[[_computeGroupPath(item)]]"> [[item.name]] </a>
            </td>
            <td>[[item.description]]</td>
            <td class="visibleCell">[[_computeVisibleToAll(item)]]</td>
          </tr>
        </template>
      </tbody>
    </table>
  </div>
`;var pP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let uP=class extends fi{constructor(){super(...arguments),this._groups=[],this.restApiService=i.restApiService}static get template(){return hP}loadData(){return this.restApiService.getAccountGroups().then(e=>{e&&(this._groups=e.sort((e,t)=>(e.name||"").localeCompare(t.name||"")))})}_computeVisibleToAll(e){return e.options&&e.options.visible_to_all?"Yes":"No"}_computeGroupPath(e){if(e&&e.id)return Qm.getUrlForGroup(decodeURIComponent(e.id))}};pP([Oo({type:Array})],uP.prototype,"_groups",void 0),uP=pP([Po("gr-group-list")],uP);const gP=mi`
  <style include="shared-styles">
    .password {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
    }
    #generatedPasswordOverlay {
      padding: var(--spacing-xxl);
      width: 50em;
    }
    #generatedPasswordDisplay {
      margin: var(--spacing-l) 0;
    }
    #generatedPasswordDisplay .title {
      width: unset;
    }
    #generatedPasswordDisplay .value {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
    }
    #passwordWarning {
      font-style: italic;
      text-align: center;
    }
    .closeButton {
      bottom: 2em;
      position: absolute;
      right: 2em;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="gr-form-styles">
    <div hidden$="[[_passwordUrl]]">
      <section>
        <span class="title">Username</span>
        <span class="value">[[_username]]</span>
      </section>
      <gr-button id="generateButton" on-click="_handleGenerateTap"
        >Generate new password</gr-button
      >
    </div>
    <span hidden$="[[!_passwordUrl]]">
      <a href$="[[_passwordUrl]]" target="_blank" rel="noopener">
        Obtain password</a
      >
      (opens in a new tab)
    </span>
  </div>
  <gr-overlay
    id="generatedPasswordOverlay"
    on-iron-overlay-closed="_generatedPasswordOverlayClosed"
    with-backdrop=""
  >
    <div class="gr-form-styles">
      <section id="generatedPasswordDisplay">
        <span class="title">New Password:</span>
        <span class="value">[[_generatedPassword]]</span>
        <gr-copy-clipboard
          has-tooltip=""
          button-title="Copy password to clipboard"
          hide-input=""
          text="[[_generatedPassword]]"
        >
        </gr-copy-clipboard>
      </section>
      <section id="passwordWarning">
        This password will not be displayed again.<br />
        If you lose it, you will need to generate a new one.
      </section>
      <gr-button link="" class="closeButton" on-click="_closeOverlay"
        >Close</gr-button
      >
    </div>
  </gr-overlay>
`;var mP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let fP=class extends fi{constructor(){super(...arguments),this._passwordUrl=null,this.restApiService=i.restApiService}static get template(){return gP}connectedCallback(){super.connectedCallback(),this.loadData()}loadData(){const e=[];return e.push(this.restApiService.getAccount().then(e=>{e&&(this._username=e.username)})),e.push(this.restApiService.getConfig().then(e=>{this._passwordUrl=e&&e.auth.http_password_url||null})),Promise.all(e)}_handleGenerateTap(){this._generatedPassword="Generating...",this.$.generatedPasswordOverlay.open(),this.restApiService.generateAccountHttpPassword().then(e=>{this._generatedPassword=e})}_closeOverlay(){this.$.generatedPasswordOverlay.close()}_generatedPasswordOverlayClosed(){this._generatedPassword=""}};mP([Oo({type:String})],fP.prototype,"_username",void 0),mP([Oo({type:String})],fP.prototype,"_generatedPassword",void 0),mP([Oo({type:String})],fP.prototype,"_passwordUrl",void 0),fP=mP([Po("gr-http-password")],fP);const _P=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    tr th.emailAddressHeader,
    tr th.identityHeader {
      width: 15em;
      padding: 0 10px;
    }
    tr td.statusColumn,
    tr td.emailAddressColumn,
    tr td.identityColumn {
      word-break: break-word;
    }
    tr td.emailAddressColumn,
    tr td.identityColumn {
      padding: 4px 10px;
      width: 15em;
    }
    .deleteButton {
      float: right;
    }
    .deleteButton:not(.show) {
      display: none;
    }
    .space {
      margin-bottom: var(--spacing-l);
    }
  </style>
  <div class="gr-form-styles">
    <fieldset class="space">
      <table>
        <thead>
          <tr>
            <th class="statusHeader">Status</th>
            <th class="emailAddressHeader">Email Address</th>
            <th class="identityHeader">Identity</th>
            <th class="deleteHeader"></th>
          </tr>
        </thead>
        <tbody>
          <template
            is="dom-repeat"
            items="[[_identities]]"
            filter="filterIdentities"
          >
            <tr>
              <td class="statusColumn">[[_computeIsTrusted(item.trusted)]]</td>
              <td class="emailAddressColumn">[[item.email_address]]</td>
              <td class="identityColumn">
                [[_computeIdentity(item.identity)]]
              </td>
              <td class="deleteColumn">
                <gr-button
                  class$="deleteButton [[_computeHideDeleteClass(item.can_delete)]]"
                  on-click="_handleDeleteItem"
                >
                  Delete
                </gr-button>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </fieldset>
    <template is="dom-if" if="[[_showLinkAnotherIdentity]]">
      <fieldset>
        <a href$="[[_computeLinkAnotherIdentity()]]">
          <gr-button id="linkAnotherIdentity" link=""
            >Link Another Identity</gr-button
          >
        </a>
      </fieldset>
    </template>
  </div>
  <gr-overlay id="overlay" with-backdrop="">
    <gr-confirm-delete-item-dialog
      class="confirmDialog"
      on-confirm="_handleDeleteItemConfirm"
      on-cancel="_handleConfirmDialogCancel"
      item="[[_idName]]"
      item-type="id"
    ></gr-confirm-delete-item-dialog>
  </gr-overlay>
`;var vP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const yP=["OPENID","OAUTH"];let bP=class extends fi{constructor(){super(...arguments),this._identities=[],this.restApiService=i.restApiService}static get template(){return _P}loadData(){return this.restApiService.getExternalIds().then(e=>{this._identities=null!=e?e:[]})}_computeIdentity(e){return e&&e.startsWith("mailto:")?"":e}_computeHideDeleteClass(e){return e?"show":""}_handleDeleteItemConfirm(){return this.$.overlay.close(),this.restApiService.deleteAccountIdentity([this._idName]).then(()=>{this.loadData()})}_handleConfirmDialogCancel(){this.$.overlay.close()}_handleDeleteItem(e){const t=e.model.item.identity;t&&(this._idName=t,this.$.overlay.open())}_computeIsTrusted(e){return e?"":"Untrusted"}filterIdentities(e){return!e.identity.startsWith("username:")}_computeShowLinkAnotherIdentity(e){var t;return!(null===(t=null==e?void 0:e.auth)||void 0===t||!t.git_basic_auth_policy)&&yP.includes(e.auth.git_basic_auth_policy.toUpperCase())}_computeLinkAnotherIdentity(){const e=k()||"";let t=window.location.pathname;return e&&(t="/"+t.substring(e.length)),e+"/login/"+encodeURIComponent(t)+"?link"}};vP([Oo({type:Array})],bP.prototype,"_identities",void 0),vP([Oo({type:String})],bP.prototype,"_idName",void 0),vP([Oo({type:Object})],bP.prototype,"serverConfig",void 0),vP([Oo({type:Boolean,computed:"_computeShowLinkAnotherIdentity(serverConfig)"})],bP.prototype,"_showLinkAnotherIdentity",void 0),bP=vP([Po("gr-identities")],bP);const wP=mi`
  <style include="shared-styles">
    .buttonColumn {
      width: 2em;
    }
    .moveUpButton,
    .moveDownButton {
      width: 100%;
    }
    tbody tr:first-of-type td .moveUpButton,
    tbody tr:last-of-type td .moveDownButton {
      display: none;
    }
    td.urlCell {
      word-break: break-word;
    }
    .newUrlInput {
      min-width: 23em;
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="gr-form-styles">
    <table>
      <thead>
        <tr>
          <th class="nameHeader">Name</th>
          <th class="url-header">URL</th>
        </tr>
      </thead>
      <tbody>
        <template is="dom-repeat" items="[[menuItems]]">
          <tr>
            <td>[[item.name]]</td>
            <td class="urlCell">[[item.url]]</td>
            <td class="buttonColumn">
              <gr-button
                link=""
                data-index$="[[index]]"
                on-click="_handleMoveUpButton"
                class="moveUpButton"
                ></gr-button
              >
            </td>
            <td class="buttonColumn">
              <gr-button
                link=""
                data-index$="[[index]]"
                on-click="_handleMoveDownButton"
                class="moveDownButton"
                ></gr-button
              >
            </td>
            <td>
              <gr-button
                link=""
                data-index$="[[index]]"
                on-click="_handleDeleteButton"
                class="remove-button"
                >Delete</gr-button
              >
            </td>
          </tr>
        </template>
      </tbody>
      <tfoot>
        <tr>
          <th>
            <iron-input
              placeholder="New Title"
              on-keydown="_handleInputKeydown"
              bind-value="{{_newName}}"
            >
              <input
                is="iron-input"
                placeholder="New Title"
                on-keydown="_handleInputKeydown"
                bind-value="{{_newName}}"
              />
            </iron-input>
          </th>
          <th>
            <iron-input
              class="newUrlInput"
              placeholder="New URL"
              on-keydown="_handleInputKeydown"
              bind-value="{{_newUrl}}"
            >
              <input
                class="newUrlInput"
                is="iron-input"
                placeholder="New URL"
                on-keydown="_handleInputKeydown"
                bind-value="{{_newUrl}}"
              />
            </iron-input>
          </th>
          <th></th>
          <th></th>
          <th>
            <gr-button
              link=""
              disabled$="[[_computeAddDisabled(_newName, _newUrl)]]"
              on-click="_handleAddButton"
              >Add</gr-button
            >
          </th>
        </tr>
      </tfoot>
    </table>
  </div>
`;var CP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let SP=class extends fi{static get template(){return wP}_handleMoveUpButton(e){const t=Th(e).localTarget;if(!(t instanceof HTMLElement))return;const i=Number(t.dataset.index);if(0===i)return;const n=this.menuItems[i],o=this.menuItems[i-1];this.splice("menuItems",i-1,2,n,o)}_handleMoveDownButton(e){const t=Th(e).localTarget;if(!(t instanceof HTMLElement))return;const i=Number(t.dataset.index);if(i===this.menuItems.length-1)return;const n=this.menuItems[i],o=this.menuItems[i+1];this.splice("menuItems",i,2,o,n)}_handleDeleteButton(e){const t=Th(e).localTarget;if(!(t instanceof HTMLElement))return;const i=Number(t.dataset.index);this.splice("menuItems",i,1)}_handleAddButton(){this._computeAddDisabled(this._newName,this._newUrl)||(this.splice("menuItems",this.menuItems.length,0,{name:this._newName,url:this._newUrl,target:"_blank"}),this._newName="",this._newUrl="")}_computeAddDisabled(e,t){return!(null==e?void 0:e.length)||!(null==t?void 0:t.length)}_handleInputKeydown(e){13===e.keyCode&&(e.stopPropagation(),this._handleAddButton())}};CP([Oo({type:Array})],SP.prototype,"menuItems",void 0),CP([Oo({type:String})],SP.prototype,"_newName",void 0),CP([Oo({type:String})],SP.prototype,"_newUrl",void 0),SP=CP([Po("gr-menu-editor")],SP);const EP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    .statusHeader {
      width: 4em;
    }
    .keyHeader {
      width: 7.5em;
    }
    #viewKeyOverlay {
      padding: var(--spacing-xxl);
      width: 50em;
    }
    .publicKey {
      font-family: var(--monospace-font-family);
      font-size: var(--font-size-mono);
      line-height: var(--line-height-mono);
      overflow-x: scroll;
      overflow-wrap: break-word;
      width: 30em;
    }
    .closeButton {
      bottom: 2em;
      position: absolute;
      right: 2em;
    }
    #existing {
      margin-bottom: var(--spacing-l);
    }
    #existing .commentColumn {
      min-width: 27em;
      width: auto;
    }
  </style>
  <div class="gr-form-styles">
    <fieldset id="existing">
      <table>
        <thead>
          <tr>
            <th class="commentColumn">Comment</th>
            <th class="statusHeader">Status</th>
            <th class="keyHeader">Public key</th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <template is="dom-repeat" items="[[_keys]]" as="key">
            <tr>
              <td class="commentColumn">[[key.comment]]</td>
              <td>[[_getStatusLabel(key.valid)]]</td>
              <td>
                <gr-button link="" on-click="_showKey" data-index$="[[index]]"
                  >Click to View</gr-button
                >
              </td>
              <td>
                <gr-copy-clipboard
                  has-tooltip=""
                  button-title="Copy SSH public key to clipboard"
                  hide-input=""
                  text="[[key.ssh_public_key]]"
                >
                </gr-copy-clipboard>
              </td>
              <td>
                <gr-button
                  link=""
                  data-index$="[[index]]"
                  on-click="_handleDeleteKey"
                  >Delete</gr-button
                >
              </td>
            </tr>
          </template>
        </tbody>
      </table>
      <gr-overlay id="viewKeyOverlay" with-backdrop="">
        <fieldset>
          <section>
            <span class="title">Algorithm</span>
            <span class="value">[[_keyToView.algorithm]]</span>
          </section>
          <section>
            <span class="title">Public key</span>
            <span class="value publicKey">[[_keyToView.encoded_key]]</span>
          </section>
          <section>
            <span class="title">Comment</span>
            <span class="value">[[_keyToView.comment]]</span>
          </section>
        </fieldset>
        <gr-button class="closeButton" on-click="_closeOverlay"
          >Close</gr-button
        >
      </gr-overlay>
      <gr-button on-click="save" disabled$="[[!hasUnsavedChanges]]"
        >Save changes</gr-button
      >
    </fieldset>
    <fieldset>
      <section>
        <span class="title">New SSH key</span>
        <span class="value">
          <iron-autogrow-textarea
            id="newKey"
            autocomplete="on"
            bind-value="{{_newKey}}"
            placeholder="New SSH Key"
          ></iron-autogrow-textarea>
        </span>
      </section>
      <gr-button
        id="addButton"
        link=""
        disabled$="[[_computeAddButtonDisabled(_newKey)]]"
        on-click="_handleAddKey"
        >Add new SSH key</gr-button
      >
    </fieldset>
  </div>
`;var AP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let xP=class extends fi{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this._keys=[],this._newKey="",this._keysToRemove=[],this.restApiService=i.restApiService}static get template(){return EP}loadData(){return this.restApiService.getAccountSSHKeys().then(e=>{e&&(this._keys=e)})}save(){const e=this._keysToRemove.map(e=>this.restApiService.deleteAccountSSHKey(`${e.seq}`));return Promise.all(e).then(()=>{this._keysToRemove=[],this.hasUnsavedChanges=!1})}_getStatusLabel(e){return e?"Valid":"Invalid"}_showKey(e){const t=Th(e).localTarget,i=Number(t.getAttribute("data-index"));this._keyToView=this._keys[i],this.$.viewKeyOverlay.open()}_closeOverlay(){this.$.viewKeyOverlay.close()}_handleDeleteKey(e){const t=Th(e).localTarget,i=Number(t.getAttribute("data-index"));this.push("_keysToRemove",this._keys[i]),this.splice("_keys",i,1),this.hasUnsavedChanges=!0}_handleAddKey(){return this.$.addButton.disabled=!0,this.$.newKey.disabled=!0,this.restApiService.addAccountSSHKey(this._newKey.trim()).then(e=>{this.$.newKey.disabled=!1,this._newKey="",this.push("_keys",e)}).catch(()=>{this.$.addButton.disabled=!1,this.$.newKey.disabled=!1})}_computeAddButtonDisabled(e){return!e.length}};AP([Oo({type:Boolean,notify:!0})],xP.prototype,"hasUnsavedChanges",void 0),AP([Oo({type:Array})],xP.prototype,"_keys",void 0),AP([Oo({type:Object})],xP.prototype,"_keyToView",void 0),AP([Oo({type:String})],xP.prototype,"_newKey",void 0),AP([Oo({type:Array})],xP.prototype,"_keysToRemove",void 0),xP=AP([Po("gr-ssh-editor")],xP);const RP=mi`
  <style include="shared-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-form-styles">
    #watchedProjects .notifType {
      text-align: center;
      padding: 0 var(--spacing-s);
    }
    .notifControl {
      cursor: pointer;
      text-align: center;
    }
    .notifControl:hover {
      outline: 1px solid var(--border-color);
    }
    .projectFilter {
      color: var(--deemphasized-text-color);
      font-style: italic;
      margin-left: var(--spacing-l);
    }
    .newFilterInput {
      width: 100%;
    }
  </style>
  <div class="gr-form-styles">
    <table id="watchedProjects">
      <thead>
        <tr>
          <th>Repo</th>
          <template is="dom-repeat" items="[[_getTypes()]]">
            <th class="notifType">[[item.name]]</th>
          </template>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <template
          is="dom-repeat"
          items="[[_projects]]"
          as="project"
          index-as="projectIndex"
        >
          <tr>
            <td>
              [[project.project]]
              <template is="dom-if" if="[[project.filter]]">
                <div class="projectFilter">[[project.filter]]</div>
              </template>
            </td>
            <template is="dom-repeat" items="[[_getTypes()]]" as="type">
              <td class="notifControl" on-click="_handleNotifCellClick">
                <input
                  type="checkbox"
                  data-index$="[[projectIndex]]"
                  data-key$="[[type.key]]"
                  on-change="_handleCheckboxChange"
                  checked$="[[_computeCheckboxChecked(project, type.key)]]"
                />
              </td>
            </template>
            <td>
              <gr-button
                link=""
                data-index$="[[projectIndex]]"
                on-click="_handleRemoveProject"
                >Delete</gr-button
              >
            </td>
          </tr>
        </template>
      </tbody>
      <tfoot>
        <tr>
          <th>
            <gr-autocomplete
              id="newProject"
              query="[[_query]]"
              threshold="1"
              allow-non-suggested-values=""
              tab-complete=""
              placeholder="Repo"
            ></gr-autocomplete>
          </th>
          <th colspan$="[[_getTypeCount()]]">
            <iron-input
              class="newFilterInput"
              placeholder="branch:name, or other search expression"
            >
              <input
                id="newFilter"
                class="newFilterInput"
                is="iron-input"
                placeholder="branch:name, or other search expression"
              />
            </iron-input>
          </th>
          <th>
            <gr-button link="" on-click="_handleAddProject">Add</gr-button>
          </th>
        </tr>
      </tfoot>
    </table>
  </div>
`;var TP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const kP=[{name:"Changes",key:"notify_new_changes"},{name:"Patches",key:"notify_new_patch_sets"},{name:"Comments",key:"notify_all_comments"},{name:"Submits",key:"notify_submitted_changes"},{name:"Abandons",key:"notify_abandoned_changes"}];let PP=class extends fi{constructor(){super(),this.hasUnsavedChanges=!1,this._projectsToRemove=[],this.restApiService=i.restApiService,this._query=e=>this._getProjectSuggestions(e)}static get template(){return RP}loadData(){return this.restApiService.getWatchedProjects().then(e=>{this._projects=e})}save(){let e;return e=this._projectsToRemove.length?this.restApiService.deleteWatchedProjects(this._projectsToRemove):Promise.resolve(void 0),e.then(()=>this._projects?this.restApiService.saveWatchedProjects(this._projects):Promise.resolve(void 0)).then(e=>{this._projects=e,this._projectsToRemove=[],this.hasUnsavedChanges=!1})}_getTypes(){return kP}_getTypeCount(){return this._getTypes().length}_computeCheckboxChecked(e,t){return o(e,t)}_getProjectSuggestions(e){return this.restApiService.getSuggestedProjects(e).then(e=>{const t=[];for(const[i,n]of Object.entries(null!=e?e:{}))t.push({name:i,value:n.id});return t})}_handleRemoveProject(e){const t=Th(e).localTarget.getAttribute("data-index");if(null===t||!this._projects)return;const i=Number(t),n=this._projects[i];this.splice("_projects",i,1),this.push("_projectsToRemove",n),this.hasUnsavedChanges=!0}_canAddProject(e,t,i){if(null===e&&null===t)return!1;if(!e&&t)return!0;if(!this._projects)return!0;for(let t=0;t<this._projects.length;t++)if(this._projects[t].project===e&&this.areFiltersEqual(this._projects[t].filter,i))return!1;return!0}_getNewProjectIndex(e,t){if(!this._projects)return;let i;for(i=0;i<this._projects.length;i++){const n=this._projects[i].filter;if(this._projects[i].project>e||this._projects[i].project===e&&this.isFilterDefined(n)&&this.isFilterDefined(t)&&n>t)break}return i}_handleAddProject(){const e=this.$.newProject.value,t=this.$.newProject.text,i=this.$.newFilter.value||null;if(!this._canAddProject(e,t,i))return;const n=this._getNewProjectIndex(t,i);void 0!==n&&this.splice("_projects",n,0,{project:t,filter:i,_is_local:!0}),this.$.newProject.clear(),this.$.newFilter.value="",this.hasUnsavedChanges=!0}_handleCheckboxChange(e){const t=Th(e).localTarget;if(null===t)return;const i=t.getAttribute("data-index"),n=t.getAttribute("data-key");if(null===i||null===n)return;const o=Number(i),r=t.checked;this.set(["_projects",o,n],!!r),this.hasUnsavedChanges=!0}_handleNotifCellClick(e){if(null===e.target)return;const t=e.target.querySelector("input");t&&t.click()}isFilterDefined(e){return null!=e}areFiltersEqual(e,t){return!this.isFilterDefined(e)&&!this.isFilterDefined(t)||e===t}};TP([Oo({type:Boolean,notify:!0})],PP.prototype,"hasUnsavedChanges",void 0),TP([Oo({type:Array})],PP.prototype,"_projects",void 0),TP([Oo({type:Array})],PP.prototype,"_projectsToRemove",void 0),TP([Oo({type:Object})],PP.prototype,"_query",void 0),PP=TP([Po("gr-watched-projects-editor")],PP);const IP=mi`
  <style include="shared-styles">
    :host {
      color: var(--primary-text-color);
    }
    h2 {
      font-family: var(--header-font-family);
      font-size: var(--font-size-h2);
      font-weight: var(--font-weight-h2);
      line-height: var(--line-height-h2);
    }
    .newEmailInput {
      width: 20em;
    }
    #email {
      margin-bottom: var(--spacing-l);
    }
    .main section.darkToggle {
      display: block;
    }
    .filters p,
    .darkToggle p {
      margin-bottom: var(--spacing-l);
    }
    .queryExample em {
      color: violet;
    }
    .toggle {
      align-items: center;
      display: flex;
      margin-bottom: var(--spacing-l);
      margin-right: var(--spacing-l);
    }
  </style>
  <style include="gr-form-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-menu-page-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <style include="gr-page-nav-styles">
    /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */
  </style>
  <div class="loading" hidden$="[[!_loading]]">Loading...</div>
  <div hidden$="[[_loading]]" hidden="">
    <gr-page-nav class="navStyles">
      <ul>
        <li><a href="#Profile">Profile</a></li>
        <li><a href="#Preferences">Preferences</a></li>
        <li><a href="#DiffPreferences">Diff Preferences</a></li>
        <li><a href="#EditPreferences">Edit Preferences</a></li>
        <li><a href="#Menu">Menu</a></li>
        <li><a href="#ChangeTableColumns">Change Table Columns</a></li>
        <li><a href="#Notifications">Notifications</a></li>
        <li><a href="#EmailAddresses">Email Addresses</a></li>
        <template is="dom-if" if="[[_showHttpAuth(_serverConfig)]]">
          <li><a href="#HTTPCredentials">HTTP Credentials</a></li>
        </template>
        <li hidden$="[[!_serverConfig.sshd]]">
          <a href="#SSHKeys"> SSH Keys </a>
        </li>
        <li hidden$="[[!_serverConfig.receive.enable_signed_push]]">
          <a href="#GPGKeys"> GPG Keys </a>
        </li>
        <li><a href="#Groups">Groups</a></li>
        <li><a href="#Identities">Identities</a></li>
        <template
          is="dom-if"
          if="[[_serverConfig.auth.use_contributor_agreements]]"
        >
          <li>
            <a href="#Agreements">Agreements</a>
          </li>
        </template>
        <li><a href="#MailFilters">Mail Filters</a></li>
        <gr-endpoint-decorator name="settings-menu-item">
        </gr-endpoint-decorator>
      </ul>
    </gr-page-nav>
    <div class="main gr-form-styles">
      <h1 class="heading-1">User Settings</h1>
      <section class="darkToggle">
        <div class="toggle">
          <paper-toggle-button
            aria-labelledby="darkThemeToggleLabel"
            checked="[[_isDark]]"
            on-change="_handleToggleDark"
            on-click="_onTapDarkToggle"
          ></paper-toggle-button>
          <div id="darkThemeToggleLabel">Dark theme (alpha)</div>
        </div>
        <p>
          Gerrit's dark theme is in early alpha, and almost definitely will not
          play nicely with themes set by specific Gerrit hosts. Filing feedback
          via the link in the app footer is strongly encouraged!
        </p>
      </section>
      <h2 id="Profile" class$="[[_computeHeaderClass(_accountInfoChanged)]]">
        Profile
      </h2>
      <fieldset id="profile">
        <gr-account-info
          id="accountInfo"
          has-unsaved-changes="{{_accountInfoChanged}}"
        ></gr-account-info>
        <gr-button
          on-click="_handleSaveAccountInfo"
          disabled="[[!_accountInfoChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <h2 id="Preferences" class$="[[_computeHeaderClass(_prefsChanged)]]">
        Preferences
      </h2>
      <fieldset id="preferences">
        <section>
          <label class="title" for="changesPerPageSelect"
            >Changes per page</label
          >
          <span class="value">
            <gr-select bind-value="{{_localPrefs.changes_per_page}}">
              <select id="changesPerPageSelect">
                <option value="10">10 rows per page</option>
                <option value="25">25 rows per page</option>
                <option value="50">50 rows per page</option>
                <option value="100">100 rows per page</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section>
          <label class="title" for="dateTimeFormatSelect"
            >Date/time format</label
          >
          <span class="value">
            <gr-select bind-value="{{_localPrefs.date_format}}">
              <select id="dateTimeFormatSelect">
                <option value="STD">Jun 3 ; Jun 3, 2016</option>
                <option value="US">06/03 ; 06/03/16</option>
                <option value="ISO">06-03 ; 2016-06-03</option>
                <option value="EURO">3. Jun ; 03.06.2016</option>
                <option value="UK">03/06 ; 03/06/2016</option>
              </select>
            </gr-select>
            <gr-select
              bind-value="{{_localPrefs.time_format}}"
              aria-label="Time Format"
            >
              <select>
                <option value="HHMM_12">4:10 PM</option>
                <option value="HHMM_24">16:10</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section>
          <label class="title" for="emailNotificationsSelect"
            >Email notifications</label
          >
          <span class="value">
            <gr-select bind-value="{{_localPrefs.email_strategy}}">
              <select id="emailNotificationsSelect">
                <option value="CC_ON_OWN_COMMENTS">Every comment</option>
                <option value="ENABLED">Only comments left by others</option>
                <option value="ATTENTION_SET_ONLY">
                  Only when I am in the attention set
                </option>
                <option value="DISABLED">None</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section hidden$="[[!_localPrefs.email_format]]">
          <label class="title" for="emailFormatSelect">Email format</label>
          <span class="value">
            <gr-select bind-value="{{_localPrefs.email_format}}">
              <select id="emailFormatSelect">
                <option value="HTML_PLAINTEXT">HTML and plaintext</option>
                <option value="PLAINTEXT">Plaintext only</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section hidden$="[[!_localPrefs.default_base_for_merges]]">
          <span class="title">Default Base For Merges</span>
          <span class="value">
            <gr-select bind-value="{{_localPrefs.default_base_for_merges}}">
              <select>
                <option value="AUTO_MERGE">Auto Merge</option>
                <option value="FIRST_PARENT">First Parent</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section>
          <label class="title" for="relativeDateInChangeTable"
            >Show Relative Dates In Changes Table</label
          >
          <span class="value">
            <input
              id="relativeDateInChangeTable"
              type="checkbox"
              checked$="[[_localPrefs.relative_date_in_change_table]]"
              on-change="_handleRelativeDateInChangeTable"
            />
          </span>
        </section>
        <section>
          <span class="title">Diff view</span>
          <span class="value">
            <gr-select bind-value="{{_localPrefs.diff_view}}">
              <select>
                <option value="SIDE_BY_SIDE">Side by side</option>
                <option value="UNIFIED_DIFF">Unified diff</option>
              </select>
            </gr-select>
          </span>
        </section>
        <section>
          <label for="showSizeBarsInFileList" class="title"
            >Show size bars in file list</label
          >
          <span class="value">
            <input
              id="showSizeBarsInFileList"
              type="checkbox"
              checked$="[[_localPrefs.size_bar_in_change_table]]"
              on-change="_handleShowSizeBarsInFileListChanged"
            />
          </span>
        </section>
        <section>
          <label for="publishCommentsOnPush" class="title"
            >Publish comments on push</label
          >
          <span class="value">
            <input
              id="publishCommentsOnPush"
              type="checkbox"
              checked$="[[_localPrefs.publish_comments_on_push]]"
              on-change="_handlePublishCommentsOnPushChanged"
            />
          </span>
        </section>
        <section>
          <label for="workInProgressByDefault" class="title"
            >Set new changes to "work in progress" by default</label
          >
          <span class="value">
            <input
              id="workInProgressByDefault"
              type="checkbox"
              checked$="[[_localPrefs.work_in_progress_by_default]]"
              on-change="_handleWorkInProgressByDefault"
            />
          </span>
        </section>
        <section>
          <label for="insertSignedOff" class="title">
            Insert Signed-off-by Footer For Inline Edit Changes
          </label>
          <span class="value">
            <input
              id="insertSignedOff"
              type="checkbox"
              checked$="[[_localPrefs.signed_off_by]]"
              on-change="_handleInsertSignedOff"
            />
          </span>
        </section>
        <gr-button
          id="savePrefs"
          on-click="_handleSavePreferences"
          disabled="[[!_prefsChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <h2
        id="DiffPreferences"
        class$="[[_computeHeaderClass(_diffPrefsChanged)]]"
      >
        Diff Preferences
      </h2>
      <fieldset id="diffPreferences">
        <gr-diff-preferences
          id="diffPrefs"
          has-unsaved-changes="{{_diffPrefsChanged}}"
        ></gr-diff-preferences>
        <gr-button
          id="saveDiffPrefs"
          on-click="_handleSaveDiffPreferences"
          disabled$="[[!_diffPrefsChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <h2
        id="EditPreferences"
        class$="[[_computeHeaderClass(_editPrefsChanged)]]"
      >
        Edit Preferences
      </h2>
      <fieldset id="editPreferences">
        <gr-edit-preferences
          id="editPrefs"
          has-unsaved-changes="{{_editPrefsChanged}}"
        ></gr-edit-preferences>
        <gr-button
          id="saveEditPrefs"
          on-click="_handleSaveEditPreferences"
          disabled$="[[!_editPrefsChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <h2 id="Menu" class$="[[_computeHeaderClass(_menuChanged)]]">Menu</h2>
      <fieldset id="menu">
        <gr-menu-editor menu-items="{{_localMenu}}"></gr-menu-editor>
        <gr-button
          id="saveMenu"
          on-click="_handleSaveMenu"
          disabled="[[!_menuChanged]]"
          >Save changes</gr-button
        >
        <gr-button id="resetMenu" link="" on-click="_handleResetMenuButton"
          >Reset</gr-button
        >
      </fieldset>
      <h2
        id="ChangeTableColumns"
        class$="[[_computeHeaderClass(_changeTableChanged)]]"
      >
        Change Table Columns
      </h2>
      <fieldset id="changeTableColumns">
        <gr-change-table-editor
          show-number="{{_showNumber}}"
          server-config="[[_serverConfig]]"
          displayed-columns="{{_localChangeTableColumns}}"
        >
        </gr-change-table-editor>
        <gr-button
          id="saveChangeTable"
          on-click="_handleSaveChangeTable"
          disabled="[[!_changeTableChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <h2
        id="Notifications"
        class$="[[_computeHeaderClass(_watchedProjectsChanged)]]"
      >
        Notifications
      </h2>
      <fieldset id="watchedProjects">
        <gr-watched-projects-editor
          has-unsaved-changes="{{_watchedProjectsChanged}}"
          id="watchedProjectsEditor"
        ></gr-watched-projects-editor>
        <gr-button
          on-click="_handleSaveWatchedProjects"
          disabled$="[[!_watchedProjectsChanged]]"
          id="_handleSaveWatchedProjects"
          >Save changes</gr-button
        >
      </fieldset>
      <h2 id="EmailAddresses" class$="[[_computeHeaderClass(_emailsChanged)]]">
        Email Addresses
      </h2>
      <fieldset id="email">
        <gr-email-editor
          id="emailEditor"
          has-unsaved-changes="{{_emailsChanged}}"
        ></gr-email-editor>
        <gr-button on-click="_handleSaveEmails" disabled$="[[!_emailsChanged]]"
          >Save changes</gr-button
        >
      </fieldset>
      <fieldset id="newEmail">
        <section>
          <span class="title">New email address</span>
          <span class="value">
            <iron-input
              class="newEmailInput"
              bind-value="{{_newEmail}}"
              type="text"
              on-keydown="_handleNewEmailKeydown"
              placeholder="email@example.com"
            >
              <input
                class="newEmailInput"
                bind-value="{{_newEmail}}"
                is="iron-input"
                type="text"
                disabled="[[_addingEmail]]"
                on-keydown="_handleNewEmailKeydown"
                placeholder="email@example.com"
              />
            </iron-input>
          </span>
        </section>
        <section
          id="verificationSentMessage"
          hidden$="[[!_lastSentVerificationEmail]]"
        >
          <p>
            A verification email was sent to
            <em>[[_lastSentVerificationEmail]]</em>. Please check your inbox.
          </p>
        </section>
        <gr-button
          disabled="[[!_computeAddEmailButtonEnabled(_newEmail, _addingEmail)]]"
          on-click="_handleAddEmailButton"
          >Send verification</gr-button
        >
      </fieldset>
      <template is="dom-if" if="[[_showHttpAuth(_serverConfig)]]">
        <div>
          <h2 id="HTTPCredentials">HTTP Credentials</h2>
          <fieldset>
            <gr-http-password id="httpPass"></gr-http-password>
          </fieldset>
        </div>
      </template>
      <div hidden$="[[!_serverConfig.sshd]]">
        <h2 id="SSHKeys" class$="[[_computeHeaderClass(_keysChanged)]]">
          SSH keys
        </h2>
        <gr-ssh-editor
          id="sshEditor"
          has-unsaved-changes="{{_keysChanged}}"
        ></gr-ssh-editor>
      </div>
      <div hidden$="[[!_serverConfig.receive.enable_signed_push]]">
        <h2 id="GPGKeys" class$="[[_computeHeaderClass(_gpgKeysChanged)]]">
          GPG keys
        </h2>
        <gr-gpg-editor
          id="gpgEditor"
          has-unsaved-changes="{{_gpgKeysChanged}}"
        ></gr-gpg-editor>
      </div>
      <h2 id="Groups">Groups</h2>
      <fieldset>
        <gr-group-list id="groupList"></gr-group-list>
      </fieldset>
      <h2 id="Identities">Identities</h2>
      <fieldset>
        <gr-identities
          id="identities"
          server-config="[[_serverConfig]]"
        ></gr-identities>
      </fieldset>
      <template
        is="dom-if"
        if="[[_serverConfig.auth.use_contributor_agreements]]"
      >
        <h2 id="Agreements">Agreements</h2>
        <fieldset>
          <gr-agreements-list id="agreementsList"></gr-agreements-list>
        </fieldset>
      </template>
      <h2 id="MailFilters">Mail Filters</h2>
      <fieldset class="filters">
        <p>
          Gerrit emails include metadata about the change to support writing
          mail filters.
        </p>
        <p>
          Here are some example Gmail queries that can be used for filters or
          for searching through archived messages. View the
          <a
            href$="[[_getFilterDocsLink(_docsBaseUrl)]]"
            target="_blank"
            rel="nofollow"
            >Gerrit documentation</a
          >
          for the complete set of footers.
        </p>
        <table>
          <tbody>
            <tr>
              <th>Name</th>
              <th>Query</th>
            </tr>
            <tr>
              <td>Changes requesting my review</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Reviewer: <em>Your Name</em>
                  &lt;<em>your.email@example.com</em>&gt;"
                </code>
              </td>
            </tr>
            <tr>
              <td>Changes requesting my attention</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Attention: <em>Your Name</em>
                  &lt;<em>your.email@example.com</em>&gt;"
                </code>
              </td>
            </tr>
            <tr>
              <td>Changes from a specific owner</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Owner: <em>Owner name</em>
                  &lt;<em>owner.email@example.com</em>&gt;"
                </code>
              </td>
            </tr>
            <tr>
              <td>Changes targeting a specific branch</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Branch: <em>branch-name</em>"
                </code>
              </td>
            </tr>
            <tr>
              <td>Changes in a specific project</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Project: <em>project-name</em>"
                </code>
              </td>
            </tr>
            <tr>
              <td>Messages related to a specific Change ID</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Change-Id: <em>Change ID</em>"
                </code>
              </td>
            </tr>
            <tr>
              <td>Messages related to a specific change number</td>
              <td>
                <code class="queryExample">
                  "Gerrit-Change-Number: <em>change number</em>"
                </code>
              </td>
            </tr>
          </tbody>
        </table>
      </fieldset>
      <gr-endpoint-decorator name="settings-screen"> </gr-endpoint-decorator>
    </div>
  </div>
`;var OP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const NP=["changes_per_page","date_format","time_format","email_strategy","diff_view","publish_comments_on_push","work_in_progress_by_default","default_base_for_merges","signed_off_by","email_format","size_bar_in_change_table","relative_date_in_change_table"],LP=/^https?:/,DP=/\/$/,MP=["HTTP","HTTP_LDAP"];var FP;!function(e){e[e.PrefsToLocalPrefs=0]="PrefsToLocalPrefs",e[e.LocalPrefsToPrefs=1]="LocalPrefsToPrefs"}(FP||(FP={}));let $P=class extends(zb(fi)){constructor(){super(...arguments),this.prefs={},this._localPrefs={},this._localChangeTableColumns=[],this._localMenu=[],this._loading=!0,this._changeTableChanged=!1,this._prefsChanged=!1,this._menuChanged=!1,this._watchedProjectsChanged=!1,this._keysChanged=!1,this._gpgKeysChanged=!1,this._addingEmail=!1,this._lastSentVerificationEmail=null,this._isDark=!1,this.restApiService=i.restApiService,this.handleLocationChange=()=>{const e=window.location.hash;if(e){const t=(this.shadowRoot||document).querySelector(e);t&&t.scrollIntoView()}}}static get template(){return IP}connectedCallback(){super.connectedCallback(),window.addEventListener("location-change",this.handleLocationChange),xi(this,"Settings"),this._isDark=!!window.localStorage.getItem("dark-theme");const e=[this.$.accountInfo.loadData(),this.$.watchedProjectsEditor.loadData(),this.$.groupList.loadData(),this.$.identities.loadData(),this.$.editPrefs.loadData(),this.$.diffPrefs.loadData()];e.push(this.restApiService.getPreferences().then(e=>{if(!e)throw new Error("getPreferences returned undefined");this.prefs=e,this._showNumber=!!e.legacycid_in_change_table,this._copyPrefs(FP.PrefsToLocalPrefs),this._localMenu=this._cloneMenu(e.my),this._localChangeTableColumns=0===e.change_table.length?this.columnNames:this.renameProjectToRepoColumn(e.change_table)})),e.push(this.restApiService.getConfig().then(e=>{this._serverConfig=e;const t=[];return this._serverConfig&&this._serverConfig.sshd&&t.push(this.$.sshEditor.loadData()),this._serverConfig&&this._serverConfig.receive&&this._serverConfig.receive.enable_signed_push&&t.push(this.$.gpgEditor.loadData()),t.push(I(e,this.restApiService).then(e=>{this._docsBaseUrl=e})),Promise.all(t)})),this.params&&this.params.view===bs.SETTINGS&&this.params.emailToken?e.push(this.restApiService.confirmEmail(this.params.emailToken).then(e=>{e&&Ci(this,e),this.$.emailEditor.loadData()})):e.push(this.$.emailEditor.loadData()),this._testOnly_loadingPromise=Promise.all(e).then(()=>{this._loading=!1,this.handleLocationChange()})}disconnectedCallback(){window.removeEventListener("location-change",this.handleLocationChange),super.disconnectedCallback()}reloadAccountDetail(){Promise.all([this.$.accountInfo.loadData(),this.$.emailEditor.loadData()])}_isLoading(){return this._loading||void 0===this._loading}_copyPrefs(e){let t,i;e===FP.LocalPrefsToPrefs?(i=this._localPrefs,t="prefs"):(i=this.prefs,t="_localPrefs");for(let e=0;e<NP.length;e++)this.set([t,NP[e]],i[NP[e]])}_cloneMenu(e){return e.map(({id:e,...t})=>t)}_handleChangeTableChanged(){this._isLoading()||(this._changeTableChanged=!0)}_handlePrefsChanged(){this._isLoading()||(this._prefsChanged=!0)}_handleRelativeDateInChangeTable(){this.set("_localPrefs.relative_date_in_change_table",this.$.relativeDateInChangeTable.checked)}_handleShowSizeBarsInFileListChanged(){this.set("_localPrefs.size_bar_in_change_table",this.$.showSizeBarsInFileList.checked)}_handlePublishCommentsOnPushChanged(){this.set("_localPrefs.publish_comments_on_push",this.$.publishCommentsOnPush.checked)}_handleWorkInProgressByDefault(){this.set("_localPrefs.work_in_progress_by_default",this.$.workInProgressByDefault.checked)}_handleInsertSignedOff(){this.set("_localPrefs.signed_off_by",this.$.insertSignedOff.checked)}_handleMenuChanged(){this._isLoading()||(this._menuChanged=!0)}_handleSaveAccountInfo(){this.$.accountInfo.save()}_handleSavePreferences(){return this._copyPrefs(FP.LocalPrefsToPrefs),this.restApiService.savePreferences(this.prefs).then(()=>{this._prefsChanged=!1})}_handleSaveChangeTable(){return this.set("prefs.change_table",this._localChangeTableColumns),this.set("prefs.legacycid_in_change_table",this._showNumber),this.restApiService.savePreferences(this.prefs).then(()=>{this._changeTableChanged=!1})}_handleSaveDiffPreferences(){this.$.diffPrefs.save()}_handleSaveEditPreferences(){this.$.editPrefs.save()}_handleSaveMenu(){return this.set("prefs.my",this._localMenu),this.restApiService.savePreferences(this.prefs).then(()=>{this._menuChanged=!1})}_handleResetMenuButton(){return this.restApiService.getDefaultPreferences().then(e=>{(null==e?void 0:e.my)&&(this._localMenu=this._cloneMenu(e.my))})}_handleSaveWatchedProjects(){this.$.watchedProjectsEditor.save()}_computeHeaderClass(e){return e?"edited":""}_handleSaveEmails(){this.$.emailEditor.save()}_handleNewEmailKeydown(e){13===e.keyCode&&(e.stopPropagation(),this._handleAddEmailButton())}_isNewEmailValid(e){return!!e&&e.includes("@")}_computeAddEmailButtonEnabled(e,t){return this._isNewEmailValid(e)&&!t}_handleAddEmailButton(){this._isNewEmailValid(this._newEmail)&&(this._addingEmail=!0,this.restApiService.addAccountEmail(this._newEmail).then(e=>{this._addingEmail=!1,e.status<200||e.status>=300||(this._lastSentVerificationEmail=this._newEmail,this._newEmail="")}))}_getFilterDocsLink(e){let t=e;return t&&LP.test(t)||(t="https://gerrit-review.googlesource.com/Documentation"),t=t.replace(DP,""),t+"/user-notify.html"}_handleToggleDark(){this._isDark?(window.localStorage.removeItem("dark-theme"),function(){const e=document.head.querySelectorAll("#dark-theme");e.length&&e.forEach(e=>e.remove())}()):(window.localStorage.setItem("dark-theme","true"),rf()),this._isDark=!!window.localStorage.getItem("dark-theme"),Ci(this,`Theme changed to ${this._isDark?"dark":"light"}.`)}_showHttpAuth(e){return!!(e&&e.auth&&e.auth.git_basic_auth_policy)&&MP.includes(e.auth.git_basic_auth_policy.toUpperCase())}_onTapDarkToggle(e){e.preventDefault()}};OP([Oo({type:Object})],$P.prototype,"prefs",void 0),OP([Oo({type:Object})],$P.prototype,"params",void 0),OP([Oo({type:Boolean})],$P.prototype,"_accountInfoChanged",void 0),OP([Oo({type:Object})],$P.prototype,"_localPrefs",void 0),OP([Oo({type:Array})],$P.prototype,"_localChangeTableColumns",void 0),OP([Oo({type:Array})],$P.prototype,"_localMenu",void 0),OP([Oo({type:Boolean})],$P.prototype,"_loading",void 0),OP([Oo({type:Boolean})],$P.prototype,"_changeTableChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_prefsChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_diffPrefsChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_editPrefsChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_menuChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_watchedProjectsChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_keysChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_gpgKeysChanged",void 0),OP([Oo({type:String})],$P.prototype,"_newEmail",void 0),OP([Oo({type:Boolean})],$P.prototype,"_addingEmail",void 0),OP([Oo({type:String})],$P.prototype,"_lastSentVerificationEmail",void 0),OP([Oo({type:Object})],$P.prototype,"_serverConfig",void 0),OP([Oo({type:String})],$P.prototype,"_docsBaseUrl",void 0),OP([Oo({type:Boolean})],$P.prototype,"_emailsChanged",void 0),OP([Oo({type:Boolean})],$P.prototype,"_showNumber",void 0),OP([Oo({type:Boolean})],$P.prototype,"_isDark",void 0),OP([No("_localChangeTableColumns","_showNumber")],$P.prototype,"_handleChangeTableChanged",null),OP([No("_localPrefs.*")],$P.prototype,"_handlePrefsChanged",null),OP([No("_localMenu.splices")],$P.prototype,"_handleMenuChanged",null),$P=OP([Po("gr-settings-view")],$P);const BP=mi`
  <style include="shared-styles">
    :host {
      background-color: var(--background-color-tertiary);
      display: flex;
      flex-direction: column;
      min-height: 100%;
    }
    gr-main-header,
    footer {
      color: var(--primary-text-color);
    }
    gr-main-header {
      background: var(
        --header-background,
        var(--header-background-color, #eee)
      );
      padding: var(--header-padding);
      border-bottom: var(--header-border-bottom);
      border-image: var(--header-border-image);
      border-right: 0;
      border-left: 0;
      border-top: 0;
      box-shadow: var(--header-box-shadow);
      /* Make sure the header is above the main content, to preserve box-shadow
         visibility. We need 2 here instead of 1, because dropdowns in the
         header should be shown on top of the sticky diff header, which has a
         z-index of 1. */
      z-index: 2;
    }
    footer {
      background: var(
        --footer-background,
        var(--footer-background-color, #eee)
      );
      border-top: var(--footer-border-top);
      display: flex;
      justify-content: space-between;
      padding: var(--spacing-m) var(--spacing-l);
      z-index: 100;
    }
    main {
      flex: 1;
      padding-bottom: var(--spacing-xxl);
      position: relative;
    }
    .errorView {
      align-items: center;
      display: none;
      flex-direction: column;
      justify-content: center;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }
    .errorView.show {
      display: flex;
    }
    .errorEmoji {
      font-size: 2.6rem;
    }
    .errorText,
    .errorMoreInfo {
      margin-top: var(--spacing-m);
    }
    .errorText {
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
    }
    .errorMoreInfo {
      color: var(--deemphasized-text-color);
    }
    .feedback {
      color: var(--error-text-color);
    }
  </style>
  <gr-endpoint-decorator name="banner"></gr-endpoint-decorator>
  <gr-main-header
    id="mainHeader"
    search-query="{{params.query}}"
    on-mobile-search="_mobileSearchToggle"
    on-show-keyboard-shortcuts="handleShowKeyboardShortcuts"
    mobile-search-hidden="[[!mobileSearch]]"
    login-url="[[_loginUrl]]"
    aria-hidden="[[_footerHeaderAriaHidden]]"
  >
  </gr-main-header>
  <main aria-hidden="[[_mainAriaHidden]]">
    <template is="dom-if" if="[[mobileSearch]]">
      <gr-smart-search
        id="search"
        label="Search for changes"
        search-query="{{params.query}}"
        hidden="[[!mobileSearch]]"
      >
      </gr-smart-search>
    </template>
    <template is="dom-if" if="[[_showChangeListView]]" restamp="true">
      <gr-change-list-view
        params="[[params]]"
        account="[[_account]]"
        view-state="{{_viewState.changeListView}}"
      ></gr-change-list-view>
    </template>
    <template is="dom-if" if="[[_showDashboardView]]" restamp="true">
      <gr-dashboard-view
        account="[[_account]]"
        params="[[params]]"
        view-state="{{_viewState.dashboardView}}"
      ></gr-dashboard-view>
    </template>
    <template is="dom-if" if="[[_showChangeView]]" restamp="true">
      <gr-change-view
        params="[[params]]"
        view-state="{{_viewState.changeView}}"
        back-page="[[_lastSearchPage]]"
      ></gr-change-view>
    </template>
    <template is="dom-if" if="[[_showEditorView]]" restamp="true">
      <gr-editor-view params="[[params]]"></gr-editor-view>
    </template>
    <template is="dom-if" if="[[_showDiffView]]" restamp="true">
      <gr-diff-view
        params="[[params]]"
        change-view-state="{{_viewState.changeView}}"
      ></gr-diff-view>
    </template>
    <template is="dom-if" if="[[_showSettingsView]]" restamp="true">
      <gr-settings-view
        params="[[params]]"
        on-account-detail-update="_handleAccountDetailUpdate"
      >
      </gr-settings-view>
    </template>
    <template is="dom-if" if="[[_showAdminView]]" restamp="true">
      <gr-admin-view path="[[_path]]" params="[[params]]"></gr-admin-view>
    </template>
    <template is="dom-if" if="[[_showPluginScreen]]" restamp="true">
      <gr-endpoint-decorator name="[[_pluginScreenName]]">
        <gr-endpoint-param
          name="token"
          value="[[params.screen]]"
        ></gr-endpoint-param>
      </gr-endpoint-decorator>
    </template>
    <template is="dom-if" if="[[_showCLAView]]" restamp="true">
      <gr-cla-view></gr-cla-view>
    </template>
    <template is="dom-if" if="[[_showDocumentationSearch]]" restamp="true">
      <gr-documentation-search params="[[params]]"> </gr-documentation-search>
    </template>
    <div id="errorView" class="errorView">
      <div class="errorEmoji">[[_lastError.emoji]]</div>
      <div class="errorText">[[_lastError.text]]</div>
      <div class="errorMoreInfo">[[_lastError.moreInfo]]</div>
    </div>
  </main>
  <footer r="contentinfo" aria-hidden="[[_footerHeaderAriaHidden]]">
    <div>
      Powered by
      <a href="https://www.gerritcodereview.com/" rel="noopener" target="_blank"
        >Gerrit Code Review</a
      >
      ([[_version]])
      <gr-endpoint-decorator name="footer-left"></gr-endpoint-decorator>
    </div>
    <div>
      <template is="dom-if" if="[[_feedbackUrl]]">
        <a
          class="feedback"
          href$="[[_feedbackUrl]]"
          rel="noopener"
          target="_blank"
          >Report bug</a
        >
        |
      </template>
      Press ? for keyboard shortcuts
      <gr-endpoint-decorator name="footer-right"></gr-endpoint-decorator>
    </div>
  </footer>
  <template is="dom-if" if="[[loadKeyboardShortcutsDialog]]">
    <gr-overlay
      id="keyboardShortcuts"
      with-backdrop=""
      on-iron-overlay-canceled="onOverlayCanceled"
    >
      <gr-keyboard-shortcuts-dialog
        on-close="_handleKeyboardShortcutDialogClose"
      ></gr-keyboard-shortcuts-dialog>
    </gr-overlay>
  </template>
  <template is="dom-if" if="[[loadRegistrationDialog]]">
    <gr-overlay id="registrationOverlay" with-backdrop="">
      <gr-registration-dialog
        id="registrationDialog"
        settings-url="[[_settingsUrl]]"
        on-account-detail-update="_handleAccountDetailUpdate"
        on-close="_handleRegistrationDialogClose"
      >
      </gr-registration-dialog>
    </gr-overlay>
  </template>
  <gr-endpoint-decorator name="plugin-overlay"></gr-endpoint-decorator>
  <gr-error-manager
    id="errorManager"
    login-url="[[_loginUrl]]"
  ></gr-error-manager>
  <gr-router id="router"></gr-router>
  <gr-plugin-host id="plugins" config="[[_serverConfig]]"> </gr-plugin-host>
  <gr-external-style
    id="externalStyleForAll"
    name="app-theme"
  ></gr-external-style>
  <gr-external-style
    id="externalStyleForTheme"
    name="[[getThemeEndpoint()]]"
  ></gr-external-style>
`;var jP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let HP=class extends(Kf(fi)){constructor(){super(),this.keyEventTarget=document.body,this._lastGKeyPressTimestamp=null,this.mobileSearch=!1,this._loginUrl="/login",this.loadRegistrationDialog=!1,this.loadKeyboardShortcutsDialog=!1,this._footerHeaderAriaHidden=!1,this._mainAriaHidden=!1,this.reporting=i.reportingService,this.restApiService=i.restApiService,i.configService,this._bindKeyboardShortcuts(),document.addEventListener(vi.PAGE_ERROR,e=>{this._handlePageError(e)}),this.addEventListener(vi.TITLE_CHANGE,e=>{this._handleTitleChange(e)}),this.addEventListener(vi.DIALOG_CHANGE,e=>{this._handleDialogChange(e)}),this.addEventListener("location-change",e=>this._handleLocationChange(e)),document.addEventListener("gr-rpc-log",e=>this._handleRpcLog(e)),this.addEventListener("shortcut-triggered",e=>this._handleShortcutTriggered(e)),this.addEventListener("reload",()=>hu())}static get template(){return BP}keyboardShortcuts(){return{[Hf.OPEN_SHORTCUT_HELP_DIALOG]:"_showKeyboardShortcuts",[Hf.GO_TO_USER_DASHBOARD]:"_goToUserDashboard",[Hf.GO_TO_OPENED_CHANGES]:"_goToOpenedChanges",[Hf.GO_TO_MERGED_CHANGES]:"_goToMergedChanges",[Hf.GO_TO_ABANDONED_CHANGES]:"_goToAbandonedChanges",[Hf.GO_TO_WATCHED_CHANGES]:"_goToWatchedChanges"}}ready(){super.ready(),this._updateLoginUrl(),this.reporting.appStarted(),this.$.router.start(),this.restApiService.getAccount().then(e=>{this._account=e,e?this.reporting.reportLifeCycle(d.STARTED_AS_USER):this.reporting.reportLifeCycle(d.STARTED_AS_GUEST)}),this.restApiService.getConfig().then(e=>{this._serverConfig=e,e&&e.gerrit&&e.gerrit.report_bug_url&&(this._feedbackUrl=e.gerrit.report_bug_url)}),this.restApiService.getVersion().then(e=>{this._version=e,this._logWelcome()}),window.localStorage.getItem("dark-theme")&&rf(),this._settingsUrl=Qm.getUrlForSettings(),this._viewState={changeView:{changeNum:null,patchRange:null,selectedFileIndex:0,showReplyDialog:!1,showDownloadDialog:!1,diffMode:null,numFilesShown:null,scrollTop:0},changeListView:{query:null,offset:0,selectedChangeIndex:0},dashboardView:{}}}_bindKeyboardShortcuts(){this.bindShortcut(Hf.SEND_REPLY,$f.DOC_ONLY,"ctrl+enter","meta+enter"),this.bindShortcut(Hf.EMOJI_DROPDOWN,$f.DOC_ONLY,":"),this.bindShortcut(Hf.OPEN_SHORTCUT_HELP_DIALOG,"?"),this.bindShortcut(Hf.GO_TO_USER_DASHBOARD,$f.GO_KEY,"i"),this.bindShortcut(Hf.GO_TO_OPENED_CHANGES,$f.GO_KEY,"o"),this.bindShortcut(Hf.GO_TO_MERGED_CHANGES,$f.GO_KEY,"m"),this.bindShortcut(Hf.GO_TO_ABANDONED_CHANGES,$f.GO_KEY,"a"),this.bindShortcut(Hf.GO_TO_WATCHED_CHANGES,$f.GO_KEY,"w"),this.bindShortcut(Hf.CURSOR_NEXT_CHANGE,"j"),this.bindShortcut(Hf.CURSOR_PREV_CHANGE,"k"),this.bindShortcut(Hf.OPEN_CHANGE,"o"),this.bindShortcut(Hf.NEXT_PAGE,"n","]"),this.bindShortcut(Hf.PREV_PAGE,"p","["),this.bindShortcut(Hf.TOGGLE_CHANGE_REVIEWED,"r:keyup"),this.bindShortcut(Hf.TOGGLE_CHANGE_STAR,"s:keydown"),this.bindShortcut(Hf.REFRESH_CHANGE_LIST,"shift+r:keyup"),this.bindShortcut(Hf.EDIT_TOPIC,"t"),this.bindShortcut(Hf.OPEN_REPLY_DIALOG,"a:keyup"),this.bindShortcut(Hf.OPEN_DOWNLOAD_DIALOG,"d:keyup"),this.bindShortcut(Hf.EXPAND_ALL_MESSAGES,"x"),this.bindShortcut(Hf.COLLAPSE_ALL_MESSAGES,"z"),this.bindShortcut(Hf.REFRESH_CHANGE,"shift+r:keyup"),this.bindShortcut(Hf.UP_TO_DASHBOARD,"u"),this.bindShortcut(Hf.UP_TO_CHANGE,"u"),this.bindShortcut(Hf.TOGGLE_DIFF_MODE,"m:keyup"),this.bindShortcut(Hf.DIFF_AGAINST_BASE,$f.V_KEY,"down","s"),this.bindShortcut(Hf.DIFF_AGAINST_LATEST,$f.V_KEY,"up","w"),this.bindShortcut(Hf.DIFF_BASE_AGAINST_LEFT,$f.V_KEY,"left","a"),this.bindShortcut(Hf.DIFF_RIGHT_AGAINST_LATEST,$f.V_KEY,"right","d"),this.bindShortcut(Hf.DIFF_BASE_AGAINST_LATEST,$f.V_KEY,"b"),this.bindShortcut(Hf.NEXT_LINE,"j","down"),this.bindShortcut(Hf.PREV_LINE,"k","up"),this._isCursorManagerSupportMoveToVisibleLine()&&this.bindShortcut(Hf.VISIBLE_LINE,"."),this.bindShortcut(Hf.NEXT_CHUNK,"n"),this.bindShortcut(Hf.PREV_CHUNK,"p"),this.bindShortcut(Hf.TOGGLE_ALL_DIFF_CONTEXT,"shift+x"),this.bindShortcut(Hf.NEXT_COMMENT_THREAD,"shift+n"),this.bindShortcut(Hf.PREV_COMMENT_THREAD,"shift+p"),this.bindShortcut(Hf.EXPAND_ALL_COMMENT_THREADS,$f.DOC_ONLY,"e"),this.bindShortcut(Hf.COLLAPSE_ALL_COMMENT_THREADS,$f.DOC_ONLY,"shift+e"),this.bindShortcut(Hf.LEFT_PANE,"shift+left"),this.bindShortcut(Hf.RIGHT_PANE,"shift+right"),this.bindShortcut(Hf.TOGGLE_LEFT_PANE,"shift+a"),this.bindShortcut(Hf.NEW_COMMENT,"c"),this.bindShortcut(Hf.SAVE_COMMENT,"ctrl+enter","meta+enter","ctrl+s","meta+s"),this.bindShortcut(Hf.OPEN_DIFF_PREFS,","),this.bindShortcut(Hf.TOGGLE_DIFF_REVIEWED,"r:keyup"),this.bindShortcut(Hf.NEXT_FILE,"]"),this.bindShortcut(Hf.PREV_FILE,"["),this.bindShortcut(Hf.NEXT_FILE_WITH_COMMENTS,"shift+j"),this.bindShortcut(Hf.PREV_FILE_WITH_COMMENTS,"shift+k"),this.bindShortcut(Hf.CURSOR_NEXT_FILE,"j","down"),this.bindShortcut(Hf.CURSOR_PREV_FILE,"k","up"),this.bindShortcut(Hf.OPEN_FILE,"o","enter"),this.bindShortcut(Hf.TOGGLE_FILE_REVIEWED,"r:keyup"),this.bindShortcut(Hf.NEXT_UNREVIEWED_FILE,"shift+m"),this.bindShortcut(Hf.TOGGLE_ALL_INLINE_DIFFS,"shift+i:keyup"),this.bindShortcut(Hf.TOGGLE_INLINE_DIFF,"i:keyup"),this.bindShortcut(Hf.TOGGLE_BLAME,"b:keyup"),this.bindShortcut(Hf.TOGGLE_HIDE_ALL_COMMENT_THREADS,"h"),this.bindShortcut(Hf.OPEN_FILE_LIST,"f"),this.bindShortcut(Hf.OPEN_FIRST_FILE,"]"),this.bindShortcut(Hf.OPEN_LAST_FILE,"["),this.bindShortcut(Hf.SEARCH,"/")}_isCursorManagerSupportMoveToVisibleLine(){return"IntersectionObserver"in window}_accountChanged(e){e&&(this.restApiService.getPreferences(),this.restApiService.getDiffPreferences(),this.restApiService.getEditPreferences(),this.$.errorManager.knownAccountId=this._account&&this._account._account_id||null)}_viewChanged(e){this.$.errorView.classList.remove("show"),this.set("_showChangeListView",e===bs.SEARCH),this.set("_showDashboardView",e===bs.DASHBOARD),this.set("_showChangeView",e===bs.CHANGE),this.set("_showDiffView",e===bs.DIFF),this.set("_showSettingsView",e===bs.SETTINGS),this.set("_showAdminView",e===bs.ADMIN||e===bs.GROUP||e===bs.REPO),this.set("_showCLAView",e===bs.AGREEMENTS),this.set("_showEditorView",e===bs.EDIT);const t=e===bs.PLUGIN_SCREEN;if(this.set("_showPluginScreen",!1),t&&setTimeout(()=>this.set("_showPluginScreen",!0),1),this.set("_showDocumentationSearch",e===bs.DOCUMENTATION_SEARCH),this.params&&function(e){return void 0!==e.justRegistered}(this.params)&&this.params.justRegistered){this.loadRegistrationDialog=!0,yh();const e=this.shadowRoot.querySelector("#registrationOverlay"),t=this.shadowRoot.querySelector("#registrationDialog");e.open(),t.loadData().then(()=>{e.refit()})}Ti(this," ")}_handleShortcutTriggered(e){var t;const{event:i,goKey:n,vKey:o}=e.detail;let r=`${i.key}:${i.type}`;n&&(r="g+"+r),o&&(r="v+"+r),i.shiftKey&&(r="shift+"+r),i.ctrlKey&&(r="ctrl+"+r),i.metaKey&&(r="meta+"+r),i.altKey&&(r="alt+"+r);const s=e.composedPath();this.reporting.reportInteraction("shortcut-triggered",{key:r,from:null!==(t=s&&s[0]&&s[0].nodeName)&&void 0!==t?t:"unknown"})}_handlePageError(e){const t=["_showChangeListView","_showDashboardView","_showChangeView","_showDiffView","_showSettingsView","_showAdminView"];for(const e of t)this.set(e,!1);this.$.errorView.classList.add("show");const i=e.detail.response,n={text:[null==i?void 0:i.status,null==i?void 0:i.statusText].join(" ")};404===(null==i?void 0:i.status)?(n.emoji="\\_()_/",this._lastError=n):(n.emoji="o_O",i&&i.text().then(e=>{n.moreInfo=e,this._lastError=n}))}_handleLocationChange(e){this._updateLoginUrl();const t=e.detail.hash.substring(1);let i=e.detail.pathname;i.startsWith("/c/")&&Number(t)>0&&(i+="@"+t),this.set("_path",i)}_updateLoginUrl(){const e=k();this._loginUrl=e?e+"/login/"+encodeURIComponent("/"+window.location.pathname.substring(e.length)+window.location.search+window.location.hash):"/login/"+encodeURIComponent(window.location.pathname+window.location.search+window.location.hash)}_paramsChanged(e){const t=e.base,i=[bs.SEARCH,bs.DASHBOARD];(null==t?void 0:t.view)&&i.includes(t.view)&&this.set("_lastSearchPage",location.pathname)}_handleTitleChange(e){e.detail.title?document.title=e.detail.title+"  Gerrit Code Review":document.title=""}_handleDialogChange(e){e.detail.canceled?this._footerHeaderAriaHidden=!1:e.detail.opened&&(this._footerHeaderAriaHidden=!0)}handleShowKeyboardShortcuts(){this.loadKeyboardShortcutsDialog=!0,yh(),this.shadowRoot.querySelector("#keyboardShortcuts").open()}_showKeyboardShortcuts(e){this.loadKeyboardShortcutsDialog=!0,yh();const t=this.shadowRoot.querySelector("#keyboardShortcuts");t&&(t.opened?t.cancel():this.shouldSuppressKeyboardShortcut(e)||(t.open(),this._footerHeaderAriaHidden=!0,this._mainAriaHidden=!0))}_handleKeyboardShortcutDialogClose(){this.shadowRoot.querySelector("#keyboardShortcuts").cancel()}onOverlayCanceled(){this._footerHeaderAriaHidden=!1,this._mainAriaHidden=!1}_handleAccountDetailUpdate(){var e;this.$.mainHeader.reload(),(null===(e=this.params)||void 0===e?void 0:e.view)===bs.SETTINGS&&this.shadowRoot.querySelector("gr-settings-view").reloadAccountDetail()}_handleRegistrationDialogClose(){this.params.justRegistered=!1,this.shadowRoot.querySelector("#registrationOverlay").close()}_goToOpenedChanges(){Qm.navigateToStatusSearch("open")}_goToUserDashboard(){Qm.navigateToUserDashboard()}_goToMergedChanges(){Qm.navigateToStatusSearch("merged")}_goToAbandonedChanges(){Qm.navigateToStatusSearch("abandoned")}_goToWatchedChanges(){Qm.navigateToSearchQuery("is:watched is:open")}_computePluginScreenName(e){return e.view!==bs.PLUGIN_SCREEN?"":e.plugin&&e.screen?`${e.plugin}-screen-${e.screen}`:""}_logWelcome(){console.group("Runtime Info"),console.info("Gerrit UI (PolyGerrit)"),console.info(`Gerrit Server Version: ${this._version}`),window.VERSION_INFO&&console.info(`UI Version Info: ${window.VERSION_INFO}`),this._feedbackUrl&&console.info(`Please file bugs and feedback at: ${this._feedbackUrl}`),console.groupEnd()}_handleRpcLog(e){this.reporting.reportRpcTiming(e.detail.anonymizedUrl,e.detail.elapsed)}_mobileSearchToggle(){this.mobileSearch=!this.mobileSearch}getThemeEndpoint(){return window.localStorage.getItem("dark-theme")?"app-theme-dark":"app-theme-light"}};jP([Oo({type:Object})],HP.prototype,"params",void 0),jP([Oo({type:Object})],HP.prototype,"keyEventTarget",void 0),jP([Oo({type:Object,observer:"_accountChanged"})],HP.prototype,"_account",void 0),jP([Oo({type:Number})],HP.prototype,"_lastGKeyPressTimestamp",void 0),jP([Oo({type:Object})],HP.prototype,"_serverConfig",void 0),jP([Oo({type:String})],HP.prototype,"_version",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showChangeListView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showDashboardView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showChangeView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showDiffView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showSettingsView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showAdminView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showCLAView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showEditorView",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showPluginScreen",void 0),jP([Oo({type:Boolean})],HP.prototype,"_showDocumentationSearch",void 0),jP([Oo({type:Object})],HP.prototype,"_viewState",void 0),jP([Oo({type:Object})],HP.prototype,"_lastError",void 0),jP([Oo({type:String})],HP.prototype,"_lastSearchPage",void 0),jP([Oo({type:String})],HP.prototype,"_path",void 0),jP([Oo({type:String,computed:"_computePluginScreenName(params)"})],HP.prototype,"_pluginScreenName",void 0),jP([Oo({type:String})],HP.prototype,"_settingsUrl",void 0),jP([Oo({type:String})],HP.prototype,"_feedbackUrl",void 0),jP([Oo({type:Boolean})],HP.prototype,"mobileSearch",void 0),jP([Oo({type:String})],HP.prototype,"_loginUrl",void 0),jP([Oo({type:Boolean})],HP.prototype,"loadRegistrationDialog",void 0),jP([Oo({type:Boolean})],HP.prototype,"loadKeyboardShortcutsDialog",void 0),jP([Oo({type:Boolean})],HP.prototype,"_footerHeaderAriaHidden",void 0),jP([Oo({type:Boolean})],HP.prototype,"_mainAriaHidden",void 0),jP([No("params.view")],HP.prototype,"_viewChanged",null),jP([No("params.*")],HP.prototype,"_paramsChanged",null),HP=jP([Po("gr-app-element")],HP);const UP=mi`
  <gr-app-element id="app-element"></gr-app-element>
`;(function(){var e=this||self,t=function(t,i){t=t.split(".");var n,o=e;t[0]in o||void 0===o.execScript||o.execScript("var "+t[0]);for(;t.length&&(n=t.shift());)t.length||void 0===i?o=o[n]&&o[n]!==Object.prototype[n]?o[n]:o[n]={}:o[n]=i},i=function(e,t,i){return e.call.apply(e.bind,arguments)},n=function(e,t,i){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}},o=function(e,t,r){return(o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:n).apply(null,arguments)},r={align:1,alt:1,"aria-activedescendant":10,"aria-atomic":1,"aria-autocomplete":1,"aria-busy":1,"aria-checked":1,"aria-disabled":1,"aria-dropeffect":1,"aria-expanded":1,"aria-haspopup":1,"aria-hidden":1,"aria-invalid":1,"aria-label":1,"aria-level":1,"aria-live":1,"aria-multiline":1,"aria-multiselectable":1,"aria-orientation":1,"aria-posinset":1,"aria-pressed":1,"aria-readonly":1,"aria-relevant":1,"aria-required":1,"aria-selected":1,"aria-setsize":1,"aria-sort":1,"aria-valuemax":1,"aria-valuemin":1,"aria-valuenow":1,"aria-valuetext":1,autocapitalize:1,autocomplete:1,autocorrect:1,autofocus:1,bgcolor:1,border:1,checked:1,class:1,color:1,cols:1,colspan:1,contenteditable:1,dir:8,disabled:1,draggable:1,enctype:1,face:1,for:10,formenctype:1,frameborder:1,height:1,hidden:1,href:4,hreflang:1,id:10,ismap:1,itemid:1,itemprop:1,itemref:1,itemscope:1,itemtype:1,label:1,lang:1,list:10,loop:1,max:1,maxlength:1,min:1,multiple:1,muted:1,name:10,placeholder:1,preload:1,rel:1,required:1,reversed:1,role:1,rows:1,rowspan:1,selected:1,shape:1,size:1,sizes:1,span:1,spellcheck:1,src:4,start:1,step:1,style:5,summary:1,tabindex:1,target:8,title:1,translate:1,valign:1,value:1,width:1,wrap:1},s={a:{href:[{c:3}]},area:{href:[{c:3}]},audio:{src:[{c:3}]},blockquote:{cite:[{c:3}]},button:{formaction:[{c:3}],formmethod:[{c:1}],type:[{c:1}]},command:{type:[{c:1}]},content:{select:[{c:1}]},del:{cite:[{c:3}]},details:{open:[{c:1}]},form:{action:[{c:3}],method:[{c:1}]},iframe:{srcdoc:[{c:2}]},img:{src:[{c:3}],srcset:[{c:11}]},input:{formaction:[{c:3}],formmethod:[{c:1}],pattern:[{c:1}],readonly:[{c:1}],src:[{c:3}],type:[{c:1}]},ins:{cite:[{c:3}]},li:{type:[{c:1}]},link:{href:[{c:3,f:"rel",g:"alternate"},{c:3,f:"rel",g:"author"},{c:3,f:"rel",g:"bookmark"},{c:3,f:"rel",g:"canonical"},{c:3,f:"rel",g:"cite"},{c:3,f:"rel",g:"help"},{c:3,f:"rel",g:"icon"},{c:3,f:"rel",g:"license"},{c:3,f:"rel",g:"next"},{c:3,f:"rel",g:"prefetch"},{c:3,f:"rel",g:"dns-prefetch"},{c:3,f:"rel",g:"prerender"},{c:3,f:"rel",g:"preconnect"},{c:3,f:"rel",g:"preload"},{c:3,f:"rel",g:"prev"},{c:3,f:"rel",g:"search"},{c:3,f:"rel",g:"subresource"}],media:[{c:1}],nonce:[{c:1}],type:[{c:1}]},menuitem:{icon:[{c:3}]},ol:{type:[{c:1}]},q:{cite:[{c:3}]},script:{nonce:[{c:1}],type:[{c:1}]},source:{media:[{c:1}],src:[{c:3}]},style:{media:[{c:1}],nonce:[{c:1}]},table:{cellpadding:[{c:1}],cellspacing:[{c:1}]},textarea:{readonly:[{c:1}]},time:{datetime:[{c:1}]},video:{autoplay:[{c:1}],controls:[{c:1}],poster:[{c:3}],src:[{c:3}]}},a={a:1,abbr:1,address:1,applet:4,area:5,article:1,aside:1,audio:1,b:1,base:4,bdi:1,bdo:1,blockquote:1,body:1,br:5,button:1,canvas:1,caption:1,cite:1,code:1,col:5,colgroup:1,command:1,content:1,data:1,datalist:1,dd:1,del:1,details:1,dfn:1,dialog:1,div:1,dl:1,dt:1,em:1,embed:4,fieldset:1,figcaption:1,figure:1,font:1,footer:1,form:1,frame:1,frameset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,head:1,header:1,hr:5,html:1,i:1,iframe:1,img:5,input:5,ins:1,kbd:1,keygen:5,label:1,legend:1,li:1,link:5,main:1,map:1,mark:1,math:4,menu:1,menuitem:1,meta:4,meter:1,nav:1,noscript:1,object:4,ol:1,optgroup:1,option:1,output:1,p:1,param:5,picture:1,pre:1,progress:1,q:1,rb:1,rp:1,rt:1,rtc:1,ruby:1,s:1,samp:1,script:3,section:1,select:1,slot:1,small:1,source:5,span:1,strong:1,style:2,sub:1,summary:1,sup:1,svg:4,table:1,tbody:1,td:1,template:4,textarea:6,tfoot:1,th:1,thead:1,time:1,title:6,tr:1,track:5,u:1,ul:1,var:1,video:1,wbr:5},l=[{auto:!0,ltr:!0,rtl:!0},{_self:!0,_blank:!0}],c={"*":{dir:0,target:1}},d=function(){if(!u){var e=p,t={};for(i in e)t[i]=e[i];for(u=t,e=0,t=h.length;e<t;++e){var i=h[e];u[i.toLowerCase()]=i}}return u},h="aLink accessKey allowFullscreen bgColor cellPadding cellSpacing codeBase codeType contentEditable crossOrigin dateTime dirName formAction formEnctype formMethod formNoValidate formTarget frameBorder innerHTML innerText inputMode isMap longDesc marginHeight marginWidth maxLength mediaGroup minLength noHref noResize noShade noValidate noWrap nodeValue outerHTML outerText readOnly tabIndex textContent trueSpeed useMap vAlign vLink valueAsDate valueAsNumber valueType".split(" "),p={accept_charset:"acceptCharset",char:"ch",charoff:"chOff",checked:"defaultChecked",class:"className",for:"htmlFor",http_equiv:"httpEquiv",muted:"defaultMuted",selected:"defaultSelected",value:"defaultValue"},u=null,g=null,m={},f=!1,_=0,v=/^(?!(?:annotation-xml|color-profile|font-face|font-face(?:-(?:src|uri|format|name))?|missing-glyph)$)[a-z][a-z.0-9_\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u200c\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\udfff\uf900-\ufdcf\ufdf0-\ufffd]*-[\-a-z.0-9_\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u200c\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\udfff\uf900-\ufdcf\ufdf0-\ufffd]*$/,y=function(e,t){var i=window.customElements;if(f){for(var n=window.Polymer.telemetry.registrations,o=n.length,r=_;r<o;++r)m[n[r].is]=m;_=o}return i&&i.get(e)||m[e]===m?2:"HTMLUnknownElement"===t.name?1:"HTMLElement"===t.name&&v.test(e)?3:0},b=/(?!,)([^\t\n\f\r ]+)(?:[\t\n\f\r ]+([.0-9+\-]+[a-z]?))?/gi,w=/[\t\n\f\r ]+/,C=/[\t\n\f\r ,]+/g,S=function(e){return(e=e.split(w,2))?{url:e[0],metadata:e[1]}:null},E=function(e){var t=String(e.url).replace(C,encodeURIComponent);if(e=e.metadata){if(C.lastIndex=0,C.test(e))return null;t+=" "+e}return t},A=function(e,t,i){return i},x=function(e){function t(e){var t=this.getAttribute(e);return!t||/[\[\{]/.test(e)?null:t}var i=e.reportHandler||void 0,n=e.safeTypesBridge||A,h=/^$/;if(e=e.allowedIdentifierPrefixes)for(var p=0,u=e.length;p<u;++p)h=new RegExp(h.source+"|^"+String(e[p]).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"));i&&i(!1,"initResin");var m={},f=[,{h:null,j:function(e,t,i){return i},l:null,m:null},{h:null,j:null,l:null,m:"HTML"},{h:null,j:null,l:"about:invalid#zClosurez",m:"URL"},{h:null,j:null,l:"about:invalid#zClosurez",m:"RESOURCE_URL"},{h:null,j:null,l:"zClosurez",m:"STYLE"},,{h:null,j:null,l:" /*zClosurez*/ ",m:"JAVASCRIPT"},{h:null,j:function(e,t,i){i=String(i).toLowerCase();var n=null;return(e=c[e])&&(n=e[t]),(t=("number"==typeof n||((e=c["*"])&&(n=e[t]),"number"==typeof n))&&!0===l[n][String(i).toLowerCase()])?i:"zClosurez"},l:"zClosurez",m:null},{h:null,j:null,l:"zClosurez",m:"CONSTANT"},{h:null,j:function(e,t,i){return h.test(i)?i:"zClosurez"},l:"zClosurez",m:"CONSTANT"},{h:function(e,t,o){var r=o;if("string"==typeof r&&(r=(r=r.match(b))?r.map(S).filter(Boolean):[]),!Array.isArray(r))return"about:invalid#zClosurez";var s=r;r=[];var a=[],l={};if(Array.isArray(s))for(var c=0,d=s.length;c<d;++c){var h=s[c],p=h&&h.url;if(p){var u=n(p,"URL",l);if(u){var g=u!==l;(g?r:a).push({url:g?u:p,metadata:h.metadata})}}}else a.push(s);if(s=a.length?JSON.stringify(a):null,a=m,r.length){if(!Array.isArray(r))throw Error();a=r.map(E).filter(Boolean).join(" , ")||m}return s&&i&&i(!0,'Failed to sanitize attribute value of <%s>: <%s %s="%O">: %s',e,e,t,o,s),a===m?"about:invalid#zClosurez":a},j:null,l:null,m:null}],_={},v=document.createElement("polyresinuncustomized");return function(e,l,c,h){if(!h&&h!==document.all)return h;var p=e.nodeType;if(p!==Node.ELEMENT_NODE){if(p===Node.TEXT_NODE){if(l=!(p=e.parentElement),p&&p.nodeType===Node.ELEMENT_NODE){var u=p.localName;switch(y(u,p.constructor)){case 0:case 1:l=1===(p=Object.hasOwnProperty.call(a,u)?a[u]:null)||6===p;break;case 3:case 2:l=!0}}if(l)return""+n(h,"STRING",h)}return i&&i(!0,"Failed to sanitize %s %s%s node to value %O",e.parentElement&&e.parentElement.nodeName,"#text","",h),"zClosurez"}p=e.localName;var b=e.localName;if(e.getAttribute("is")||2!==y(b,e.constructor)){var w=_[b];w||(w=_[b]=document.createElement(b)),b=w}else b=v;switch(c){case"attribute":w=String(l).toLowerCase();var C=d()[w];if(("string"==typeof C?C:function(e){return String(e).replace(/\-([a-z])/g,(function(e,t){return t.toUpperCase()}))}(w))in b)break;return h;case"property":if(l in b)break;if(w=l.toLowerCase(),(w="string"==typeof(w=d()[w])?w:null)&&w in b)break;return h;default:throw Error(c+": "+typeof c)}if("attribute"==c)l=l.toLowerCase();else{if(!(c=g)){for(u in b={},c=d())b[c[u]]=u;c=g=b}l="string"==typeof(u=c[l])?u:String(l).replace(/([A-Z])/g,"-$1").toLowerCase()}e:{if(e=o(t,e),Object.hasOwnProperty.call(s,p)&&(u=s[p],Object.hasOwnProperty.call(u,l)&&(u=u[l])instanceof Array)){for(c=null,b=!1,w=0,C=u.length;w<C;++w){var S=u[w],E=S.f;if(!E){c=S.c;break e}if(null===c&&(c={}),(E=Object.hasOwnProperty.call(c,E)?c[E]:c[E]=e(E))===S.g){c=S.c;break e}null==E&&(b=!0)}if(b){c=null;break e}}c="number"==typeof(e=r[l])?e:null}return u=m,e=null,null!=c&&(b=(c=f[c]).m,e=c.l,b&&(u=n(h,b,m)),u===m&&(c.j?(u=""+n(h,"STRING",h),u=c.j(p,l,u)):c.h&&(u=c.h(p,l,h)),u===e&&(u=m))),u===m&&(u=e||"zClosurez",i&&i(!0,'Failed to sanitize attribute of <%s>: <%s %s="%O">',p,p,l,h)),u}};t("security.polymer_resin.install",(function(e){var t=x(e||{});if(/^1\./.test(Polymer.version)){f=!0;var i=Polymer.Base._computeFinalAnnotationValue;if(e=function(e,n,o,r){o=i.call(this,e,n,o,r);var s="property";return r&&r.propertyName?n=r.propertyName:s=r&&r.kind||"property",t(e,n,s,o)},Polymer.Base._computeFinalAnnotationValue=e,Polymer.Base._computeFinalAnnotationValue!==e)throw Error("Cannot replace _computeFinalAnnotationValue.  Is Polymer frozen?")}else{var n=Polymer.sanitizeDOMValue||Polymer.Settings&&Polymer.Settings.sanitizeDOMValue;if(e=function(e,i,o,r){return e=n?n.call(Polymer,e,i,o,r):e,r?t(r,i,o,e):"zClosurez"},Polymer.Settings&&Polymer.Settings.o)Polymer.Settings.o(e);else if(Polymer.sanitizeDOMValue=e,Polymer.sanitizeDOMValue!==e)throw Error("Cannot install sanitizeDOMValue.  Is Polymer frozen?")}})),t("security.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER",(function(e,t,i){for(var n=[t],o=2,r=arguments.length;o<r;++o)n[o-1]=arguments[o];e?console.warn.apply(console,n):console.log.apply(console,n)}))}).call(window);const GP=window.security;GP.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER;var zP=window&&window.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};he=!1,Q(!0),function(e,t=GP.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER){window.security.polymer_resin.install({allowedIdentifierPrefixes:[""],reportHandler:t,safeTypesBridge:e})}((function(e,i){if("URL"===i){let i=null;if(e instanceof t?i=e:"string"==typeof e&&(i=new t(e)),i)return i.toString()}if("STRING"===i||"CONSTANT"===i)return e;throw new Error(`Refused to bind value as ${i}: ${e}`)}));let VP=class extends fi{static get template(){return UP}};VP=zP([Po("gr-app")],VP),window.GrAnnotation=Dm,window.page=$m,window.GrPluginActionContext=Bm,window.Gerrit=window.Gerrit||{},window.Gerrit.Nav=Qm,window.Gerrit.Auth=i.authService,jE();